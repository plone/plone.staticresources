{"version":3,"file":"chunks/27479.f32c00b66c713f4e1733.min.js","mappings":"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","sources":["webpack://plone.staticresources/./node_modules/mockup/src/pat/controlpanels/contentrules--implementation.js"],"sourcesContent":["import $ from \"jquery\";\nimport Modal from \"../modal/modal\";\n\nexport default class Contentrules {\n    constructor(el) {\n        this.el = el;\n    }\n    updatezebra(table) {\n        table.find(\"tr:visible:odd\").removeClass(\"odd even\").addClass(\"odd\");\n        table.find(\"tr:visible:even\").removeClass(\"odd even\").addClass(\"even\");\n    }\n\n    initStatusMessageArea() {\n        let msgWrapper = document.getElementById(\"portalMessagesWrapper\");\n        if (msgWrapper) {\n            return;\n        }\n        let newNode = document.createElement(\"div\");\n        newNode.id = \"portalMessagesWrapper\";\n        document.getElementById(\"content\").insertAdjacentElement(\"afterbegin\", newNode);\n    }\n\n    addStatusMessage(message, type) {\n        if (type === undefined) {\n            type = \"info\";\n        }\n        let msgDlNode = document.createElement(\"dl\");\n        let msgDtNode = document.createElement(\"dt\");\n        let msgDdNode = document.createElement(\"dd\");\n\n        msgDlNode.classList.add(\"alert\", \"alert-\" + type);\n        msgDtNode.innerText = type;\n        msgDdNode.innerText = message;\n        msgDlNode.appendChild(msgDtNode);\n        msgDlNode.appendChild(msgDdNode);\n\n        let msgWrapper = document.getElementById(\"portalMessagesWrapper\")\n        if(!msgWrapper) {return};\n        msgWrapper.innerHTML = \"\";\n        msgWrapper.appendChild(msgDlNode);\n    }\n\n    init() {\n        let self = this;\n        self.initStatusMessageArea();\n\n        // TODO find out why is it binding multiple times\n        $(\".btn-rule-action\")\n            .unbind(\"click\")\n            .bind(\"click\", function (e) {\n                e.preventDefault();\n\n                var $this = $(this),\n                    triggerEl = this,\n                    $row = $this.parents(\"tr\").first(),\n                    $table = $row.parent(),\n                    id = $this.data(\"value\"),\n                    url = $this.data(\"url\");\n\n                $.ajax({\n                    type: \"POST\",\n                    url: url,\n                    data: {\n                        \"rule-id\": id,\n                        \"_authenticator\": $('input[name=\"_authenticator\"]').val(),\n                    },\n                    beforeSend: function () {\n                        $(\"#spinner\").show();\n                    },\n                    error: function () {\n                        self.addStatusMessage($(\"#trns_form_error\").html(), \"warn\");\n                    },\n                    success: function () {\n                        let ruleTitle = \"\";\n                        ruleTitle = $row.find(\".rule-title\")[0].innerText;\n\n                        // Enable\n                        if ($this.hasClass(\"btn-rule-enable\")) {\n                            $row.removeClass(\"state-disabled\").addClass(\"state-enabled\");\n                            triggerEl.parentNode.querySelector(\".btn-rule-enable\").classList.add(\"d-none\")\n                            triggerEl.parentNode.querySelector(\".btn-rule-disable\").classList.remove(\"d-none\")\n                            self.addStatusMessage($(\"#trns_form_success_enabled\").html() + \": \" + ruleTitle, \"info\");\n                        }\n\n                        // Disable\n                        if ($this.hasClass(\"btn-rule-disable\")) {\n                            $row.removeClass(\"state-enabled\").addClass(\"state-disabled\");\n                            triggerEl.parentNode.querySelector(\".btn-rule-disable\").classList.add(\"d-none\")\n                            triggerEl.parentNode.querySelector(\".btn-rule-enable\").classList.remove(\"d-none\")\n                            self.addStatusMessage($(\"#trns_form_success_disabled\").html() + \": \" + ruleTitle, \"info\");\n                        }\n\n                        // DELETE\n                        if ($this.hasClass(\"btn-rule-delete\")) {\n                            $row.remove();\n                            self.updatezebra($table);\n                            self.addStatusMessage($(\"#trns_form_success_deleted\").html() + \": \" + ruleTitle, \"info\");\n                        }\n                    },\n                    complete: function () {\n                        $(\"#spinner\").hide();\n                    },\n                });\n            });\n\n        $(\".filter-option input\")\n            .unbind(\"change\")\n            .bind(\"change\", function () {\n                // Go through the checkboxes and map up what is the filtering criterea\n                var $table = $(\"#rules_table_form table\");\n                var state_filters = $(\".state-filters input:checked\");\n                var type_filters = $(\".type-filters input:checked\");\n\n                $table.find(\"tr\").show();\n                if (state_filters.length > 0) {\n                    $(\".state-filters input:not(:checked)\").each(function () {\n                        $table.find(\".\" + this.id).hide();\n                    });\n                }\n                if (type_filters.length > 0) {\n                    $(\".type-filters input:not(:checked)\").each(function () {\n                        $table.find(\".\" + this.id).hide();\n                    });\n                }\n                self.updatezebra($table);\n            });\n\n        $(\"#rules_disable_globally\").change(function () {\n            var form = $(\"#fieldset-global form\");\n            var disabled = \"\";\n            if ($(\"#rules_disable_globally\")[0].checked) {\n                disabled = \"True\";\n            }\n\n            $.ajax({\n                type: \"POST\",\n                url: form.attr(\"action\"),\n                data: {\n                    \"global_disable:boolean\": disabled,\n                    \"_authenticator\": $('input[name=\"_authenticator\"]').val(),\n                },\n                beforeSend: function () {\n                    $(\"#spinner\").show();\n                },\n                error: function () {\n                    self.addStatusMessage($(\"#trns_form_error\").html(), \"warn\");\n                },\n                success: function () {\n                    self.addStatusMessage($(\"#trns_form_success\").html(), \"info\");\n                },\n                complete: function () {\n                    $(\"#spinner\").hide();\n                },\n            });\n        });\n    }\n}\n"],"names":["Contentrules","el","this","table","find","removeClass","addClass","document","getElementById","newNode","createElement","id","insertAdjacentElement","message","type","undefined","msgDlNode","msgDtNode","msgDdNode","classList","add","innerText","appendChild","msgWrapper","innerHTML","self","initStatusMessageArea","$","unbind","bind","e","preventDefault","$this","triggerEl","$row","parents","first","$table","parent","data","url","val","beforeSend","show","error","addStatusMessage","html","success","ruleTitle","hasClass","parentNode","querySelector","remove","updatezebra","complete","hide","state_filters","type_filters","length","each","change","form","disabled","checked","attr"],"sourceRoot":""}