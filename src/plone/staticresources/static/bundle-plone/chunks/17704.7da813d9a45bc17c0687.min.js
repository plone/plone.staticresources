(self.webpackChunkplone_staticresources=self.webpackChunkplone_staticresources||[]).push([[17704],{11191:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var a=n(85330),i=n.n(a),o=n(50033),r=n(7424),s={getOptions(e,t,n){n=n||{},0===e.length||i().nodeName(e[0],"body")||(n=this.getOptions(e.parent(),t,n));let a={};if(0!==e.length&&(a=e.data("pat-"+t),a&&"string"==typeof a)){const e={};i().each(a.split(";"),(function(t,n){(n=n.split(":")).reverse();let a=n.pop();a=a.replace(/^\s+|\s+$/g,""),n.reverse();let i=n.join(":");i=i.replace(/^\s+|\s+$/g,""),e[a]=i})),a=e}return i().extend(!0,{},n,a)}};const l=r.Z.getLogger("Patternslib Base"),c=function(e,t,n){e.jquery||(e=i()(e));const a=this.prototype.name,l=r.Z.getLogger(`pat.${a}`);let c=e.data(`pattern-${a}`);if(void 0===c&&o.Z.patterns[a])try{e.data(`pattern-${a}`,"initializing"),t="mockup"===this.prototype.parser?s.getOptions(e,a,t):t,c=new o.Z.patterns[a](e,t,n)}catch(e){l.error(`Failed while initializing ${a} pattern.`,e)}return c},d=async function(e,t,n){e?.jquery&&0===e.length||!e?l.warn("No element given to pattern."):(e.jquery||(e=i()(e)),this.$el=e,this.el=e[0],this.options=i().extend(!0,{},this.defaults||{},t||{}),this.emit("pre-init"),await this.init(e,t,n),this.$el.data(`pattern-${this.name}`,this),this.el[`pattern-${this.name}`]=this,this.emit("init"))};d.prototype={constructor:d,on(e,t){this.$el.on(`${e}.${this.name}.patterns`,t)},one(e,t){this.$el.one(`${e}.${this.name}.patterns`,t)},emit(e,t){void 0===t&&(t=[]),this.$el.trigger(`${e}.${this.name}.patterns`,t)}},d.extend=function(e){const t=this;let n;if(!e)throw new Error("Pattern configuration properties required when calling Base.extend");n=Object.hasOwnProperty.call(e,"constructor")?e.constructor:function(){t.apply(this,arguments)},n.extend=d.extend,n.init=c,n.jquery_plugin=!0,n.trigger=e.trigger,n.parser=e?.parser||null;var a=function(){this.constructor=n};return a.prototype=t.prototype,n.prototype=new a,i().extend(!0,n.prototype,e),n.__super__=t.prototype,e.name?e.trigger?!1!==e.autoregister&&o.Z.register(n,e.name):l.warn(`The pattern ${e.name} does not have a trigger attribute, it will not be registered.`):l.warn("This pattern without a name attribute will not be registered!"),n};var p=d},32751:function(e,t,n){"use strict";n.d(t,{o:function(){return o}});var a=n(18742);const i=n(7424).Z.getLogger("basepattern");class o{static name;static trigger;static parser;parser_group_options=!0;parser_multiple=void 0;parser_inherit=!0;constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.name=this.constructor.name,this.trigger=this.constructor.trigger,this.parser=this.constructor.parser,e?(e.jquery&&(e=e[0]),this.el=e,this.el.dispatchEvent(new Event(`pre-init.${this.name}.patterns`,{bubbles:!0,cancelable:!0})),window.setTimeout((async()=>{if(void 0!==this.el[`pattern-${this.name}`])return i.debug(`Not reinstatiating the pattern ${this.name}.`,this.el),void this.el.dispatchEvent(new Event(`not-init.${this.name}.patterns`,{bubbles:!0,cancelable:!1}));this.options=this.parser?.parse(this.el,t,this.parser_multiple,this.parser_inherit,this.parser_group_options)??t,this.el[`pattern-${this.name}`]=this,await this.init(),this.el.dispatchEvent(new Event(`init.${this.name}.patterns`,{bubbles:!0,cancelable:!0}))}),0)):i.warn(`No element given to pattern ${this.name}.`)}async init(){}one(e,t){a.Z.add_event_listener(this.el,`${e}.${this.name}.patterns`,`basepattern-one--${e}.${this.name}.patterns`,t,{once:!0})}destroy(){delete this.el[`pattern-${this.name}`]}}},32218:function(e,t,n){"use strict";var a=n(18742);const i=n(7424).Z.getLogger("core dom"),o="__patternslib__data_prefix__",r="__patternslib__style__display";function s(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=window.getComputedStyle(e).getPropertyValue(t);return(n||a)&&(i=parseFloat(i)||0),n&&!a&&(i=parseInt(Math.round(i),10)),i}const l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body;t===window&&(t=document.body);const n=Math.abs(e.getBoundingClientRect().left+t.scrollLeft-t.getBoundingClientRect().left-c.get_css_value(t,"border-left-width",!0));return{top:Math.abs(e.getBoundingClientRect().top+t.scrollTop-t.getBoundingClientRect().top-c.get_css_value(t,"border-top-width",!0)),left:n}},c={toNodeArray:e=>(e.jquery||e instanceof NodeList?e=[...e]:e instanceof Array==!1&&(e=[e]),e),querySelectorAllAndMe:(e,t)=>{if(!e)return[];const n=[...e.querySelectorAll(t)];return e.matches(t)&&n.unshift(e),n},wrap:(e,t)=>{e.parentNode.insertBefore(t,e),t.appendChild(e)},hide:e=>{"none"!==e.style.display&&(e.style.display&&(e[r]=e.style.display),e.style.display="none")},show:e=>{const t=e[r]||null;e.style.display=t,delete e[r]},find_parents:(e,t)=>{const n=[];let a=e;for(;a;)a=a.parentNode?.closest?.(t),a&&n.push(a);return n},find_scoped:(e,t)=>(0===t.indexOf("#")?document:e).querySelectorAll(t),get_parents:e=>{const t=[];let n=e?.parentNode;for(;n;)t.push(n),n=n?.parentNode,n=n instanceof HTMLElement?n:null;return t},acquire_attribute:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=e;const o=[];for(;i;){const e=i.getAttribute(t);if(e||n&&""===e){if(!a)return e;o.push(e)}i=i.parentElement}if(a)return o},is_visible:e=>e.offsetWidth>0&&e.offsetHeight>0,is_input:e=>/^(?:input|select|textarea|button)$/i.test(e.nodeName),create_from_string:e=>document.createRange().createContextualFragment(e.trim()),get_css_value:s,find_scroll_container:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document.body;for(;e&&e!==document.body;){if(!t||"y"===t){let t=s(e,"overflow-y");if(["auto","scroll"].includes(t))return e}if(!t||"x"===t){let t=s(e,"overflow-x");if(["auto","scroll"].includes(t))return e}e=e.parentElement}return n},get_scroll_x:e=>void 0!==e.scrollLeft?e.scrollLeft:e.scrollX,get_scroll_y:e=>void 0!==e.scrollTop?e.scrollTop:e.scrollY,get_relative_position:l,scroll_to_element:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"top";const i=l(e,t),o={behavior:"auto"};"top"!==a&&"both"!==a||(o.top=i.top-n),"left"!==a&&"both"!==a||(o.left=i.left-n),t.scrollTo(o)},scroll_to_top:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.scrollTo({top:0-t,behavior:"auto"})},scroll_to_bottom:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(e===window?document.body:e).scrollHeight;e.scrollTo({top:n-t,behavior:"auto"})},get_data:(e,t,n)=>e[`${o}${t}`]||n,set_data:(e,t,n)=>{e[`${o}${t}`]=n},delete_data:(e,t)=>{delete e[`${o}${t}`]},template:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.warn("Using dom.template is not recommended due to a problem with Content-Security-Policy."),new Function("return `"+e+"`;").call(t)},get_visible_ratio:(e,t)=>{if(!e)return 0;const n=e.getBoundingClientRect(),a=t!==window?t.getBoundingClientRect():{top:0,bottom:window.innerHeight};let i=0;if(n.top<a.bottom&&n.bottom>a.top){const e=n.bottom-n.top;i=(Math.min(n.bottom,a.bottom)-Math.max(n.top,a.top))/e}return i},escape_css_id:e=>`#${CSS.escape(e.split("#")[1])}`,add_event_listener:a.Z.add_event_listener,remove_event_listener:a.Z.remove_event_listener};t.Z=c},18742:function(e,t,n){"use strict";const a={},i=(e,t)=>{if(!e?.removeEventListener)return;const n=a[e];if(!n)return;let i;if(t){const e=n[t];i=e?[e]:[]}else i=Object.entries(n);for(const t of i||[])e.removeEventListener(t[0],t[1],t[2])};t.Z={add_event_listener:function(e,t,n,o){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(!e?.addEventListener)return;i(e,n),a[e]||(a[e]={});let s=o;!0===r?.once&&(s=t=>{delete a[e][n],o(t)}),a[e][n]=[t,s,r.capture?r:void 0],e.addEventListener(t,s,r)},remove_event_listener:i,await_event:(e,t)=>new Promise((n=>e.addEventListener(t,n,{once:!0}))),await_pattern_init:e=>new Promise(((t,n)=>{e.one("init",(n=>{n.target===e.el&&(i(e.el,`basepattern-one--not-init.${e.name}.patterns`),t())})),e.one("not-init",(t=>{t.target===e.el&&(i(e.el,`basepattern-one--init.${e.name}.patterns`),n())}))})).catch((()=>{throw new Error(`Pattern "${e.name}" not initialized.`)})),blur_event:()=>new Event("blur",{bubbles:!1,cancelable:!1}),click_event:()=>new Event("click",{bubbles:!0,cancelable:!0}),change_event:()=>new Event("change",{bubbles:!0,cancelable:!1}),focus_event:()=>new Event("focus",{bubbles:!1,cancelable:!1}),input_event:()=>new Event("input",{bubbles:!0,cancelable:!1}),mousedown_event:()=>new Event("mousedown",{bubbles:!0,cancelable:!0}),mouseup_event:()=>new Event("mouseup",{bubbles:!0,cancelable:!0}),scroll_event:()=>new Event("scroll",{bubbles:!0,cancelable:!1}),submit_event:()=>new Event("submit",{bubbles:!0,cancelable:!0}),dragstart_event:()=>new Event("dragstart",{bubbles:!0,cancelable:!0}),dragend_event:()=>new Event("dragend",{bubbles:!0,cancelable:!0})}},7424:function(e,t){"use strict";var n,a;Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,a=function(){},i=function(){return n.apply(this instanceof a&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return a.prototype=this.prototype,i.prototype=new a,i});var i={DEBUG:10,INFO:20,WARN:30,ERROR:40,FATAL:50};function o(){}function r(e,t){this._loggers={},this.name=e||"",this._parent=t||null,t||(this._enabled=!0,this._level=i.WARN)}function s(e){a=e}o.prototype={output:function(e,t,n){e&&n.unshift(e+":"),t<=i.DEBUG?(n.unshift("[DEBUG]"),console.log.apply(console,n)):t<=i.INFO?console.info.apply(console,n):t<=i.WARN?console.warn.apply(console,n):console.error.apply(console,n)}},r.prototype={getLogger:function(e){for(var t=e.split("."),n=this,a=this.name?[this.name]:[];t.length;){var i=t.shift();a.push(i),i in n._loggers||(n._loggers[i]=new r(a.join("."),n)),n=n._loggers[i]}return n},_getFlag:function(e){var t=this;for(e="_"+e;null!==t;){if(void 0!==t[e])return t[e];t=t._parent}return null},setEnabled:function(e){this._enabled=!!e},isEnabled:function(){this._getFlag("enabled")},setLevel:function(e){"number"==typeof e?this._level=e:"string"==typeof e&&(e=e.toUpperCase())in i&&(this._level=i[e])},getLevel:function(){return this._getFlag("level")},log:function(e,t){!t.length||!this._getFlag("enabled")||e<this._getFlag("level")||(t=Array.prototype.slice.call(t),a.output(this.name,e,t))},debug:function(){this.log(i.DEBUG,arguments)},info:function(){this.log(i.INFO,arguments)},warn:function(){this.log(i.WARN,arguments)},error:function(){this.log(i.ERROR,arguments)},fatal:function(){this.log(i.FATAL,arguments)}},s(new o),n=new r;for(var l,c=/loglevel(|-[^=]+)=([^&]+)/g;null!==(l=c.exec(window.location.search));){(""===l[1]?n:n.getLogger(l[1].slice(1))).setLevel(l[2].toUpperCase())}var d={Level:i,getLogger:n.getLogger.bind(n),setEnabled:n.setEnabled.bind(n),isEnabled:n.isEnabled.bind(n),setLevel:n.setLevel.bind(n),getLevel:n.getLevel.bind(n),debug:n.debug.bind(n),info:n.info.bind(n),warn:n.warn.bind(n),error:n.error.bind(n),fatal:n.fatal.bind(n),getWriter:function(){return a},setWriter:s};t.Z=d},82799:function(e,t,n){"use strict";var a=n(85330),i=n.n(a),o=n(37834),r=n(7424);class s{constructor(e){this.order=[],this.parameters={},this.attribute="data-pat-"+e,this.enum_values={},this.enum_conflicts=[],this.groups={},this.possible_groups={},this.log=r.Z.getLogger(e+".parser"),this.group_pattern=/([a-z][a-z0-9]*)-([A-Z][a-z0-0\-]*)/i,this.json_param_pattern=/^\s*\[?\s*{/i,this.named_param_pattern=/^\s*([a-z][a-z0-9\-]*)\s*:(.*)/is,this.token_pattern=/((["']).*?(?!\\)\2)|\s*(\S+)\s*/g}_camelCase(e){return e.replace(/\-([a-z])/g,((e,t)=>t.toUpperCase()))}addAlias(e,t){if(!this.parameters[t])throw'Attempted to add an alias "'+e+'" for a non-existing parser argument "'+t+'".';this.parameters[t].alias=e}addGroupToSpec(e){const t=e.name.match(this.group_pattern);if(t){const n=t[1],a=t[2];if(n in this.possible_groups){const e=this.possible_groups[n],t=e.name.match(this.group_pattern)[2];e.group=n,e.dest=t,this.groups[n]=new s,this.groups[n].addArgument(t,e.value,e.choices,e.multiple),delete this.possible_groups[n]}n in this.groups?(this.groups[n].addArgument(a,e.value,e.choices,e.multiple),e.group=n,e.dest=a):(this.possible_groups[n]=e,e.dest=this._camelCase(e.name))}return e}addJSONArgument(e,t){this.order.push(e),this.parameters[e]=this.addGroupToSpec({name:e,value:t,dest:e,group:null,type:"json"})}addArgument(e,t,n,a){const i={name:e,value:a&&!Array.isArray(t)?[t]:t,multiple:a,dest:e,group:null};if(n&&Array.isArray(n)&&n.length){i.choices=n,i.type=this._typeof(n[0]);for(const t of n)-1===this.enum_conflicts.indexOf(t)&&(t in this.enum_values?(this.enum_conflicts.push(t),delete this.enum_values[t]):this.enum_values[t]=e)}else"string"==typeof i.value&&"$"===i.value.slice(0,1)?i.type=this.parameters[i.value.slice(1)].type:i.type=this._typeof(a?i.value[0]:i.value);this.order.push(e),this.parameters[e]=this.addGroupToSpec(i)}_typeof(e){return null===e?"null":typeof e}_coerce(e,t){const n=this.parameters[e];if(typeof t!==n.type)try{switch(n.type){case"json":t=JSON.parse(t);break;case"boolean":if("string"==typeof t){t=t.toLowerCase();const e=parseInt(t,10);t=isNaN(e)?"true"===t||"y"===t||"yes"===t||"y"===t||"on"===t:!!e}else{if("number"!=typeof t)throw"Cannot convert value for "+e+" to boolean";t=!!t}break;case"number":if("string"==typeof t){if(t=parseInt(t,10),isNaN(t))throw"Cannot convert value for "+e+" to number"}else{if("boolean"!=typeof t)throw"Cannot convert value for "+e+" to number";t+=0}break;case"string":t=t.toString();break;case"null":case"undefined":break;default:throw"Do not know how to convert value for "+e+" to "+n.type}}catch(e){return this.log.warn(e),null}return n.choices&&-1===n.choices.indexOf(t)?(this.log.warn("Illegal value for "+e+": "+t),null):t}_set(e,t,n){if(!(t in this.parameters))return void this.log.debug("Ignoring value for unknown argument "+t);let a;if(this.parameters[t].multiple){a="string"==typeof n?n.split(/,+/):n,n=[];for(const e of a){const a=this._coerce(t,e.trim());null!==a&&n.push(a)}}else if(null===(n=this._coerce(t,n)))return;e[t]=n}_split(e){const t=[];return e.replace(this.token_pattern,((e,n,a,i)=>{n?t.push(n):i&&t.push(i)})),t}_parseExtendedNotation(e){const t={},n=e.replace(/;;/g,"\0x1f").replace(/&amp;/g,"&amp\0x1f").split(/;/).map((e=>e.replace(new RegExp("\0x1f","g"),";")));for(const a of n){if(!a)continue;const n=a.match(this.named_param_pattern);if(!n){this.log.warn("Invalid parameter: "+a+": "+e);continue}const i=n[1],o=n[2].trim(),r=Object.values(this.parameters).filter((e=>e.alias===i));if(1===r.length)this._set(t,r[0].name,o);else if(i in this.parameters)this._set(t,i,o);else{if(!(i in this.groups)){this.log.warn("Unknown named parameter "+n[1]);continue}{const e=this.groups[i]._parseShorthandNotation(o);for(const n in e)this._set(t,i+"-"+n,e[n])}}}return t}_parseShorthandNotation(e){const t=this._split(e),n={};let a=0;for(;t.length;){const e=t.shift().trim();let i,o,r=!0;if("no-"===e.slice(0,3)?(i=!1,o=e.slice(3)):(i=!0,o=e),o in this.parameters&&"boolean"===this.parameters[o].type)r=!1,this._set(n,o,i);else if(o in this.enum_values)r=!1,this._set(n,this.enum_values[o],o);else{if(!r){t.unshift(e);break}this._set(n,this.order[a],e)}if(a++,a>=this.order.length)break}return t.length&&this.log.warn("Ignore extra arguments: "+t.join(" ")),n}_parse(e){if(!e)return{};if(e.match(this.json_param_pattern))try{return JSON.parse(e)}catch(t){this.log.warn("Invalid JSON argument found: "+e)}if(e.match(this.named_param_pattern))return this._parseExtendedNotation(e);const t=e.indexOf(";");if(-1===t)return this._parseShorthandNotation(e);const n=this._parseShorthandNotation(e.slice(0,t)),a=this._parseExtendedNotation(e.slice(t+1));for(const e in a)n[e]=a[e];return n}_defaults(e){const t={};for(const n in this.parameters)if("function"==typeof this.parameters[n].value)try{t[n]=this.parameters[n].value(e,n),this.parameters[n].type=typeof t[n]}catch(e){this.log.error("Default function for "+n+" failed.")}else t[n]=this.parameters[n].value;return t}_cleanupOptions(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];for(const t of Object.keys(e)){const n=this.parameters[t];void 0!==n&&(e[t]===n.value&&"string"==typeof n.value&&"$"===n.value.slice(0,1)&&(e[t]=e[n.value.slice(1)]))}if(t)for(const t of Object.keys(e)){const n=this.parameters[t];let a;void 0!==n&&(n.group?("object"!=typeof e[n.group]&&(e[n.group]={}),a=e[n.group]):a=e,n.dest!==t&&(a[n.dest]=e[t],delete e[t]))}return e}parse(e,t,n){let a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];e.jquery||(e=i()(e)),"boolean"==typeof t&&void 0===n&&(n=t,t={});const s=a?[[this._defaults(e)]]:[[{}]];let l,c=1;l=!a||e.hasClass("pat-modal")&&"data-pat-inject"===this.attribute?e:e.parents("["+this.attribute+"]").addBack();for(const e of l){let t;const n=(i()(e).attr(this.attribute)||"").trim();if(!n)continue;const a=this._parse.bind(this);t=n.match(/&&/)?n.split(/\s*&&\s*/).map(a):a(n),Array.isArray(t)||(t=[t]),c=Math.max(t.length,c),s.push(t)}"object"==typeof t&&(Array.isArray(t)?(s.push(t),c=Math.max(t.length,c)):s.push([t])),n||(c=1);const d=o.Z.removeDuplicateObjects(o.Z.mergeStack(s,c)).map((e=>this._cleanupOptions(e,r)));return n?d:d[0]}}s.prototype.add_argument=s.prototype.addArgument,t.Z=s},28778:function(){!function(){let e=null;const t='button, input[type="button"], input[type="submit"], input[type="image"]';document.addEventListener("click",(function(n){n.target.closest&&(e=n.target.closest(t))}),!0),document.addEventListener("submit",(function(n){if("submitter"in n)return;const a=[document.activeElement,e];e=null;for(const e of a)if(e&&e.form&&e.matches(t))return void(n.submitter=e);n.submitter=n.target.querySelector(t)}),!0)}()},50033:function(e,t,n){"use strict";var a=n(85330),i=n.n(a),o=n(32218),r=n(7424),s=n(37834);const l=r.Z.getLogger("registry"),c=/patterns-disable=([^&]+)/g,d=/patterns-dont-catch/g,p={};let u,h=!1;for(;null!==(u=c.exec(window.location.search));)p[u[1]]=!0,l.info("Pattern disabled via url config:",u[1]);for(;null!==(u=d.exec(window.location.search));)h=!0,l.info("I will not catch init exceptions");void 0===window.__patternslib_registry&&(window.__patternslib_registry={});const m=window.__patternslib_registry;void 0===window.__patternslib_registry_initialized&&(window.__patternslib_registry_initialized=!1);const f={patterns:m,init(){i()(document).ready((function(){window.__patternslib_registry_initialized||(window.__patternslib_registry_initialized=!0,l.debug("Loaded: "+Object.keys(f.patterns).sort().join(", ")),f.scan(document.body),l.debug("Finished initial scan."))}))},clear(){for(const e in f.patterns)delete f.patterns[e]},transformPattern(e,t){if(p[e])return void l.debug(`Skipping disabled pattern: ${e}.`);const n=f.patterns[e],a=n.transform||n.prototype?.transform;if(a)try{a(i()(t))}catch(t){if(h)throw t;l.error(`Transform error for pattern ${e}.`,t)}},initPattern(e,t,n){const a=i()(t),o=f.patterns[e],s=r.Z.getLogger(`pat.${e}`);if(t.matches(o.trigger)){s.debug("Initialising.",t);try{o.init?o.init(a,null,n):new o(a,null,n),s.debug("done.")}catch(e){if(h)throw e;s.error("Caught error:",e)}}},orderPatterns(e){return e.includes("validation")&&(e.splice(e.indexOf("validation"),1),e.unshift("validation")),e.includes("clone-code")&&(e.splice(e.indexOf("clone-code"),1),e.unshift("clone-code")),e},scan(e,t,n){if(!e)return;if("string"==typeof e)e=document.querySelector(e);else{if(e instanceof Text)return;e.jquery&&(e=e[0])}const a=[];t=this.orderPatterns(t||Object.keys(f.patterns));for(const n of t){this.transformPattern(n,e);const t=f.patterns[n];t.trigger&&a.unshift(t.trigger)}let i=o.Z.querySelectorAllAndMe(e,a.map((e=>e.trim().replace(/,$/,""))).join(","));i=i.filter((e=>!(e.matches(".disable-patterns")||e?.parentNode?.closest?.(".disable-patterns")||e?.parentNode?.closest?.("pre")||e?.parentNode?.closest?.("template")||e.matches(".cant-touch-this")||e?.parentNode?.closest?.(".cant-touch-this"))));for(const e of i.reverse())for(const a of t)this.initPattern(a,e,n);document.body.classList.add("patterns-loaded")},register(e,t){if(!(t=t||e.name))return l.error("Pattern lacks a name.",e),!1;if(f.patterns[t])return l.debug(`Already have a pattern called ${t}.`),!1;if(f.patterns[t]=e,e.jquery_plugin){const n=("pat-"+t).replace(/-([a-zA-Z])/g,(function(e,t){return t.toUpperCase()}));i().fn[n]=s.Z.jqueryPlugin(e),i().fn[n.replace(/^pat/,"pattern")]=i().fn[n]}return l.debug(`Registered pattern ${t}`,e),window.__patternslib_registry_initialized&&(f.scan(document.body,[t]),l.debug(`Re-scanned dom with newly registered pattern ${t}.`)),!0}};t.Z=f},37834:function(e,t,n){"use strict";var a=n(85330),i=n.n(a),o=n(32218);i().fn.safeClone=function(){return this.clone()},Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var n,a;if(null===this)throw new TypeError(" this is null or not defined");var i=Object(this),o=i.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(n=t),a=0;a<o;){var r;a in i&&(r=i[a],e.call(n,r,a,i)),a++}});var r=function(e,t,n){return this.each((function(){var a,o=i()(this);if(a=e.init(o,n),t){if(void 0===a[t])return i().error("Method "+t+" does not exist on jQuery."+e.name),!1;if("_"===t.charAt(0))return i().error("Method "+t+" is private on jQuery."+e.name),!1;a[t].apply(a,[n])}})),this},s=function(e,t,n){var a=this;if(t){if(e[t])return e[t].apply(a,[a].concat([n]));i().error("Method "+t+" does not exist on jQuery."+e.name)}else e.init.apply(a,[a].concat([n]));return a};function l(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function c(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;e instanceof i()&&(e=e[0]);const a=e.getBoundingClientRect();return![a.top,a.bottom,a.left,a.right].every((e=>0===e))&&(t?a.top<=0+n&&a.bottom>=0+n:a.top>=0&&a.left>=0&&a.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&a.right<=(window.innerWidth||document.documentElement.clientWidth))}var d={jqueryPlugin:function(e){return function(t,n){return 0===this.length?this:("object"==typeof t&&(n=t,t=void 0),"function"==typeof e?r.call(this,e,t,n):s.call(this,e,t,n))}},escapeRegExp:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isObject:l,extend:function(e){if(!l(e))return e;for(var t,n,a=1,i=arguments.length;a<i;a++)for(n in t=arguments[a])hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},findLabel:function(e){for(var t,n=e.parentNode;n&&11!==n.nodeType;n=n.parentNode)if("LABEL"===n.tagName)return n;return e.id&&(t=i()('label[for="'+e.id+'"]')),t&&0===t.length&&e.form&&(t=i()('label[for="'+e.name+'"]',e.form)),t&&t.length?t[0]:null},removeWildcardClass:function(e,t){if(e=d.ensureArray(e),-1===t.indexOf("*"))for(const n of e)n.classList.remove(t);else{let n=t.replace(/[\-\[\]{}()+?.,\\\^$|#\s]/g,"\\$&");n=n.replace(/[*]/g,".*"),n=new RegExp("^"+n+"$");for(const t of e){const e=(t.getAttribute("class")||"").split(/\s+/);if(!e.length)continue;const a=e.filter((e=>!n.test(e)));a.length?t.setAttribute("class",a.join(" ")):t.removeAttribute("class")}}},hideOrShow:(e,t,n,a)=>{e=o.Z.toNodeArray(e);const r={none:{hide:"hide",show:"show"},fade:{hide:"fadeOut",show:"fadeIn"},slide:{hide:"slideUp",show:"slideDown"}},s="css"===n.transition||"none"===n.transition?null:n.effect.duration,l=e=>{e.classList.remove("in-progress"),e.classList.add(t?"visible":"hidden"),i()(e).trigger("pat-update",{pattern:a,action:"attribute-changed",dom:e,transition:"complete"})};for(const c of e)if(c.classList.remove("visible"),c.classList.remove("hidden"),c.classList.remove("in-progress"),s){const e=r[n.transition];c.classList.add("in-progress"),i()(c).trigger("pat-update",{pattern:a,action:"attribute-changed",dom:c,transition:"start"}),i()(c)[t?e.show:e.hide]({duration:s,easing:n.effect.easing,complete:()=>l(c)})}else"css"!==n.transition&&o.Z[t?"show":"hide"](c),l(c)},addURLQueryParameter:function(e,t,n){var a=new RegExp("(\\?|\\&)"+t+"=.*?(?=(&|$))"),i=e.toString().split("#"),o=i[0],r=i[1],s=o;return s=a.test(o)?o.replace(a,"$1"+t+"="+n):/\?.+$/.test(o)?o+"&"+t+"="+n:o+"?"+t+"="+n,r&&(s+="#"+r),s},removeDuplicateObjects:function(e){const t=function(e,t){return this[e]===t};return e.reduce((function(e,n){let a=!1;for(const i of e)a=Object.keys(i).length===Object.keys(n).length&&0===Object.entries(i).filter((e=>!t.bind(n)(e[0],e[1]))).length;return a||e.push(n),e}),[])},mergeStack:function(e,t){const n=[];for(let e=0;e<t;e++)n.push({});for(const a of e){const e=a.length-1;for(let o=0;o<t;o++)n[o]=i().extend(n[o]||{},a[o>e?e:o])}return n},isElementInViewport:c,hasValue:function(e){return"INPUT"===e.tagName?"checkbox"===e.type||"radio"===e.type?e.checked:""!==e.value:"SELECT"===e.tagName?-1!==e.selectedIndex:"TEXTAREA"===e.tagName&&""!==e.value},parseTime:function(e){var t=/^(\d+(?:\.\d+)?)\s*(\w*)/.exec(e);if(!t)throw new Error("Invalid time");var n=parseFloat(t[1]);switch(t[2]){case"s":return Math.round(1e3*n);case"m":return Math.round(1e3*n*60);default:return Math.round(n)}},parseLength:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=/^(\d+(?:\.\d+)?)\s*(\%?\w*)/.exec(e);if(!n)throw new Error("Invalid length");const a=parseFloat(n[1]);switch(n[2]){case"px":default:return Math.round(a);case"%":return t?t/100*Math.round(a):0;case"vw":return Math.round(a*window.innerWidth/100);case"vh":return Math.round(a*window.innerHeight/100);case"vmin":return Math.round(a*Math.min(window.innerWidth,window.innerHeight)/100);case"vmax":return Math.round(a*Math.max(window.innerWidth,window.innerHeight)/100)}},findRelatives:function(e){var t=i()(e),n=i()(e),a=i()();if(n=(n=n.add(t.closest("label"))).add(t.closest("fieldset")),e.id&&(a=i()("label[for='"+e.id+"']")),!a.length){var o=t.closest("form");o.length||(o=i()(document.body)),a=o.find("label[for='"+e.name+"']")}return n=n.add(a)},get_bounds:function(e){const t=e.getBoundingClientRect();return{x:parseInt(Math.round(t.x),10)||0,y:parseInt(Math.round(t.y),10)||0,top:parseInt(Math.round(t.top),10)||0,bottom:parseInt(Math.round(t.bottom),10)||0,left:parseInt(Math.round(t.left),10)||0,right:parseInt(Math.round(t.right),10)||0,width:parseInt(Math.round(t.width),10)||0,height:parseInt(Math.round(t.height),10)||0}},checkInputSupport:function(e,t){let n=!1;const a=document.createElement("input");return a.setAttribute("type",e),n=a.type==e,void 0!==t&&(a.setAttribute("value",t),n=a.value!==t),n},checkCSSFeature:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"div";n=document.createElement(n);let a=void 0!==n.style[e];return a&&void 0!==t&&(n.style[e]=t,a=n.style[e]===t),a},animation_frame:()=>new Promise(window.requestAnimationFrame),timeout:e=>new Promise((t=>setTimeout(t,e))),debounce:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{timer:null},a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return n.last_run=0,function(){const i=arguments;!a&&n.timer&&Date.now()-n.last_run<=t||(clearTimeout(n.timer),n.last_run=Date.now(),n.timer=setTimeout((()=>{e.apply(this,i)}),t))}},isIE:()=>!!document.documentMode,jqToNode:e=>(e.jquery&&(e=e[0]),e),ensureArray:(e,t)=>!!(NodeList.prototype.isPrototypeOf(e)||Array.isArray(e)||e.jquery)?t?[...e]:e:[e],localized_isodate:e=>{const t=e.getDate().toString().padStart(2,"0"),n=(e.getMonth()+1).toString().padStart(2,"0");return`${e.getFullYear().toString()}-${n}-${t}`},escape_html:e=>{if(!e)return"";const t=document.createElement("div");return t.appendChild(document.createTextNode(e)),t.innerHTML.replace(/"/g,"&quot;")},unescape_html:e=>{if(!e)return"";return(new DOMParser).parseFromString(e,"text/html").documentElement.textContent.replace(/&quot;/g,'"')},is_iso_date_time:function(e){return(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?/^\d{4}-[01]\d-[0-3]\d(T[0-2]\d:[0-5]\d)?$/:/^\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d$/).test(e)},is_iso_date:e=>/^\d{4}-[01]\d-[0-3]\d$/.test(e),date_diff:(e,t)=>{const n=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),a=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate());return Math.floor((n-a)/864e5)},threshold_list:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=[];for(let n=1;n<=e;n++)t.push(n/e);return t.push(0),t.sort()},is_option_truthy:e=>![void 0,null,"none",!1,"false",""].includes(e),getCSSValue:o.Z.get_css_value,elementInViewport:e=>(console.warn("Deprecated. Use utils.isElementInViewport"),c(e))};t.Z=d},93520:function(e,t,n){"use strict";n.r(t),n.d(t,{parser:function(){return u}});var a=n(85330),i=n.n(a),o=n(11191),r=n(7424),s=n(82799),l=n(32218),c=n(18742),d=n(37834);const p=r.Z.getLogger("date-picker"),u=new s.Z("date-picker");u.addArgument("behavior","styled",["native","styled"]),u.addArgument("week-numbers",[],["show","hide"]),u.addArgument("i18n"),u.addArgument("first-day",0),u.addArgument("after"),u.addArgument("offset-days",0),u.add_argument("output-format",null),u.add_argument("locale",null),u.addAlias("behaviour","behavior"),t.default=o.Z.extend({name:"date-picker",trigger:".pat-date-picker",parser:u,format:"YYYY-MM-DD",async init(){const e=this.el,t=this.el.disabled;if(this.options=i().extend(u.parse(e),this.options),!t&&this.options.after){const e=document.querySelectorAll(this.options.after);for(const t of e)t.addEventListener("change",(e=>{let t=e.target.value;if(t=t?new Date(t):null,!t)return;let n=this.el.value;if(n=n?new Date(n):null,!n||n<t){const e=this.options.offsetDays||0;t.setDate(t.getDate()+e),this.el.value=t.toISOString().substring(0,10),this.dispatch_change_event()}}))}let a;if("styled"===this.options.behavior){l.Z.hide(e),a=document.createElement("time"),a.setAttribute("class","output-field"),a.setAttribute("datetime",e.value),t&&a.classList.add("disabled"),e.insertAdjacentElement("beforebegin",a);const o=a.closest("label");let r;if(o&&c.Z.add_event_listener(o,"click","pat-date-picker--label",(e=>{e.preventDefault()})),this.options.outputFormat){const e=(await Promise.resolve().then(n.bind(n,67164))).default,t={format:this.format};this.options.outputFormat&&(t["output-format"]=this.options.outputFormat),this.options.locale&&(t.locale=this.options.locale),r=new e(a,t)}else this.el.value&&(a.textContent=e.value);const s=()=>{this.add_clear_button(a),!this.el.value&&this.el.placeholder&&(a.innerHTML=`<span class="placeholder">${this.el.placeholder}</span>`)};if(r?i()(a).on("init.display-time.patterns",(()=>{s()})):s(),this.el.addEventListener("change",(()=>{a.setAttribute("datetime",this.el.value),r&&this.el.value?r.format():a.textContent=this.el.value,s()})),t)return}else{if(t)return;if(d.Z.checkInputSupport("date","invalid date"))return;"date"===e.getAttribute("type")&&e.setAttribute("type","text")}window.__patternslib_import_styles&&n.e(80298).then(n.bind(n,80298));const o=(await n.e(76392).then(n.t.bind(n,76392,23))).default,r={field:e,trigger:a||e,format:this.format,firstDay:this.options.firstDay,showWeekNumber:"show"===this.options.weekNumbers,onSelect:()=>this.dispatch_change_event(),onClose:()=>{"styled"!==this.options.behavior||this.el.value||e.dispatchEvent(c.Z.blur_event())}};if(e.getAttribute("min")&&(r.minDate=new Date(e.getAttribute("min"))),e.getAttribute("max")&&(r.maxDate=new Date(e.getAttribute("max"))),this.options.i18n)try{const e=await fetch(this.options.i18n);r.i18n=await e.json()}catch{p.error(`date-picker could not load i18n for ${this.options.i18n}`)}this.pikaday=new o(r)},add_clear_button(e){if(!this.el.disabled&&!this.el.required&&this.el.value){const t=document.createElement("span");t.setAttribute("class","cancel-button"),t.addEventListener("click",(e=>{e.stopPropagation(),this.el.value=null,this.dispatch_change_event()})),e.appendChild(t)}},dispatch_change_event(){const e=new Event("change",{bubbles:!0,cancelable:!0});e.firedBy=this.pikaday,this.el.dispatchEvent(e),i()(this.el).trigger("input-change"),i()(this.el.form).trigger("input-change")}})},67164:function(e,t,n){"use strict";n.r(t),n.d(t,{parser:function(){return d}});var a=n(11191),i=n(82799),o=n(32218),r=n(7424),s=n(37834);let l;const c=r.Z.getLogger("pat-display-time"),d=new i.Z("display-time");d.add_argument("format",""),d.add_argument("locale",null),d.add_argument("strict",!1),d.add_argument("from-now",!1),d.add_argument("no-suffix",!1),d.add_argument("output-format",null),t.default=a.Z.extend({name:"display-time",trigger:".pat-display-time",async init(){l=(await n.e(36823).then(n.t.bind(n,36823,23))).default,this.options=d.parse(this.el,this.options);let e=this.options.locale||o.Z.acquire_attribute(this.el,"lang")||"en";e=e.substr(0,2).toLowerCase();try{await n(77961)(`./${e}.js`),l.locale(e),this.lang=e}catch{l.locale("en"),this.lang="en"}c.debug(`Moment.js language used: ${e}.`),this.format()},format(){const e=this.el.getAttribute("datetime");let t="";if(e){const n=l(e,this.options.format,this.options.strict);if(t=n,!0===this.options.fromNow)if(s.Z.is_iso_date(e)){const e=new Intl.RelativeTimeFormat(this.lang,{numeric:"auto"}),a=s.Z.date_diff(n.toDate(),new Date);t=n.calendar(null,{lastWeek:`[${e.format(a,"day")}]`,lastDay:`[${e.format(-1,"day")}]`,sameDay:`[${e.format(0,"day")}]`,nextDay:`[${e.format(1,"day")}]`,nextWeek:"dddd",sameElse:()=>`[${e.format(a,"day")}]`})}else t=n.fromNow(this.options.noSuffix);else this.options.outputFormat&&(t=n.format(this.options.outputFormat))}this.el.textContent=t}})},36382:function(e,t,n){"use strict";n.d(t,{ZP:function(){return m},E2:function(){return u}});var a=n(85330),i=n.n(a),o=n(32751),r=n(7424),s=n(82799),l=n(18742),c=n(50033),d=n(37834);n(11191).Z.extend({name:"close-panel",trigger:".close-panel",init(){const e=this.el.closest("dialog");e&&l.Z.add_event_listener(e,"close-panel","close-panel--dialog",(()=>{e.close()})),this.el.addEventListener("click",(async e=>{await d.Z.timeout(0),e.target.matches("[type=submit], button:not([type=button])")&&!1===this.el.closest("form")?.checkValidity()||this.el.dispatchEvent(new Event("close-panel",{bubbles:!0,cancelable:!0}))}))}});const p=r.Z.getLogger("pat-tooltip"),u=new s.Z("tooltip");u.addArgument("position-list",[],["tl","tm","tr","rt","rm","rb","br","bm","bl","lb","lm","lt"],!0),u.addArgument("position-policy","auto",["auto","force"]),u.addArgument("trigger","click",["click","hover","none"]),u.addArgument("source","title",["ajax","content","title"]),u.addArgument("ajax-data-type","html",["html","markdown"]),u.addArgument("closing","auto",["auto","sticky","close-button"]),u.addArgument("delay"),u.addArgument("mark-inactive",!0),u.addArgument("class"),u.addArgument("target","body"),u.addArgument("arrow-padding",null),u.addArgument("url",null);class h extends o.o{static name="tooltip";static trigger=".pat-tooltip, .pat-tooltip-ng";static parser=u;tippy=null;active_class="tooltip-active-hover";inactive_class="tooltip-inactive";async init(){const e=this.el;window.__patternslib_import_styles&&n.e(17287).then(n.bind(n,17287));const t=(await n.e(25981).then(n.t.bind(n,25981,23))).default;this.tippy_options=this.parseOptionsForTippy(this.options);const a={animation:!1,arrow:!0,hideOnClick:"close-button"!==this.options.closing,ignoreAttributes:!0,interactive:!0,onHide:this._onHide.bind(this),onShow:this._onShow.bind(this),trigger:"click"};t.setDefaultProps(a),this.tippy=new t(e,this.tippy_options),"title"===this.options.source&&e.removeAttribute("title"),"click"===this.options.trigger&&"ajax"===this.options.source&&l.Z.add_event_listener(e,"click","pat-tooltip--click-prevent-default",(e=>{e.preventDefault(),e.stopPropagation()})),"click"===this.options.trigger&&(this.active_class="tooltip-active-click"),this.options.markInactive&&e.classList.add(this.inactive_class)}show(){this.tippy.show()}async hide(){await d.Z.timeout(1),this.tippy.hide()}destroy(){super.destroy(),this.tippy.destroy()}parseOptionsForTippy(e){const t=e=>{return`${n=e[0],{t:"bottom",r:"left",b:"top",l:"right"}[n]}${t=e[1],{l:"-start",r:"-end",m:"",t:"-start",b:"-end"}[t]}`;var t,n},n={popperOptions:{modifiers:[]}};null!==e.arrowPadding&&n.popperOptions.modifiers.push({name:"arrow",options:{padding:parseInt(e.arrowPadding,10)}});const a={position:()=>{if(!e.position?.list?.length)return;n.placement=t(e.position.list[0]);const a={name:"flip",enabled:!0};if("force"===e.position.policy)a.enabled=!1;else if(e.position.length>1){const n=e.position.list.slice(1).map(t);a.fallbackPlacements=n}n.popperOptions.modifiers.push(a)},trigger(){"hover"===e.trigger?n.trigger="mouseenter focus":"none"===e.trigger&&(n.trigger="manual",n.hideOnClick=!1)},source:()=>{let t;"title"===e.source?t=this.el.getAttribute("title"):"content"===e.source?(t=this.el.innerHTML,n.allowHTML=!0):"ajax"===e.source&&(t=document.createElement("progress"),n.allowHTML=!0),n.content=t},delay(){e.delay&&(n.delay=[d.Z.parseTime(e.delay),0])},target:()=>{e.target&&("parent"===e.target?n.appendTo="parent":"body"===e.target?n.appendTo=document.body:n.appendTo=document.querySelector(e.target))}};for(let t in e){switch(t){case"ajax-data-type":t="ajaxDataType";break;case"mark-inactive":t="markInactive"}a[t]&&a[t](t)}return n}_initialize_content(){c.Z.scan(this.tippy.popper)}async _onShow(){const e=[];if(this.options.class&&e.push(...this.options.class.split(" ")),e.push("tooltip-container"),"close-button"===this.options.closing){for(const e of this.tippy.popper.querySelectorAll(".pat-tooltip--close-button"))e.remove();const e=document.createElement("button");e.setAttribute("class","close-panel pat-tooltip--close-button");const t=this.tippy.popper.querySelector(".tippy-content");t.parentNode.insertBefore(e,t)}l.Z.add_event_listener(this.tippy.popper,"close-panel","pat-tooltip--close-panel",(()=>this.hide())),this.tippy.popper.classList.add(...e),this.options.markInactive&&(this.el.classList.remove(this.inactive_class),this.el.classList.add(this.active_class)),"auto"!==this.options.closing&&"hover"===this.options.trigger&&this.tippy.setProps({trigger:"click"}),"ajax"===this.options.source&&await this._get_content(),i()(this.tippy.popper).trigger("patterns-injected",[{skipPatInjectHandler:!0},this.el,this.tippy.popper]),this._initialize_content()}_onHide(){this.options.markInactive&&(this.el.classList.remove(this.active_class),this.el.classList.add(this.inactive_class)),"auto"!==this.options.closing&&"hover"===this.options.trigger&&this.tippy.setProps({trigger:"mouseenter focus"}),"ajax"===this.options.source&&this.tippy.setContent(document.createElement("progress"))}async _get_content(){let e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.url;if(({url:n,selector:e}=this.get_url_parts(n||this.el.getAttribute("href"))),n){const a=this.data_type_handlers[this.options.ajaxDataType];try{const i=await fetch(n,{headers:{Accept:"text/html,application/xhtml+xml,application/xml"}}),o=await i.text();t=await a(o,n,e)}catch(e){p.error("Error on ajax request. ${e}")}}else e&&(t=document.querySelector(e),t=t?.innerHTML||void 0);t&&(this.tippy.setContent(t),await d.Z.timeout(1),this.tippy.popperInstance.forceUpdate())}async get_content(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.url;await this._get_content(e),this._initialize_content()}get_url_parts(e){let t,n,a;return e?([t,n]=e.split("#"),n&&(n=`#${n}`,[n,a]=n.split("?")),a&&(t=`${t}?${a}`),{url:t,selector:n}):{url:t,selector:n}}static data_type_handlers={html(e,t,n){let a=document.createElement("div");return a.innerHTML=e,n&&(a=a.querySelector(n)),a?.innerHTML||""},async markdown(e,t,n){const a=c.Z.patterns.markdown;if(!a)return e;const o=new a(i()("<div/>"));await l.Z.await_pattern_init(o);const r={url:t};n&&(r.source=n);return(await o.renderForInjection(r,e))[0]}};static register_type_handler(e,t){h.data_type_handlers[e]=t}constructor(){super(...arguments),this.register_type_handler=this.constructor.register_type_handler,this.data_type_handlers=this.constructor.data_type_handlers}}c.Z.register(h);var m=h},10354:function(e,t,n){"use strict";n.d(t,{O4:function(){return r}});var a=n(25219);let i={plone:null,widgets:null};const o=function(e,t,n){if(null===i[e]){var o=new a.Z;o.loadCatalog(e),i[e]=o.MessageFactory(e)}return i[e](t,n)},r=function(e,t){return o("plone",e,t)};t.ZP=function(e,t){return o("widgets",e,t)}},25219:function(e,t,n){"use strict";var a=n(85330),i=n.n(a);t.Z=function(){var e=this;e.baseUrl=i()("body").attr("data-i18ncatalogurl"),e.currentLanguage=i()("html").attr("lang")||"en",e.currentLanguage.split("-").length>1&&(e.currentLanguage=e.currentLanguage.split("-")[0]+"_"+e.currentLanguage.split("-")[1].toUpperCase()),e.storage=null,e.catalogs={},e.ttl=864e5,Date.now||(Date.now=function(){return(new Date).valueOf()});try{"localStorage"in window&&null!==window.localStorage&&"JSON"in window&&null!==window.JSON&&(e.storage=window.localStorage)}catch(e){console.log("Failed to set local storage")}e.configure=function(t){for(var n in t)e[n]=t[n]},e._setCatalog=function(t,n,a){t in e.catalogs||(e.catalogs[t]={}),e.catalogs[t][n]=a},e._storeCatalog=function(t,n,a){var i=t+"-"+n;null!==e.storage&&null!==a&&(e.storage.setItem(i,JSON.stringify(a)),e.storage.setItem(i+"-updated",Date.now()))},e.getUrl=function(t,n){return e.baseUrl+"?domain="+t+"&language="+n},e.loadCatalog=function(t,n){if(void 0===n&&(n=e.currentLanguage),null!==e.storage){var a=t+"-"+n;if(a in e.storage&&Date.now()-parseInt(e.storage.getItem(a+"-updated"),10)<e.ttl){var o=JSON.parse(e.storage.getItem(a));return void e._setCatalog(t,n,o)}}e.baseUrl&&i().getJSON(e.getUrl(t,n),(function(a){null!==a&&(e._setCatalog(t,n,a),e._storeCatalog(t,n,a))}))},e.MessageFactory=function(t,n){return n=n||e.currentLanguage,function(a,i){var o,r,s;if(o=t in e.catalogs&&n in e.catalogs[t]&&a in e.catalogs[t][n]?e.catalogs[t][n][a]:a,i)for(s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r=new RegExp("\\$\\{"+s+"\\}","g"),o=o.replace(r,i[s]));return o}}}},62832:function(e,t,n){"use strict";var a=n(85330),i=n.n(a);const o=n(7424).Z.getLogger("core utils");var r=function(e){var t=this;t.className="spinner-border";return e||(e={}),t.options=i().extend({},{backdrop:null,zIndex:10005},e),t.init=function(){t.$el=i()("."+t.className),0===t.$el.length&&(t.$el=i()("<div><div></div></div>"),t.$el.addClass(t.className).hide().appendTo("body"))},t.show=function(e){t.init(),t.$el.show(),t.$el.css("position","absolute"),t.$el.css("top","50%"),t.$el.css("left","50%");var n=t.options.zIndex;"function"==typeof n?n=Math.max(n(),10005):(n=10005,i()(".modal-wrapper,.-modal-backdrop").each((function(){n=Math.max(n,i()(this).css("zIndex")||10005)})),n+=1),t.$el.css("zIndex",n),void 0===e&&(e=!0),t.options.backdrop&&(t.options.backdrop.closeOnClick=e,t.options.backdrop.closeOnEsc=e,t.options.backdrop.init(),t.options.backdrop.show())},t.hide=function(){t.init(),t.$el.hide()},t},s=function(e){return void 0===e&&(e="id"),e+Math.floor(65536*(1+Math.random())).toString(16).substring(1)},l={dragAndDrop:function(){return"draggable"in document.createElement("span")},fileApi:function(){return"undefined"!=typeof FileReader},history:function(){return!(!window.history||!window.history.pushState)}},c={get:function(e){if(window.localStorage){var t=window.localStorage[e];return"string"==typeof t?JSON.parse(t):void 0}},set:function(e,t){window.localStorage&&(window.localStorage[e]=JSON.stringify(t))}};const d=new Map;t.Z={bool:function(e){return"string"==typeof e&&(e=e.trim(e).toLowerCase()),-1===["false",!1,"0",0,"",void 0,null].indexOf(e)},escapeHTML:function(e){return i()("<div/>").text(e).html()},removeHTML:function(e){return e.replace(/<[^>]+>/gi,"")},featureSupport:l,generateId:s,getAuthenticator:function(){var e=i()('input[name="_authenticator"]');return 0===e.length?(e=i()('a[href*="_authenticator"]')).length>0?e.attr("href").split("_authenticator=")[1]:"":e.val()},getWindow:function(){var e=window;return e.parent!==window&&(e=e.parent),e},Loading:r,loading:new r,parseBodyTag:function(e){return i()(/<body[^>]*>[^]*<\/body>/im.exec(e)[0].replace("<body","<div").replace("</body>","</div>")).eq(0).html()},QueryHelper:function(e){var t=this;return t.options=i().extend({},{pattern:null,vocabularyUrl:null,searchParam:"SearchableText",pathOperator:"plone.app.querystring.operation.string.path",attributes:["UID","Title","Description","getURL","portal_type"],batchSize:10,baseCriteria:[],sort_on:"is_folderish",sort_order:"reverse",pathDepth:1},e),t.pattern=t.options.pattern,void 0!==t.pattern&&null!==t.pattern||(t.pattern={browsing:!1,basePath:"/"}),t.options.url&&!t.options.vocabularyUrl?t.options.vocabularyUrl=t.options.url:t.pattern.vocabularyUrl&&(t.options.vocabularyUrl=t.pattern.vocabularyUrl),t.valid=Boolean(t.options.vocabularyUrl),t.getBatch=function(e){return{page:e||1,size:t.options.batchSize}},t.getCurrentPath=function(){var e,n=t.pattern;"function"==typeof(e=t.currentPath?t.currentPath:n.currentPath)&&(e=e());var a=e;return a||(a=n.basePath?n.basePath:n.options.basePath?n.options.basePath:"/"),a},t.getCriterias=function(e,n){void 0===n&&(n={});var a=[];return(n=i().extend({},{useBaseCriteria:!0,additionalCriterias:[]},n)).useBaseCriteria&&(a=t.options.baseCriteria.slice(0)),e&&(e+="*",a.push({i:t.options.searchParam,o:"plone.app.querystring.operation.string.contains",v:e})),n.searchPath?a.push({i:"path",o:t.options.pathOperator,v:n.searchPath+"::"+t.options.pathDepth}):t.pattern.browsing&&a.push({i:"path",o:t.options.pathOperator,v:t.getCurrentPath()+"::"+t.options.pathDepth}),a=a.concat(n.additionalCriterias)},t.getQueryData=function(e,n){var a={query:JSON.stringify({criteria:t.getCriterias(e),sort_on:t.options.sort_on,sort_order:t.options.sort_order}),attributes:JSON.stringify(t.options.attributes)};return n&&(a.batch=JSON.stringify(t.getBatch(n))),a},t.getUrl=function(){var e=t.options.vocabularyUrl;return-1===e.indexOf("?")?e+="?":e+="&",e+i().param(t.getQueryData())},t.selectAjax=function(){return{url:t.options.vocabularyUrl,dataType:"JSON",quietMillis:100,data:function(e,n){return t.getQueryData(e,n)},results:function(e,t){var n=10*t<e.total;return{results:e.results,more:n}}}},t.search=function(e,n,a,o,r,s){void 0===r&&(r=!0),void 0===s&&(s="GET");var l=[];r&&(l=t.options.baseCriteria.slice(0)),l.push({i:e,o:n,v:a});var c={query:JSON.stringify({criteria:l}),attributes:JSON.stringify(t.options.attributes)};i().ajax({url:t.options.vocabularyUrl,dataType:"JSON",data:c,type:s,success:o})},t},resolveIcon:async function(e){const t=`plone.icon.${e}`,a=t;return d.has(a)||(d.set(a,async function(){let a="";const i=document.body.getAttribute("data-portal-url");if(i){const t=i+"/@@iconresolver";if(t)try{const n=new AbortController;setTimeout((()=>n.abort()),5e3);const i=await fetch(`${t}/${e}`,{signal:n.signal});a=await i.text()}catch(n){o.warn(`Loading icon "${e}" from URL ${t} failed.`),console.warn(n)}}if(!a){e=t;try{n.e(71662).then(n.bind(n,71662));const t=await n.e(83392).then(n.t.bind(n,83392,19)),i=t[e]?.split?.("/");i[0].includes("bootstrap-icons")&&(a=await n(47010)(`./${i[1]}`),a=a?.default)}catch(e){o.warn(`Loading icon "${t}" failed from fallback.`),console.warn(e)}}return a}()),o.debug(`Loading icon "${t}"`)),await d.get(a)},setId:function(e,t){void 0===t&&(t="id");var n=e.attr("id");return n=void 0===n?s(t):n.replace(/\./g,"-"),e.attr("id",n),n},storage:c}},95474:function(e,t,n){"use strict";var a=n(85330),i=n.n(a);n(11191).Z.extend({name:"autotoc",trigger:".pat-autotoc",parser:"mockup",defaults:{section:"section",levels:"h1,h2,h3",IDPrefix:"autotoc-item-",classTOCName:"autotoc-nav",classSectionName:"autotoc-section",classLevelPrefixName:"autotoc-level-",classActiveName:"active",scrollDuration:"slow",scrollEasing:"swing"},init:function(){n.e(4650).then(n.bind(n,4650));var e=this;e.$toc=i()("<nav/>").addClass(e.options.classTOCName),e.options.prependTo?e.$toc.prependTo(e.options.prependTo):e.options.appendTo?e.$toc.appendTo(e.options.appendTo):e.$toc.prependTo(e.$el),e.options.className&&e.$el.addClass(e.options.className),i()(e.options.section,e.$el).addClass(e.options.classSectionName);var t=e.$el.hasClass("autotabs"),a=null;i()(e.options.levels,e.$el).each((function(n){var o=i()(this),r=o.prop("id")?o.prop("id"):o.parents(e.options.section).prop("id");(!r||i()("#"+r).length>0)&&(r=e.options.IDPrefix+e.name+"-"+n),window.location.hash==="#"+r&&(a=r),null===a&&o.hasClass(e.options.classActiveName)&&(a=r),o.data("navref",r),i()("<a/>").appendTo(e.$toc).text(o.text()).attr("id",r).attr("href","#"+r).addClass(e.options.classLevelPrefixName+e.getLevel(o)).on("click",(function(n,a){n.stopPropagation(),n.preventDefault(),a||(a={doScroll:!0,skipHash:!1});var r=i()(this);e.$toc.children("."+e.options.classActiveName).removeClass(e.options.classActiveName),e.$el.children("."+e.options.classActiveName).removeClass(e.options.classActiveName),i()(n.target).addClass(e.options.classActiveName),o.parents(e.options.section).addClass(e.options.classActiveName),!1!==a.doScroll&&e.options.scrollDuration&&o&&!t&&i()("body,html").animate({scrollTop:o.offset().top},e.options.scrollDuration,e.options.scrollEasing),0!==e.$el.parents(".plone-modal").length&&e.$el.trigger("resize.plone-modal.patterns"),i()(this).trigger("clicked"),a.skipHash||window.history&&window.history.pushState&&window.history.pushState({},"","#"+r.attr("id"))})),o.data("autotoc-trigger-id",r)})),a?i()("a#"+a).trigger("click",{doScroll:!0,skipHash:!0}):e.$toc.find("a").first().trigger("click",{doScroll:!1,skipHash:!0})},getLevel:function(e){var t=0;return i().each(this.options.levels.split(","),(function(n,a){if(1===e.filter(a).length)return t=n+1,!1})),t}})},57887:function(e,t,n){"use strict";var a=n(85330),i=n.n(a),o=n(11191);t.Z=o.Z.extend({name:"backdrop",trigger:".pat-backdrop",parser:"mockup",defaults:{zIndex:null,opacity:.8,className:"plone-backdrop",classActiveName:"plone-backdrop-active",closeOnEsc:!0,closeOnClick:!0},init:function(){var e=this;e.$backdrop=i()("> ."+e.options.className,e.$el),0===e.$backdrop.length&&(e.$backdrop=i()("<div/>").hide().appendTo(e.$el).addClass(e.options.className),null!==e.options.zIndex&&e.$backdrop.css("z-index",e.options.zIndex)),!0===e.options.closeOnEsc&&i()(document).on("keydown",(function(t,n){e.$el.is("."+e.options.classActiveName)&&27===t.keyCode&&e.hide()})),!0===e.options.closeOnClick&&e.$backdrop.on("click",(function(){e.$el.is("."+e.options.classActiveName)&&e.hide()}))},show:function(){var e=this;e.$el.hasClass(e.options.classActiveName)||(e.emit("show"),e.$backdrop.css("opacity","0").show(),e.$el.addClass(e.options.classActiveName),e.$backdrop.animate({opacity:e.options.opacity},500),e.emit("shown"))},hide:function(){var e=this;e.$el.hasClass(e.options.classActiveName)&&(e.emit("hide"),e.$backdrop.animate({opacity:"0"},500).hide(),e.$el.removeClass(e.options.classActiveName),e.emit("hidden"))}})},62027:function(e,t,n){"use strict";var a=n(85330),i=n.n(a);n(11191).Z.extend({name:"datatables",trigger:".pat-datatables",parser:"mockup",table:null,defaults:{},async init(){Promise.all([n.e(50421),n.e(99992)]).then(n.bind(n,66662)),Promise.all([n.e(50421),n.e(93931)]).then(n.bind(n,5802)),Promise.all([n.e(50421),n.e(36517)]).then(n.bind(n,53990)),Promise.all([n.e(50421),n.e(79056)]).then(n.bind(n,986)),Promise.all([n.e(50421),n.e(1345)]).then(n.bind(n,90091)),Promise.all([n.e(50421),n.e(94433)]).then(n.bind(n,61833)),Promise.all([n.e(50421),n.e(34109)]).then(n.bind(n,72347)),await n.e(30518).then(n.t.bind(n,30518,23)),await n.e(25375).then(n.t.bind(n,25375,23)),await n.e(28811).then(n.t.bind(n,28811,23)),await n.e(95533).then(n.t.bind(n,95533,23)),await Promise.all([n.e(50421),n.e(30518),n.e(28811)]).then(n.t.bind(n,17740,23)),await Promise.all([n.e(50421),n.e(30518),n.e(28811)]).then(n.t.bind(n,85253,23)),await Promise.all([n.e(50421),n.e(30518),n.e(28811)]).then(n.t.bind(n,442,23)),await n.e(7022).then(n.t.bind(n,7022,23)),await n.e(71693).then(n.t.bind(n,71693,23)),await n.e(44596).then(n.t.bind(n,44596,23)),await n.e(86603).then(n.t.bind(n,86603,23)),await n.e(88101).then(n.t.bind(n,88101,23)),await n.e(22481).then(n.t.bind(n,22481,23)),await n.e(76697).then(n.t.bind(n,76697,23)),await n.e(97759).then(n.t.bind(n,97759,23)),await n.e(42852).then(n.t.bind(n,42852,23)),await n.e(86717).then(n.t.bind(n,86717,23)),i()(this.el).DataTable(this.options)}})},43067:function(e,t,n){"use strict";var a=n(85330),i=n.n(a),o=n(11191),r=n(24481),s=n.n(r),l=n(57887),c=n(50033),d=n(62832),p=n(25219);n(50834);t.Z=o.Z.extend({name:"plone-modal",trigger:".pat-plone-modal",parser:"mockup",createModal:null,$model:null,defaults:{width:"",height:"",modalSizeClass:"",margin:0,position:"center middle",triggers:[],zIndexSelector:".modal-wrapper,.modal-backdrop",backdrop:"body",backdropOptions:{zIndex:"1040",opacity:"0.85",className:"modal-backdrop",classActiveName:"backdrop-active",closeOnEsc:!0,closeOnClick:!0},title:null,titleSelector:"h1:first",buttons:'.formControls > input[type="submit"], .formControls > button',content:"#content",automaticallyAddButtonActions:!0,loadLinksWithinModal:!0,prependContent:".portalMessage, #global_statusmessage",onRender:null,templateOptions:{className:"modal fade",classDialog:"modal-dialog",classModal:"modal-content",classHeaderName:"modal-header",classBodyName:"modal-body",classFooterName:"modal-footer",classWrapperName:"modal-wrapper",classWrapperInnerName:"modal-wrapper-inner",classActiveName:"show",classPrependName:"",classContentName:"",template:'<div class="<%= options.className %>">  <div class="<%= options.classDialog %><% if (modalSizeClass) { %> <%= modalSizeClass %><% } %>" role="dialog" <% if (title) { %>aria-labelledby="modal-title" <% } %> tabindex="-1">    <div class="<%= options.classModal %>" role="document">      <div class="<%= options.classHeaderName %>">        <% if (title) { %><h5 class="modal-title" id="modal-title" tabindex="0"><%= title %></h5><% } %>        <button type="button" class="btn-close modal-close" aria-label="Close"></button>      </div>      <div class="<%= options.classBodyName %>">        <div class="<%= options.classPrependName %>"><%= prepend %></div>         <div class="<%= options.classContentName %>"><%= content %></div>      </div>      <div class="<%= options.classFooterName %>">         <% if (buttons) { %><%= buttons %><% } %>      </div>    </div>  </div></div>'},actions:{},actionOptions:{eventType:"click",disableAjaxFormSubmit:!1,target:null,ajaxUrl:null,modalFunction:null,isForm:!1,timeout:5e3,displayInModal:!0,reloadWindowOnClose:!0,error:".portalMessage.error, .alert-danger",formFieldError:".field.error",onSuccess:null,onError:null,onFormError:null,onTimeout:null,redirectOnResponse:!1,redirectToUrl:function(e,t){var n;return(n=/<body.*data-view-url=[\"'](.*)[\"'].*/im.exec(t))&&n.length>1||(n=/<body.*data-base-url=[\"'](.*)[\"'].*/im.exec(t))&&n.length>1?n[1].split('"')[0]:(n=/<base.*href=[\"'](.*)[\"'].*/im.exec(t))&&n.length>1?n[1]:""}},form:function(e){var t=this,n=t.$modal;t.options.automaticallyAddButtonActions&&(e[t.options.buttons]={}),e.a={},i().each(e,(function(e,a){var o=s().union(s().keys(t.options.actionOptions),["templateOptions"]),r=i().extend(!0,{},t.options.actionOptions,s().pick(a,o));a.templateOptions=i().extend(!0,a.templateOptions,t.options.templateOptions);var l=s().union(s().keys(t.options.actionOptions),["actions","actionOptions"]),c=i().extend(!0,s().omit(a,l),t.options);i()(e,i()("."+a.templateOptions.classBodyName,n)).each((function(){var e=i()(this);e.on(r.eventType,(function(n){n.stopPropagation(),n.preventDefault(),t.loading.show(!1),null!==r.modalFunction?t[r.modalFunction]():i().nodeName(e[0],"input")||i().nodeName(e[0],"button")||!0===a.isForm?t.options.handleFormAction.apply(t,[e,r,c]):(null!==a.ajaxUrl||i().nodeName(e[0],"a"))&&t.options.handleLinkAction.apply(t,[e,r,c])}))}))}))},handleFormAction:function(e,t,n){var a,o,r=this,s={};if(s[e.attr("name")]=e.attr("value"),a=i().nodeName(e[0],"form")?e:e.parents("form:not(.disableAutoSubmit)"),o=null!==t.ajaxUrl?"function"==typeof t.ajaxUrl?t.ajaxUrl.apply(r,[e,t]):t.ajaxUrl:e.parents("form").attr("action"),t.disableAjaxFormSubmit)return e.attr("name")&&e.attr("value")&&a.append(i()('<input type="hidden" name="'+e.attr("name")+'" value="'+e.attr("value")+'" />')),void a.trigger("submit");a.on("submit",(function(e){e.preventDefault()})),a.trigger("submit"),r.loading.show(!1),a.ajaxSubmit({timeout:t.timeout,data:s,url:o,error:function(e,n,a){r.loading.hide(),"timeout"===n&&t.onTimeout?t.onTimeout.apply(r,e,a):t.onError?"string"==typeof t.onError?window[t.onError](e,n,a):t.onError(e,n,a):console.log("error happened",n," do something"),r.emit("formActionError",[e,n,a])},success:function(a,o,s,l){r.loading.hide(),0===i()(t.error,a).length&&0===i()(t.formFieldError,a).length?!0!==t.redirectOnResponse?(t.onSuccess&&("string"==typeof t.onSuccess?window[t.onSuccess](r,a,o,s,l):t.onSuccess(r,a,o,s,l)),!0===t.displayInModal?r.redraw(a,n):(e.trigger("destroy.plone-modal.patterns"),t.reloadWindowOnClose&&r.reloadWindow()),r.emit("formActionSuccess",[a,o,s,l])):"function"==typeof t.redirectToUrl?window.parent.location.href=t.redirectToUrl.apply(r,[e,a,t]):window.parent.location.href=t.redirectToUrl:t.onFormError?"string"==typeof t.onFormError?window[t.onFormError](r,a,o,s,l):t.onFormError(r,a,o,s,l):r.redraw(a,n)}})},handleLinkAction:function(e,t,n){var a,o=this;e.hasClass("pat-plone-modal")||(a=t.ajaxUrl?"function"==typeof t.ajaxUrl?t.ajaxUrl.apply(o,[e,t]):t.ajaxUrl:e.attr("href"),!1!==t.displayInModal?i().ajax({url:a}).fail((function(e,n,a){"timeout"===n&&t.onTimeout?t.onTimeout(o.$modal,e,a):t.onError?t.onError(e,n,a):window.alert((0,p.Z)("There was an error loading modal.")),o.emit("linkActionError",[e,n,a])})).done((function(e,a,i){o.redraw(e,n),t.onSuccess&&("string"==typeof t.onSuccess?window[t.onSuccess](o,e,a,i):t.onSuccess(o,e,a,i)),o.emit("linkActionSuccess",[e,a,i])})).always((function(){o.loading.hide()})):"_blank"===e.attr("target")?(window.open(a,"_blank"),o.loading.hide()):window.location=a)},render:function(e){var t=this;if(t.emit("before-render"),t.$raw){var n=t.$raw.clone();i()("input:checked",n).each((function(){this.setAttribute&&this.setAttribute("checked","checked")}));var a={title:"",prepend:"<div />",content:"",modalSizeClass:e.modalSizeClass,buttons:'<div class="pattern-modal-buttons"></div>',options:e.templateOptions};if(null===e.title){var o=i()(e.titleSelector,n);a.title=o.html(),i()(e.titleSelector,n).remove()}else a.title=e.title;e.prependContent&&(a.prepend=i()("<div />").append(i()(e.prependContent,n).clone()).html(),i()(e.prependContent,n).remove()),e.content?a.content=i()(e.content,n).html():a.content=n.html(),t.$modal=i()(s().template(t.options.templateOptions.template)(a)),t.$modalDialog=i()("> ."+t.options.templateOptions.classDialog,t.$modal),t.$modalContent=i()("> ."+t.options.templateOptions.classModal,t.$modalDialog),i()("form",t.$modal).on("keydown",(function(e){13===e.keyCode&&"TEXTAREA"!==e.target.nodeName&&(e.preventDefault(),i()("input[type=submit], button[type=submit], button:not(type)",this).eq(0).trigger("click"))})),i()(e.buttons,t.$modal).each((function(){var e=i()(this);e.on("click",(function(e){e.stopPropagation(),e.preventDefault()})).clone().appendTo(i()(".pattern-modal-buttons",t.$modal)).off("click").on("click",(function(t){t.stopPropagation(),t.preventDefault(),e.trigger("click")})),e.hide()})),t.emit("before-events-setup"),t.$modal[0].querySelectorAll('.modal-header > .modal-close,\n                 .modal-footer > .pattern-modal-buttons > .modal-close,\n                 .modal-footer [name="form.buttons.Cancel" i]').forEach((e=>{i()(e).off("click").on("click",(e=>{e.stopPropagation(),e.preventDefault(),i()(e.target).trigger("destroy.plone-modal.patterns")}))})),e.form&&e.form.apply(t,[e.actions]),t.$modal.addClass(t.options.templateOptions.className).on("destroy.plone-modal.patterns",(function(e){e.stopPropagation(),t.hide()})).on("resize.plone-modal.patterns",(function(e){e.stopPropagation(),e.preventDefault(),t.positionModal()})).appendTo(t.$wrapperInner),t.options.loadLinksWithinModal&&t.$modal.on("click",(function(e){e.stopPropagation(),i().nodeName(e.target,"a")&&e.preventDefault(),t.$modal.trigger("modal-click")})),t.$modal.data("pattern-"+t.name,t),t.emit("after-render"),e.onRender&&("string"==typeof e.onRender?window[e.onRender](t):e.onRender(t))}}},reloadWindow:function(){window.parent.location.reload()},init:function(){n.e(1413).then(n.bind(n,1413));var e=this;e.options.loadLinksWithinModal=i().parseJSON(e.options.loadLinksWithinModal),!0===e.options.backdropOptions.closeOnEsc&&i()(document).on("keydown",(function(t){e.$el.is("."+e.options.templateOptions.classActiveName)&&27===t.keyCode&&e.hide()})),i()(window.parent).resize((function(){e.positionModal()})),e.options.triggers&&i().each(e.options.triggers,(function(t,n){var a=n.substring(0,n.indexOf(" ")),o=n.substring(n.indexOf(" "),n.length);i()(o||e.$el).on(a,(function(t){t.stopPropagation(),t.preventDefault(),e.show()}))})),e.$el.is("a")&&(e.$el.attr("href")&&!e.options.image&&(!e.options.target&&"#"===e.$el.attr("href").substr(0,1)&&e.$el.attr("href").length>1&&(e.options.target=e.$el.attr("href"),e.options.content=""),e.options.ajaxUrl||"#"===e.$el.attr("href").substr(0,1)||(e.options.ajaxUrl=function(){return e.$el.attr("href")})),e.$el.on("click",(function(t){t.stopPropagation(),t.preventDefault(),e.show()}))),e.initModal()},createAjaxModal:function(){var e=this;e.emit("before-ajax"),e.loading.show();var t=e.options.ajaxUrl;"function"==typeof t&&(t=t.apply(e,[e.options])),e.ajaxXHR=i().ajax({url:t,type:e.options.ajaxType}).done((function(t,n,a){e.ajaxXHR=void 0,e.$raw=i()("<div />").append(i()(d.Z.parseBodyTag(t))),e.emit("after-ajax",e,n,a),e._show()})).fail((function(t,n,a){var i=e.options.actionOptions;"timeout"===n&&i.onTimeout?i.onTimeout(e.$modal,t,a):i.onError?i.onError(t,n,a):(window.alert((0,p.Z)("There was an error loading modal.")),e.hide()),e.emit("linkActionError",[t,n,a])})).always((function(){e.loading.hide()}))},createTargetModal:function(){var e=this;e.$raw=i()(e.options.target).clone(),e._show()},createBasicModal:function(){var e=this;e.$raw=i()("<div/>").html(e.$el.clone()),e._show()},createHtmlModal:function(){var e=this,t=i()(e.options.html);e.$raw=t,e._show()},createImageModal:function(){var e=this;e.$wrapper.addClass("image-modal");var t=e.$el.attr("href"),n=e.$el.attr("data-modal-srcset")||"",a=i().trim(e.$el.context.innerText)||"Image";e.$raw=i()("<div><h1>"+a+'</h1><div id="content"><div class="modal-image"><img src="'+t+'" srcset="'+n+'" /></div></div></div>'),e._show()},initModal:function(){var e=this;e.options.ajaxUrl?e.createModal=e.createAjaxModal:e.options.target?e.createModal=e.createTargetModal:e.options.html?e.createModal=e.createHtmlModal:e.options.image?e.createModal=e.createImageModal:e.createModal=e.createBasicModal},findPosition:function(e,t,n,a,i,o,r){var s,l,c,d,p={};return d=c=s=c="auto","left"===e?(c=n+"px",a>o&&(c="0px"),p.left=c):"right"===e?(d=n+"px",a>o&&(d="0px"),p.right=d,p.left="auto"):(c=o/2-a/2-n+"px",a>o&&(c="0px"),p.left=c),"top"===t?(s=n+"px",i>r&&(s="0px"),p.top=s):"bottom"===t?(l=n+"px",i>r&&(l="0px"),p.bottom=l,p.top="auto"):(s=r/2-i/2-n+"px",i>r&&(s="0px"),p.top=s),p},modalInitialized:function(){return null!==this.$modal&&void 0!==this.$modal},activateFocusTrap:function(){for(var e=this,t=e.$modal.find("."+e.options.templateOptions.classBodyName).first().find("select, input[type!=hidden], textarea, button, a"),n=e.$modal.find("."+e.options.templateOptions.classFooterName).first().find("select, input[type!=hidden], textarea, button, a"),a=[],o=0;o<t.length;o++)i()(t[o]).is(":visible")&&a.push(t[o]);for(var r=0;r<n.length;r++)i()(n[r]).is(":visible")&&a.push(n[r]);0===a.length&&(a=e.$modal.find(".modal-title"));var s=a[0],l=a[a.length-1],c=e.$modal.find(".modal-close").first();i()(document).on("keydown","."+e.options.templateOptions.classDialog,(function(e){if(9===e.which){e.preventDefault();var t=i()(e.target),n=i().inArray(t[0],a);if(n>=0&&n<a.length){var o=n+(e.shiftKey?-1:1);o<0||o>=a.length?c.focus():a[o].focus()}else e.shiftKey?l.focus():s.focus()}})),!0===e.options.backdropOptions.closeOnClick&&e.$modal.on("click",(function(t){i()(t.target).closest("."+e.options.templateOptions.classModal).length||e.hide()})),e.$modal.find(".modal-title").focus()},positionModal:function(){var e=this;if(!e.modalInitialized())return;e.$modal.removeAttr("style"),e.$wrapper.parent().is("body")&&e.$wrapper.height(i()(window.parent).height());var t="function"==typeof e.options.margin?e.options.margin():e.options.margin;let n={position:"absolute"};"0"!==t&&(n.padding=t),e.$modal.css(n),e.$modalDialog.css({width:e.options.width,height:e.options.height}),e.$modalContent.css({width:e.options.width});var a=e.options.position.split(" "),o=a[0],r=a[1],s=e.$modalDialog.outerWidth(!0),l=e.$modalDialog.outerHeight(!0),c=e.$wrapperInner.width(),d=e.$wrapperInner.height(),p=e.findPosition(o,r,t,s,l,c,d);for(var u in p)e.$modalDialog.css(u,p[u])},render:function(e){var t=this;t.emit("render"),t.options.render.apply(t,[e]),t.emit("rendered")},show:function(){var e=this;e.backdrop=e.createBackdrop(),e.createModal()},createBackdrop:function(){var e=this,t=new l.Z(e.$el.parents(e.options.backdrop),e.options.backdropOptions),n=e.options.backdropOptions.zIndex||1041;return i()(e.options.zIndexSelector).each((function(){n=Math.max(n,parseInt(i()(this).css("zIndex"))+1||1041)})),e.$wrapper=i()("<div/>").hide().css({"z-index":n,"overflow-y":"auto",position:"fixed",height:"100%",width:"100%",bottom:"0",left:"0",right:"0",top:"0"}).addClass(e.options.templateOptions.classWrapperName).insertBefore(t.$backdrop).on("click",(function(n){e.options.backdropOptions.closeOnClick&&(n.stopPropagation(),n.preventDefault(),t.hide())})),t.on("hidden",(function(){void 0!==e.$modal&&e.$modal.hasClass(e.options.templateOptions.classActiveName)&&e.hide()})),e.loading=new d.Z.Loading({backdrop:t}),e.$wrapperInner=i()("<div/>").addClass(e.options.classWrapperInnerName).css({position:"absolute",bottom:"0",left:"0",right:"0",top:"0"}).appendTo(e.$wrapper),t},_show:function(){var e=this;e.render.apply(e,[e.options]),e.emit("show"),e.backdrop.show(),e.$wrapper.show(),e.loading.hide(),e.$el.addClass(e.options.templateOptions.classActiveName),e.$modal.addClass(e.options.templateOptions.classActiveName),c.Z.scan(e.$modal),e.positionModal(),i()(window.parent).on("resize.plone-modal.patterns",(function(){e.positionModal()})),i()("body").addClass("modal-open"),e.emit("shown"),e.activateFocusTrap()},hide:function(){var e=this;e.ajaxXHR&&e.ajaxXHR.abort(),e.emit("hide"),e._suppressHide&&!window.confirm(e._suppressHide)||(e.loading.hide(),e.$el.removeClass(e.options.templateOptions.classActiveName),void 0!==e.$modal&&(e.$modal.remove(),e.initModal()),e.$wrapper.remove(),i()(".modal",i()("body")).length<1&&(e._suppressHide=void 0,e.backdrop.hide(),i()("body").removeClass("modal-open"),i()(window.parent).off("resize.plone-modal.patterns")),e.emit("hidden"),e.$el.focus())},redraw:function(e,t){var n=this;n.emit("beforeDraw"),n.$modal.remove(),n.$raw=i()("<div />").append(i()(d.Z.parseBodyTag(e))),n.render.apply(n,[t||n.options]),n.$modal.addClass(n.options.templateOptions.classActiveName),n.positionModal(),c.Z.scan(n.$modal),n.emit("afterDraw")}})},73918:function(e,t,n){"use strict";var a=n(85330),i=n.n(a),o=n(24481),r=n.n(o),s=n(10354),l=n(62832),c=n(11191),d=function(){this.init.apply(this,arguments)};d.prototype={defaults:{indexWidth:"20em",remove:"",classBetweenDtName:"querystring-criteria-betweendt",classWrapperName:"querystring-criteria-wrapper",classIndexName:"querystring-criteria-index",classOperatorName:"querystring-criteria-operator",classValueName:"querystring-criteria-value",classRemoveName:"querystring-criteria-remove",classResultsName:"querystring-criteria-results",classClearName:"querystring-criteria-clear",classDepthName:"querystring-criteria-depth"},init:function(e,t,n,a,o,r,l,c,d,p,u){var h=this;h.app=t,h.options=i().extend(!0,{},h.defaults,n),h.indexes=a,h.indexGroups={},h.baseUrl=c,h.advanced=!1,h.initial=l,h.$wrapper=i()("<div/>").addClass(h.options.classWrapperName).appendTo(e),h.patternDateOptions=d||{},h.patternAjaxSelectOptions=p||{},h.patternRelateditemsOptions=u||{},h.patternAjaxSelectOptions=i().extend({width:"250px"},h.patternAjaxSelectOptions),h.patternRelateditemsOptions=i().extend({vocabularyUrl:h.baseUrl+"@@getVocabulary?name=plone.app.vocabularies.Catalog&field=relatedItems",width:"400px"},h.patternRelateditemsOptions),h.patternRelateditemsOptions.maximumSelectionSize=1,h.$remove=i()("<div>"+h.options.remove+"</div>").addClass(h.options.classRemoveName).appendTo(h.$wrapper).on("click",(function(e){e.stopPropagation(),h.remove()})),h.$index=i()("<select><option></option></select>").attr("placeholder",(0,s.ZP)("Select criteria")),i().each(h.indexes,(function(e,t){t.enabled&&(h.indexGroups[t.group]||(h.indexGroups[t.group]=i()("<optgroup/>").attr("label",t.group).appendTo(h.$index)),h.indexGroups[t.group].append(i()("<option/>").attr("value",e).html(t.title)))})),h.$wrapper.append(i()("<div/>").addClass(h.options.classIndexName).append(h.$index)),h.$index.patternSelect2({width:h.options.indexWidth,placeholder:(0,s.ZP)("Select criteria")}),h.$index.on("change",(function(e){h.removeValue(),h.createOperator(e.val),h.createClear(),h.trigger("index-changed")})),void 0!==o&&(h.$index.val(o),h.createOperator(o,r,l),h.createClear()),h.trigger("create-criteria")},appendOperators:function(e){var t=this;t.$operator=i()("<select/>"),t.indexes[e]&&r().each(t.indexes[e].operations,(function(n){var a=t.indexes[e].operators[n];i()("<option/>").attr("value",n).html(a.title).appendTo(t.$operator)})),t.$wrapper.append(i()("<div/>").addClass(t.options.classOperatorName).append(t.$operator)),t.$operator.patternSelect2({width:"10em"}),t.$operator.on("change",(function(){t.createValue(e),t.createClear(),t.trigger("operator-changed")}))},convertPathOperators:function(e){return this.advanced?e:e=e.replace("advanced","relativePath").replace("path","relativePath")},createPathOperators:function(){var e=this;if(e.advanced)e.resetPathOperators();else{var t="plone.app.querystring.operation.string.advanced";void 0===e.indexes.path.operators[t]&&(e.indexes.path.operations.push(t),e.indexes.path.operators[t]={title:"Advanced",widget:"AdvancedPathWidget",description:"Enter a custom path string",operation:"plone.app.querystring.queryparser._relativePath"}),i().each(e.indexes.path.operators,(function(e,t){var n=t;e.indexOf("absolute")>0?n.title="Custom":e.indexOf("relative")>0?n.title="Parent (../)":e.indexOf("advanced")>0?n.title="Advanced Mode":(n.title="Current (./)",n.widget="RelativePathWidget")}))}},resetPathOperators:function(){i().each(this.indexes.path.operators,(function(e,t){var n=t;e.indexOf("absolute")>0?n.title="Absolute Path":e.indexOf("relative")>0?n.title="Relative Path":e.indexOf("advanced")>0?n.title="Simple Mode":(n.title="Navigation Path",n.widget="ReferenceWidget")}))},createOperator:function(e,t,n){var a=this;a.removeOperator(),a.createPathOperators(),"path"===e&&n&&".::1"!==n&&"..::1"!==n&&!n.match(/^[0-9a-f\-]{32,36}::-?[0-9]+$/)&&(a.advanced=!0,a.resetPathOperators()),a.appendOperators(e),void 0===t&&(t=a.$operator.val()),a.$operator.val(t),a.createValue(e,n),a.trigger("create-operator")},createValue:function(e,t){var n=this,a=n.indexes[e].operators[n.$operator.val()].widget,o=i()("<div/>").addClass(n.options.classValueName).appendTo(n.$wrapper);n.removeValue();var r=function(e){o.remove(".depth-select-box");for(var t="<div class='depth-select-box'><label for='depth-select'>Depth</label><select name='depth-select' class='"+n.options.classDepthName+"'><option value='-1' selected='selected'>Unlimited</option>",a=0;a<=10;a+=1)t+="<option value="+a+" ",""+a===e&&(t+="selected='selected' "),t+=">"+a+"</option>";return t+="</select></div>",i()(t).on("change",(function(){n.trigger("depth-changed")}))};if("StringWidget"===a)n.$value=i()('<input type="text"/>').addClass(n.options.classValueName+"-"+a).val(t).appendTo(o).on("change",(function(){n.trigger("value-changed")}));else if("DateWidget"===a)n.$value=i()('<input type="date"/>').addClass(n.options.classValueName+"-"+a).val(t).appendTo(o).on("change",(function(){n.trigger("value-changed")}));else if("DateRangeWidget"===a){var l=i()("<span/>").appendTo(o),c="",d="";t&&(c=t[0]?t[0]:"",d=t[1]?t[1]:"");var p=i()('<input type="date"/>').addClass(n.options.classValueName+"-"+a).addClass(n.options.classValueName+"-"+a+"-start").val(c).appendTo(l).on("change",(function(){n.trigger("value-changed")}));o.append(i()("<span/>").html((0,s.ZP)("to")).addClass(n.options.classBetweenDtName));var u=i()("<span/>").appendTo(o),h=i()('<input type="date"/>').addClass(n.options.classValueName+"-"+a).addClass(n.options.classValueName+"-"+a+"-end").val(d).appendTo(u).on("change",(function(){n.trigger("value-changed")}));n.$value=[p,h]}else if("RelativeDateWidget"===a)n.$value=i()('<input type="text"/>').after(i()("<span/>").html((0,s.ZP)("days"))).addClass(n.options.classValueName+"-"+a).val(t).appendTo(o).on("change",(function(){n.trigger("value-changed")}));else if("AdvancedPathWidget"===a)n.advanced?n.advanced=!1:n.advanced=!0,n.createPathOperators(),n.removeOperator(),n.appendOperators(e),n.createValue(e);else if("RelativePathWidget"===a)if(n.advanced)n.$value=i()('<input type="text"/>').addClass(n.options.classValueName+"-"+a).appendTo(o).val(t).on("change",(function(){n.trigger("value-changed")}));else{console.log(t);var m=[".","1"];void 0!==t?"."===(m=t.split("::"))[0]?n.$operator.val("plone.app.querystring.operation.string.path"):n.$operator.val("plone.app.querystring.operation.string.relativePath"):"plone.app.querystring.operation.string.relativePath"===n.$operator.val()&&(m=["..","1"]),n.$value=i()('<input type="hidden"/>').addClass(n.options.classValueName+"-"+a).appendTo(o).val(m[0]),n.$value.after(r(m[1]))}else"ReferenceWidget"===a?n.advanced?n.$value=i()('<input type="text"/>').addClass(n.options.classValueName+"-"+a).val(t).appendTo(o).on("change",(function(){n.trigger("value-changed")})):(m=["","-1"],void 0!==t&&(m=t.split("::")),n.$value=i()('<input type="text"/>').addClass(n.options.classValueName+"-"+a).appendTo(o).val(m[0]).patternRelateditems(n.patternRelateditemsOptions).on("change",(function(){n.trigger("value-changed")})),o.addClass("break-line"),n.$value.after(r(m[1]))):"MultipleSelectionWidget"===a&&(n.$value=i()("<select/>").prop("multiple",!0).addClass(n.options.classValueName+"-"+a).appendTo(o).on("change",(function(){n.trigger("value-changed")})),n.indexes[e]&&i().each(n.indexes[e].values,(function(e,t){i()("<option/>").attr("value",e).html(t.title).appendTo(n.$value)})),n.$value.patternSelect2(n.patternAjaxSelectOptions));if(void 0!==t&&void 0!==n.$value)if(Array.isArray(n.$value))i().each(t,(function(e,t){n.$value[e].val(t)}));else{var f=t;"string"==typeof t&&"RelativePathWidget"!==a&&(f=t.replace(/::-?[0-9]+/,"")),n.$value.val(f)}n.trigger("create-value")},createClear:function(){var e=this;e.removeClear(),e.$clear=i()("<div/>").addClass(e.options.classClearName).appendTo(e.$wrapper)},remove:function(){var e=this;e.trigger("remove"),e.$remove.remove(),e.$index.parent().remove(),e.removeOperator(),e.removeValue(),e.removeClear(),e.$wrapper.remove()},removeClear:function(){var e=this;e.trigger("remove-clear"),e.$clear&&e.$clear.remove()},removeOperator:function(){var e=this;e.trigger("remove-operator"),e.$operator&&e.$operator.parent().remove()},removeValue:function(){var e=this;e.trigger("remove-value"),e.$value&&(Array.isArray(e.$value)?e.$value[0].parents(".querystring-criteria-value").remove():e.$value.parents(".querystring-criteria-value").remove())},buildQueryPart:function(){var e=this,t=e.$index.val();if(""===t)return"";var n="query.i:records="+t;if(void 0===e.$operator)return"";var a=e.$operator.val();if("path"===t){if(a.indexOf("advanced")>0)return"";a=e.convertPathOperators(a)}var o="query.o:records="+a,r="query.v:records=",s="query.v:records:list=",l=[];if(void 0===e.$value)l.push(r);else if(Array.isArray(e.$value))i().each(e.$value,(function(){l.push(s+i()(this).val())}));else if(Array.isArray(e.$value.val()))i().each(e.$value.val(),(function(e,t){l.push(s+t)}));else{var c=r+e.$value.val();"path"===t&&""!==e.$value.val()?c+=e.getDepthString():void 0!==e.initial&&(c=r+e.initial,delete e.initial),l.push(c)}return n+"&"+o+"&"+l.join("&")},getJSONListStr:function(){var e=this,t=e.$index.val();if(""===t)return"";if(void 0===e.$operator)return"";var n=e.$operator.val();if("path"===t){if(n.indexOf("advanced")>0)return"";n=e.convertPathOperators(n)}var a,o=[];if(Array.isArray(e.$value))i().each(e.$value,(function(){o.push(i()(this).val())}));else if(void 0!==e.$value){var r=e.$value.val();if("path"===t&&r){var s=e.getDepthString();s&&(r+=s)}o.push(r)}return a=o.length>1?'["'+o.join('","')+'"]':1===o.length?JSON.stringify(o[0]):'""',void 0!==e.indexes[t].operators[n]?'{"i":"'+t+'", "o":"'+n+'", "v":'+a+"}":void 0},getDepthString:function(){var e="",t=i()("."+this.options.classDepthName).val();return""!==t&&void 0!==t&&(e+="::"+t),e},trigger:function(e){this.$wrapper.trigger(e+"-criteria.querystring.patterns",[this])},on:function(e,t){this.$wrapper.on(e+"-criteria.querystring.patterns",t)}},t.Z=c.Z.extend({name:"querystring",trigger:".pat-querystring",parser:"mockup",defaults:{indexes:[],classWrapperName:"querystring-wrapper",criteria:{},indexOptionsUrl:null,previewURL:"portal_factory/@@querybuilder_html_results",previewCountURL:"portal_factory/@@querybuildernumberofresults",patternDateOptions:{},patternAjaxSelectOptions:{},patternRelateditemsOptions:{},classSortLabelName:"querystring-sort-label",classSortReverseName:"querystring-sortreverse",classSortReverseLabelName:"querystring-sortreverse-label",classPreviewCountWrapperName:"querystring-previewcount-wrapper",classPreviewResultsWrapperName:"querystring-previewresults-wrapper",classPreviewWrapperName:"querystring-preview-wrapper",classPreviewName:"querystring-preview",classPreviewTitleName:"querystring-preview-title",classPreviewDescriptionName:"querystring-preview-description",classSortWrapperName:"querystring-sort-wrapper",showPreviews:!0},init:async function(){await Promise.resolve().then(n.bind(n,74090)),await Promise.resolve().then(n.bind(n,15260)),n.e(18102).then(n.bind(n,18102));var e=this;if(e.$el.hide(),e.$wrapper=i()("<div/>"),e.$el.after(e.$wrapper),e.initialized=!1,e.options.criteria.remove=await l.Z.resolveIcon("x-circle"),e.options.indexOptionsUrl)try{const t=await fetch(e.options.indexOptionsUrl),n=await t.json();e.options.indexes=n.indexes,e.options.sortable_indexes=n.sortable_indexes,e._init()}catch(e){}},_init:function(){var e=this;e.$criteriaWrapper=i()("<div/>").addClass(e.options.classWrapperName).appendTo(e.$wrapper),e.$sortWrapper=i()("<div/>").addClass(e.options.classSortWrapperName).appendTo(e.$wrapper),"false"===e.options.showPreviews&&(e.options.showPreviews=!1),e.options.showPreviews&&(e.$previewWrapper=i()("<div/>").addClass(e.options.classPreviewWrapperName).appendTo(e.$wrapper),i()("<div/>").addClass(e.options.classPreviewTitleName).html((0,s.ZP)("Preview")).appendTo(e.$previewWrapper),i()("<div/>").addClass(e.options.classPreviewDescriptionName).html((0,s.ZP)("Preview of at most 10 items")).appendTo(e.$previewWrapper)),e.criterias=[],e.$el.val()&&i().each(JSON.parse(e.$el.val()),(function(t,n){e.createCriteria(n.i,n.o,n.v)})),e.createCriteria(),e.createSort(),e.options.showPreviews&&e.refreshPreviewEvent(),e.$el.trigger("initialized"),e.initialized=!0},createCriteria:function(e,t,n){var a=this,i=a.options.indexOptionsUrl.replace(/(@@.*)/g,""),o=new d(a.$criteriaWrapper,a,a.options.criteria,a.options.indexes,e,t,n,i,a.options.patternDateOptions,a.options.patternAjaxSelectOptions,a.options.patternRelateditemsOptions);o.on("remove",(function(){a.criterias[a.criterias.length-1]===o&&a.createCriteria()})),o.on("index-changed",(function(){a.criterias[a.criterias.length-1]===o&&a.createCriteria()}));var r=function(){a.refreshPreviewEvent(),a.updateValue()},s=-1,l=function(){clearTimeout(s),s=setTimeout(r,100)};o.on("remove",(function(e,t){-1!==a.criterias.indexOf(t)&&a.criterias.splice(a.criterias.indexOf(t),1),l()})),o.on("remove-clear",l),o.on("remove-operator",l),o.on("remove-value",l),o.on("index-changed",l),o.on("operator-changed",l),o.on("create-criteria",l),o.on("create-operator",l),o.on("create-value",l),o.on("value-changed",l),o.on("depth-changed",l),a.criterias.push(o)},createSort:function(){var e=this,t=i()('[id$="-sort_on"]').filter('[id^="formfield-"]'),n=i()('[id*="-sort_reversed"]').filter('[id^="formfield-"]');for(var a in i()("<span/>").addClass(e.options.classSortLabelName).html((0,s.ZP)("Sort on")).appendTo(e.$sortWrapper),e.$sortOn=i()("<select/>").attr("name","sort_on").appendTo(e.$sortWrapper).on("change",(function(){e.refreshPreviewEvent.call(e),i()('[id$="sort_on"]',t).val(i()(this).val())})),e.$sortOn.append(i()('<option value="">'+(0,s.ZP)("No sorting")+"</option>")),e.options.sortable_indexes)e.$sortOn.append(i()("<option/>").attr("value",a).html(e.options.indexes[a].title));if(e.$sortOn.patternSelect2({width:"150px"}),e.$sortOrder=i()('<input type="checkbox" />').attr("name","sort_reversed:boolean").on("change",(function(){e.refreshPreviewEvent.call(e),i()(this).prop("checked")?i()('input[type="checkbox"]',n).prop("checked",!0):i()('input[type="checkbox"]',n).prop("checked",!1)})),i()("<span/>").addClass(e.options.classSortReverseName).appendTo(e.$sortWrapper).append(e.$sortOrder).append(i()("<span/>").html((0,s.ZP)("Reversed Order")).addClass(e.options.classSortReverseLabelName)),t.length>=1&&n.length>=1){var o=i()('input[type="checkbox"]',n).prop("checked"),r=i()('[id$="-sort_on"]',t).val();o&&e.$sortOrder.prop("checked",!0),e.$sortOn.val(r),i()(t).hide(),i()(n).hide()}},refreshPreviewEvent:function(){var e=this;if(e.options.showPreviews){void 0!==e._previewXhr&&e._previewXhr.abort(),void 0!==e.$previewPane&&e.$previewPane.remove();var t=[];i().each(e.criterias,(function(e,n){var a=n.buildQueryPart();""!==a&&t.push(a)})),e.$previewPane=i()("<div/>").addClass(e.options.classPreviewName).appendTo(e.$previewWrapper),t.length<=0?i()("<div/>").addClass(e.options.classPreviewCountWrapperName).html("No results to preview").prependTo(e.$previewPane):(t.push("sort_on="+e.$sortOn.val()),e.$sortOrder.prop("checked")&&t.push("sort_order=reverse"),e._previewXhr=i().get(e.options.previewURL+"?"+t.join("&")).done((function(t){i()("<div/>").addClass(e.options.classPreviewResultsWrapperName).html(t).appendTo(e.$previewPane)})))}},updateValue:function(){var e=this,t=[];i().each(e.criterias,(function(e,n){var a=n.getJSONListStr();""!==a&&t.push(a)}));var n="["+t.join(",")+"]";e.$el.val(n),e.$el.trigger("change")}})},15260:function(e,t,n){"use strict";n.r(t);var a=n(85330),i=n.n(a),o=n(24481),r=n.n(o),s=n(11191),l=n(10354),c=n(62832),d=n(50033),p=n(74090);const u=37,h=39;t.default=s.Z.extend({name:"relateditems",trigger:".pat-relateditems",parser:"mockup",currentPath:void 0,selectedUIDs:[],openAfterInit:void 0,defaults:{vocabularyUrl:null,attributes:["UID","Title","portal_type","path","getURL","getIcon","is_folderish","review_state"],basePath:"",pageSize:10,browsing:void 0,closeOnSelect:!0,contextPath:void 0,dropdownCssClass:"pat-relateditems-dropdown",favorites:[],recentlyUsed:!1,recentlyUsedMaxItems:20,recentlyUsedKey:"relateditems_recentlyused",maximumSelectionSize:-1,minimumInputLength:0,mode:"browse",orderable:!0,pathOperator:"plone.app.querystring.operation.string.path",rootPath:"/",rootUrl:"",scanSelection:!1,selectableTypes:null,separator:",",sortOn:null,sortOrder:"ascending",tokenSeparators:[","," "],upload:!1,uploadAllowView:void 0,breadcrumbTemplateSelector:null,favoriteTemplateSelector:null,recentlyusedTemplateSelector:null,resultTemplateSelector:null,selectionTemplateSelector:null,toolbarTemplateSelector:null,multiple:!0,ajaxTimeout:500},recentlyUsed(e){let t=c.Z.storage.get(this.options.recentlyUsedKey)||[];t=t.slice(t.length-1e3,t.length),e&&t.filter(this.isSelectable.bind(this));const n=parseInt(this.options.recentlyUsedMaxItems,10);return n&&(t=t.slice(t.length-n,t.length)),t},applyTemplate(e,t){let n;this.options[e+"TemplateSelector"]&&(n=i()(this.options[e+"TemplateSelector"]).html()),n||(n=this.options[e+"Template"]?this.options[e+"Template"]:this[e+"Template"]);const a=i().extend(!0,{},this.options,t,{browsing:this.browsing,open_folder:(0,l.ZP)("Open folder"),current_directory:(0,l.ZP)("current directory:"),one_level_up:(0,l.ZP)("Go one level up")});return a._item=t,r().template(n)(a)},setAjax(){const e=parseInt(this.options.ajaxTimeout||500,10),t={url:this.options.vocabularyUrl,dataType:"JSON",quietMillis:e,data:(e,t)=>{const n=[];e&&(e="*"+e+"*",n.push({i:"SearchableText",o:"plone.app.querystring.operation.string.contains",v:e})),!this.browsing&&this.options.selectableTypes&&n.push({i:"portal_type",o:"plone.app.querystring.operation.selection.any",v:this.options.selectableTypes}),n.push({i:"path",o:this.options.pathOperator,v:this.options.rootPath+this.currentPath+(this.browsing?"::1":"")});let a=this.options.sortOn,i=a?this.options.sortOrder:null;this.browsing&&null===a&&(a="getObjPositionInParent",i="ascending");return{query:JSON.stringify({criteria:n,sort_on:a,sort_order:i}),attributes:JSON.stringify(this.options.attributes),batch:JSON.stringify({page:t||1,size:this.options.pageSize})}},results:(e,t)=>{const n=t*this.options.pageSize<e.total;let a=e.results;this.selectedUIDs=(this.$el.select2("data")||[]).map((e=>e.UID)),a=a.filter((e=>!!(this.browsing&&e.is_folderish||this.isSelectable(e)&&-1===this.selectedUIDs.indexOf(e.UID))));const i=this.currentPath.split("/");return 1===t&&this.browsing&&i.length>1&&"/"!==this.currentPath&&(a=[{oneLevelUp:!0,Title:(0,l.ZP)("One level up"),path:i.slice(0,i.length-1).join("/")||"/",currentPath:this.currentPath,is_folderish:!0,selectable:!1}].concat(a)),{results:a,more:n}}};this.options.ajax=t},async renderToolbar(){let e;const t=this.currentPath.split("/");let n="",a="";for(const e of t)if(""!==e){const t={};t.path=n=`${n}/${e}`,t.text=e,a+=this.applyTemplate("breadcrumb",t)}let o="";for(const e of this.options.favorites){const t=r().clone(e);t.path=t.path.substr(this.options.rootPath.length)||"/",o+=this.applyTemplate("favorite",t)}let s="";if(this.options.recentlyUsed){const e=this.recentlyUsed(!0);for(const t of e.reverse())s+=this.applyTemplate("recentlyused",t)}e=this.applyTemplate("toolbar",{items:a,favItems:o,favText:(0,l.ZP)("Favorites"),searchText:(0,l.ZP)("Current path:"),searchModeText:(0,l.ZP)("Search"),browseModeText:(0,l.ZP)("Browse"),recentlyUsedItems:s,recentlyUsedText:(0,l.ZP)("Recently Used"),icon_root:await c.Z.resolveIcon("house-fill"),icon_recently_used:await c.Z.resolveIcon("grid-fill"),icon_favorites:await c.Z.resolveIcon("star-fill"),icon_upload:await c.Z.resolveIcon("cloud-arrow-up"),upload:this.options.upload,upload_text:(0,l.ZP)("Upload")}),this.$toolbar.html(e),i()(".pat-relateditems-dropdown").off("mouseup"),i()(".pat-relateditems-dropdown").on("mouseup",(e=>{e.stopPropagation()})),i()("button.mode.search",this.$toolbar).on("click",(e=>{e.preventDefault(),this.browsing?(i()("button.mode.search",this.$toolbar).toggleClass("btn-primary btn-secondary"),i()("button.mode.browse",this.$toolbar).toggleClass("btn-primary btn-secondary"),this.browsing=!1,this.$el.select2("data").length>0&&(this.openAfterInit=!0),this.openAfterInit||(this.$el.select2("close"),this.$el.select2("open"))):(this.$el.select2("close"),this.$el.select2("open"))})),i()("button.mode.browse",this.$toolbar).on("click",(e=>{e.preventDefault(),this.browsing?(this.$el.select2("close"),this.$el.select2("open")):(i()("button.mode.search",this.$toolbar).toggleClass("btn-primary btn-secondary"),i()("button.mode.browse",this.$toolbar).toggleClass("btn-primary btn-secondary"),this.browsing=!0,this.$el.select2("data").length>0&&(this.openAfterInit=!0),this.openAfterInit||(this.$el.select2("close"),this.$el.select2("open")))})),i()("a.crumb",this.$toolbar).on("click",(e=>{e.preventDefault(),e.stopPropagation(),this.browseTo(i()(e.currentTarget).attr("href"))})),i()("a.fav",this.$toolbar).on("click",(e=>{e.preventDefault(),e.stopPropagation(),this.browseTo(i()(e.currentTarget).attr("href"))})),this.options.recentlyUsed&&i()(".pat-relateditems-recentlyused-select",this.$toolbar).on("click",(e=>{e.preventDefault();const t=i()(e.currentTarget).data("uid");let n=this.recentlyUsed().filter((e=>e.UID===t));if(n.length>0&&(n=n[0],this.selectItem(n),this.options.maximumSelectionSize>0)){if(this.$el.select2("data").length>=this.options.maximumSelectionSize)return}})),this.options.upload&&c.Z.featureSupport.dragAndDrop()&&c.Z.featureSupport.fileApi()&&(this.options.uploadAllowView?i().ajax({url:this.options.uploadAllowView,dataType:"JSON",data:{path:this.options.rootPath+this.currentPath},type:"GET",success:e=>{this.initUploadView(!e.allowUpload)}}):this.initUploadView())},async initUploadView(e){let t=await Promise.resolve().then(n.bind(n,37103));t=t.default;const a=this.$toolbar[0].querySelector(".upload button");a.disabled=e;const o=this.$toolbar[0].querySelector(".upload .pat-upload"),r={success:(e,t)=>{const n=t.UID;if(n){new c.Z.QueryHelper({vocabularyUrl:this.options.vocabularyUrl,attributes:this.options.attributes}).search("UID","plone.app.querystring.operation.selection.is",n,(e=>{const t=this.$el.select2("data");t.push.apply(t,e.results),this.$el.select2("data",t,!0),this.emit("selected"),this.popover.hide()}),!1)}},uloadMultiple:!0,allowPathSelection:!1,relativePath:"fileUpload",baseUrl:this.options.rootUrl},s=new t(i()(o),r);a.addEventListener("show.bs.dropdown",(()=>{this.currentPath!==s.currentPath&&s.setPath(this.currentPath)}))},browseTo(e){this.emit("before-browse"),this.currentPath=e,this.$el.select2("close"),this.renderToolbar(),this.$el.select2("open"),this.emit("after-browse")},selectItem(e){this.emit("selecting");const t=this.$el.select2("data");if(t.push(e),this.$el.select2("data",t,!0),this.options.recentlyUsed){const t=this.recentlyUsed(),n=t.filter((t=>t.UID===e.UID));n.length>0&&t.splice(t.indexOf(n[0]),1),t.push(e),c.Z.storage.set(this.options.recentlyUsedKey,t)}this.emit("selected")},deselectItem(e){this.emit("deselecting");const t=this.$el.select2("data");t.forEach(((n,a)=>{n.UID===e.UID&&t.splice(a,1)})),this.$el.select2("data",t,!0),this.emit("deselected")},isSelectable(e){return!1!==e.selectable&&(null===this.options.selectableTypes||-1!==this.options.selectableTypes.indexOf(e.portal_type))},async init(){(await n.e(50722).then(n.t.bind(n,50722,23))).Dropdown,n.e(76492).then(n.bind(n,76492)),this.breadcrumbTemplate=(await n.e(8147).then(n.t.bind(n,8147,17))).default,this.favoriteTemplate=(await n.e(58640).then(n.t.bind(n,58640,17))).default,this.recentlyusedTemplate=(await n.e(77427).then(n.t.bind(n,77427,17))).default,this.resultTemplate=(await n.e(71531).then(n.t.bind(n,71531,17))).default,this.selectionTemplate=(await n.e(8443).then(n.t.bind(n,8443,17))).default,this.toolbarTemplate=(await n.e(16071).then(n.t.bind(n,16071,17))).default,this.browsing="search"!==this.options.mode,this.options.rootPath=this.options.rootPath.replace(/\/$/,""),this.currentPath=this.options.basePath.substr(this.options.rootPath.length)||"/",this.setAjax(),this.$el.wrap('<div class="pat-relateditems-container" />'),this.$container=this.$el.parents(".pat-relateditems-container"),p.default.prototype.initializeValues.call(this),p.default.prototype.initializeTags.call(this),this.options.formatSelection=e=>{e=i().extend(!0,{Title:"",getIcon:"",getURL:"",path:"",portal_type:"",review_state:""},e);const t=i()(this.applyTemplate("selection",e));if(this.options.scanSelection&&d.Z.scan(t),1==this.options.maximumSelectionSize){let t=e.path,n=t.split("/");n=n.slice(0,-1),t=n.join("/"),this.currentPath=t,this.renderToolbar()}return t};const e=await c.Z.resolveIcon("arrow-left-circle"),t=await c.Z.resolveIcon("arrow-right-circle");this.options.formatResult=n=>{n.selectable=this.isSelectable(n),n=i().extend(!0,{Title:"",getIcon:"",getURL:"",is_folderish:!1,oneLevelUp:!1,iconLevelUp:e,iconLevelDown:t,path:"",portal_type:"",review_state:"",selectable:!1},n),-1!==this.selectedUIDs.indexOf(n.UID)&&(n.selectable=!1);const a=i()(this.applyTemplate("result",n));return i()(".pat-relateditems-result-select",a).on("click",(e=>{const t=e.currentTarget;if(e.preventDefault(),i()(t).is(".selectable")){const e=i()(t).parents(".pat-relateditems-result");if(e.is(".pat-relateditems-active"))e.removeClass("pat-relateditems-active"),this.deselectItem(n);else{if(this.options.maximumSelectionSize>0){this.$el.select2("data").length>=this.options.maximumSelectionSize&&this.$el.select2("close")}this.selectItem(n),e.addClass("pat-relateditems-active"),this.options.closeOnSelect&&this.$el.select2("close")}}})),i()(".pat-relateditems-result-browse",a).on("click",(e=>{e.preventDefault(),e.stopPropagation();const t=i()(e.currentTarget).data("path");this.browseTo(t)})),i()(a)},this.options.initSelection=(e,t)=>{const n=i()(e).val();if(""!==n){const e=n.split(this.options.separator);new c.Z.QueryHelper(i().extend(!0,{},this.options,{pattern:this})).search("UID","plone.app.querystring.operation.list.contains",e,(n=>{const a=n.results.reduce(((e,t)=>(e[t.UID]=t,e)),{});try{t(e.map((e=>a[e])).filter((e=>void 0!==e)))}catch(e){}this.openAfterInit&&(this.$el.select2("open"),this.openAfterInit=void 0)}),!1)}},this.options.tokenizer=e=>{"auto"===this.options.mode&&(this.browsing=!e)},this.options.id=e=>e.UID,await p.default.prototype.initializeSelect2.call(this),await p.default.prototype.initializeOrdering.call(this),this.$toolbar=i()('<div class="toolbar d-flex" />'),this.$container.prepend(this.$toolbar),this.$el.on("select2-selecting",(e=>{this.isSelectable(e.choice)||e.preventDefault()})),this.renderToolbar(),this.$el.on("select2-loaded",(()=>{let e=window.innerHeight||document.documentElement.clientHeight;const t=i()(".pat-relateditems-dropdown.select2-drop-active .select2-results")[0],n=e-t.getBoundingClientRect().top-18;i()(t).css("max-height",`${n}px`)})),i()(document).on("keyup",this.$el,(e=>{if(p.default.prototype.opened.call(this)&&(e.which===u||e.which===h)){e.stopPropagation();const t=e.which===u?".pat-relateditems-result.one-level-up":".select2-highlighted",n=".pat-relateditems-result-browse",a=i()(n,t);if(1!==a.length)return;const o=a.data("path");this.browseTo(o)}}))}})},74090:function(e,t,n){"use strict";n.r(t);var a=n(85330),i=n.n(a),o=n(11191),r=n(25219),s=n(62832);t.default=o.Z.extend({name:"select2",trigger:".pat-select2",parser:"mockup",defaults:{separator:",",ajaxTimeout:300},initializeValues(){this.options.initialValues&&(this.options.id=e=>e.id,this.options.initSelection=(e,t)=>{const n=[],a=e.val();let o=this.options.initialValues;if("string"==typeof this.options.initialValues&&""!==this.options.initialValues)if("{"===this.options.initialValues[0])o=JSON.parse(this.options.initialValues);else{o={};const e=i()(this.options.initialValues.split(this.options.separator));for(const t of e){const e=t.split(":"),n=e[0].trim(),a=e[1].trim();o[n]=a}}const r=i()(a.split(this.options.separator));for(const e of r){let t=e;o[e]&&(t=o[e]),n.push({id:s.Z.removeHTML(e),text:s.Z.removeHTML(t)})}t(n)})},initializeTags(){this.options.tags&&"string"==typeof this.options.tags&&("["===this.options.tags.substr(0,1)?this.options.tags=JSON.parse(this.options.tags):this.options.tags=this.options.tags.split(this.options.separator)),this.options.tags&&!this.options.allowNewItems&&(this.options.data=this.options.tags.map((e=>({id:e,text:e}))),this.options.multiple=!0,delete this.options.tags)},async initializeOrdering(){if(!this.options.orderable)return;const e=(await n.e(37578).then(n.t.bind(n,37578,23))).default,t=()=>{const t=this.$select2[0].querySelector(".select2-choices");new e(t,{draggable:"li",dragClass:"select2-choice-dragging",chosenClass:"dragging",onStart:()=>this.$el.select2("onSortStart"),onEnd:()=>this.$el.select2("onSortEnd")})};this.$el.on("change",t.bind(this)),t()},async initializeSelect2(){Promise.all([n.e(14894),n.e(69106)]).then(n.bind(n,71058)),n.e(30385).then(n.bind(n,30385)),await n.e(152).then(n.t.bind(n,152,23));try{this.options.language&&"en"!==this.options.language&&await n(70623)(`./select2_locale_${this.options.language}`)}catch{console.warn("Language file could not be loaded",this.options.language)}function e(e,t){return e?(this.options.debug&&console.debug("callback",e,t),"string"==typeof e&&(e=window[e]),e(t)):e}this.options.formatResultCssClass=e=>{if(e.id)return"select2-option-"+e.id.toLowerCase().replace(/[ \:\)\(\[\]\{\}\_\+\=\&\*\%\#]/g,"-")},this.$el.select2(this.options),this.$el.on("select2-selected",(t=>e(this.options.onSelected,t))),this.$el.on("select2-selecting",(t=>e(this.options.onSelecting,t))),this.$el.on("select2-deselecting",(t=>e(this.options.onDeselecting,t))),this.$el.on("select2-deselected",(t=>e(this.options.onDeselected,t))),this.$select2=this.$el.parent().find(".select2-container"),this.$el.parent().off("close.plone-modal.patterns"),this.options.orderable&&this.$select2.addClass("select2-orderable")},opened(){return 1===i()(".select2-dropdown-open",this.$el.parent()).length},async init(){const e=new r.Z;if(this.options.language=e.currentLanguage,this.options.allowNewItems=!this.options.allowNewItems||JSON.parse(this.options.allowNewItems),this.options.ajax||this.options.vocabularyUrl){this.options.vocabularyUrl&&(this.options.multiple=void 0===this.options.multiple||this.options.multiple,this.options.ajax=this.options.ajax||{},this.options.ajax.url=this.options.vocabularyUrl,this.options.initSelection=(e,t)=>{const n=[],a=e.val();for(const e of a.split(this.options.separator)){const t=s.Z.removeHTML(e);n.push({id:t,text:t})}t(n)});let e="";const t=parseInt(this.options.ajaxTimeout||300,10);delete this.options.ajaxTimeout,this.options.ajax=i().extend({quietMillis:t,data:(t,n)=>(e=t,{query:t,page_limit:10,page:n}),results:t=>{let n=t.results;if(this.options.vocabularyUrl){const a=[];for(const e of t.results)a.push(e.id);n=[];const i=""===e||a.includes(e);this.options.allowNewItems&&!i&&(e=s.Z.removeHTML(e),n.push({id:e,text:e}));for(const e of t.results)n.push(e)}return{results:n}}},this.options.ajax)}else if(this.options.multiple&&this.$el.is("select")){this.$el.attr("multiple",!0);const e=this.$el.val()||[],t=[...this.el.querySelectorAll("option")].map((e=>({text:e.innerHTML,id:e.value}))),n=document.createElement("input");n.type="hidden",n.value=e.join(this.options.separator),n.className=this.el.getAttribute("class"),n.name=this.el.name,n.id=this.el.id,this.el.after(n),this.el.remove(),this.el=n,this.$el=i()(n),this.options.data=t}this.initializeValues(),this.initializeTags(),await this.initializeSelect2(),await this.initializeOrdering()}})},71015:function(e,t,n){"use strict";var a=n(85330),i=n.n(a),o=n(11191);t.Z=o.Z.extend({name:"sortable",trigger:".pat-sortable",parser:"mockup",defaults:{selector:"li",dragClass:"item-dragging",cloneClass:"dragging",drop:void 0},init:async function(){let e=await n.e(37578).then(n.t.bind(n,37578,23));e=e.default,this.sortable=new e(this.$el[0],{animation:150,draggable:this.options.selector,chosenClass:this.options.dragClass,dragClass:this.options.cloneClass,onEnd:function(e){var t=this.options.drop;t&&("string"==typeof t&&(t=window[this.options.drop]),t(i()(e.item),e.newIndex-e.oldIndex))}.bind(this)})},disableSort:function(){this.sortable.option("sort",!1)},enableSort:function(){this.sortable.option("sort",!0)}})},37103:function(e,t,n){"use strict";n.r(t);var a=n(85330),i=n.n(a),o=n(24481),r=n.n(o),s=n(10354),l=n(11191),c=n(62832);let d;t.default=l.Z.extend({name:"upload",trigger:".pat-upload",parser:"mockup",defaults:{showTitle:!0,url:null,className:"upload",wrap:!1,wrapperTemplate:'<div class="upload-wrapper"/>',fileaddedClassName:"dropping",useTus:!1,container:"",ajaxUpload:!0,paramName:"file",addRemoveLinks:!1,autoCleanResults:!0,previewsContainer:".previews",previewTemplate:null,maxFiles:null,maxFilesize:99999999,allowPathSelection:void 0,relatedItems:{attributes:["UID","Title","Description","getURL","portal_type","path","ModificationDate"],batchSize:20,basePath:"/",vocabularyUrl:null,width:500,maximumSelectionSize:1,selectableTypes:["Folder"]}},init:async function(){n.e(83930).then(n.bind(n,83930)),n.e(50794).then(n.bind(n,50794)),d=(await n.e(59625).then(n.t.bind(n,15205,23))).default,d.autoDiscover=!1;const e=(await n.e(94818).then(n.t.bind(n,94818,17))).default;var t=this;void 0===t.options.allowPathSelection&&(t.options.allowPathSelection=t.options.baseUrl&&t.options.relativePath),i()(document).on("paste",(function(e){var n=e.originalEvent.clipboardData.items;if(n)for(var a=0;a<n.length;a++)if(-1!==n[a].type.indexOf("image")){var i=n[a].getAsFile();t.dropzone.addFile(i)}})),t.currentPath=t.options.currentPath,t.currentFile=0;let a=r().template(e)({_t:s.ZP,allowPathSelection:t.options.allowPathSelection});t.$el.addClass(t.options.className),t.$el.append(a),t.$progress=i()(".progress-bar-success",t.$el),t.options.showTitle||t.$el.find("h2.title").hide(),t.options.ajaxUpload||(i()(".fallback",this.$el).remove(),this.$el.hasClass(".upload-container")?this.$el.addClass("no-ajax-upload"):this.$el.closest(".upload-container").addClass("no-ajax-upload")),t.options.wrap&&(t.$el.wrap(t.options.wrapperTemplate),t.$el=t.$el.parent()),t.options.allowPathSelection?(t.$pathInput=i()('input[name="location"]',t.$el),t.relatedItems=await t.setupRelatedItems(t.$pathInput)):(i()('input[name="location"]',t.$el).parent().remove(),t.relatedItems=null),t.$dropzone=i()(".upload-area",t.$el),i()("div.browse-select button.browse",t.$el).on("click",(function(e){e.preventDefault(),e.stopPropagation(),(!t.options.maxFiles||t.dropzone.files.length<t.options.maxFiles)&&t.dropzone.hiddenFileInput.click()}));var o=await this.getDzoneOptions();try{t.dropzone=new d(t.$dropzone[0],o)}catch(e){throw window.DEBUG&&console.log(e),e}t.dropzone.on("maxfilesreached",(function(){t.showHideControls()})),t.dropzone.on("addedfile",(function(){t.showHideControls()})),t.dropzone.on("removedfile",(function(){t.showHideControls()})),t.dropzone.on("success",(function(e,n){var a;try{a=i().parseJSON(n)}catch(e){a=n}t.$el.trigger("uploadAllCompleted",{data:a,path_uid:t.$pathInput?t.$pathInput.val():null})})),t.options.autoCleanResults&&t.dropzone.on("complete",(function(e){e.status===d.SUCCESS&&setTimeout((function(){i()(e.previewElement).fadeOut()}),3e3)})),t.dropzone.on("complete",(function(e){e.status===d.SUCCESS&&1===t.dropzone.files.length&&t.showHideControls()})),t.dropzone.on("error",(function(e,t,n){void 0!==n&&403!==n.status&&i()(".dz-error-message span",e.previewElement).html((0,s.ZP)("The file transfer failed"))})),t.dropzone.on("totaluploadprogress",(function(e){e=(100*(t.currentFile-1)+e)/(100*t.dropzone.files.length)*100,t.$progress.attr("aria-valuenow",e).css("width",e+"%")})),i()(".upload-all",t.$el).on("click",(function(e){e.preventDefault(),e.stopPropagation(),t.processUpload({finished:function(){t.$progress.attr("aria-valuenow",0).css("width","0%")}})})),t.options.clipboardfile&&t.dropzone.addFile(t.options.clipboardfile)},showHideControls:function(){var e=this;e._showHideTimeout&&clearTimeout(e._showHideTimeout),e._showHideTimeout=setTimeout((function(){e._showHideControls()}),50)},_showHideControls:function(){var e=this,t=i()(".controls",e.$el),n=i()(".browse-select",e.$el),a=i()(".dz-hidden-input");if(e.options.maxFiles&&(e.dropzone.files.length<e.options.maxFiles?(n.show(),a.prop("disabled",!1)):(n.hide(),a.prop("disabled",!0))),e.dropzone.files.length>0){t.fadeIn("slow");var o=e.dropzone.files[0];i()(".dz-error-message span",o.previewElement).html("")}else t.fadeOut("slow")},pathJoin:function(){var e=[];return r().each(arguments,(function(t){t&&("/"===t[0]&&(t=t.substring(1)),"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),e.push(t))})),e.join("/")},getUrl:function(){var e=this,t=e.options.url;if(!t)if(e.options.baseUrl&&e.options.relativePath)"/"!==(t=e.options.baseUrl)[t.length-1]&&(t+="/"),t+=e.pathJoin(e.currentPath,e.options.relativePath);else{var n=e.$el.parents("form");t=n.length>0?n.attr("action"):window.location.href}return t},getDzoneOptions:async function(){let e=await n.e(51967).then(n.t.bind(n,51967,17));e=e.default;var t=this;t.options.clickable=!0;var a=i().extend({},t.options);if(a.url=t.getUrl(),a.headers={"X-CSRF-TOKEN":c.Z.getAuthenticator()},a.uploadMultiple=!1,delete a.wrap,delete a.wrapperTemplate,delete a.resultTemplate,delete a.autoCleanResults,delete a.fileaddedClassName,delete a.useTus,t.options.previewsContainer){var o=t.$el.find(t.options.previewsContainer);o.length>0&&(a.previewsContainer=o[0])}return a.autoProcessQueue=!1,a.previewTemplate=e,a},processUpload:function(e){e||(e={});var t=this,n=!1,a=t.options.useTus,i=t.options.fileaddedClassName,o=e.finished;t.currentFile=0,function e(){n=!0,0===t.dropzone.files.length&&(n=!1);var r=t.dropzone.files[0];if(n&&r.status===d.ERROR&&(r.status=d.QUEUED,n=!1),!n)return t.$el.removeClass(i),void(void 0!==o&&"function"==typeof o&&o());-1!==[d.SUCCESS,d.CANCELED].indexOf(r.status)?(t.dropzone.removeFile(r),e()):r.status!==d.UPLOADING?(a&&window.tus?t.handleTusUpload(r):(t.currentFile+=1,t.dropzone.processFile(r)),setTimeout(e,100)):setTimeout(e,100)}()},handleTusUpload:function(e){var t=this;e.status=d.UPLOADING,window.tus.upload(e,{endpoint:t.dropzone.options.url,headers:{FILENAME:e.name,"X-CSRF-TOKEN":c.Z.getAuthenticator()},chunkSize:5242880}).fail((function(){window.DEBUG&&console.alert((0,s.ZP)("Error uploading with TUS resumable uploads")),e.status=d.ERROR})).progress((function(e,n,a){var i=n/a*100;t.$progress.attr("aria-valuenow",i).css("width",i+"%"),t.$progress.html((0,s.ZP)("uploading...")+"<br />"+t.formatBytes(n)+" / "+t.formatBytes(a))})).done((function(e,n){n.status=d.SUCCESS,t.dropzone.emit("success",n),t.dropzone.emit("complete",n)}))},formatBytes:function(e){var t=Math.round(e/1024);if(t<1024)return t+" KiB";var n=Math.round(t/1024);return n<1024?n+" MB":Math.round(n/1024)+" GB"},setPath:function(e){var t=this;t.currentPath=e,t.options.url=null,t.options.url=t.dropzone.options.url=t.getUrl()},setupRelatedItems:async function(e){const t=(await Promise.resolve().then(n.bind(n,15260))).default;var a=this,o=a.options.relatedItems;o.upload=!1,a.options.initialFolder&&e.attr("value",a.options.initialFolder);var r=new t(e,o);return r.$el.on("change",(function(){var e=i()(this).select2("data"),t=null;e.length>0&&(t=e[0].path),a.setPath(t)})),r}})},17704:function(e,t,n){"use strict";n.r(t);var a=n(50033),i=n(11191),o=n(82799),r=n(32218),s=n(37834),l=n(85330),c=n.n(l),d={init:function(e){var t={time:3,initialTime:8,exceptionAreas:[]};return this.each((function(){var n=c()(this);n.data("timeout")||(e&&c().extend(t,e),n.data("timeout",{lastEvent:new Date,trueTime:t.time,time:t.initialTime,untouched:!0,inExceptionArea:!1}),n.on("mouseover.timeout",d.mouseMoved),n.on("mouseenter.timeout",d.mouseMoved),c()(t.exceptionAreas).each((function(){n.find(this).live("mouseover.timeout",{parent:n},d.enteredException).live("mouseleave.timeout",{parent:n},d.leftException)})),t.initialTime>0?n.timeout("startTimer"):n.addClass("timeout"))}))},enteredException:function(e){var t=e.data.parent.data("timeout");t.inExceptionArea=!0,e.data.parent.data("timeout",t),e.data.parent.trigger("mouseover")},leftException:function(e){var t=e.data.parent.data("timeout");t.inExceptionArea=!1,e.data.parent.data("timeout",t)},destroy:function(){return this.each((function(){var e=c()(this),t=e.data("timeout");c()(window).off(".timeout"),t.timeout.remove(),e.removeData("timeout")}))},mouseMoved:function(){var e=c()(this),t=e.data("timeout");e.hasClass("timeout")?(e.removeClass("timeout"),e.timeout("startTimer")):t.untouched&&(t.untouched=!1,t.time=t.trueTime),t.lastEvent=new Date,e.data("timeout",t)},startTimer:function(){var e=c()(this),t=e.data("timeout"),n=function(){var t=e.data("timeout");if(t&&t.lastEvent)if(t.inExceptionArea)setTimeout(n,Math.floor(1e3*t.time));else{var a=new Date,i=Math.floor(1e3*t.time)-(a-t.lastEvent);i>0?setTimeout(n,i+100):e.addClass("timeout")}};setTimeout(n,Math.floor(1e3*t.time))}};c().fn.timeout=function(e){return d[e]?d[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void c().error("Method "+e+" does not exist on jQuery.timeout"):d.init.apply(this,arguments)},c().extend(c().expr[":"],{scrollable:function(e){return"scroll"===c()(e).css("overflow")||"scroll"===c()(e).css("overflowX")||"scroll"===c()(e).css("overflowY")||(e.clientHeight<e.scrollHeight&&(-1!==c().inArray(c()(e).css("overflowY"),["scroll","auto"])||-1!==c().inArray(c()(e).css("overflow"),["scroll","auto"]))||e.clientWidth<e.scrollWidth&&(-1!==c().inArray(c()(e).css("overflowX"),["scroll","auto"])||-1!==c().inArray(c()(e).css("overflow"),["scroll","auto"])))}}),c().fn.makeVisibleInScroll=function(e){var t=null;return"string"==typeof e?t=c()("#"+e):e&&(t=c()(e)),this.each((function(){var e,n=c()(this);e=t||((e=n.parents(":scrollable")).length>0?c()(e[0]):c()(window));var a=n.position().top,i=n.height()+a,o=e.scrollTop(),r=e.height()+o;a<o?e.scrollTop(a):i>r-e.height()/2&&e.scrollTop(a-(e.height()-n.height())/2)}))},c().fn.safeOffset=function(){var e,t=this[0],n={top:0,left:0};return t&&t.nodeType?(e=(t.ownerDocument||document).documentElement,c().contains(e,t)?c().fn.offset.apply(this,arguments):n):n},c().fn.setPositionAbsolute=function(e,t,n){return this.each((function(){var a=c()(this),i=c()(this).width(),o=e.safeOffset(),r=e.width(),s=e.height(),l=o.left+r-i+n,d=o.top+s+t;a.css({"z-index":1,position:"absolute",marginLeft:0,marginTop:0,left:l+"px",top:d+"px",width:i}),a.remove().appendTo("body").show()}))},c().fn.positionAncestor=function(e){var t=0,n=0;return this.each((function(){var a=c()(this).closest(e);if(a.length&&"static"!==a.css("position")){var i=c()(this),o=i.safeOffset().left-parseInt(i.css("marginLeft"),10),r=i.safeOffset().top-parseInt(i.css("marginTop"),10),s=a.safeOffset().left+parseInt(a.css("borderLeftWidth"),10),l=a.safeOffset().top+parseInt(a.css("borderTopWidth"),10);return t=o-s,n=r-l,!1}})),{left:t,top:n}},c().fn.findInclusive=function(e){return this.find("*").addBack().filter(e)},c().fn.slideIn=function(e,t,n){return this.animate({width:"show"},e,t,n)},c().fn.slideOut=function(e,t,n){return this.animate({width:"hide"},e,t,n)},c().expr[":"].Contains=function(e,t,n){return c()(e).text().toUpperCase().indexOf(n[3].toUpperCase())>=0},c().fn.scopedFind=function(e){return 0===e.indexOf("#")?c()(e):this.find(e)};const p=new o.Z("checklist");p.addArgument("select",".select-all"),p.addArgument("deselect",".deselect-all"),p.addArgument("toggle",".toggle-all");i.Z.extend({name:"checklist",trigger:".pat-checklist",jquery_plugin:!0,all_selects:[],all_deselects:[],all_toggles:[],all_checkboxes:[],all_radios:[],init(){this.options=p.parse(this.el,this.options,!1),this.$el.on("patterns-injected",this._init.bind(this)),this._init()},_init(){this.all_checkboxes=this.el.querySelectorAll("input[type=checkbox]"),this.all_radios=this.el.querySelectorAll("input[type=radio]"),this.all_selects=r.Z.find_scoped(this.el,this.options.select);for(const e of this.all_selects)e.addEventListener("click",this.select_all.bind(this));this.all_deselects=r.Z.find_scoped(this.el,this.options.deselect);for(const e of this.all_deselects)e.addEventListener("click",this.deselect_all.bind(this));this.all_toggles=r.Z.find_scoped(this.el,this.options.toggle);for(const e of this.all_toggles)e.addEventListener("click",this.toggle_all.bind(this));this.el.addEventListener("change",this._handler_change.bind(this)),this.change_buttons_and_toggles(),this.change_checked()},_handler_change(){s.Z.debounce((()=>this.change_buttons_and_toggles()),50)(),s.Z.debounce((()=>this.change_checked()),50)()},destroy(){for(const e of this.all_selects)e.removeEventListener("click",this.select_all);for(const e of this.all_deselects)e.removeEventListener("click",this.deselect_all);this.el.removeEventListener("change",this._handler_change),this.$el.off("patterns_injected")},find_siblings(e,t){let n,a=e.parentNode;for(;a;){if(n=a.querySelectorAll(`${t}:not(${this.options.toggle})`),n.length||a===this.el)return n;a=a.parentNode}},find_checkboxes(e,t){let n=[];return n=0===this.options.select.indexOf("#")?this.el.querySelectorAll(t):this.find_siblings(e,t),n},change_buttons_and_toggles(){let e;for(const t of this.all_selects)e=this.find_checkboxes(t,"input[type=checkbox]"),t.disabled=[...e].map((e=>e.matches(":checked"))).every((e=>!0===e));for(const t of this.all_deselects)e=this.find_checkboxes(t,"input[type=checkbox]"),t.disabled=[...e].map((e=>e.matches(":checked"))).every((e=>!1===e));for(const t of this.all_toggles)e=this.find_checkboxes(t,"input[type=checkbox]"),t.checked=[...e].map((e=>e.matches(":checked"))).every((e=>!0===e))},select_all(e){e.preventDefault();const t=this.find_checkboxes(e.target,"input[type=checkbox]:not(:checked)");for(const e of t)e.checked=!0,e.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))},deselect_all(e){e.preventDefault();const t=this.find_checkboxes(e.target,"input[type=checkbox]:checked");for(const e of t)e.checked=!1,e.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))},toggle_all(e){e.preventDefault();const t=e.target.checked,n=this.find_checkboxes(e.target,"input[type=checkbox]");for(const e of n)e.checked=t,e.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))},change_checked(){for(const e of[...this.all_checkboxes,...this.all_radios])for(const t of e.labels)t.classList.remove("checked","unchecked"),t.classList.add(e.checked?"checked":"unchecked");for(const e of r.Z.querySelectorAllAndMe(this.el,"fieldset"))e.querySelectorAll(`input[type=checkbox]:checked:not(${this.options.toggle}), input[type=radio]:checked`).length?(e.classList.remove("unchecked"),e.classList.add("checked")):(e.classList.remove("checked"),e.classList.add("unchecked"))}}),n(93520);const u=new o.Z("datetime-picker");u.addArgument("format","YYYY-MM-DD"),u.addArgument("week-numbers",[],["show","hide"]),u.addArgument("i18n"),u.addArgument("today","Today"),u.addArgument("clear","Clear"),u.addArgument("first-day",0);i.Z.extend({name:"datetime-picker",trigger:".pat-datetime-picker",parser:u,el_date:null,el_time:null,async init(){const e=this.el;if(this.options=u.parse(this.el,this.options),s.Z.checkInputSupport("datetime-local","invalid date"))return;window.__patternslib_import_styles&&n.e(28108).then(n.bind(n,28108));const t=(await Promise.resolve().then(n.bind(n,93520))).default,a=this.el.value.split("T"),i=a[0]||"",o=a[1]||"",l=document.createElement("div");l.setAttribute("class","pat-datetime-picker__wrapper"),r.Z.hide(e);const c=`\n            <button type="button" class="_btn _now" title="${this.options.today}">\n                <span class="_icon"/>\n                <span class="_text">${this.options.today}</span>\n            </button>`,d=`\n            <button type="button" class="_btn _clear" title="${this.options.clear}">\n                <span class="_icon"/>\n                <span class="_text">${this.options.clear}</span>\n            </button>`;l.innerHTML=`\n            <input type="date" placeholder="YYYY-MM-DD" value="${i}" />\n            <input type="time" placeholder="hh:mm" value="${o}" />\n            ${this.options.today?c:""}\n            ${this.options.clear?d:""}\n        `,this.el_time=l.querySelector("input[type=time]"),this.el_time.addEventListener("change",(()=>this.update())),this.el_date=l.querySelector("input[type=date]"),this.el_date.addEventListener("change",(()=>{this.el_time.value||(this.el_time.value=this.isotime()),this.update()}));const p={behavior:"native",format:this.options.format,weekNumbers:this.options.weekNumbers,firstDay:this.options.firstDay};if(await t.init(this.el_date,p),this.options.today){l.querySelector("._btn._now").addEventListener("click",(e=>{e.preventDefault(),this.el_date.value=this.isodate(),this.el_time.value=this.isotime(),this.update()}))}if(this.options.clear){l.querySelector("._btn._clear").addEventListener("click",(e=>{e.preventDefault(),this.el_date.value="",this.el_time.value="",this.update()}))}e.parentNode.insertBefore(l,e)},update(){this.el_date.value&&this.el_time.value?this.el.value=`${this.el_date.value}T${this.el_time.value}`:this.el.value="",this.el.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))},isodate(){return(new Date).toISOString().substr(0,10)},isotime(){return(new Date).toTimeString().substr(0,5)}}),n(67164),n(28778);var h=n(32751),m=n(18742),f=n(7424);const g=f.Z.getLogger("pat-validation"),v=new o.Z("validation");v.addArgument("disable-selector","[type=submit], button:not([type=button])"),v.addArgument("message-date",""),v.addArgument("message-datetime",""),v.addArgument("message-email",""),v.addArgument("message-max",""),v.addArgument("message-min",""),v.addArgument("message-number",""),v.addArgument("message-required",""),v.addArgument("message-equality","is not equal to %{attribute}."),v.addArgument("not-after",null),v.addArgument("not-before",null),v.addArgument("equality",null),v.addArgument("delay",100),v.addAlias("message-integer","message-number"),v.addArgument("error-template");const y="__patternslib__input__error__el",b="__patternslib__input__error__msg";class w extends h.o{static name="validation";static trigger="form.pat-validation";static parser=v;init(){m.Z.add_event_listener(this.el,"submit","pat-validation--submit--validator",(e=>{for(const t of this.inputs)g.debug("Checking input for submit",t,e),this.check_input({input:t,event:e})}),{capture:!0}),this.initialize_inputs(),c()(this.el).on("pat-update",(()=>{this.initialize_inputs()})),this.el.setAttribute("novalidate","")}initialize_inputs(){this.inputs=[...this.el.querySelectorAll("input[name], select[name], textarea[name]")],this.disabled_elements=[...this.el.querySelectorAll(this.options.disableSelector)];for(const[e,t]of this.inputs.entries()){const n=s.Z.debounce((e=>{g.debug("Checking input for event",t,e),this.check_input({input:t,event:e})}),this.options.delay);m.Z.add_event_listener(t,"input",`pat-validation--input-${t.name}--${e}--validator`,(e=>n(e))),m.Z.add_event_listener(t,"change",`pat-validation--change-${t.name}--${e}--validator`,(e=>n(e))),m.Z.add_event_listener(t,"blur",`pat-validation--blur-${t.name}--${e}--validator`,(e=>n(e)))}}check_input(e){let{input:t,event:n,stop:a=!1}=e;if(t.disabled)return;this.set_validity({input:t,msg:""});const i=t.validity;if(n?.submitter?.hasAttribute("formnovalidate"))return;g.debug(`\n            validity_state.badInput ${i.badInput}\n            validity_state.customError ${i.customError}\n            validity_state.patternMismatch ${i.patternMismatch}\n            validity_state.rangeOverflow ${i.rangeOverflow}\n            validity_state.rangeUnderflow ${i.rangeUnderflow}\n            validity_state.stepMismatch ${i.stepMismatch}\n            validity_state.tooLong ${i.tooLong}\n            validity_state.tooShort ${i.tooShort}\n            validity_state.typeMismatch ${i.typeMismatch}\n            validity_state.valid ${i.valid}\n            validity_state.valueMissing ${i.valueMissing}\n        `);const o=v.parse(t);if(i.valid){if(o.equality&&this.el.querySelector(`[name=${o.equality}]`)?.value!==t.value){const e=o.message.equality||"The value is not equal to %{attribute}";this.set_validity({input:t,msg:e,attribute:o.equality})}else if(o.not.after||o.not.before){const e=o.message.date||o.message.datetime,n="The date must be after %{attribute}",i="The date must be before %{attribute}";let r,l,c,d;if(o.not.after&&(s.Z.is_iso_date_time(o.not.after,!0)?r=new Date(o.not.after):(l=document.querySelector(o.not.after),r=l?.value?new Date(l?.value):void 0),r=isNaN(r)?null:r),o.not.before&&(s.Z.is_iso_date_time(o.not.before,!0)?c=new Date(o.not.before):(d=document.querySelector(o.not.before),c=d?.value?new Date(d?.value):void 0),c=isNaN(c)?null:c),t.value&&s.Z.is_iso_date_time(t.value,!0)&&!isNaN(new Date(t.value))){const a=new Date(t.value);if(r&&a>r){let n;!l&&o.not.after?n=o.not.after:(n=l?.labels?.[0]?.textContent.replace(/\s\s+/g," "),n=n||l.name),this.set_validity({input:t,msg:e||i,attribute:n.trim()})}else if(c&&a<c){let a;!d&&o.not.before?a=o.not.before:(a=d?.labels?.[0]?.textContent.replace(/\s\s+/g," "),a=a||d.name),this.set_validity({input:t,msg:e||n,attribute:a.trim()})}}!a&&l&&(g.debug("Check `not-after` input.",l),this.check_input({input:l,stop:!0})),!a&&d&&(g.debug("Check `no-before` input.",l),this.check_input({input:d,stop:!0}))}if(!i.customError)return void this.remove_error(t,!0)}else i.valueMissing&&o.message.required?this.set_validity({input:t,msg:o.message.required}):i.rangeUnderflow&&o.message.min?this.set_validity({input:t,msg:o.message.min,min:t.getAttribute("min")}):i.rangeOverflow&&o.message.max?this.set_validity({input:t,msg:o.message.max,max:t.getAttribute("max")}):(i.badInput||i.stepMismatch)&&"number"===t.type&&o.message.number?this.set_validity({input:t,msg:o.message.number}):i.typeMismatch&&"email"===t.type&&o.message.email?this.set_validity({input:t,msg:o.message.email}):i.rangeUnderflow&&"date"===t.type&&o.message.date||i.rangeOverflow&&"date"===t.type&&o.message.date?this.set_validity({input:t,msg:o.message.date}):(i.rangeUnderflow&&"datetime"===t.type&&o.message.datetime||i.rangeOverflow&&"datetime"===t.type&&o.message.datetime)&&this.set_validity({input:t,msg:o.message.datetime});"submit"===n?.type&&(n.preventDefault(),n.stopPropagation(),n.stopImmediatePropagation()),this.set_error_message(t)}set_validity(e){let{input:t,msg:n,attribute:a=null,min:i=null,max:o=null}=e;a&&(n=n.replace(/%{attribute}/g,a)),i&&(n=n.replace(/%{count}/g,i)),o&&(n=n.replace(/%{count}/g,o)),n=n.replace(/%{value}/g,JSON.stringify(t.value)),t.setCustomValidity(n),t[b]=n}remove_error(e){let t=[e];arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&(t=this.inputs.filter((t=>t.name===e.name)));for(const e of t){const t=e[y];e[y]=null,t?.remove()}if(this.el.checkValidity())for(const e of this.disabled_elements)e.disabled&&(e.removeAttribute("disabled"),e.classList.remove("disabled"))}set_error_message(e){this.remove_error(e);const t=this.inputs.filter((t=>t.name===e.name));if(t.length>1&&t.some((e=>!!e[y])))return;const n=e.validationMessage||e[b],a=r.Z.create_from_string(this.error_template(n)).firstChild;let i;"radio"!==e.type&&"checkbox"!==e.type||(i=e.closest("fieldset.pat-checklist")),i?i.append(a):e.after(a),e[y]=a;let o=!1;for(const e of this.disabled_elements)e.disabled||e.formNoValidate||(o=!0,e.setAttribute("disabled","disabled"),e.classList.add("disabled"),g.debug("Disable element",e));if(o){g.debug("Checking whole form after element was disabled.");for(const t of this.inputs.filter((t=>t!==e)))this.check_input({input:t,stop:!0})}}error_template(e){return`<em class="validation warning message">${e}</em>`}}a.Z.register(w);var _=n(36382);const x=new o.Z("code-editor");x.addArgument("language",null),x.addArgument("linenumbers",!1),x.addArgument("theme","dark"),x.addArgument("tab","    "),x.addArgument("indent-on","{$"),x.addArgument("spellcheck",!1),x.addArgument("catch-tab",!0),x.addArgument("preserve-ident",!0),x.addArgument("add-closing",!0),x.addArgument("history",!0);const $={atom:"xml",html:"xml",plist:"xml",rss:"xml",svg:"xml",wsf:"xml",xhtml:"xml",xjb:"xml",xsd:"xml",xsl:"xml"};class k extends h.o{static name="code-editor";static trigger=".pat-code-editor";static parser=x;async init(){const e=(await n.e(20256).then(n.bind(n,20256))).CodeJar,t=(await n.e(47802).then(n.t.bind(n,47802,23))).default;let a,i=this.el;a="light"===this.options.theme?"stackoverflow-light":"dark"===this.options.theme||"okaidia"===this.options.theme?"stackoverflow-dark":this.options.theme,await n(25794)(`./${a}.css`),window.__patternslib_import_styles&&await n.e(95912).then(n.bind(n,95912));const o=e=>{e.textContent=e.textContent,t.highlightElement(e)};let r=o;if(this.options.linenumbers){r=(0,(await n.e(65663).then(n.bind(n,65663))).withLineNumbers)(o,{class:`codejar-linenumbers ${a}`})}let s=[...i.classList].filter((e=>e.startsWith("language-")))[0];s=s?s.replace("language-",""):this.options.language,s=s||"plaintext";const l=(await n(55867)(`./${$[s]||s}`)).default;if(t.registerLanguage(s,l),["textarea","input"].includes(this.el.nodeName.toLowerCase())){const e=document.createElement("pre");e.innerHTML="<code contenteditable></code>",i=e.querySelector("code"),i.textContent=this.el.value,this.el.parentNode.insertBefore(e,this.el),this.el.setAttribute("hidden","")}i.classList.add("code-editor",`theme-${this.options.theme}`,`language-${s}`);const c={tab:this.options.tab.replace(/'/g,"").replace(/"/g,"").replace(/\\t/g,"\t"),indentOn:new RegExp(this.options.indentOn),spellcheck:this.options.spellcheck,catchTab:this.options.catchTab,preserveIdent:this.options.preserveIdent,addClosing:this.options.addClosing,history:this.options.history};this.codeeditor=e(i,r,c),i!==this.el&&this.codeeditor.onUpdate((e=>{this.el.value=e.trim(),this.el.dispatchEvent(m.Z.input_event())}))}}a.Z.register(k);const T=f.Z.getLogger("pat.ajax"),O=new o.Z("ajax");O.addArgument("accept","text/html"),O.addArgument("url",(function(e){return(e.is("a")?e.attr("href"):e.is("form")?e.attr("action"):"").split("#")[0]})),O.addArgument("browser-cache","no-cache",["cache","no-cache"]);const E={get:function(e){return void 0!==this[e]?this[e]:0},inc:function(e){return this[e]=this.get(e)+1,this.get(e)}},A={name:"ajax",trigger:".pat-ajax",parser:O,init(e){return e.off(".pat-ajax"),e.filter("a").on("click.pat-ajax",A.onTriggerEvents),e.filter("form").on("submit.pat-ajax",A.onTriggerEvents).on("click.pat-ajax","[type=submit]",A.onClickSubmit),e.filter(":not(form,a)").each((function(){T.warn("Unsupported element:",this)})),e},destroy(e){e.off(".pat-ajax")},onClickSubmit(e){const t=e.target,n=t.closest("form"),a={};t.name&&(a[t.name]=t.value),c()(n).data("pat-ajax.clicked-data",a)},onTriggerEvents(e){e&&e.preventDefault(),A.request(c()(this))},request(e,t){return e.each((function(){A._request(c()(this),t)}))},_request(e,t){const n=A.parser.parse(e,t),a=E.inc(n.url),i=e.data("pat-ajax.clicked-data"),o=i?c().param(i):"",r={context:e,data:[e.serialize(),o].filter(Boolean).join("&"),headers:{},url:n.url,method:e.attr("method")?e.attr("method"):"GET",cache:"cache"===n.browserCache};if(n.accept&&(r.headers.Accept=n.accept),e.is("form")&&e.attr("method")&&"POST"==e.attr("method").toUpperCase()){const t=new FormData(e[0]);for(const e in i)t.append(e,i[e]);r.method="POST",r.data=t,r.cache=!1,r.contentType=!1,r.processData=!1,r.type="POST"}e.removeData("pat-ajax.clicked-data"),T.debug("request:",r,e[0]);const s=c().ajax(r);s&&s.done((function(t,i,o){T.debug("success: jqxhr:",o),a===E.get(n.url)&&e.trigger({type:"pat-ajax-success",jqxhr:o})})).fail((function(t,a,i){T.error("load error for "+n.url+":",i,t),e.trigger({type:"pat-ajax-error",jqxhr:t})}))}};a.Z.register(A);var S=A;const C=f.Z.getLogger("pat.inject"),D=new o.Z("inject");D.addArgument("default-selector"),D.addArgument("target"),D.addArgument("data-type","html"),D.addArgument("next-href"),D.addArgument("source"),D.addArgument("trigger","default",["default","autoload","autoload-visible","idle"]),D.addArgument("delay"),D.addArgument("browser-cache","no-cache",["cache","no-cache"]),D.addArgument("confirm","class",["never","always","form-data","class"]),D.addArgument("confirm-message","Are you sure you want to leave this page?"),D.addArgument("loading-class","injecting"),D.addArgument("executing-class","executing"),D.addArgument("executed-class","executed"),D.addArgument("class"),D.addArgument("history","none",["none","record"]),D.addArgument("push-marker"),D.addArgument("scroll"),D.addArgument("url");const N={name:"inject",trigger:"a.pat-inject, form.pat-inject, .pat-subform.pat-inject",parser:D,init(e,t){const n=this.extractConfig(e,t);if(n.some((e=>"record"===e.history))&&!("pushState"in history))return e;if(e.data("pat-inject",n),n[0].nextHref&&0===n[0].nextHref.indexOf("#")&&e.is("a")&&c()(n[0].nextHref).length>0)return C.debug("Skipping as next href is anchor, which already exists",n[0].nextHref),e.attr({href:(window.location.href.split("#")[0]||"")+n[0].nextHref});if(n[0].pushMarker&&c()("body").on("push",((t,a)=>{C.debug("received push message: "+a),a==n[0].pushMarker&&(C.debug("re-injecting "+a),this.onTrigger({currentTarget:e[0]}))})),n[0].idleTrigger)this._initIdleTrigger(e,n[0].idleTrigger);else switch(n[0].trigger){case"default":n.forEach((e=>{e.delay&&(e.processDelay=e.delay)})),e.is("form")?e.on("submit.pat-inject",this.onTrigger.bind(this)).on("click.pat-inject","[type=submit]",S.onClickSubmit).on("click.pat-inject","[type=submit][formaction], [type=image][formaction]",this.onFormActionSubmit.bind(this)):e.is(".pat-subform")?C.debug("Initializing subform with injection"):e.on("click.pat-inject",this.onTrigger.bind(this));break;case"autoload":if(n[0].delay){const t=Math.random().toString(36);e.attr("data-pat-inject-uid",t);const a=t=>0!=c()("[data-pat-inject-uid='"+t+"']").length&&(e.data("pat-inject-autoloaded",!0),this.onTrigger({currentTarget:e[0]}),!0);window.setTimeout(a.bind(null,t),n[0].delay)}else this.onTrigger({currentTarget:e[0]});break;case"autoload-visible":this._initAutoloadVisible(e,n);break;case"idle":this._initIdleTrigger(e,n[0].delay)}return C.debug("initialised:",e),e},destroy(e){return e.off(".pat-inject"),e.data("pat-inject",null),e},onTrigger(e){const t=c()(e.currentTarget),n=t.data("pat-inject");t.is("form")&&c()(n).each(((e,n)=>{n.params=c().param(t.serializeArray())})),e.preventDefault&&e.preventDefault(),t.trigger("patterns-inject-triggered"),this.execute(n,t)},onFormActionSubmit(e){S.onClickSubmit(e);const t=c()(e.target),n=t.attr("formaction"),a=t.parents(".pat-inject").first(),i={url:n},o=t.closest("[data-pat-inject]"),r=this.extractConfig(o,i);c()(r).each(((e,t)=>{t.params=c().param(a.serializeArray())})),e.preventDefault(),a.trigger("patterns-inject-triggered"),this.execute(r,a)},submitSubform(e){const t=e.parents("form"),n=e.data("pat-inject");c()(n).each(((t,n)=>{n.params=c().param(e.serializeArray())}));try{t.trigger("patterns-inject-triggered")}catch(e){C.error("patterns-inject-triggered",e)}this.execute(n,t)},extractConfig(e,t){t=c().extend({},t);const n=D.parse(e,t,!0);return n.forEach((n=>{n.$context=e,n.url=t.url||n.url||e.attr("href")||e.attr("action")||e.parents("form").attr("action")||"";const a=n.url.split("#");if(n.url=a[0],a.length>2&&C.warn("Ignoring additional source ids:",a.slice(2)),n.defaultSelector||(n.defaultSelector=a[1]&&"#"+a[1]||"body"),n.delay)try{n.delay=s.Z.parseTime(n.delay)}catch(e){C.warn("Invalid delay value: ",n.delay),n.delay=null}n.processDelay=0})),n},elementIsDirty(e){const t=c().map(e.find(":input:not(select)"),(e=>{const t=c()(e).val();return Boolean(t)&&t!==c()(e).attr("placeholder")}));return-1!==c().inArray(!0,t)},askForConfirmation(e){let t,n=!1;for(const a of e){let e=!1;"always"==a.confirm?e=!0:"form-data"===a.confirm&&a.target&&"none"!==a.target?e=this.elementIsDirty(a.$target):"class"===a.confirm&&a.target&&"none"!==a.target&&(e=a.$target.hasClass("is-dirty")),e&&(n=!0,t=a.confirmMessage)}return!(n&&!window.confirm(t))},ensureTarget(e){if("none"===e.target)return!0;if(e.$target=e.$target||("self"===e.target?e.$context:c()(e.target)),0===e.$target.length){if(!e.target)return C.error("Need target selector",e),!1;e.$target=this.createTarget(e.target),e.$injected=e.$target}return!0},verifySingleConfig(e,t){return t.url!==e?(C.error("Unsupported different urls for multi-inject"),!1):(t.source=t.source||t.defaultSelector,t.target=t.target||t.defaultSelector,!!this.extractModifiers(t)&&(!!this.ensureTarget(t)&&(this.listenForFormReset(t),!0)))},verifyConfig(e){return e.every((t=>this.verifySingleConfig(e[0].url,t)))},listenForFormReset(e){if("none"===e.target)return;const t=e.$target.parents("form");0!==t.length&&void 0===e.$target.data("initial-value")&&(e.$target.data("initial-value",e.$target.html()),t.on("reset",(()=>{e.$target.html(e.$target.data("initial-value"))})))},extractModifiers(e){const t=/^(.*?)(::element)?$/.exec(e.source),n=/^(.*?)(::element)?(::after|::before)?$/.exec(e.target);e.source=t[1],e.sourceMod=t[2]?"element":"content",e.target=n[1];const a=n[2]?"element":"content",i=(n[3]||"::").slice(2);return e.loadingClass&&(e.loadingClass+=" "+e.loadingClass+"-"+a,i&&e.loadingClass&&(e.loadingClass+=" "+e.loadingClass+"-"+i)),e.action=a+i,!0},createTarget(e){if("#"!==e.slice(0,1))return C.error("only id supported for non-existing target"),null;const t=c()("<div />").attr({id:e.slice(1)});return c()("body").append(t),t},_performInjection(e,t,n,a,i,o){let r;"content"===a.sourceMod&&(n=n.contents()),r=n.safeClone(),r.findInclusive("img").on("load",(e=>{c()(e.currentTarget).trigger("pat-inject-content-loaded")}));const s=a.$injected||r;this._inject(i,r,c()(e),a)&&(this._update_history(a,i,o),this._afterInjection(t,s,a))},_update_history(e,t,n){const a=e.url.indexOf("?")>-1?"&":"?";"record"===e.history&&"pushState"in history&&(e.params?history.pushState({url:e.url+a+e.params},"",e.url+a+e.params):history.pushState({url:e.url},"",e.url),n&&this._inject(t,n,c()("title"),{action:"element"}))},_afterInjection(e,t,n){if(t.filter(((e,t)=>3!==t.nodeType)).data("pat-injected",{origin:n.url}),1===t.length&&3==t[0].nodeType?t.parent().trigger("patterns-injected",[n,e[0],t[0]]):t.each(((t,a)=>{3!==a.nodeType&&c()(a).addClass(n.class).trigger("patterns-injected",[n,e[0],a])})),n.scroll&&"none"!==n.scroll){const e=["top","target"].includes(n.scroll)?n.$target[0]:t.findInclusive(n.scroll)[0],a=r.Z.find_scroll_container(e,null,window);"top"===n.scroll?r.Z.scroll_to_top(a):e&&r.Z.scroll_to_element(e,a)}e[0].dispatchEvent(new Event("pat-inject-success",{bubbles:!0,cancelable:!0}))},async _onInjectSuccess(e,t,n){let a=n?.jqxhr?.responseText;if(!a)return void C.warn("No response content, aborting",n);"none"===t[0].source&&(a="");const i=await this.callTypeHandler(t[0].dataType,"sources",e,[t,a,n]);let o;i&&i[i.length-1]&&i[i.length-1][0]&&"TITLE"==i[i.length-1][0].nodeName&&(o=i[i.length-1]),t.forEach(((t,a)=>{const r=()=>{"none"!==t.target&&t.$target.each(((r,s)=>{this._performInjection(s,e,i[a],t,n.target,o)}))};t.processDelay?setTimeout((()=>r()),t.processDelay):r()})),t[0].nextHref&&e.is("a")&&(e.attr({href:t[0].nextHref.replace(/&amp;/g,"&")}),this.destroy(e)),e.off("pat-ajax-success.pat-inject"),e.off("pat-ajax-error.pat-inject")},async _onInjectError(e,t,n){let i="";const o=n.jqxhr.status,r=new Date;let s,l;o%100==4?i="Sorry! We couldn't find the page to load. Please make a screenshot and send it to support. Thank you!":o%100==5?i="I am very sorry! There was an error at the server. Please make a screenshot and contact support. Thank you!":0==o&&(i="It seems, the server is down. Please make a screenshot and contact support. Thank you!");if(null===new URLSearchParams(window.location.search).get("pat-inject-errorhandler.off")){const e=document?.querySelector(`meta[name^=pat-inject-status-${o}]`)?.getAttribute("content",!1);if(l=e?.split("#")[1],l=l?`#${l}`:null,l&&(s=document.createElement("html"),s.innerHTML=n.jqxhr.responseText,s=s.querySelector(l)),!s&&e)try{const t=await fetch(e,{method:"GET"});s=document.createElement("html"),s.innerHTML=await t.text(),s=s.querySelector(l||"body")}catch{}}if(t.forEach((t=>{"$injected"in t&&t.$injected.remove(),t.$target.removeClass(t.loadingClass),e.removeClass(t.executingClass)})),e.off("pat-ajax-success.pat-inject"),e.off("pat-ajax-error.pat-inject"),s){const e=document.querySelector(l||"body");e.innerHTML=s.innerHTML,a.Z.scan(e)}else{const e=`${i} Status is ${o} ${n.jqxhr.statusText}, time was ${r}. You can click to close this.`;c()("body").attr("data-error-message",e),c()("body").on("click",(()=>{c()("body").removeAttr("data-error-message"),window.location.href=window.location.href}))}},execute(e,t){if(e=e.map((e=>c().extend({},e))),!this.verifyConfig(e))return;if(!this.askForConfirmation(e))return;if(t.data("pat-inject-triggered"))return;t.data("pat-inject-triggered",!0);for(const n of e)n?.executingClass&&t[0].classList.add(n.executingClass),n?.loadingClass&&"none"!==n?.target&&n.$target.addClass(n.loadingClass);t.on("pat-ajax-success.pat-inject",(async a=>{this._onInjectSuccess(t,e,a),await s.Z.timeout(1),m.Z.remove_event_listener(t[0],"pat-inject--close-panel"),n&&(n=!1,t[0].dispatchEvent(new Event("close-panel",{bubbles:!0,cancelable:!0})))})),t.on("pat-ajax-error.pat-inject",this._onInjectError.bind(this,t,e)),t.on("pat-ajax-success.pat-inject pat-ajax-error.pat-inject",(()=>t.removeData("pat-inject-triggered")));let n=!1;m.Z.add_event_listener(t[0],"close-panel","pat-inject--close-panel",(e=>{e.stopPropagation(),e.stopImmediatePropagation(),n=!0})),e[0].url.length?S.request(t,{url:e[0].url,"browser-cache":e[0].browserCache}):t.trigger({type:"pat-ajax-success",jqxhr:{responseText:c()("body").html()}})},_inject(e,t,n,a){const i={contentbefore:"prepend",contentafter:"append",elementbefore:"before",elementafter:"after"}[a.action];return"none"===a.source?(n.replaceWith(""),!0):0===t.length?(C.warn("Aborting injection, source not found:",t),c()(e).trigger("pat-inject-missingSource",{url:a.url,selector:a.source}),!1):"none"===a.target||(0===n.length?(C.warn("Aborting injection, target not found:",n),c()(e).trigger("pat-inject-missingTarget",{selector:a.target}),!1):("content"===a.action?n.empty().append(t):"element"===a.action?n.replaceWith(t):n[i](t),!0))},_sourcesFromHtml(e,t,n){const a=this._parseRawHtml(e,t);return n.map((e=>{if("body"===e&&(e="#__original_body"),"none"===e)return c()("\x3c!-- --\x3e");const n=a.find(e);return 0===n.length&&"title"!=e&&C.warn("No source elements for selector:",e,a),n.find('a[href^="#"]').each(((e,a)=>{const i=a.getAttribute("href");-1===i.indexOf("#{1}")&&(1===i.length?a.href=t:n.find(i).length||(a.href=t+i))})),n}))},_rebaseAttrs:{A:"href",FORM:"action",IMG:"data-pat-inject-rebase-src",OBJECT:"data",SOURCE:"data-pat-inject-rebase-src",VIDEO:"data-pat-inject-rebase-src"},_rebaseOptions:{calendar:["url","event-sources"],collapsible:["load-content"],"date-picker":["i18n"],"datetime-picker":["i18n"],inject:["url"]},_rebaseURL(e,t){return-1!==t.indexOf("://")||"/"===t[0]||0===t.indexOf("data:")?t:(e=new URL(e,window.location).href).slice(0,e.lastIndexOf("/")+1)+t},_rebaseHTML(e,t){if(""===t)return"";const n=c()(t.replace(/(\s)(src\s*)=/gi,'$1src="" data-pat-inject-rebase-$2=').trim()).wrapAll("<div>").parent();n.find(Object.keys(this._rebaseAttrs).join(",")).each(((t,n)=>{const a=c()(n),i=this._rebaseAttrs[n.tagName];let o=a.attr(i);o&&"@@"!==o.slice(0,2)&&"#"!==o[0]&&"mailto:"!==o.slice(0,7)&&"tel:"!==o.slice(0,4)&&"fax:"!==o.slice(0,4)&&"callto:"!==o.slice(0,7)&&"ts3server:"!==o.slice(0,10)&&"teams:"!==o.slice(0,6)&&"javascript:"!==o.slice(0,11)&&(o=this._rebaseURL(e,o),a.attr(i,o))}));for(const[t,i]of Object.entries(this._rebaseOptions))for(const o of r.Z.querySelectorAllAndMe(n[0],`[data-pat-${t}]`)){const n=a.Z.patterns?.[t],r=n?.parser;if(!r)continue;const s=r.parse(o,{},!0,!1,!1);let l=!1;for(const t of s)for(const n of i){const a=t[n];a&&(l=!0,Array.isArray(a)?t[n]=a.map((t=>this._rebaseURL(e,t))):t[n]=this._rebaseURL(e,a))}l&&o.setAttribute(`data-pat-${t}`,JSON.stringify(1===s.length?s[0]:s))}return n.html().replace(/src="" data-pat-inject-rebase-/g,"").trim()},_parseRawHtml(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=e.match(/\<title\>(.*)\<\/title\>/);let a=e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<head\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/head>/gi,"").replace(/<body([^>]*?)>/gi,'<div id="__original_body">').replace(/<\/body([^>]*?)>/gi,"</div>");n&&2==n.length&&(a=n[0]+a);try{a=this._rebaseHTML(t,a)}catch(e){C.error("Error rebasing urls",e)}const i=c()("<div/>").html(a);return 0===i.children().length&&C.warn("Parsing html resulted in empty jquery object:",a),i},_initAutoloadVisible(e,t){if(e.data("pat-inject-autoloaded"))return!1;const n=e[0],a=t[0].delay||200;C.debug(`Delay time: ${a}`);const i=t=>e.data("pat-inject-autoloaded")?(C.debug(`autoload-visible trigger skipped ${n}`),!1):(e.data("pat-inject-autoloaded",!0),this.onTrigger({currentTarget:n}),t&&t.preventDefault(),C.debug(`autoload-visible trigger run ${n}`),!0);let o=null;const r=new IntersectionObserver((e=>{for(const t of e)t.isIntersecting?(o=window.setTimeout((()=>{r.disconnect(),i()}),a),C.debug(`autoload-visible intersecting ${n}`)):(window.clearTimeout(o),C.debug(`autoload-visible not intersecting ${n}`))}),{threshold:0,root:null,margin:"0px"});r.observe(n)},_initIdleTrigger(e,t){const n=parseInt(t,10);let a;const i=()=>{this.onTrigger({currentTarget:e[0]}),r(),clearTimeout(a)},o=s.Z.debounce((()=>{document.body.contains(e[0])?(clearTimeout(a),a=setTimeout(i,n)):r()}),n),r=()=>{["scroll","resize"].forEach((e=>window.removeEventListener(e,o))),["click","keypress","keyup","mousemove","touchstart","touchend"].forEach((e=>document.removeEventListener(e,o)))};o(),["scroll","resize"].forEach((e=>window.addEventListener(e,o))),["click","keypress","keyup","mousemove","touchstart","touchend"].forEach((e=>document.addEventListener(e,o)))},registerTypeHandler(e,t){this.handlers[e]=t},async callTypeHandler(e,t,n,a){return e=e||"html",this.handlers[e]&&c().isFunction(this.handlers[e][t])?await this.handlers[e][t].bind(this)(...a):null},handlers:{html:{sources(e,t){const n=e.map((e=>e.source));return n.push("title"),this._sourcesFromHtml(t,e[0].url,n)}}}};if(c()(document).on("patterns-injected.inject",(async(e,t,n,i)=>{t&&t.skipPatInjectHandler||(t&&(t.$target.removeClass(t.loadingClass),c()(n).removeClass(t.executingClass).addClass(t.executedClass)),3!==i.nodeType&&8!==i.nodeType&&(a.Z.scan(i,null,{type:"injection",element:n}),c()(i).trigger("patterns-injected-scanned"),await s.Z.timeout(10),i.dispatchEvent(new CustomEvent("patterns-injected-delayed",{bubbles:!0,cancelable:!0,detail:{injected:i}}))))})),c()(window).on("popstate",(e=>{if(e.originalEvent.state||!("replaceState"in history))window.location.reload();else try{history.replaceState("anchor","",document.location.href)}catch(e){C.debug(e)}})),"replaceState"in history)try{history.replaceState("pageload","",document.location.href)}catch(e){C.debug(e)}a.Z.register(N);const P=f.Z.getLogger("depends"),I=new o.Z("depends");I.addArgument("condition"),I.addArgument("action","show",["show","enable","both"]),I.addArgument("transition","none",["none","css","fade","slide"]),I.addArgument("effect-duration","fast"),I.addArgument("effect-easing","swing");i.Z.extend({name:"depends",trigger:".pat-depends",jquery_plugin:!0,async init(e,t){const a=(await n.e(35387).then(n.bind(n,35387))).default,i=this.$el[0],o=I.parse(this.$el,t);let r;this.$modal=this.$el.parents(".pat-modal");try{r=new a(this.$el,o.condition)}catch(e){return void P.error("Invalid condition: "+e.message,i)}let l=r.evaluate();switch(o.action){case"show":s.Z.hideOrShow(e,l,o,this.name),this.updateModal();break;case"enable":l?this.enable():this.disable();break;case"both":l?(s.Z.hideOrShow(e,l,o,this.name),this.updateModal(),this.enable()):(s.Z.hideOrShow(e,l,o,this.name),this.updateModal(),this.disable())}const d={handler:r,options:o,dependent:i};for(let e of r.getAllInputs()){if(e.form){let t=c()(e.form),n=t.data("patDepends.dependents");n?-1===n.indexOf(d)&&n.push(d):(n=[d],t.on("reset.pat-depends",(()=>this.onReset))),t.data("patDepends.dependents",n)}c()(e).on("change.pat-depends",null,d,this.onChange.bind(this)),c()(e).on("keyup.pat-depends",null,d,this.onChange.bind(this))}},async onReset(e){const t=c()(e.target).data("patDepends.dependents");await s.Z.timeout(50);for(let n of t)e.data=n,this.onChange(e)},updateModal(){this.$modal.length&&c()(document).trigger("pat-update",{pattern:"depends"})},enable(){this.$el.is(":input")?this.$el[0].disabled=null:this.$el.is("a")&&this.$el.off("click.patternDepends"),this.$el.removeClass("disabled"),this.$el.trigger("pat-update",{pattern:"depends",action:"attribute-changed",dom:this.$el[0],enabled:!0})},disable(){this.$el.is(":input")?this.$el[0].disabled="disabled":this.$el.is("a")&&this.$el.on("click.patternDepends",(e=>e.preventDefault())),this.$el.addClass("disabled"),this.$el.trigger("pat-update",{pattern:"depends",action:"attribute-changed",dom:this.$el[0],enabled:!1})},onChange(e){const t=e.data.handler,n=e.data.options,a=e.data.dependent,i=c()(a),o=t.evaluate();switch(n.action){case"show":s.Z.hideOrShow(i,o,n,this.name),this.updateModal();break;case"enable":o?this.enable():this.disable();break;case"both":s.Z.hideOrShow(i,o,n,this.name),this.updateModal(),o?this.enable():this.disable()}}}),n(95474),n(57887);var j=n(62832),M=n(24481),Z=n.n(M);const z=f.Z.getLogger("pat-contentloader");i.Z.extend({name:"contentloader",trigger:".pat-contentloader",parser:"mockup",defaults:{url:null,content:null,trigger:"click",target:null,template:null,dataType:"html"},init:function(){var e=this;"el"===e.options.url&&"A"===e.$el[0].tagName&&(e.options.url=e.$el.attr("href")),e.$el.removeClass("loading-content"),e.$el.removeClass("content-load-error"),"immediate"===e.options.trigger?e._load():e.$el.on(e.options.trigger,(function(t){t.preventDefault(),e._load()}))},_load:function(){var e=this;e.$el.addClass("loading-content"),e.options.url?e.loadRemote():e.loadLocal()},loadRemote:function(){var e=this;c().ajax({url:e.options.url,dataType:e.options.dataType,success:function(t){var n;if("html"===e.options.dataType)-1!==t.indexOf("<html")&&(t=j.Z.parseBodyTag(t)),n=c()("<div>"+t+"</div>");else if(-1!==e.options.dataType.indexOf("json")){t.constructor===Array&&1===t.length&&(t=t[0]);try{n=c()(Z().template(e.options.template)(t))}catch(t){return e.$el.removeClass("loading-content"),e.$el.addClass("content-load-error"),void z.warn("error rendering template. pat-contentloader will not work")}}null!==e.options.content&&(n=n.find(e.options.content)),e.loadLocal(n)},error:function(){e.$el.removeClass("loading-content"),e.$el.addClass("content-load-error")}})},loadLocal:function(e){var t=this;if(!e&&null===t.options.content)return t.$el.removeClass("loading-content"),t.$el.addClass("content-load-error"),void z.warn("No selector configured");var n=t.$el;if(null!==t.options.target&&0===(n=c()(t.options.target)).length)return t.$el.removeClass("loading-content"),t.$el.addClass("content-load-error"),void z.warn("No target nodes found");e||(e=c()(t.options.content).clone()),e.length?(e.show(),n.replaceWith(e),a.Z.scan(e)):n.empty(),t.$el.removeClass("loading-content"),t.emit("loading-done")}}),i.Z.extend({name:"cookietrigger",trigger:".pat-cookietrigger",parser:"mockup",isCookiesEnabled:function(){var e="areYourCookiesEnabled=0";document.cookie=e;var t=document.cookie;return-1===t.indexOf(e)?0:(e="areYourCookiesEnabled=1",document.cookie=e,-1===(t=document.cookie).indexOf(e)?0:(document.cookie="areYourCookiesEnabled=; expires=Thu, 01-Jan-70 00:00:01 GMT",1))},showIfCookiesDisabled:function(){this.isCookiesEnabled()?r.Z.hide(this.el):r.Z.show(this.el)},init:function(){this.showIfCookiesDisabled()}}),n(62027),i.Z.extend({name:"formautofocus",trigger:".pat-formautofocus",parser:"mockup",defaults:{condition:"div.error",target:"div.error :input:not(.formTabs):visible:first",always:":input:not(.formTabs):visible:first"},init(){0!==c()(this.options.condition,this.$el).length?c()(this.options.target,this.$el).focus():c()(this.options.always,this.$el).focus()}});var L=n(10354),U=(i.Z.extend({name:"formunloadalert",trigger:".pat-formunloadalert",parser:"mockup",_changed:!1,_suppressed:!1,defaults:{message:(0,L.ZP)("Discard changes? If you click OK, any changes you have made will be lost."),changingEvents:"change keyup paste",changingFields:"input,select,textarea,fileupload"},init(){var e=this;if(e.$el.is("form")){c()(e.options.changingFields,e.$el).on(e.options.changingEvents,(()=>{e._changed=!0}));var t=e.$el.parents(".plone-modal");0!==t.length?t.on("hide",(function(n){var a=t.data("patternPloneModal");a&&(a._suppressHide=e._handleUnload.call(e,n))})):c()(window).on("beforeunload",(t=>e._handleUnload(t))),e.$el.on("submit",(()=>{e._suppressed=!0}))}},_handleUnload(e){var t=this;if(t._suppressed)t._suppressed=!1;else if(t._changed){var n=t.options.message;return t._handleMsg(e,n),c()(window).trigger("messageset"),n}},_handleMsg(e,t){(e||window.event).returnValue=t}}),i.Z.extend({name:"livesearch",trigger:".pat-livesearch",parser:"mockup",timeout:null,active:!1,results:null,selectedItem:-1,resultsClass:"livesearch-results list-group d-none",defaults:{ajaxUrl:null,defaultSortOn:"",perPage:7,quietMillis:350,timeoutHide:200,minimumInputLength:4,inputSelector:'input[type="text"]',itemTemplate:'<li class="search-result <%- state %> list-group-item list-group-item-action"><a class="text-reset text-decoration-none" href="<%- url %>"><div class="row"><div class="col info"><div class="heading"><%- title %></div><div class="description"><%- description %></div></div><% if (img_tag) { %> <div class="col img"><%= img_tag %></div><% } %> </div></a></li>'},doSearch:function(e){var t=this;t.active=!0,t.render(),t.$el.addClass("searching");var n=t.$el.serialize();void 0===e&&(e=1);var a=function(){var e=location.search,n=e.indexOf("sort_on");if(-1===n){var a=c()("#search-results");return a.length>0?a.attr("data-default-sort"):t.options.defaultSortOn}var i=e.substring(n);return i=(i=i.split("&")[0]).split("=")[1]}();c().ajax({url:t.options.ajaxUrl+"?"+n+"&page="+e+"&perPage="+t.options.perPage+"&sort_on="+a,dataType:"json"}).done((function(a){t.results=a,t.page=e,n!==t.$el.serialize()&&t.doSearch()})).fail((function(){t.results={items:[{url:"",title:(0,L.ZP)("Error"),description:(0,L.ZP)("There was an error searching"),state:"error",error:!1}],total:1},t.page=1})).always((function(){t.active=!1,t.selectedItem=-1,t.$el.removeClass("searching"),t.render()}))},render:function(){var e=this;if(e.$results.empty(),e.active?e.$results.append(c()('<li class="searching list-group-item">'+(0,L.ZP)("searching")+"</li>")):null===e.results?e.$results.append(c()('<li class="no-results no-search list-group-item">'+(0,L.ZP)("enter search phrase")+"</li>")):0===e.results.total?e.$results.append(c()('<li class="no-results list-group-item">'+(0,L.ZP)("no results found")+"</li>")):e.$results.append(c()('<li class="results-summary list-group-item">'+(0,L.ZP)("found")+" "+e.results.total+" "+(0,L.ZP)("results")+"</li>")),null!==e.results){var t=Z().template(e.options.itemTemplate);Z().each(e.results.items,(function(n,a){var i=c()(t(c().extend({_t:L.ZP},n)));i.attr("data-url",n.url).on("click",(function(){n.error||(window.location=n.url)})),a===e.selectedItem&&i.addClass("active"),e.$results.append(i)}));var n={};if(e.page>1){var a=c()('<a href="#" class="prev position-absolute ps-3 start-0">'+(0,L.ZP)("Previous")+"</a>");a.on("click",(function(t){e.disableHiding=!0,t.preventDefault(),e.doSearch(e.page-1)})),n.prev=a}if(e.page*e.options.perPage<e.results.total){var i=c()('<a href="#" class="next position-absolute pe-3 end-0">'+(0,L.ZP)("Next")+"</a>");i.on("click",(function(t){e.disableHiding=!0,t.preventDefault(),e.doSearch(e.page+1)})),n.next=i}if(n.next||n.prev){var o=c()('<li class="list-group-item load-more d-flex justify-content-center"><span class="page">'+e.page+"</span></li>");n.prev&&o.prepend(n.prev),n.next&&o.append(n.next),e.$results.append(o)}}e.show()},show:function(){this.$results[0].classList.remove("d-none"),this.$el[0].classList.add("livesearch-active")},hide:function(){this.$el[0].classList.remove("livesearch-active"),this.$results[0].classList.add("d-none")},init:function(){var e=this;e.$input=e.$el.find(e.options.inputSelector),e.$input.off("focusout").on("focusout",(function(){setTimeout((function(){e.disableHiding?(e.disableHiding=!1,e.$input.focus()):e.hide()}),e.options.timeoutHide)})).off("focusin").on("focusin",(function(){e.onceFocused?r.Z.is_visible(e.$results[0])||e.render():(e.onceFocused=!0,e.$input.val().length>=e.options.minimumInputLength&&e.doSearch())})).attr("autocomplete","off").off("keyup").on("keyup",(function(t){var n=t.keyCode||t.which;if(27===n)return e.$input.val(""),void e.hide();if(e.results&&e.results.items&&e.results.items.length>0){if(13===n)return void(-1!==e.selectedItem&&(window.location=e.results.items[e.selectedItem].url));if(38===n)return void(-1!==e.selectedItem&&(e.selectedItem-=1,e.render()));if(40===n)return void(e.selectedItem<e.results.items.length&&(e.selectedItem+=1,e.render()))}null!==e.timeout&&(clearTimeout(e.timeout),e.timeout=null),e.active||(e.$input.val().length>=e.options.minimumInputLength?e.timeout=setTimeout((function(){e.doSearch()}),e.options.quietMillis):(e.results=null,e.render()))})),c()("#sorting-options a").on("click",(function(t){t.preventDefault(),e.onceFocused=!1})),e.$results=c()('<ul class="'+e.resultsClass+'"></ul>').insertAfter(e.$el)}}),i.Z.extend({name:"markspeciallinks",trigger:".pat-markspeciallinks",parser:"mockup",defaults:{external_links_open_new_window:!1,mark_special_links:!0},protocol_icon_map:{https:"link-45deg",http:"link-45deg",ftp:"cloud-download",callto:"telephone",bitcoin:"credit-card",geo:"geo-alt",im:"chat",irc:"chat",ircs:"chat",magnet:"link-45deg",mailto:"envelope",mms:"chat",news:"newspaper",nntp:"newspaper",openpgp4fpr:"key",sip:"telephone",sms:"chat",smsto:"chat",ssh:"lock",tel:"telephone",urn:"link-45deg",webcal:"calendar",wtai:"telephone",xmpp:"chat"},async init(){let e=!1;"string"==typeof this.options.external_links_open_new_window?e="true"===this.options.external_links_open_new_window.toLowerCase():"boolean"==typeof this.options.external_links_open_new_window&&(e=this.options.external_links_open_new_window);let t=!1;"string"==typeof this.options.mark_special_links?t="true"===this.options.mark_special_links.toLowerCase():"boolean"==typeof this.options.mark_special_links&&(t=this.options.mark_special_links),t&&n.e(94023).then(n.bind(n,94023));const a=window.location.protocol+"//"+window.location.host,i=this.el.querySelectorAll(`a[href]:not(.link-plain):not([href^="${a}"]):not([href^="#"])`);for(const n of i){let a;try{a=new URL(n.getAttribute("href"))}catch(e){continue}if(e&&a.protocol.startsWith("http")&&(n.setAttribute("target","_blank"),n.setAttribute("rel","noopener")),t){const e=this.protocol_icon_map[a.protocol.split(":")[0]];if(e){const t=await j.Z.resolveIcon(e),a=r.Z.create_from_string(t);a.querySelector("svg").classList.add("markspeciallinks__icon"),n.parentNode.insertBefore(a,n)}}}}}),n(43067));i.Z.extend({name:"navigationmarker",trigger:".pat-navigationmarker",parser:"mockup",init:function(){const e=document.body.dataset.portalUrl;var t=document.querySelector('head link[rel="canonical"]').href||window.location.href;c()("a",this.$el).each((function(){var n=this.href.replace("/view","");if(-1!==t.indexOf(n)){var a=c()(this).parent(),i=a.find("> input");i.length&&(i[0].checked=!0);for(var o=t.split("/"),r=n.split("/"),s=!1,l=0,d=r.length;l<d;l++)s=!1,r[l]===o[l]&&(s=!0);n===e&&t!==e&&(s=!1),s&&a.addClass("inPath"),t===n&&a.addClass("current")}}))}});i.Z.extend({name:"passwordstrength",trigger:".pat-passwordstrength",parser:"mockup",defaults:{zxcvbn:"//cdnjs.cloudflare.com/ajax/libs/zxcvbn/4.4.2/zxcvbn.js"},init:function(){var e,t,n=this.el,a=(e='<div class="progress my-3"><div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0"></div></div>',t=document.createElement("div"),e=e.trim(),t.innerHTML=e,t.firstElementChild),i=a.firstChild,o={0:"bg-transparent",1:"bg-danger",2:"bg-warning",3:"bg-warning",4:"bg-success"};function r(){var e=0;n.value.length>0&&(e=Math.max(1,window.zxcvbn(n.value,[].map.call((n.form||{elements:[]}).elements,(function(e){return e===n?null:e.value||null})).filter((function(e){return e}))).score));var t="";0!=e&&(t=" w-"+25*e),i.className="progress-bar"+t+" "+o[e],i.setAttribute("aria-valuenow",25*e)}n.parentNode.insertBefore(a,n.nextSibling),n.onkeyup=function(){r()},"function"!=typeof window.zxcvbn&&function(e){var t,n,a,i=document.getElementsByTagName("script");for(n=0;n<i.length;n++)if(-1!==i[n].src.indexOf(e))return;(t=document.createElement("script")).type="text/javascript",t.async=!0,t.src=e,(a=document.getElementsByTagName("head")[0]).insertBefore(t,a.firstChild)}(this.options.zxcvbn),r()}}),i.Z.extend({name:"preventdoublesubmit",trigger:".pat-preventdoublesubmit",parser:"mockup",defaults:{message:(0,L.ZP)("You already clicked the submit button. Do you really want to submit this form again?"),guardClassName:"submitting",optOutClassName:"allowMultiSubmit"},init(){var e=this;e.$el.is("form")&&c()(":submit",e.$el).on("click",(function(){if(c()(":submit").removeAttr("clicked"),c()(this).attr("clicked","clicked"),c()(this).hasClass(e.options.guardClassName)&&!c()(this).hasClass(e.options.optOutClassName))return e._confirm.call(e);c()(this).addClass(e.options.guardClassName)}))},_confirm(){return window.confirm(this.options.message)}});const R=f.Z.getLogger("pat-manage-portlets");i.Z.extend({name:"manage-portlets",trigger:".pat-manage-portlets",parser:"mockup",messageTimeout:0,submitTimeout:0,switchTimeout:0,isModal:!1,dirty:!1,init:async function(){(await Promise.resolve().then(n.t.bind(n,50834,23))).default;var e=this,t=e.$el.parents(".plone-modal");if(1===t.length){this.isModal=!0;var a=t.data("pattern-plone-modal");a.on("hide",(function(){e.dirty&&window.location.reload()})),e.loading=a.loading}else e.loading=j.Z.loading;e.bind()},bind:function(){var e=this;e.setupAddDropdown(),e.setupSwitchPortletManager(),e.setupSavePortletsSettings(),e.setupPortletEdit(),e.isModal&&c()(".portlets-link-to-parent").off("click").on("click",(function(t){e.loading.show();var n=c()(this);t.preventDefault(),c().ajax({url:n.attr("href"),data:{ajax_load:1}}).done((function(t){var a=c()(j.Z.parseBodyTag(t)),i=n.parents(".plone-modal-body");i.empty();var o=c()("#content",a),r=c()("h1",o);c()(".plone-modal-header",i.parent()).find("h2").html(r.html()),r.remove(),i.append(o),e.rebind(c()(".pat-manage-portlets",o),!0),e.loading.hide()}))}))},rebind:function(e,t){R.info("rebind"),c().contains(document,this.$el[0])&&this.$el.replaceWith(e),this.$el=e,this.bind(),t||this.statusMessage(),this.dirty=!0},statusMessage:function(e){void 0===e&&(e=(0,L.ZP)("Portlet changes saved"));var t=this,n=c()("#portlet-message");0===n.length&&(n=c()('<div class="alert alert-info" role="alert" id="portlet-message" style="opacity: 0"></div>'),t.isModal?c()(".plone-modal-body:visible").prepend(n):c()("#content-core").prepend(n)),n.html('<strong class="mr-1">'+(0,L.ZP)("Info")+"</strong>"+e),clearTimeout(t.messageTimeout),n.fadeTo(500,1),t.messageTimeout=window.setTimeout((function(){n.fadeTo(500,.6)}),3e3)},showEditPortlet:function(e){R.info("show edit portlet in modal");var t=this,n=c()("<a/>");c()("body").append(n);var a=new U.Z(n,{ajaxUrl:e,actionOptions:{displayInModal:!1,reloadWindowOnClose:!1,isForm:!0,onSuccess:function(e,n){a.hide();var i=c()(j.Z.parseBodyTag(n));t.rebind(c()("#"+t.$el.attr("id"),i).eq(0)),t.statusMessage((0,L.ZP)("Portlet added"))}}});a.on("after-render",(function(){var e=c()("#"+t.$el.attr("id"),a.$raw);1===e.length&&(e=e.clone(),a.on("shown",(function(){a.hide()})),t.rebind(e),t.statusMessage((0,L.ZP)("Portlet added")))})),a.show()},setupPortletEdit:function(){var e=this;c()(".managedPortlet .portletHeader > a",e.$el).on("click",(function(t){t.preventDefault(),e.showEditPortlet(c()(this).attr("href"))}))},setupAddDropdown:function(){var e=this;c()(".add-portlet",e.$el).on("change",(function(t){t.preventDefault();var n=c()(this),a=n.parents("form"),i=n.attr("data-context-url")+n.val()+"?_authenticator="+c()('[name="_authenticator"]').val()+"&referer="+c()('[name="referer"]',a).val();e.showEditPortlet(i)}))},setupSavePortletsSettings:function(){var e=this;c()(".portlets-settings, form.portlet-action",e.$el).ajaxForm({beforeSubmit:function(){e.loading.show()},success:function(t){e.loading.hide(),R.info("form submit");var n=c()(j.Z.parseBodyTag(t));e.rebind(c()("#"+e.$el.attr("id"),n).eq(0))}}),c()(".portlets-settings select",e.$el).on("change",(function(){R.info("select change"),clearTimeout(e.submitTimeout),e.submitTimeout=window.setTimeout((function(){c()(".portlets-settings",e.$el).trigger("submit")}),100)}))},setupSwitchPortletManager:function(){var e=this;c()("#main-container").on("change",".switch-portlet-manager",(function(t){t.stopImmediatePropagation(),R.info("switch portlet manager");var n=c()(this).val();clearTimeout(e.switchTimeout),e.switchTimeout=window.setTimeout((function(){e._reloadPortletManager(n)}),100)})),c()(window).on("popstate",(function(t){if(t.stopImmediatePropagation(),t&&void 0===t.state){var n=window.location.href;R.info("redirecting to: "+n),e._reloadPortletManager(n,!0)}}))},_reloadPortletManager:function(e,t){var n=this;n.loading.show(),c().get(e,{ajax_load:1}).done((function(a){var i=c()(j.Z.parseBodyTag(a));c()("#content").html(i),n.rebind(c()(".pat-manage-portlets",i),!0),t?window.history.replaceState(null,null,e):window.history.pushState(null,null,e),n.loading.hide()}))}}),n(73918);var F=/d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*'/g;function q(e,t){for(e=e.toString(),t=t||2;e.length<t;)e="0"+e;return e}function H(e,t,n){var a=e.getDate(),i=e.getDay(),o=e.getMonth(),r=e.getFullYear(),s={d:a,dd:q(a),ddd:n.localization.shortWeekdays[i],dddd:n.localization.weekdays[i],m:o+1,mm:q(o+1),mmm:n.localization.shortMonths[o],mmmm:n.localization.months[o],yy:String(r).slice(2),yyyy:r};return t.replace(F,(function(e){return Object.prototype.hasOwnProperty.call(s,e)?s[e]:e.slice(1,e.length-1)}))}function W(e,t,n,a,i){var o,r,s,l,d,p,u,h,m,f,g,v=e.find("select[name=rirtemplate]").val(),y=a.rtemplate[v],b="RRULE:"+y.rrule,w=a.localization.rtemplate[v];for(const t of y.fields){const n=e.find(`#${t}`);switch(n.attr("id")){case"ridailyinterval":"1"!==(o=n.find("input[name=ridailyinterval]").val())&&(b+=`;INTERVAL=${o}`),w=`${o} ${a.localization.dailyInterval2}`;break;case"riweeklyinterval":"1"!==(o=n.find("input[name=riweeklyinterval]").val())&&(b+=`;INTERVAL=${o}`),w=`${o} ${a.localization.weeklyInterval2}`;break;case"riweeklyweekdays":p=[],u=[];for(let e=0;e<a.weekdays.length;e++)n.find(`input[name=riweeklyweekdays${e}]`).is(":checked")&&(p.push(a.weekdays[e]),u.push(a.localization.weekdays[e]));p.length>0&&(b+=`;BYDAY=${p.join(",")}`,w+=` ${a.localization.weeklyWeekdaysHuman} ${u.join(",")}`);break;case"rimonthlyinterval":"1"!==(o=n.find("input[name=rimonthlyinterval]").val())&&(b+=`;INTERVAL=${o}`),w=`${o} ${a.localization.monthlyInterval2}`;break;case"rimonthlyoptions":"DAYOFMONTH"===(h=c()("input[name=rimonthlytype]:checked",e).val())?(b+=`;BYMONTHDAY=${d=c()("select[name=rimonthlydayofmonthday]",e).val()}`,w+=`, ${a.localization.monthlyDayOfMonth1Human} ${d} ${a.localization.monthlyDayOfMonth2}`):"WEEKDAYOFMONTH"===h&&(m=c()("select[name=rimonthlyweekdayofmonthindex]",e).val(),d=a.weekdays[c()("select[name=rimonthlyweekdayofmonth]",e).val()],["MO","TU","WE","TH","FR","SA","SU"].includes(d)&&(b+=`;BYDAY=${m}${d}`,w+=`, ${a.localization.monthlyWeekdayOfMonth1Human} `,w+=`${a.localization.orderIndexes[a.orderIndexes.indexOf(m)]} ${a.localization.monthlyWeekdayOfMonth2} `,w+=`${a.localization.weekdays[a.weekdays.indexOf(d)]} ${a.localization.monthlyDayOfMonth2}`));break;case"riyearlyinterval":"1"!==(o=n.find("input[name=riyearlyinterval]").val())&&(b+=`;INTERVAL=${o}`),w=`${o} ${a.localization.yearlyInterval2}`;break;case"riyearlyoptions":r="","DAYOFMONTH"===(f=c()("input[name=riyearlyType]:checked",e).val())?(b+=`;BYMONTH=${r=c()("select[name=riyearlydayofmonthmonth]",e).val()};BYMONTHDAY=${d=c()("select[name=riyearlydayofmonthday]",e).val()}`,w+=`, ${a.localization.yearlyDayOfMonth1Human} ${a.localization.months[r-1]} ${d}`):"WEEKDAYOFMONTH"===f&&(m=c()("select[name=riyearlyweekdayofmonthindex]",e).val(),d=a.weekdays[c()("select[name=riyearlyweekdayofmonthday]",e).val()],b+=`;BYMONTH=${r=c()("select[name=riyearlyweekdayofmonthmonth]",e).val()}`,["MO","TU","WE","TH","FR","SA","SU"].includes(d)&&(b+=`;BYDAY=${m}${d}`,w+=", "+a.localization.yearlyWeekdayOfMonth1Human,w+=" "+a.localization.orderIndexes[c().inArray(m,a.orderIndexes)],w+=" "+a.localization.yearlyWeekdayOfMonth2,w+=" "+a.localization.weekdays[c().inArray(d,a.weekdays)],w+=" "+a.localization.yearlyWeekdayOfMonth3,w+=" "+a.localization.months[r-1],w+=" "+a.localization.yearlyWeekdayOfMonth4));break;case"rirangeoptions":if("BYOCCURRENCES"===(g=e.find("input[name=rirangetype]:checked").val()))b+=`;COUNT=${l=e.find("input[name=rirangebyoccurrencesvalue]").val()}`,w+=`, ${a.localization.rangeByOccurrences1Human} ${l} ${a.localization.rangeByOccurrences2}`;else if("BYENDDATE"===g){let t=e.find("input[name=rirangebyenddatecalendar]").val();if(""===t){const e=new Date;t=`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate()}`}b+=`;UNTIL=${t.replaceAll("-","")}T000000${!0===i?"Z":""}`,w+=`, ${a.localization.rangeByEndDateHuman} `;var _=t.split("-");w+=H(new Date(_[0],_[1]-1,_[2]),a.localization.longDateFormat,a)}}}if(t.length){t.sort();let e=[],n=[];for(let o of t)""!==o&&(o+=10===o.length?"T000000":"",o+=i?"Z":"",e.push(o),s=parseInt(o.substring(0,4),10),r=parseInt(o.substring(5,7),10)-1,d=parseInt(o.substring(8,10),10),n.push(H(new Date(s,r,d),a.localization.longDateFormat,a)));e.length&&(b+=`\nRDATE:${e.join(",")}`,w+=`${a.localization.including} ${n.join("; ")}`)}if(n.length){n.sort();let e=[],t=[];for(let i of n)""!==i&&(e.push(i),s=parseInt(i.substring(0,4),10),r=parseInt(i.substring(4,6),10)-1,d=parseInt(i.substring(6,8),10),t.push(H(new Date(s,r,d),a.localization.longDateFormat,a)));e.length&&(b+=`\nEXDATE:${e.join(",")}`,w+=`${a.localization.except} ${t.join("; ")}`)}return{result:b,description:w}}function B(e){var t={},n=e.indexOf(":"),a=e.substring(0,n);return t.value=e.substring(n+1),-1!==a.indexOf(";")?(n=a.indexOf(";"),t.parameters=a.substring(n+1),t.property=a.substring(0,n)):(t.parameters=null,t.property=a),t}function Y(e){var t=[];for(const n of e.split(","))-1!==n.indexOf("Z")?t.push(n.substring(0,15)):t.push(n);return t}function V(e){var t,n=[],a={RRULE:"",RDATE:[],EXDATE:[]},i=null;for((n=e.split("\n")).reverse();""!==i;){if(n.length>0){if(" "===(t=n.pop()).charAt(0)||"\t"===t.charAt(0)){i+=t;continue}}else t="";null!==i&&("RDATE"===(i=B(i)).property||"EXDATE"===i.property?a[i.property]=Y(i.value):a[i.property]=i.value),i=t}return a}function J(e,t,n,a){var i,o,r,s,l,d,p,u,h,m,f,g,v,y,b,w,_,x,$,k=[];if(void 0===n.RRULE){if(k.push(t.localization.noRule),!a)return-1}else{if(h=(i=/FREQ=([^;]+);?/.exec(n.RRULE))?i[1]:"DAILY",m=(i=/INTERVAL=([0-9]+);?/.exec(n.RRULE))?i[1]:"1",f=(i=/BYDAY=([^;]+);?/.exec(n.RRULE))?i[1]:"",v=(i=/BYMONTHDAY=([^;]+);?/.exec(n.RRULE))?i[1].split(","):null,g=(i=/BYMONTH=([^;]+);?/.exec(n.RRULE))?i[1].split(","):null,y=(i=/COUNT=([0-9]+);?/.exec(n.RRULE))?i[1]:null,b=(i=/UNTIL=([0-9T]+);?/.exec(n.RRULE))?i[1]:null,(i=/BYSETPOS=([^;]+);?/.exec(n.RRULE))&&k.push(t.localization.bysetpos),Object.prototype.hasOwnProperty.call(t.rtemplate,h.toLowerCase()))o=t.rtemplate[h.toLowerCase()];else{for(h of t.rtemplate){o=t.rtemplate[h];break}k.push(t.localization.noTemplateMatch)}e.find("select[name='rirtemplate']").val(h.toLowerCase());for(const n of o.fields)switch((p=e.find(`#${n}`)).attr("id")){case"ridailyinterval":p.find("input[name=ridailyinterval]").val(m);break;case"riweeklyinterval":p.find("input[name=riweeklyinterval]").val(m);break;case"riweeklyweekdays":if(0===f.length)break;for(f=f.split(","),r=0;r<t.weekdays.length;r++)0!==(s=p.find(`input[name="riweeklyweekdays${r}"]`)).length&&(w=t.weekdays[r],s.attr("checked",f.includes(w)));break;case"rimonthlyinterval":p.find("input[name=rimonthlyinterval]").val(m);break;case"rimonthlyoptions":var T="DAYOFMONTH";if(v&&(T="DAYOFMONTH",v.length>1&&(k.push(t.localization.multipleDayOfMonth),v=v[0]),p.find("select[name=rimonthlydayofmonthday]").val(v)),f){T="WEEKDAYOFMONTH",-1!==f.indexOf(",")&&(k.push(t.localization.multipleDayOfMonth),f=f.split(",")[0]),"+"!==(l=f.slice(0,-2)).charAt(0)&&"-"!==l.charAt(0)&&(l="+"+l),$=f.slice(-2),p.find("select[name=rimonthlyweekdayofmonthindex]").val(l);const e=t.weekdays.indexOf($);p.find("select[name=rimonthlyweekdayofmonth]").val(e)}for(d=p.find("input[name=rimonthlytype]"),l=0;l<d.length;l++)u=d[l],c()(u).attr("checked",u.value===T);break;case"riyearlyinterval":p.find("input[name=riyearlyinterval]").val(m);break;case"riyearlyoptions":var O="DAYOFMONTH";if(v&&(O="DAYOFMONTH",v.length>1&&(k.push(t.localization.multipleDayOfMonth),v=v[0]),p.find("select[name=riyearlydayofmonthmonth]").val(g),p.find("select[name=riyearlydayofmonthday]").val(v)),f){O="WEEKDAYOFMONTH",-1!==f.indexOf(",")&&(k.push(t.localization.multipleDayOfMonth),f=f.split(",")[0]),"+"!==(l=f.slice(0,-2)).charAt(0)&&"-"!==l.charAt(0)&&(l="+"+l),$=f.slice(-2),p.find("select[name=riyearlyweekdayofmonthindex]").val(l);const e=t.weekdays.indexOf($);p.find("select[name=riyearlyweekdayofmonthday]").val(e),p.find("select[name=riyearlyweekdayofmonthmonth]").val(g)}for(d=p.find("input[name=riyearlyType]"),l=0;l<d.length;l++)u=d[l],c()(u).attr("checked",u.value===O);break;case"rirangeoptions":var E=t.hasRepeatForeverButton?"NOENDDATE":"BYOCCURRENCES";for(y&&(E="BYOCCURRENCES",p.find("input[name=rirangebyoccurrencesvalue]").val(y)),b&&(E="BYENDDATE",s=p.find("input[name=rirangebyenddatecalendar]"),x=b.slice(0,4),_=b.slice(4,6),w=b.slice(6,8),s.val(`${x}-${_}-${w}`)),d=p.find("input[name=rirangetype]"),l=0;l<d.length;l++)u=d[l],c()(u).attr("checked",u.value===E)}}var A=e.find("#messagearea");return 0!==k.length?(A.text(t.localization.unsupportedFeatures+" "+k.join("; ")),A.show(),1):(A.text(""),A.hide(),0)}const X=function(e,t){var n=this,a=c()(t);t.innerHTML?t.ical=V(t.innerHTML):t.ical={RRULE:"",RDATE:[],EXDATE:[]};var i,o=[],r=(new Date).toISOString().substring(0,10);for(let t=0;t<7;t++)(i=t+e.firstDay)>6&&(i-=7),o.push(i);function s(t){n.$modalForm.find(".rifield").hide();var a=t.val();if(a)for(const t of e.rtemplate[a].fields)n.$modalForm.find(`#${t}`).show()}function l(e){e.preventDefault(),t.ical.EXDATE.push(this.attributes.date.value);var n=c()(this);n.addClass("exdate"),n.parent().parent().addClass("exdate"),n.off("click").on("click",d)}function d(e){e.preventDefault(),t.ical.EXDATE.splice(c().inArray(this.attributes.date.value,t.ical.EXDATE),1);var n=c()(this);n.removeClass("exdate"),n.parent().parent().removeClass("exdate"),n.off("click").on("click",l)}function p(e){e.preventDefault(),t.ical.RDATE.splice(c().inArray(this.attributes.date.value,t.ical.RDATE),1),c()(this).parent().parent().hide("slow",(function(){c()(this).remove()}))}function u(a){a.preventDefault();var i=n.$modalForm.find(".riaddoccurrence input#adddate").val(),o=n.$modalForm.find(".riaddoccurrence div.alert");if(o.text(""),o.hide(),t.ical.RDATE.includes(i))o.text(e.localization.alreadyAdded).show();else{t.ical.RDATE.push(i);var r=i.split("-"),s=c()(`<div class="d-flex justify-content-between occurrence rdate">\n                <span class="rdate">\n                    ${H(new Date(r[0],r[1]-1,r[2]),e.localization.longDateFormat,e)},\n                    <span class="rlabel">${e.localization.additionalDate}</span>\n                </span>\n                <span class="action">\n                    <a date="${i}" href="#" class="btn btn-sm btn-secondary rdate" >\n                        ${e.icons.remove}\n                    </a>\n                </span>\n                </div>`);s.hide(),n.$modalForm.find("div.rioccurrences").prepend(s),s.slideDown(),s.find("a.rdate").on("click",p)}}function h(t,a,i,o){var r,s;r=o?n.display:n.$modalForm,(s=r.find(".rioccurrences")).hide();var u={year:t.getFullYear(),month:t.getMonth()+1,day:t.getDate(),rrule:a,format:e.localization.longDateFormat,start:i};c().ajax({url:e.ajaxURL,async:!1,type:"post",dataType:"json",contentType:e.ajaxContentType,cache:!1,data:u,success:function(n){var i,c,u,m,f;n.readOnly=o,n.localization=e.localization,n.icons=e.icons;for(let t of n.occurrences)c=t.date,u=parseInt(c.substring(0,4),10),m=parseInt(c.substring(4,6),10)-1,f=parseInt(c.substring(6,8),10),t.formattedDate=H(new Date(u,m,f),e.localization.longDateFormat,e);i=Z().template('<div class="rioccurrences">\n    <% occurrences.forEach(function(occurrence) { %>\n        <div class="d-flex justify-content-between occurrence <%= occurrence.type %>">\n            <span>\n                <%= occurrence.formattedDate %>\n                <% if(occurrence.type === "start") { %>\n                    <span class="rlabel"><%= localization.recurrenceStart %></span>\n                <% } %>\n                <% if(occurrence.type === "rdate") { %>\n                    <span class="rlabel"><%= localization.additionalDate %></span>\n                <% } %>\n            </span>\n            <% if(!readOnly) { %>\n                <span class="action">\n                    <% if(occurrence.type === "rrule") { %>\n                        <a date="<%= occurrence.date %>" href="#"\n                           class="btn btn-sm btn-outline-secondary <%= occurrence.type %>" title="<%= localization.exclude %>">\n                            <%= icons.exclude %>\n                        </a>\n                    <% } %>\n                    <% if(occurrence.type === "rdate") { %>\n                        <a date="<%= occurrence.date %>" href="#"\n                           class="btn btn-sm btn-outline-secondary <%= occurrence.type %>" title="<%= localization.remove %>">\n                            <%= icons.remove %>\n                        </a>\n                    <% } %>\n                    <% if(occurrence.type === "exdate") { %>\n                        <a date="<%= occurrence.date %>" href="#"\n                           class="btn btn-sm btn-outline-secondary <%= occurrence.type %>" title="<%= localization.include %>">\n                           <%= icons.include %>\n                        </a>\n                    <% } %>\n                </span>\n            <% } %>\n        </div>\n    <% }) %>\n    <div class="batching">\n        <% for(var index=0; index < batch.batches.length; index++) { %>\n            <span <% if(index === batch.currentBatch) { %>class="current"<% } %>>\n                <a href="#" start="<%= batch.batches[index][0] %>">[<%= batch.batches[index][0] %> - <%= batch.batches[index][1] %>]</a>\n            </span>\n        <% } %>\n    </div>\n</div>\n')(n),s.replaceWith(i),r.find(".rioccurrences .batching a").on("click",(function(e){e.stopPropagation(),e.preventDefault(),h(t,a,this.attributes.start.value,o)})),o||(r.find(".rioccurrences .action a.rrule").on("click",l),r.find(".rioccurrences .action a.exdate").on("click",d),r.find(".rioccurrences .action a.rdate").on("click",p)),s.show()},error:function(e,t){alert(t)}})}function m(e){var t=c()(e);return t.length||(t=c()("#"+e)),t.length||(t=c()("input[name='"+e+"']")),t}function f(){var t,n,a,i,o=null;if(e.startField){if(!(t=m(e.startField)).length)return null;""===(o=t.val())&&(o=t.text()),"string"==typeof o&&(o=o.replace(" ","T")),o=new Date(o)}else if(e.startFieldYear&&e.startFieldMonth&&e.startFieldDay){if(n=m(e.startFieldYear),a=m(e.startFieldMonth),i=m(e.startFieldDay),!n.length&&!a.length&&!i.length)return null;o=new Date(n.val(),a.val()-1,i.val())}return null===o||isNaN(o)?null:o}function g(e){var t,a;return a=(t=n.$modalForm.find("input[name="+e+"]")).val(),isNaN(a)||-1!==a.toString().indexOf(".")||""===t.val()?null:a}function v(i){var o=W(i,t.ical.RDATE,t.ical.EXDATE,e,!1);n.display.find("label[class=ridisplay-label]").text(e.localization.displayActivate+" "+o.description),t.ical=V(o.result),t.innerHTML=o.result,a.trigger("change");var r=f();null!==r&&h(r,o.result,0,!0),n.display.find('a[name="riedit"]').text(e.localization.edit_rules),n.display.find('a[name="ridelete"]').show()}function y(t){var a,i,o,r,s,l;if(a=f(),(r=n.$modalForm.find("#messagearea")).text(""),r.hide(),n.$modalForm.find(".riaddoccurrence div.alert").text("").hide(),"block"===n.$modalForm.find("#ridailyinterval").css("display")&&(!(o=g("ridailyinterval"))||o<1||o>1e3))return r.text(e.localization.noRepeatEvery).show(),!1;if("block"===n.$modalForm.find("#riweeklyinterval").css("display")&&(!(o=g("riweeklyinterval"))||o<1||o>1e3))return r.text(e.localization.noRepeatEvery).show(),!1;if("block"===n.$modalForm.find("#rimonthlyinterval").css("display")){if(!(o=g("rimonthlyinterval"))||o<1||o>1e3)return r.text(e.localization.noRepeatEvery).show(),!1;if(0===n.$modalForm.find("#rimonthlyoptions input:checked").length)return r.text(e.localization.noRepeatOn).show(),!1}if("block"===n.$modalForm.find("#riyearlyinterval").css("display")){if(!(o=g("riyearlyinterval"))||o<1||o>1e3)return r.text(e.localization.noRepeatEvery).show(),!1;if(0===n.$modalForm.find("#riyearlyoptions input:checked").length)return r.text(e.localization.noRepeatOn).show(),!1}if(n.$modalForm.find('input[value="BYOCCURRENCES"]:visible:checked').length>0&&(!(o=g("rirangebyoccurrencesvalue"))||o<1||o>1e3))return r.text(e.localization.noEndAfterNOccurrences).show(),!1;if(n.$modalForm.find('input[value="BYENDDATE"]:visible:checked').length>0){if(l=(s=n.$modalForm.find("input[name=rirangebyenddatecalendar]")).val(),l=new Date(l),!(i=isNaN(l)||""===s.val()?null:l))return r.text(e.localization.noEndDate).show(),!1;if(i<a)return r.text(e.localization.pastEndDate).show(),!1}return!0}function b(e){e.preventDefault(),y(n.$modalForm)&&(n.modal.hide(),v(n.$modalForm),n.$modalForm=null)}function w(e){e.preventDefault(),n.modal.hide(),n.$modalForm=null}function _(){var a;a=f(),y()&&h(a,W(n.$modalForm,t.ical.RDATE,t.ical.EXDATE,e,!1).result,0,!1)}e={...e,orderIndexes:["+1","+2","+3","+4","-1"],weekdays:["SU","MO","TU","WE","TH","FR","SA"],orderedWeekdays:o},n.display=c()(Z().template('<div class="ridisplay">\n    <div class="rimain">\n        <% if(!readOnly) { %>\n            <a class="btn btn-primary" name="riedit" href="#"><%= localization.add_rules %></a>\n            <a class="btn btn-danger" name="ridelete" style="display:none" href="#"><%= localization.delete_rules %></a>\n        <% } %>\n        <label class="ridisplay-label"><%= localization.displayUnactivate %></label>\n    </div>\n<div class="rioccurrences" style="display:none"></div>\n')(e));var x=c()(Z().template('<div class="riform">\n    <form>\n        <h1><%= localization.title %></h1>\n        <div id="messagearea" class="alert alert-danger d-none"> </div>\n        <div id="rirtemplate" class="mb-2 row">\n            <label class="col-4 col-form-label" for="<%= name %>rtemplate" class="label">\n                <%= localization.recurrenceType %>\n            </label>\n            <div class="col-8">\n                <select id="rirtemplate" name="rirtemplate" class="form-select form-select-sm">\n                    <% Object.keys(rtemplate).forEach(function(val, idx) { %>\n                        <option value="<%= val %>"><%= localization.rtemplate[val] %></value>\n                    <% }) %>\n                </select>\n            </div>\n        </div>\n        <div id="riformfields" class="mb-2">\n            <div id="ridailyinterval" class="rifield row">\n                <label class="col-4 col-form-label" for="<%= name %>dailyinterval">\n                    <%= localization.dailyInterval1 %>\n                </label>\n                <div class="col-8">\n                    <input class="form-control form-control-sm w-auto float-start me-3" type="text" size="2"\n                        value="1"\n                        name="ridailyinterval"\n                        id="<%= name %>dailyinterval" />\n                    <%= localization.dailyInterval2 %>\n                </div>\n            </div>\n\n            <div id="riweeklyinterval" class="rifield row">\n                <label class="col-4 col-form-label" for="<%= name %>weeklyinterval">\n                    <%= localization.weeklyInterval1 %>\n                </label>\n                <div class="col-8">\n                    <input class="form-control form-control-sm w-auto float-start me-3" type="text" size="2"\n                        value="1"\n                        name="riweeklyinterval"\n                        id="<%= name %>weeklyinterval"/>\n                    <%= localization.weeklyInterval2 %>\n                </div>\n            </div>\n\n            <div id="riweeklyweekdays" class="rifield row">\n                <label class="col-4 col-form-label" for="<%= name %>weeklyinterval"><%= localization.weeklyWeekdays %></label>\n                <div class="col-8">\n                    <div class="row">\n                    <% orderedWeekdays.forEach(function(idx) { %>\n                        <div class="riweeklyweekday col-auto">\n                            <div class="form-check">\n                                <input class="form-check-input" type="checkbox"\n                                    name="riweeklyweekdays<%=idx %>"\n                                    id="<%= name %>weeklyWeekdays<%=idx %>"\n                                    value="<%=idx %>" />\n                                <label class="form-check-label" for="<%= name %>weeklyWeekdays<%= idx %>"><%= localization.shortWeekdays[idx] %></label>\n                            </div>\n                        </div>\n                    <% }) %>\n                    </div>\n                </div>\n            </div>\n\n            <div id="rimonthlyinterval" class="rifield row">\n                <label class="col-4 col-form-label" for="rimonthlyinterval"><%= localization.monthlyInterval1 %></label>\n                <div class="col-8">\n                    <input class="form-control form-control-sm w-auto float-start me-3" type="text" size="2"\n                        value="1"\n                        name="rimonthlyinterval"/>\n                    <%= localization.monthlyInterval2 %>\n                </div>\n            </div>\n\n            <div id="rimonthlyoptions" class="rifield row">\n                <label class="col-4 col-form-label" for="rimonthlytype"><%= localization.monthlyRepeatOn %></label>\n                <div class="col-8">\n                    <div class="row">\n                        <div class="col-auto">\n                            <div class="form-check">\n                                <input\n                                    class="form-check-input"\n                                    type="radio"\n                                    value="DAYOFMONTH"\n                                    name="rimonthlytype"\n                                    id="<%= name %>monthlytype:DAYOFMONTH" />\n                                <label class="form-check-label" for="<%= name %>monthlytype:DAYOFMONTH">\n                                    <%= localization.monthlyDayOfMonth1 %>\n                                </label>\n                            </div>\n                        </div>\n                        <div class="col-auto">\n                            <select class="form-select form-select-sm w-auto" name="rimonthlydayofmonthday" id="<%= name %>monthlydayofmonthday">\n                                <% [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31].forEach(function(val, idx) { %>\n                                    <option value="<%= val %>"><%= val %></option>\n                                <% }) %>\n                            </select>\n                        </div>\n                        <div class="col-auto">\n                            <%= localization.monthlyDayOfMonth2 %>\n                        </div>\n                    </div>\n                    <div class="row">\n                        <div class="col-auto">\n                            <div class="form-check">\n                                <input\n                                    class="form-check-input"\n                                    type="radio"\n                                    value="WEEKDAYOFMONTH"\n                                    name="rimonthlytype"\n                                    id="<%= name %>monthlytype:WEEKDAYOFMONTH" />\n                                <label class="form-check-label" for="<%= name %>monthlytype:WEEKDAYOFMONTH">\n                                    <%= localization.monthlyWeekdayOfMonth1 %>\n                                </label>\n                            </div>\n                        </div>\n                        <div class="col-auto">\n                            <select class="form-select form-select-sm w-auto float-start me-2" name="rimonthlyweekdayofmonthindex">\n                                <% orderIndexes.forEach(function(val, idx) { %>\n                                    <option value="<%= val %>"><%= localization.orderIndexes[idx] %></option>\n                                <% }) %>\n                            </select>\n                            <%= localization.monthlyWeekdayOfMonth2 %>\n                        </div>\n                        <div class="col-auto">\n                            <select class="form-select form-select-sm w-auto float-start me-2" name="rimonthlyweekdayofmonth">\n                                <% orderedWeekdays.forEach(function(idx) { %>\n                                    <option value="<%= idx %>"><%= localization.weekdays[idx] %></option>\n                                <% }) %>\n                            </select>\n                            <%= localization.monthlyWeekdayOfMonth3 %>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <div id="riyearlyinterval" class="rifield row">\n                <label class="col-4 col-form-label" for="riyearlyinterval"><%= localization.yearlyInterval1 %></label>\n                <div class="col-8">\n                    <input class="form-control form-control-sm w-auto float-start me-3" type="text" size="2"\n                        value="1"\n                        name="riyearlyinterval"/>\n                    <%= localization.yearlyInterval2 %>\n                </div>\n            </div>\n\n            <div id="riyearlyoptions" class="rifield row">\n                <label class="col-4 col-form-label" for="riyearlyType"><%= localization.yearlyRepeatOn %></label>\n                <div class="col-8">\n                    <div class="row">\n                        <div class="col-auto">\n                            <div class="form-check">\n                                <input\n                                    class="form-check-input"\n                                    type="radio"\n                                    value="DAYOFMONTH"\n                                    name="riyearlyType"\n                                    id="<%= name %>yearlytype:DAYOFMONTH" />\n                                <label class="form-check-label" for="<%= name %>yearlytype:DAYOFMONTH">\n                                    <%= localization.yearlyDayOfMonth1 %>\n                                </label>\n                            </div>\n                        </div>\n                        <div class="col-auto">\n                            <select class="form-select form-select-sm w-auto float-start me-2" name="riyearlydayofmonthmonth">\n                            <% localization.months.forEach(function(val, idx) { %>\n                                <option value="<%= idx + 1 %>"><%= val %></option>\n                            <% }) %>\n                            </select>\n                            <%= localization.yearlyDayOfMonth2 %>\n                        </div>\n                        <div class="col-auto">\n                            <select class="form-select form-select-sm w-auto float-start me-2" name="riyearlydayofmonthday">\n                                <% [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31].forEach(function(val, idx) { %>\n                                    <option value="<%= val %>"><%= val %></option>\n                                <% }) %>\n                            </select>\n                            <%= localization.yearlyDayOfMonth3 %>\n                        </div>\n                    </div>\n\n                    <div class="row">\n                        <div class="col-auto">\n                            <div class="form-check">\n                                <input\n                                    class="form-check-input"\n                                    type="radio"\n                                    value="WEEKDAYOFMONTH"\n                                    name="riyearlyType"\n                                    id="<%= name %>yearlytype:WEEKDAYOFMONTH"/>\n                                <label class="form-check-label" for="<%= name %>yearlytype:WEEKDAYOFMONTH">\n                                    <%= localization.yearlyWeekdayOfMonth1 %>\n                                </label>\n                            </div>\n                        </div>\n                        <div class="col-auto">\n                            <select class="form-select form-select-sm w-auto float-start me-2" name="riyearlyweekdayofmonthindex">\n                                <% orderIndexes.forEach(function(val, idx) { %>\n                                    <option value="<%= val %>"><%= localization.orderIndexes[idx] %></option>\n                                <% }) %>\n                            </select>\n                            <%= localization.yearlyWeekdayOfMonth2 %>\n                        </div>\n                        <div class="col-auto">\n                            <select class="form-select form-select-sm w-auto float-start me-2" name="riyearlyweekdayofmonthday">\n                                <% orderedWeekdays.forEach(function(val, idx) { %>\n                                    <option value="<%= val %>"><%= localization.weekdays[idx] %></option>\n                                <% }) %>\n                            </select>\n                            <%= localization.yearlyWeekdayOfMonth3 %>\n                        </div>\n                        <div class="col-auto">\n                            <select class="form-select form-select-sm w-auto float-start me-2" name="riyearlyweekdayofmonthmonth">\n                                <% localization.months.forEach(function(val, idx) { %>\n                                    <option value="<%= idx + 1 %>"><%= val %></option>\n                                <% }) %>\n                            </select>\n                            <%= localization.yearlyWeekdayOfMonth4 %>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <div id="rirangeoptions" class="rifield row">\n                <label class="col-4 col-form-label"><%= localization.range %></label>\n                <div class="col-8 pt-2">\n                    <% if(hasRepeatForeverButton) { %>\n                    <div class="form-check">\n                        <input\n                            class="form-check-input"\n                            type="radio"\n                            value="NOENDDATE"\n                            name="rirangetype"\n                            id="<%= name %>rangetype:NOENDDATE"/>\n                        <label class="form-check-label" for="<%= name %>rangetype:NOENDDATE">\n                            <%= localization.rangeNoEnd %>\n                        </label>\n                    </div>\n                    <% } %>\n                    <div class="row mt-2">\n                        <div class="col-auto">\n                            <div class="form-check">\n                                <input\n                                    class="form-check-input"\n                                    type="radio"\n                                    checked="checked"\n                                    value="BYOCCURRENCES"\n                                    name="rirangetype"\n                                    id="<%= name %>rangetype:BYOCCURRENCES"/>\n                                <label class="form-check-label" for="<%= name %>rangetype:BYOCCURRENCES">\n                                    <%= localization.rangeByOccurrences1 %>\n                                </label>\n                            </div>\n                        </div>\n                        <div class="col-auto">\n                            <input\n                                class="form-control form-control-sm w-auto float-start me-3" type="text" size="3"\n                                value="7"\n                                name="rirangebyoccurrencesvalue" />\n                            <%= localization.rangeByOccurrences2 %>\n                        </div>\n                    </div>\n                    <div class="row mt-2">\n                        <div class="col-auto">\n                            <div class="form-check">\n                                <input\n                                    class="form-check-input"\n                                    type="radio"\n                                    value="BYENDDATE"\n                                    name="rirangetype"\n                                    id="<%= name %>rangetype:BYENDDATE"/>\n                                <label class="form-check-label" for="<%= name %>rangetype:BYENDDATE">\n                                    <%= localization.rangeByEndDate %>\n                                </label>\n                            </div>\n                        </div>\n                        <div class="col-auto">\n                            <input\n                                class="form-control form-control-sm w-auto" type="date"\n                                name="rirangebyenddatecalendar" />\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <div class="rioccurrencesactions">\n            <div class="rioccurancesheader d-flex justify-content-between">\n                <h6><strong><%= localization.preview %></strong></h6>\n            </div>\n        </div>\n\n        <div class="rioccurrences"></div>\n\n        <div class="rioccurrencesactions">\n            <h6><strong><%= localization.addDate %></strong></h6>\n            <div class="riaddoccurrence ">\n                <div class="alert alert-danger d-none"></div>\n                <div class="input-group">\n                    <input class="form-control form-control-sm w-auto" type="date" name="adddate" id="adddate" />\n                    <input class="btn btn-sm btn-success" type="button" name="addaction" id="addaction" value="<%= localization.add %>">\n                </div>\n            </div>\n        </div>\n\n        <div class="ributtons">\n            <button\n                type="submit"\n                class="btn btn-secondary me-2 ricancelbutton <%= ributtonExtraClass %>"><%= localization.cancel %></button>\n            <button\n                type="submit"\n                class="btn btn-primary risavebutton <%= ributtonExtraClass %>"><%= localization.save %></button>\n        </div>\n    </form>\n</div>\n')(e));(x.appendTo("body"),x.hide(),n.modal=new U.Z(x,{content:"div.riform",buttons:".ributtons > button",modalSizeClass:"modal-lg",backdropOptions:{opacity:"0.5"}}),t.innerHTML)&&(-1===J(x,e,t.ical,!1)?n.display.find("label[class=ridisplay-label]").text(e.localization.noRule):v(x));n.display.find('a[name="ridelete"]').on("click",(function(i){i.preventDefault(),n.display.find("label[class=ridisplay-label]").text(e.localization.displayUnactivate),t.ical={RRULE:"",RDATE:[],EXDATE:[]},t.innerHTML="",a.trigger("change"),n.display.find(".rioccurrences").hide(),n.display.find('a[name="riedit"]').text(e.localization.add_rules),n.display.find('a[name="ridelete"]').hide()})),n.display.find('a[name="riedit"]').on("click",(function(a){a.preventDefault(),n.modal.show(),n.$modalForm=c()("form",n.modal.$modalContent),function(n){J(n,e,t.ical,!0);const a=f();if(null!==a){document.querySelector("select[name=rimonthlydayofmonthday]").value=a.getDate();const i=e.orderIndexes[Math.floor((a.getDate()-1)/7)],o=e.weekdays[a.getDay()];document.querySelector("select[name=rimonthlyweekdayofmonthindex]").value=i,document.querySelector("select[name=rimonthlyweekdayofmonth]").value=o,document.querySelector("select[name=riyearlydayofmonthmonth]").value=a.getMonth()+1,document.querySelector("select[name=riyearlydayofmonthday]").value=a.getDate(),document.querySelector("select[name=riyearlyweekdayofmonthindex]").value=i,document.querySelector("select[name=riyearlyweekdayofmonthday]").value=o,document.querySelector("select[name=riyearlyweekdayofmonthmonth]").value=a.getMonth()+1,h(a,t.innerHTML||W(n,t.ical.RDATE,t.ical.EXDATE,e,!1).result,0,!1),document.querySelector("div.rioccurrencesactions").style.display="block"}else document.querySelector("div.rioccurrencesactions").style.display="none";s(n.find("select[name=rirtemplate]"))}(n.$modalForm),function(){var e=n.$modalForm.find("input[name=rirangebyenddatecalendar]");if(!e.val()){var t=f();t.setDate(t.getDate()+1),e.val(t.toISOString().substring(0,10))}n.$modalForm.find("input#addaction").on("click",u),n.$modalForm.find('select[name="rirtemplate"]').on("change",(function(){s(c()(this)),_()})),n.$modalForm.find("\n                input:radio,\n                input:checkbox,\n                .riweeklyweekday > input,\n                input[name=ridailyinterval],\n                input[name=riweeklyinterval],\n                input[name=rimonthlyinterval],\n                input[name=riyearlyinterval],\n                input[name=rirangebyoccurrencesvalue],\n                input[name=rirangebyenddatecalendar],\n                #rimonthlyoptions select,\n                #riyearlyoptions select,\n                #riyearlyinterval select").on("change",(function(){0!==n.$modalForm.find(".rioccurrencesactions:visible").length&&_()})),n.$modalForm.find("div.riaddoccurrence input#adddate").val(r),n.$modalForm.find(".ricancelbutton").on("click",w),n.$modalForm.find(".risavebutton").on("click",b)}()}))};i.Z.extend({name:"recurrence",trigger:".pat-recurrence",parser:"mockup",defaults:{localization:{displayUnactivate:"Does not repeat",displayActivate:"Repeats every",add_rules:"Add",edit_rules:"Edit",delete_rules:"Delete",add:"Add",refresh:"Refresh",title:"Repeat",preview:"Selected dates",addDate:"Add date",recurrenceType:"Repeats:",dailyInterval1:"Repeat every:",dailyInterval2:"days",weeklyInterval1:"Repeat every:",weeklyInterval2:"week(s)",weeklyWeekdays:"Repeat on:",weeklyWeekdaysHuman:"on:",monthlyInterval1:"Repeat every:",monthlyInterval2:"month(s)",monthlyDayOfMonth1:"Day",monthlyDayOfMonth1Human:"on day",monthlyDayOfMonth2:"of the month",monthlyDayOfMonth3:"month(s)",monthlyWeekdayOfMonth1:"The",monthlyWeekdayOfMonth1Human:"on the",monthlyWeekdayOfMonth2:"",monthlyWeekdayOfMonth3:"of the month",monthlyRepeatOn:"Repeat on:",yearlyInterval1:"Repeat every:",yearlyInterval2:"year(s)",yearlyDayOfMonth1:"Every",yearlyDayOfMonth1Human:"on",yearlyDayOfMonth2:"",yearlyDayOfMonth3:"",yearlyWeekdayOfMonth1:"The",yearlyWeekdayOfMonth1Human:"on the",yearlyWeekdayOfMonth2:"",yearlyWeekdayOfMonth3:"of",yearlyWeekdayOfMonth4:"",yearlyRepeatOn:"Repeat on:",range:"End recurrence:",rangeNoEnd:"Never",rangeByOccurrences1:"After",rangeByOccurrences1Human:"ends after",rangeByOccurrences2:"occurrence(s)",rangeByEndDate:"On",rangeByEndDateHuman:"ends on",including:", and also",except:", except for",cancel:"Cancel",save:"Save",recurrenceStart:"Start of the recurrence",additionalDate:"Additional date",include:"Include",exclude:"Exclude",remove:"Remove",orderIndexes:["first","second","third","fourth","last"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortWeekdays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longDateFormat:"mmmm dd, yyyy",shortDateFormat:"mm/dd/yyyy",unsupportedFeatures:"Warning: This event uses recurrence features not supported by this widget. Saving the recurrence may change the recurrence in unintended ways:",noTemplateMatch:"No matching recurrence template",multipleDayOfMonth:"This widget does not support multiple days in monthly or yearly recurrence",bysetpos:"BYSETPOS is not supported",noRule:"No RRULE in RRULE data",noRepeatEvery:'Error: The "Repeat every"-field must be between 1 and 1000',noEndDate:"Error: End date is not set. Please set a correct value",noRepeatOn:'Error: "Repeat on"-value must be selected',pastEndDate:"Error: End date cannot be before start date",noEndAfterNOccurrences:'Error: The "After N occurrences"-field must be between 1 and 1000',alreadyAdded:"This date was already added",rtemplate:{daily:"Daily",mondayfriday:"Monday and Friday",weekdays:"Weekday",weekly:"Weekly",monthly:"Monthly",yearly:"Yearly"}},readOnly:!1,firstDay:0,startField:null,startFieldYear:null,startFieldMonth:null,startFieldDay:null,ajaxURL:null,ajaxContentType:"application/json; charset=utf8",ributtonExtraClass:"",hasRepeatForeverButton:!0,template:{form:"#jquery-recurrenceinput-form-tmpl",display:"#jquery-recurrenceinput-display-tmpl"},rtemplate:{daily:{rrule:"FREQ=DAILY",fields:["ridailyinterval","rirangeoptions"]},mondayfriday:{rrule:"FREQ=WEEKLY;BYDAY=MO,FR",fields:["rirangeoptions"]},weekdays:{rrule:"FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR",fields:["rirangeoptions"]},weekly:{rrule:"FREQ=WEEKLY",fields:["riweeklyinterval","riweeklyweekdays","rirangeoptions"]},monthly:{rrule:"FREQ=MONTHLY",fields:["rimonthlyinterval","rimonthlyoptions","rirangeoptions"]},yearly:{rrule:"FREQ=YEARLY",fields:["riyearlyinterval","riyearlyoptions","rirangeoptions"]}}},load_icons:async function(){return{reload:await j.Z.resolveIcon("arrow-clockwise"),remove:await j.Z.resolveIcon("trash"),exclude:await j.Z.resolveIcon("calendar-x"),include:await j.Z.resolveIcon("plus-circle")}},init:async function(){n.e(46823).then(n.bind(n,46823)),this.el.classList.add("recurrence-widget");var e=await this.load_icons(),t={...this.options,...this.options.configuration,icons:e},a=new X(t,this.el);this.$el.after(a.display),this.el.style.display="none"}}),n(15260),i.Z.extend({name:"search",trigger:".pat-search",init:function(){var e=new j.Z.Loading,t=c()("#search-filter"),n=c()("#search-filter-toggle",t),a=c()("#advanced-search-input"),i=c()("#pt_toggle"),o=c()(".search-type-options"),r=c()("#sorting-options");window.history&&window.history.pushState&&c()(window).on("popstate",(function(){window.location=window.location.href}));var s=0,l=function(){e.show(),function(){if(window.history&&window.history.pushState){var e=window.location.origin+window.location.pathname+"?"+c()("#searchform").serialize();window.history.pushState(null,null,e)}}(),c().ajax({url:window.location.origin+window.location.pathname+"?ajax_load=1",data:c()("#searchform").serialize()}).done((function(t){var n=c()(t);c()("#search-results").replaceWith(c()("#search-results",n)),c()("#search-term").replaceWith(c()("#search-term",n)),c()("#results-count").replaceWith(c()("#results-count",n)),e.hide()}))},d=function(e){c()("#search-batch-start").attr("value",e)},p=function(e){c()("a",r).removeClass("active"),e.addClass("active")},u=c()("#search-results").attr("data-default-sort");p(c()("a[data-sort="+u+"]")),c()("a",r).on("click",(function(e){e.preventDefault(),p(c()(this));var t=c()(this).attr("data-sort"),n=c()(this).attr("data-order");t?(c()('[name="sort_on"]').attr("value",t),n&&"reverse"==n?c()('[name="sort_order"]').attr("value","reverse"):c()('[name="sort_order"]').attr("value","")):(c()('[name="sort_on"]').attr("value",""),c()('[name="sort_order"]').attr("value","")),l()})),c()(".searchPage").on("submit",(function(e){e.preventDefault(),d("0"),l()})),n.on("click",(function(e){e.preventDefault(),t.toggleClass("activated"),t.hasClass("activated")?a.attr("value","True"):a.attr("value","False")})),i.on("change",(function(){i[0].checked?c()("input",o).each((function(){this.checked=!0})):c()("input",o).each((function(){this.checked=!1}))})),c()("input",t).on("change",(function(){d("0"),clearTimeout(s),s=setTimeout(l,200)})),c()("#searchform").on("click",".pagination a",(function(e){var t=new URLSearchParams(c()(e.currentTarget).attr("href")).get("b_start:int");t&&(e.preventDefault(),d(t),l())}))}}),n(74090),n(71015),i.Z.extend({name:"structure",trigger:".pat-structure",parser:"mockup",defaults:{urlStructure:null,vocabularyUrl:null,indexOptionsUrl:null,contextInfoUrl:null,setDefaultPageUrl:null,menuOptions:null,backdropSelector:".plone-modal",activeColumnsCookie:"activeColumns",attributes:["CreationDate","EffectiveDate","ExpirationDate","exclude_from_nav","getIcon","getMimeIcon","getObjSize","getURL","id","is_folderish","last_comment_date","ModificationDate","path","portal_type","review_state","Subject","Title","total_comments","UID"],activeColumns:["ModificationDate","EffectiveDate","review_state"],availableColumns:{id:"ID",ModificationDate:"Last modified",EffectiveDate:"Published",ExpirationDate:"Expiration",CreationDate:"Created",review_state:"Review state",Subject:"Tags",portal_type:"Type",is_folderish:"Folder",exclude_from_nav:"Excluded from navigation",getObjSize:"Object Size",last_comment_date:"Last comment date",total_comments:"Total comments"},typeToViewAction:{File:"/view",Image:"/view",Blob:"/view"},defaultPageTypes:["Document","Event","News Item","Collection"],language:"en",dateFormat:{dateStyle:"medium",timeStyle:"medium"},rearrange:{properties:{id:"ID",sortable_title:"Title"},url:"/rearrange"},moveUrl:null,buttons:[{tooltip:"Cut",url:"/cut",icon:"plone-cut"},{tooltip:"Copy",url:"/copy",icon:"plone-copy"},{tooltip:"Paste",url:"/paste",icon:"plone-paste"},{tooltip:"Delete",url:"/delete",context:"danger",icon:"plone-delete"},{tooltip:"Workflow",url:"/workflow",icon:"plone-lock"},{tooltip:"Tags",url:"/tags",icon:"tags"},{tooltip:"Properties",url:"/properties",icon:"plone-edit"},{tooltip:"Rename",url:"/rename",icon:"plone-rename"}],datatables_options:{},upload:{uploadMultiple:!0,showTitle:!0}},async init(){n.e(24772).then(n.bind(n,24772)),(await n.e(50722).then(n.t.bind(n,50722,23))).Dropdown;const e=(await Promise.resolve().then(n.t.bind(n,24481,23))).default,t=(await n.e(5749).then(n.t.bind(n,5749,23))).default;window._=e,window.Backbone=t;const a=(await Promise.all([n.e(96633),n.e(5749),n.e(88816)]).then(n.bind(n,96633))).default;this.browsing=!0,this.options.collectionUrl=this.options.vocabularyUrl,this.options.pattern=this,this.options.language=document.querySelector("html").getAttribute("lang")||"en",this.options.queryHelperAttributes=this.options.attributes,delete this.options.attributes;const i=new a(this.options);await i.render(),this.$el.append(i.$el)}});var G=n(25219);i.Z.extend({name:"tinymce",trigger:".pat-tinymce",parser:"mockup",defaults:{upload:{uploadMultiple:!1,maxFiles:1,showTitle:!1},relatedItems:{attributes:["UID","Title","portal_type","path","getURL","getIcon","is_folderish","review_state"],batchSize:20,basePath:"/",vocabularyUrl:null,width:500,maximumSelectionSize:1,placeholder:(0,L.ZP)("Search for item on site...")},text:{insertBtn:(0,L.ZP)("Insert"),cancelBtn:(0,L.ZP)("Cancel"),insertHeading:(0,L.ZP)("Insert link"),title:(0,L.ZP)("Title"),internal:(0,L.ZP)("Internal"),external:(0,L.ZP)("External"),externalText:(0,L.ZP)("External URL (can be relative within this site or absolute if it starts with http:// or https://)"),email:(0,L.ZP)("Email Address"),anchor:(0,L.ZP)("Anchor"),anchorLabel:(0,L.ZP)("Select an anchor"),target:(0,L.ZP)("Target"),subject:(0,L.ZP)("Email Subject (optional)"),image:(0,L.ZP)("Image"),imageAlign:(0,L.ZP)("Align"),enableImageZoom:(0,L.ZP)("Enable image zoom"),scale:(0,L.ZP)("Size"),alt:(0,L.ZP)("Alternative Text"),insertImageHelp:(0,L.ZP)("Specify an image. It can be on this site already (Internal Image), an image you upload (Upload), or from an external site (External Image)."),internalImage:(0,L.ZP)("Internal Image"),externalImage:(0,L.ZP)("External Image"),externalImageText:(0,L.ZP)("External Image URL (can be relative within this site or absolute if it starts with http:// or https://)"),upload:(0,L.ZP)("Upload"),insertLinkHelp:(0,L.ZP)("Specify the object to link to. It can be on this site already (Internal), an object you upload (Upload), from an external site (External), an email address (Email), or an anchor on this page (Anchor)."),captionFromDescription:(0,L.ZP)("Show Image Caption from Image Description"),caption:(0,L.ZP)("Image Caption")},loadingBaseUrl:"++plone++static/tinybase",prependToUrl:"",appendToUrl:"",linkAttribute:"path",prependToScalePart:"/imagescale/",appendToScalePart:"",appendToOriginalScalePart:"",defaultSrcset:"medium",imageCaptioningEnabled:!0,imageClasses:{"image-inline":(0,L.ZP)("Inline"),"image-right":(0,L.ZP)("Right"),"image-left":(0,L.ZP)("Left")},targetList:[{text:(0,L.ZP)("Open in this window / frame"),value:""},{text:(0,L.ZP)("Open in new window"),value:"_blank"},{text:(0,L.ZP)("Open in parent window / frame"),value:"_parent"},{text:(0,L.ZP)("Open in top frame (replaces all frames)"),value:"_top"}],imageTypes:["Image"],folderTypes:["Folder","Plone Site"],tiny:{theme:"silver",plugins:["advlist","autolink","lists","charmap","print","preview","anchor","searchreplace","visualblocks","code","fullscreen","insertdatetime","media","table","contextmenu","paste","plonelink","ploneimage"],menubar:"edit table format tools view insert",toolbar:"undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | unlink plonelink ploneimage",height:400,language:"en"},inline:!1},init:async function(){const e=(await n.e(96870).then(n.bind(n,96870))).default;var t=(new G.Z).currentLanguage;this.options.tiny.language=t,this.instance=new e(this.el,this.options),await this.instance.init()},destroy:function(){this.instance.destroy()}}),i.Z.extend({name:"textareamimetypeselector",trigger:".pat-textareamimetypeselector",parser:"mockup",current_widgets:[],defaults:{textareaName:"",widgets:{"text/html":{pattern:"tinymce",patternOptions:{}}}},async init(){this.el.addEventListener("input",(async e=>await this.init_textareas(e.target.value))),await this.init_textareas(this.el.value)},async init_textareas(e){const t=this.options.widgets[e],n=document.querySelectorAll(`textarea[name="${this.options.textareaName}"]`);this.current_widgets.forEach((e=>{e.destroy()})),this.current_widgets=[],t&&n.length&&n.forEach((async e=>{this.current_widgets.push(await new a.Z.patterns[t.pattern](e,t.patternOptions||{}))}))}});const K=f.Z.getLogger("pat-toggle");i.Z.extend({name:"toggle",trigger:".pat-toggle",parser:"mockup",defaults:{attribute:"class",event:"click",targetScope:"global"},init:function(){var e=this;e.options.target?"global"===e.options.targetScope?e.$target=c()(e.options.target):e.$target=e.$el.parents(e.options.targetScope).first().find(e.options.target):e.$target=e.$el,e.$target&&0!==e.$target.length||K.error(`No target found for "${e.options.target}".`),e.on(e.options.event,(function(t){t.stopPropagation(),t.preventDefault(),e.toggle()}))},isMarked:function(){for(var e=!1,t=0;t<this.$target.length;t+=1)if("class"===this.options.attribute){if(!this.$target.eq(t).hasClass(this.options.value)){e=!1;break}e=!0}else{if(this.$target.eq(t).attr(this.options.attribute)!==this.options.value){e=!1;break}e=!0}return e},toggle:function(){var e=this;e.isMarked()?e.remove():e.add()},remove:function(){var e=this;e.emit("remove-attr"),"class"===e.options.attribute?e.$target.removeClass(e.options.value):e.$target.removeAttr(e.options.attribute),e.emit("attr-removed")},add:function(){var e=this;e.emit("add-attr"),"class"===e.options.attribute?e.$target.addClass(e.options.value):e.$target.attr(e.options.attribute,e.options.value),e.emit("added-attr")}});var Q=n(54232),ee=n.n(Q);i.Z.extend({name:"toolbar",trigger:".pat-toolbar",parser:"mockup",defaults:{},init:function(){c()("body").on("structure-url-changed",((e,t)=>{c().ajax({url:c()("body").attr("data-portal-url")+t+"/@@render-toolbar"}).done((e=>{const t=c()(j.Z.parseBodyTag(e)),n=t.find("#edit-zone .plone-toolbar-main"),i=t.find("#edit-zone #collapse-personaltools");a.Z.scan(n),c()(".plone-toolbar-main",this.$el).replaceWith(n),c()("#collapse-personaltools",this.$el).replaceWith(i)}))})),this.$el.on("click",".toolbar-collapse",(()=>{c()("body").removeClass("plone-toolbar-left-expanded"),ee().set("plone-toolbar",JSON.stringify({expanded:!1}),{path:"/"})})),this.$el.on("click",".toolbar-expand",(()=>{c()("body").addClass("plone-toolbar-left-expanded"),ee().set("plone-toolbar",JSON.stringify({expanded:!0}),{path:"/"})})),this.el.classList.add("initialized")}}),i.Z.extend({name:"tree",trigger:".pat-tree",parser:"mockup",defaults:{dragAndDrop:!1,autoOpen:!1,selectable:!0,keyboardSupport:!0,onLoad:null},async init(){n.e(24708).then(n.bind(n,24708)),n.e(18683).then(n.bind(n,18683)),await n.e(98242).then(n.t.bind(n,98242,23));var e=this;for(var t in e.options){var a=e.defaults[t];void 0!==a&&"boolean"==typeof a&&(e.options[t]=j.Z.bool(e.options[t]))}if(void 0===e.options.onCanMoveTo&&(e.options.onCanMoveTo=function(e,t,n){return"inside"!==n||(void 0===t.folder||!0===t.folder)}),e.options.data&&"string"==typeof e.options.data&&(e.options.data=c().parseJSON(e.options.data)),null!==e.options.onLoad){var i=c().extend({},e.options);c().getJSON(i.dataUrl,(function(t){i.data=t,delete i.dataUrl,e.tree=e.$el.tree(i),e.options.onLoad(e)})).fail((function(e){console.log("failed to load json data")}))}else e.tree=e.$el.tree(e.options)}}),n(37103),i.Z.extend({name:"dexterity-types-listing",trigger:"form[action$='dexterity-types']",async init(){new(0,(await n.e(33521).then(n.bind(n,33521))).default)(this.el).init()}}),i.Z.extend({name:"registry",trigger:".pat-registry",parser:"mockup",init:async function(){new(0,(await n.e(20971).then(n.bind(n,20971))).default)(this.el).init()}}),i.Z.extend({name:"schemaeditor",trigger:".pat-schemaeditor",parser:"mockup",init:async function(){new(0,(await n.e(45196).then(n.bind(n,45196))).default)(this.el).init()}}),i.Z.extend({name:"contentrules",trigger:"form[name='ruleSettings']",async init(){new(0,(await n.e(76533).then(n.bind(n,76533))).default)(this.el).init()}}),i.Z.extend({name:"contentrules-elements",trigger:"pat-contentrules-elements",async init(){new(0,(await n.e(39113).then(n.bind(n,39113))).default)(this.el).init()}}),i.Z.extend({name:"discussion",trigger:"form#DiscussionSettingsEditForm",async init(){new(0,(await n.e(54523).then(n.bind(n,54523))).default)(this.el).init()}}),i.Z.extend({name:"discussion-comments",trigger:".pat-discussion",async init(){new(0,(await n.e(25031).then(n.bind(n,25031))).default)(this.el).init()}}),i.Z.extend({name:"discussion-moderation",trigger:"#fieldset-moderate-comments",async init(){new(0,(await n.e(16105).then(n.bind(n,16105))).default)(this.el).init()}});_.E2.parameters.trigger.value="hover",w.prototype.error_template=e=>`<em class="invalid-feedback">${e}</em>`,window.__patternslib_import_styles=!0,a.Z.init()}}]);
//# sourceMappingURL=17704.7da813d9a45bc17c0687.min.js.map