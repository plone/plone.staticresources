"use strict";(self.webpackChunkplone_staticresources=self.webpackChunkplone_staticresources||[]).push([[43923],{43923:function(t,e,n){n.r(e),n.d(e,{default:function(){return I}});var i=n(14021),a=n.n(i),l=n(40705),o=n.n(l),s=n(71553),r=n(44563),c=n(59329),d=n(75199),p=n.n(d),m='<div>\n  <div class="linkModal">\n    <h1><%- insertHeading %></h1>\n    <% if(_.contains(linkTypes, \'upload\')){ %>\n    <p class="info"><%- insertLinkHelp %></p>\n    <% } %>\n\n    <div class="linkTypes pat-autotoc autotabs"\n         data-pat-autotoc="section:fieldset;levels:legend;IDPrefix:tinymce-autotoc-">\n\n      <% if(_.contains(linkTypes, \'internal\')){ %>\n      <fieldset class="linkType internal" data-linkType="internal">\n        <legend id="tinylink-internal"><%- internal %></legend>\n        <div>\n          <div class="main mb-2">\n            \x3c!-- this gives the name to the "linkType" --\x3e\n            <input type="text" name="internal" class="form-control" />\n          </div>\n        </div>\n      </fieldset>\n      <% } %>\n\n      <% if(_.contains(linkTypes, \'upload\')){ %>\n      <fieldset class="linkType upload" data-linkType="upload">\n        <legend id="tinylink-upload"><%- uploadText %></legend>\n        <div class="uploadify-me"></div>\n      </fieldset>\n      <% } %>\n\n      <% if(_.contains(linkTypes, \'external\')){ %>\n      <fieldset class="linkType external" data-linkType="external">\n        <legend id="tinylink-external"><%- external %></legend>\n        <div class="main mb-2">\n          <label for="external"><%- externalText %></label>\n          <input type="text" name="external" class="form-control" />\n        </div>\n      </fieldset>\n      <% } %>\n\n      <% if(_.contains(linkTypes, \'email\')){ %>\n      <fieldset class="linkType email" data-linkType="email">\n        <legend id="tinylink-email"><%- emailText %></legend>\n        <div>\n          <div class="main mb-2">\n            <label><%- emailText %></label>\n            <input type="text" name="email" class="form-control" />\n          </div>\n          <div class="mb-2">\n            <label><%- subjectText %></label>\n            <input type="text" name="subject" class="form-control" />\n          </div>\n        </div>\n      </fieldset>\n      <% } %>\n\n      <% if(_.contains(linkTypes, \'anchor\')){ %>\n      <fieldset class="linkType anchor" data-linkType="anchor">\n        <legend id="tinylink-anchor"><%- anchor %></legend>\n        <div>\n          <div class="main mb-2">\n            <label><%- anchorLabel %></label>\n            <div class="input-wrapper">\n              <select name="anchor" class="pat-select2" data-pat-select2="width:500px"></select>\n            </div>\n          </div>\n        </div>\n      </fieldset>\n      <% } %>\n\n    </div>\x3c!-- / tabs --\x3e\n\n    <div class="common-controls mt-3 border-top pt-3">\n      <div class="mb-2">\n        <label><%- target %></label>\n        <select name="target" class="form-select">\n          <% _.each(targetList, function(target){ %>\n            <option value="<%- target.value %>"><%- target.text %></option>\n          <% }); %>\n        </select>\n      </div>\n      <div class="mb-2">\n        <label><%- titleText %></label>\n        <input type="text" name="title" class="form-control" />\n      </div>\n    </div>\n\n    <input type="submit" class="btn btn-secondary plone-btn me-1" name="cancel" value="<%- cancelBtn %>" />\n    <input type="submit" class="btn btn-primary plone-btn" name="insert" value="<%- insertBtn %>" />\n  </div>\n</div>\n',u='<div>\n  <div class="linkModal">\n    <h1><%- insertHeading %></h1>\n    <% if(_.contains(linkTypes, \'uploadImage\')){ %>\n    <p class="info"><%- insertImageHelp %></p>\n    <% } %>\n\n    <div class="linkTypes pat-autotoc autotabs"\n         data-pat-autotoc="section:fieldset;levels:legend;IDPrefix:tinymce-autotoc-">\n\n        <% if(_.contains(linkTypes, \'image\')){ %>\n      <fieldset class="linkType image" data-linkType="image">\n        <legend id="tinylink-image"><%- internalImageText %></legend>\n        <div>\n          <div class="main mb-2">\n            <input type="text" name="image" class="form-control" />\n          </div>\n          <div class="scale mb-2">\n            <label><%- scaleText %></label>\n            <select name="scale" class="form-select">\n              <% _.each(Object.keys(pictureVariants), function(key) { %>\n                <option value="<%- key %>" <% if (key === options.defaultSrcset) { %>selected<% } %> >\n                  <%- pictureVariants[key].title %>\n                </option>\n              <% }); %>\n            </select>\n          </div>\n        </div>\n      </fieldset>\n        <% } %>\n\n      <% if(_.contains(linkTypes, \'uploadImage\')){ %>\n      <fieldset class="linkType uploadImage" data-linkType="uploadImage">\n        <legend id="tinylink-uploadImage"><%- uploadText %></legend>\n        <div class="uploadify-me"></div>\n      </fieldset>\n      <% } %>\n\n      <% if(_.contains(linkTypes, \'externalImage\')){ %>\n      <fieldset class="linkType externalImage" data-linkType="externalImage">\n        <legend id="tinylink-externalImage"><%- externalImage %></legend>\n        <div>\n          <div class="main">\n            <label><%- externalImageText %></label>\n            <input type="text" name="externalImage" class="form-control" />\n          </div>\n        </div>\n      </fieldset>\n      <% } %>\n\n    </div>\x3c!-- / tabs --\x3e\n\n    <div class="common-controls mt-3 border-top pt-3">\n      <div class="title mb-2">\n        <label><%- titleText %></label>\n        <input type="text" name="title" class="form-control" />\n      </div>\n      <div class="text mb-2">\n        <label><%- altText %></label>\n        <input type="text" name="alt" class="form-control" />\n      </div>\n      <% if(imageCaptioningEnabled){ %>\n      <div class="captionFromDescription form-check mb-2">\n        <input type="checkbox" name="captionFromDescription" class="form-check-input" />\n        <label for="captionFromDescription" class="form-check-label">\n          <%- captionFromDescriptionText %>\n        </label>\n      </div>\n      <div class="caption mb-2">\n        <label><%- captionText %></label>\n        <textarea name="caption" class="form-control"></textarea>\n      </div>\n      <% } %>\n      <div class="align mb-2">\n        <label><%- imageAlignText %></label>\n        <select name="align" class="form-select">\n          <% _.each(Object.keys(options.imageClasses), function(align){ %>\n              <option value="<%- align %>">\n              <%- options.imageClasses[align] %>\n              </option>\n          <% }); %>\n        </select>\n      </div>\n      <div class="enable-zoom mb-2">\n        <input type="checkbox" name="enableImageZoom" class="form-check-input" />\n        <label for="enableImageZoom" class="form-check-label">\n          <%- enableImageZoom %>\n        </label>\n      </div>\n    </div>\n\n    <input type="submit" class="btn btn-secondary plone-btn me-1" name="cancel" value="<%- cancelBtn %>" />\n    <input type="submit" class="btn btn-primary plone-btn" name="insert" value="<%- insertBtn %>" />\n\n  </div>\n</div>\n',g=n(63198),h=(n(10906),n(53902),n(98146)),y=s.A.extend({name:"linktype",trigger:".pat-linktype-dummy",defaults:{linkModal:null},init:function(){this.linkModal=this.options.linkModal,this.tinypattern=this.options.tinypattern,this.tiny=this.tinypattern.tiny,this.dom=this.tiny.dom},getEl:function(){return this.$el.find("input")},value:function(){return this.getEl().val().trim()},toUrl:function(){return this.value()},load:function(t){let e=this.tiny.dom.getAttrib(t,"data-val");this.getEl().attr("value",e)},set:function(t){var e=this.getEl();e.attr("value",t),e.val(t)},attributes:function(){return{"data-val":this.value()}},updateRelatedItems:function(){}}),f=y.extend({name:"externallinktype",trigger:".pat-externallinktype-dummy",init:function(){y.prototype.init.call(this),this.getEl().on("change",(function(){var t=a()(this).val();new RegExp("https?://").test(t)||-1!==a()(this).val().split("/")[0].indexOf(".")&&a()(this).val("http://"+t)}))}}),k=y.extend({name:"internallinktype",trigger:".pat-internallinktype-dummy",init:async function(){this.getEl().length&&(y.prototype.init.call(this),this.getEl().addClass("pat-relateditems"),await this.createRelatedItems())},getEl:function(){return this.$el.find("input:not(.select2-input)")},createRelatedItems:async function(){if(this.getEl().length){var t=this.linkModal.options.relatedItems;t.upload=!1,this.relatedItems=new g.default(this.getEl(),t),await r.A.await_pattern_init(this.relatedItems)}},updateRelatedItems:async function(t){this.relatedItems||await this.createRelatedItems(),this.relatedItems.selectItem(t)},value:function(){var t=this.getEl().select2("data");return t&&"object"==typeof t&&(t=t[0]),t},toUrl:function(){var t=this.value();return t?this.tinypattern.generateUrl(t):null},load:function(t){var e=this.tiny.dom.getAttrib(t,"data-val");e&&this.set(e)},set:function(t){this.getEl().val(t).trigger("change"),this.updateRelatedItems(t)},attributes:function(){var t=this.value();return t?{"data-val":t.UID}:{}}}),v=y.extend({name:"uploadlinktype",trigger:".pat-uploadlinktype-dummy",getDelegatedLinkType:function(){return"uploadImage"===this.linkModal.linkType?this.linkModal.linkTypes.image:this.linkModal.linkTypes.internal},toUrl:function(){return this.getDelegatedLinkType().toUrl()},attributes:function(){return this.getDelegatedLinkType().attributes()},set:function(t){return this.getDelegatedLinkType().set(t)},load:function(t){return this.getDelegatedLinkType().load(t)},value:function(){return this.getDelegatedLinkType().value()}}),x=k.extend({name:"imagelinktype",trigger:".pat-imagelinktype-dummy",toUrl:function(){var t=this.value();return this.tinypattern.generateImageUrl(t,this.linkModal.getScaleFromSrcset(this.linkModal.$scale.val()))}}),b=y.extend({name:"emaillinktype",trigger:".pat-emaillinktype-dummy",toUrl:function(){var t=this.value();if(t){var e=this.getSubject(),n="mailto:"+t;return e&&(n+="?subject="+e),n}return null},load:function(t){y.prototype.load.apply(this,[t]),this.linkModal.$subject.val(this.tiny.dom.getAttrib(t,"data-subject"))},getSubject:function(){return this.linkModal.$subject.val()},attributes:function(){var t=y.prototype.attributes.call(this);return t["data-subject"]=this.getSubject(),t}}),T=y.extend({name:"anchorlinktype",trigger:".pat-anchorlinktype-dummy",init:function(){y.prototype.init.call(this),this.$select=this.$el.find("select"),this.anchorNodes=[],this.anchorData=[],this.populate()},value:function(){var t=this.$select.select2("data");return t&&"object"==typeof t&&(t=t.id),t},populate:function(){var t,e,n,i,l,o=this;o.$select.find("option").remove(),o.anchorNodes=[],o.anchorData=[];var s=o.tiny.dom.select(".mceItemAnchor,.mce-item-anchor");for(e=0;e<s.length;e+=1)t=s[e],(i=o.tiny.dom.getAttrib(t,"name"))||(i=o.tiny.dom.getAttrib(t,"id")),""!==i&&(o.anchorNodes.push(t),o.anchorData.push({name:i,title:i}));if((s=o.tiny.dom.select(o.linkModal.options.anchorSelector)).length>0)for(e=0;e<s.length;e+=1)if(t=s[e],""!==(l=a()(t).text().replace(/^\s+|\s+$/g,""))){i=(i=l.toLowerCase().substring(0,1024)).replace(/[^a-z0-9]/g,"-");var r=!1;for(n=0;n<o.anchorNodes.length;n+=1){var c=o.anchorData[n];if(c.name===i){r=!0,c.title=l;break}}r||(o.anchorData.push({name:i,title:l,newAnchor:!0}),o.anchorNodes.push(t))}if(o.anchorNodes.length>0)for(e=0;e<o.anchorData.length;e+=1){var d=o.anchorData[e];o.$select.append('<option value="'+e+'">'+d.title+"</option>")}else o.$select.append("<option>No anchors found..</option>")},getIndex:function(t){for(var e=0;e<this.anchorData.length;e+=1){if(this.anchorData[e].name===t)return e}return 0},toUrl:function(){var t=this.value();if(t){var e=parseInt(t,10),n=this.anchorNodes[e],i=this.anchorData[e];return i.newAnchor&&(n.innerHTML='<a name="'+i.name+'" class="mce-item-anchor"></a>'+n.innerHTML),"#"+i.name}return null},set:function(t){var e=this.getIndex(t);this.$select.select2("data",""+e)}});p().PluginManager.add("ploneimage",(function(t){t.ui.registry.addButton("ploneimage",{icon:"image",text:"Insert image",tooltip:"Insert/edit image",onAction:t.settings.addImageClicked}),t.ui.registry.addMenuItem("ploneimage",{icon:"image",text:"Insert image",onAction:t.settings.addImageClicked})})),p().PluginManager.add("plonelink",(function(t){t.ui.registry.addButton("plonelink",{icon:"link",tooltip:"Insert/edit link",shortcut:"Ctrl+K",onAction:t.settings.addLinkClicked,stateSelector:"a[href]"}),t.ui.registry.addMenuItem("plonelink",{icon:"link",text:"Insert link",shortcut:"Ctrl+K",onAction:t.settings.addLinkClicked,stateSelector:"a[href]"}),t.ui.registry.addButton("unlink",{icon:"unlink",tooltip:"Remove link",onAction:function(){t.execCommand("unlink")},stateSelector:"a[href]"})}));var I=s.A.extend({name:"linkmodal",trigger:".pat-linkmodal",defaults:{anchorSelector:"h1,h2,h3",linkTypes:[],initialLinkType:"internal",text:{insertHeading:"Insert Link"},linkTypeClassMapping:{internal:k,upload:v,external:f,email:b,anchor:T,image:x,uploadImage:v,externalImage:y}},linkTypeTemplateMapping:{internal:m,upload:m,external:m,email:m,anchor:m,image:u,uploadImage:u,externalImage:u},template:function(t){return o().template(this.linkTypeTemplateMapping[this.linkType])(t)},init:function(){var t=this;t.tinypattern=t.options.tinypattern,t.tinypattern.options.anchorSelector&&(t.options.anchorSelector=t.tinypattern.options.anchorSelector),t.tiny=t.tinypattern.tiny,t.dom=t.tiny.dom,t.linkType=t.options.initialLinkType,t.linkTypes={},t.modal=c.A.patterns["plone-modal"].init(t.$el,{html:t.generateModalHtml(),content:null,buttons:".plone-btn",reloadWindowOnClose:!1,templateOptions:{classDialog:"modal-dialog modal-lg",reloadWindowOnClose:!1},actionOptions:{reloadWindowOnClose:!1},backdropOptions:{zIndex:"1340",closeOnClick:!1}}),t.modal.on("shown",(e=>{t.modalShown.apply(t,[e])}))},isOnlyTextSelected:function(){var t=this.tiny.selection.getContent();if(/</.test(t)&&(!/^<a [^>]+>[^<]+<\/a>$/.test(t)||-1===t.indexOf("href=")))return!1;if(this.anchorElm){var e=this.anchorElm.childNodes;if(0===e.length)return!1;for(var n=e.length-1;n>=0;n--)if(3!==e[n].nodeType)return!1}return!0},generateModalHtml:function(){return this.template({options:this.options,upload:this.options.upload,text:this.options.text,insertHeading:this.options.text.insertHeading,insertImageHelp:this.options.text.insertImageHelp,uploadText:this.options.text.upload,insertLinkHelp:this.options.text.insertLinkHelp,internal:this.options.text.internal,external:this.options.text.external,anchor:this.options.text.anchor,anchorLabel:this.options.text.anchorLabel,target:this.options.text.target,linkTypes:this.options.linkTypes,externalText:this.options.text.externalText,emailText:this.options.text.email,subjectText:this.options.text.subject,targetList:this.options.targetList,titleText:this.options.text.title,internalImageText:this.options.text.internalImage,externalImage:this.options.text.externalImage,externalImageText:this.options.text.externalImageText,altText:this.options.text.alt,imageAlignText:this.options.text.imageAlign,captionFromDescriptionText:this.options.text.captionFromDescription,enableImageZoom:this.options.text.enableImageZoom,captionText:this.options.text.caption,scaleText:this.options.text.scale,pictureVariants:this.options.pictureVariants,imageCaptioningEnabled:this.options.imageCaptioningEnabled,cancelBtn:this.options.text.cancelBtn,insertBtn:this.options.text.insertBtn})},isImageMode:function(){return-1!==["image","uploadImage","externalImage"].indexOf(this.linkType)},initElements:async function(){var t=this;t.$target=a()('select[name="target"]',t.modal.$modal),t.$button=a()('.modal-footer input[name="insert"]',t.modal.$modal),t.$title=a()('input[name="title"]',t.modal.$modal),t.$subject=a()('input[name="subject"]',t.modal.$modal),t.$alt=a()('input[name="alt"]',t.modal.$modal),t.$align=a()('select[name="align"]',t.modal.$modal),t.$scale=a()('select[name="scale"]',t.modal.$modal),t.$enableImageZoom=a()('input[name="enableImageZoom"]',t.modal.$modal),t.$captionFromDescription=a()('input[name="captionFromDescription"]',t.modal.$modal),t.$caption=a()('textarea[name="caption"]',t.modal.$modal);for(var e=0;e<t.options.linkTypes.length;e++){var n=t.options.linkTypes[e],i=a()(".linkType."+n+" .main",t.modal.$modal);if(i.length){var l=new t.options.linkTypeClassMapping[n](i,{linkModal:t,tinypattern:t.tinypattern});await r.A.await_pattern_init(l),t.linkTypes[n]=l}}a()(".autotoc-nav a",t.modal.$modal).on("click",(function(){var e=a()("fieldset.linkType",t.modal.$modal).eq(a()(this).index())[0].className.split(/\s+/);o().each(e,(function(e){-1!==o().indexOf(t.options.linkTypes,e)&&(t.linkType=e)}))})),t.$captionFromDescription.on("change",(function(){this.checked?t.$caption.prop("disabled",!0):t.$caption.prop("disabled",!1)}))},getLinkUrl:function(){return this.linkTypes[this.linkType].toUrl()},getValue:function(){return this.linkTypes[this.linkType].value()},updateAnchor:function(t){var e=this;e.tiny.focus(),e.tiny.selection.setRng(e.rng);var n=e.$target.val(),i=e.$title.val(),l=a().extend(!0,e.data,{title:i||null,target:n||null,"data-linkType":e.linkType,href:t},e.linkTypes[e.linkType].attributes());e.anchorElm?(e.onlyText&&l.text!==e.initialText&&("innerText"in e.anchorElm?e.anchorElm.innerText=e.data.text:e.anchorElm.textContent=e.data.text),e.tiny.dom.setAttribs(e.anchorElm,l),e.tiny.selection.select(e.anchorElm),e.tiny.undoManager.add()):e.onlyText?e.tiny.insertContent(e.tiny.dom.createHTML("a",l,e.tiny.dom.encode(e.data.text))):e.tiny.execCommand("mceInsertLink",!1,l)},focusElement:function(t){this.tiny.focus(),this.tiny.selection.select(t),this.tiny.nodeChanged()},getScaleFromSrcset:function(t){let e=this.options.pictureVariants[t];return e.sourceset[e.sourceset.length-1].scale},updateImage:function(t){var e=this,n=e.$title.val(),i=e.$captionFromDescription.prop("checked"),a=e.$enableImageZoom.prop("checked"),l=e.$caption.val();e.tiny.focus(),e.tiny.selection.setRng(e.rng);var o=["image-richtext"];e.$align.val()&&o.push(e.$align.val()),"externalImage"!==e.linkType&&o.push("picture-variant-"+e.$scale.val()),(i||l)&&o.push("captioned"),a&&o.push("zoomable");var s={src:t,title:n||null,alt:e.$alt.val(),class:o.join(" "),"data-linkType":e.linkType,"data-scale":e.getScaleFromSrcset(e.$scale.val()),...e.linkTypes[e.linkType].attributes()};if("externalImage"!==e.linkType&&(s["data-picturevariant"]=e.$scale.val()),l&&!i&&(s["data-captiontext"]=l),e.imgElm&&!e.imgElm.getAttribute("data-mce-object")){const t=e.dom.getAttrib(e.imgElm,"width"),n=e.dom.getAttrib(e.imgElm,"height");t&&(s.width=t),n&&(s.height=n)}else e.imgElm=null;var r,c=e.dom.create("img",s);e.imgElm&&"img"==e.imgElm.tagName.toLowerCase()?e.imgElm.replaceWith(c):e.rng.insertNode(c),e.imgElm=c,(r=e.imgElm).onload=r.onerror=function(){r.onload=r.onerror=null,e.focusElement(r)},e.imgElm.complete&&e.focusElement(e.imgElm)},modalShown:async function(t){var e=this;await e.initElements(),e.initData(),e.options.upload&&(e.$upload=a()(".uploadify-me",e.modal.$modal),e.options.upload.relatedItems=a().extend(!0,{},e.options.relatedItems),e.options.upload.relatedItems.selectableTypes=e.options.folderTypes,e.$upload.addClass("pat-upload"),new h.default(e.$upload,e.options.upload),e.$upload.on("uploadAllCompleted",function(t,n){e.linkTypes.image?(e.linkTypes.image.set(n.data.UID),a()("#"+a()("#tinylink-image",e.modal.$modal).data("navref")).trigger("click")):(e.linkTypes.internal.set(n.data.UID),a()("#"+a()("#tinylink-internal",e.modal.$modal).data("navref")).trigger("click"))}.bind(e))),e.$button.off("click").on("click",(function(t){if(t.preventDefault(),t.stopPropagation(),e.linkType=e.modal.$modal.find("fieldset.active").data("linktype"),"uploadImage"===e.linkType||"upload"===e.linkType){var n=e.$upload.data().patternUpload;n.dropzone.files.length>0&&(n.processUpload(),e.$upload.on("uploadAllCompleted",(function(t,n){var i=0,a=function(){if(i<5&&!e.linkTypes[e.linkType].value())return i+=1,void setTimeout(a,100);var t=e.getLinkUrl();e.updateImage(t),e.hide()};a()})))}var i;try{i=e.getLinkUrl()}catch{return}i&&(e.isImageMode()?e.updateImage(i):e.updateAnchor(i),e.hide())})),a()('.modal-footer input[name="cancel"]',e.modal.$modal).on("click",(function(t){t.preventDefault(),e.hide()}))},show:function(){this.modal.show()},hide:function(){this.modal.hide()},initData:function(){var t,e,n=this;if(n.data={},n.initialText=null,n.rng=n.tiny.selection.getRng(),n.selectedElm=n.tiny.selection.getNode(),n.anchorElm=n.tiny.dom.getParent(n.selectedElm,"a[href]"),n.onlyText=n.isOnlyTextSelected(),n.data.text=n.initialText=n.anchorElm?n.anchorElm.innerText||n.anchorElm.textContent:n.tiny.selection.getContent({format:"text"}),n.data.href=n.anchorElm?n.tiny.dom.getAttrib(n.anchorElm,"href"):"",n.anchorElm?n.data.target=n.tiny.dom.getAttrib(n.anchorElm,"target"):n.tiny.settings.default_link_target&&(n.data.target=n.tiny.settings.default_link_target),(t=n.tiny.dom.getAttrib(n.anchorElm,"rel"))&&(n.data.rel=t),(t=n.tiny.dom.getAttrib(n.anchorElm,"class"))&&(n.data.class=t),(t=n.tiny.dom.getAttrib(n.anchorElm,"title"))&&(n.data.title=t),n.tiny.focus(),n.anchorElm=n.dom.getParent(n.selectedElm,"a[href]"),n.isImageMode()){var i;i=n.selectedElm,n.imgElm=i;var l=n.dom.getAttrib(n.imgElm,"src"),o=n.dom.getAttrib(n.imgElm,"data-captiontext");if(n.$title.val(n.dom.getAttrib(n.imgElm,"title")),n.$alt.val(n.dom.getAttrib(n.imgElm,"alt")),a()(n.imgElm).hasClass("zoomable")&&n.$enableImageZoom.prop("checked",!0),a()(n.imgElm).hasClass("captioned")&&!o?(n.$captionFromDescription.prop("checked",!0),n.$caption.prop("disabled",!0)):(a()(n.imgElm).hasClass("captioned"),n.$captionFromDescription.prop("checked",!1)),o&&n.$caption.val(o),(e=n.dom.getAttrib(n.imgElm,"data-linktype"))&&e in n.linkTypes){n.linkType=e,n.linkTypes[n.linkType].load(n.imgElm);var s=n.dom.getAttrib(n.imgElm,"data-picturevariant");n.$scale.val(s),a()("#tinylink-"+n.linkType,n.modal.$modal).trigger("click")}else l&&n.guessImageLink(l);for(var r=n.dom.getAttrib(n.imgElm,"class").split(" "),c=0;c<r.length;c+=1){var d=r[c];for(var p in n.options.imageClasses)-1!==p.indexOf(d)&&n.$align.val(d)}}else if(n.anchorElm){n.focusElement(n.anchorElm);var m;if(m=n.dom.getAttrib(n.anchorElm,"href"),n.$target.val(n.dom.getAttrib(n.anchorElm,"target")),n.$title.val(n.dom.getAttrib(n.anchorElm,"title")),e=n.dom.getAttrib(n.anchorElm,"data-linktype")){n.linkType=e,n.linkTypes[n.linkType].load(n.anchorElm);var u=a()("#tinylink-"+n.linkType,n.modal.$modal);1===u.length&&a()("#"+u.data("autotoc-trigger-id")).trigger("click")}else m&&n.guessAnchorLink(m)}},guessImageLink:function(t){-1!==t.indexOf(this.options.prependToScalePart)?(this.linkType="image",this.$scale.val(this.tinypattern.getScaleFromUrl(t)),this.linkTypes.image.set(this.tinypattern.stripGeneratedUrl(t))):(this.linkType="externalImage",this.linkTypes.externalImage.set(t))},guessAnchorLink:function(t){if(this.options.prependToUrl&&-1!==t.indexOf(this.options.prependToUrl))this.linkType="internal",this.linkTypes.internal.set(this.tinypattern.stripGeneratedUrl(t));else if(-1!==t.indexOf("mailto:")){this.linkType="email";var e=t.substring(7,t.length).split("?subject=");this.linkTypes.email.set(e[0]),e.length>1&&this.$subject.val(decodeURIComponent(e[1]))}else"#"===t[0]?(this.linkType="anchor",this.linkTypes.anchor.set(t.substring(1))):(this.linkType="external",this.linkTypes.external.set(t))},setSelectElement:function(t,e){t.find("option:selected").prop("selected",!1),e&&t.find('option[value="'+e+'"]').prop("selected",!0)},reinitialize:function(){this.modal.options.html=this.generateModalHtml()}})}}]);
//# sourceMappingURL=43923.0607b31819c84fdd4f8a.min.js.map