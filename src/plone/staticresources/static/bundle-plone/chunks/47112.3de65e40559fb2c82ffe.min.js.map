{"version":3,"file":"chunks/47112.3de65e40559fb2c82ffe.min.js","mappings":"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","sources":["webpack://@plone/mockup/./node_modules/@patternslib/pat-code-editor/src/code-editor.js","webpack://@plone/mockup/./node_modules/@patternslib/patternslib/src/core/mockup-parser.js","webpack://@plone/mockup/./node_modules/@patternslib/patternslib/src/core/base.js","webpack://@plone/mockup/./node_modules/@patternslib/patternslib/src/core/basepattern.js","webpack://@plone/mockup/./node_modules/@patternslib/patternslib/src/core/dom.js","webpack://@plone/mockup/./node_modules/@patternslib/patternslib/src/core/events.js","webpack://@plone/mockup/./node_modules/@patternslib/patternslib/src/core/jquery-ext.js","webpack://@plone/mockup/./node_modules/@patternslib/patternslib/src/core/logging.js","webpack://@plone/mockup/./node_modules/@patternslib/patternslib/src/core/parser.js","webpack://@plone/mockup/./node_modules/@patternslib/patternslib/src/core/polyfills.js","webpack://@plone/mockup/./node_modules/@patternslib/patternslib/src/core/registry.js","webpack://@plone/mockup/./node_modules/@patternslib/patternslib/src/core/utils.js","webpack://@plone/mockup/./node_modules/@patternslib/patternslib/src/pat/checklist/checklist.js","webpack://@plone/mockup/./node_modules/@patternslib/patternslib/src/pat/date-picker/date-picker.js","webpack://@plone/mockup/./node_modules/@patternslib/patternslib/src/pat/datetime-picker/datetime-picker.js","webpack://@plone/mockup/./node_modules/@patternslib/patternslib/src/pat/depends/depends.js","webpack://@plone/mockup/./node_modules/@patternslib/patternslib/src/pat/display-time/display-time.js","webpack://@plone/mockup/./node_modules/@patternslib/patternslib/src/pat/ajax/ajax.js","webpack://@plone/mockup/./node_modules/@patternslib/patternslib/src/pat/inject/inject.js","webpack://@plone/mockup/./node_modules/@patternslib/patternslib/src/pat/close-panel/close-panel.js","webpack://@plone/mockup/./node_modules/@patternslib/patternslib/src/pat/tooltip/tooltip.js","webpack://@plone/mockup/./node_modules/@patternslib/patternslib/src/pat/validation/validation.js"],"sourcesContent":["import { BasePattern } from \"@patternslib/patternslib/src/core/basepattern\";\nimport Parser from \"@patternslib/patternslib/src/core/parser\";\nimport events from \"@patternslib/patternslib/src/core/events\";\nimport registry from \"@patternslib/patternslib/src/core/registry\";\n\nexport const parser = new Parser(\"code-editor\");\nparser.addArgument(\"language\", null); // programming language to use.\nparser.addArgument(\"linenumbers\", false);\nparser.addArgument(\"theme\", \"dark\"); // dark or light or any other theme variant.\n\n// CodeJar options\nparser.addArgument(\"tab\", \"    \"); // The tab-string. \"\\t\" for real tabs.\nparser.addArgument(\"indent-on\", \"{$\");\nparser.addArgument(\"spellcheck\", false);\nparser.addArgument(\"catch-tab\", true);\nparser.addArgument(\"preserve-ident\", true);\nparser.addArgument(\"add-closing\", true);\nparser.addArgument(\"history\", true);\n\nconst language_mapping = {\n    atom: \"xml\",\n    html: \"xml\",\n    plist: \"xml\",\n    rss: \"xml\",\n    svg: \"xml\",\n    wsf: \"xml\",\n    xhtml: \"xml\",\n    xjb: \"xml\",\n    xsd: \"xml\",\n    xsl: \"xml\",\n};\n\nclass Pattern extends BasePattern {\n    static name = \"code-editor\";\n    static trigger = \".pat-code-editor\";\n    static parser = parser;\n\n    async init() {\n        const CodeJar = (await import(\"codejar\")).CodeJar;\n        const hljs = (await import(\"highlight.js/lib/core\")).default;\n        let el = this.el;\n\n        // Set and load the theme.\n        let theme;\n        if (this.options.theme === \"light\") {\n            theme = \"stackoverflow-light\";\n        } else if (this.options.theme === \"dark\" || this.options.theme === \"okaidia\") {\n            theme = \"stackoverflow-dark\";\n        } else {\n            theme = this.options.theme;\n        }\n\n        // Need to await the style import, otherwise theme might not be applied.\n        await import(`highlight.js/styles/${theme}.css`);\n        if (window.__patternslib_import_styles) {\n            await import(\"./_code-editor.scss\");\n        }\n\n        // Custom hightlighting function, as of:\n        // https://github.com/antonmedv/codejar/blob/master/index.html\n        const highlight = (editor) => {\n            // highlight.js does not trim old tags,\n            // let's do it by this hack.\n            editor.textContent = editor.textContent;\n            hljs.highlightElement(editor);\n        };\n        let highlight_wrapper = highlight;\n\n        // Optional line numbers.\n        if (this.options.linenumbers) {\n            const linenumbers = (await import(\"codejar/linenumbers\")).withLineNumbers;\n            highlight_wrapper = linenumbers(highlight, {\n                class: `codejar-linenumbers ${theme}`,\n            });\n        }\n\n        // Import and register the language.\n        let language = [...el.classList].filter((it) => it.startsWith(\"language-\"))[0];\n        language = language ? language.replace(\"language-\", \"\") : this.options.language;\n        language = language || \"plaintext\";\n        const hljs_language = (\n            await import(\n                `highlight.js/lib/languages/${language_mapping[language] || language}`\n            )\n        ).default;\n        hljs.registerLanguage(language, hljs_language);\n\n        // Create a editor element in case of an input element.\n        if ([\"textarea\", \"input\"].includes(this.el.nodeName.toLowerCase())) {\n            const pre_el = document.createElement(\"pre\");\n            pre_el.innerHTML = `<code contenteditable></code>`;\n            el = pre_el.querySelector(\"code\");\n            el.textContent = this.el.value; // value is already unescaped.\n            this.el.parentNode.insertBefore(pre_el, this.el);\n            this.el.setAttribute(\"hidden\", \"\");\n        }\n\n        // Add some classes to the editor element.\n        el.classList.add(\n            \"code-editor\",\n            `theme-${this.options.theme}`,\n            `language-${language}`\n        );\n\n        // Allow spaces within quotes to be added as tab argument.\n        // Replace escaped tab character with real tab.\n        const tab = this.options.tab\n            .replace(/'/g, \"\") // Allow spaces within quotes\n            .replace(/\"/g, \"\")\n            .replace(/\\\\t/g, \"\\t\"); // Replace double escaped tab character\n\n        // Create the editor.\n        const config = {\n            tab: tab,\n            indentOn: new RegExp(this.options.indentOn),\n            spellcheck: this.options.spellcheck,\n            catchTab: this.options.catchTab,\n            preserveIdent: this.options.preserveIdent,\n            addClosing: this.options.addClosing,\n            history: this.options.history,\n        };\n        this.codeeditor = CodeJar(el, highlight_wrapper, config);\n\n        // Update the input element.\n        if (el !== this.el) {\n            // Update <textarea> or <input>, if one of these were the\n            // initializing elements.\n            this.codeeditor.onUpdate((code) => {\n                this.el.value = code.trim();\n                this.el.dispatchEvent(events.input_event());\n            });\n        }\n    }\n}\n\nregistry.register(Pattern);\n\nexport default Pattern;\nexport { Pattern };\n","import $ from \"jquery\";\n\nvar parser = {\n    getOptions($el, patternName, options) {\n        /* This is the Mockup parser. An alternative parser for Patternslib\n         * patterns.\n         *\n         * NOTE: Use of the Mockup parser is discouraged and is added here for\n         * legacy support for the Plone Mockup project.\n         *\n         * It parses a DOM element for pattern configuration options.\n         */\n        options = options || {};\n        // get options from parent element first, stop if element tag name is 'body'\n        if ($el.length !== 0 && !$.nodeName($el[0], \"body\")) {\n            options = this.getOptions($el.parent(), patternName, options);\n        }\n        // collect all options from element\n        let elOptions = {};\n        if ($el.length !== 0) {\n            elOptions = $el.data(\"pat-\" + patternName);\n            if (elOptions) {\n                // parse options if string\n                if (typeof elOptions === \"string\") {\n                    const tmpOptions = {};\n                    $.each(elOptions.split(\";\"), function (i, item) {\n                        item = item.split(\":\");\n                        item.reverse();\n                        let key = item.pop();\n                        key = key.replace(/^\\s+|\\s+$/g, \"\"); // trim\n                        item.reverse();\n                        let value = item.join(\":\");\n                        value = value.replace(/^\\s+|\\s+$/g, \"\"); // trim\n                        tmpOptions[key] = value;\n                    });\n                    elOptions = tmpOptions;\n                }\n            }\n        }\n        return $.extend(true, {}, options, elOptions);\n    },\n};\n\nexport default parser;\n","/**\n * A Base pattern for creating scoped patterns. It's similar to Backbone's\n * Model class. The advantage of this approach is that each instance of a\n * pattern has its own local scope (closure).\n *\n * A new instance is created for each DOM element on which a pattern applies.\n *\n * You can assign values, such as $el, to `this` for an instance and they\n * will remain unique to that instance.\n *\n * Older Patternslib patterns on the other hand have a single global scope for\n * all DOM elements.\n */\nimport $ from \"jquery\";\nimport Registry from \"./registry\";\nimport logging from \"./logging\";\nimport mockupParser from \"./mockup-parser\";\n\nconst log = logging.getLogger(\"Patternslib Base\");\n\nconst initBasePattern = function ($el, options, trigger) {\n    if (!$el.jquery) {\n        $el = $($el);\n    }\n    const name = this.prototype.name;\n    const plog = logging.getLogger(`pat.${name}`);\n    let pattern = $el.data(`pattern-${name}`);\n    if (pattern === undefined && Registry.patterns[name]) {\n        try {\n            // Immediately set the pattern instance to the temporary value\n            // ``initializing`` before the async Base constructor is setting\n            // the value later.\n            // This prevents re-init the pattern on this element on multiple\n            // initialization calls..\n            $el.data(`pattern-${name}`, \"initializing\");\n            options =\n                this.prototype.parser === \"mockup\"\n                    ? mockupParser.getOptions($el, name, options)\n                    : options;\n            pattern = new Registry.patterns[name]($el, options, trigger);\n        } catch (e) {\n            plog.error(`Failed while initializing ${name} pattern.`, e);\n        }\n    }\n    return pattern;\n};\n\nconst Base = async function ($el, options, trigger) {\n    if (($el?.jquery && $el.length === 0) || !$el) {\n        log.warn(\"No element given to pattern.\");\n        return;\n    }\n    if (!$el.jquery) {\n        $el = $($el);\n    }\n    this.$el = $el;\n    this.el = $el[0];\n    this.options = $.extend(true, {}, this.defaults || {}, options || {});\n    await this.init($el, options, trigger);\n\n    // Store pattern instance on element\n    this.$el.data(`pattern-${this.name}`, this);\n    this.el[`pattern-${this.name}`] = this;\n\n    this.emit(\"init\");\n};\n\nBase.prototype = {\n    constructor: Base,\n    on(eventName, eventCallback) {\n        this.$el.on(`${eventName}.${this.name}.patterns`, eventCallback);\n    },\n    one(eventName, eventCallback) {\n        this.$el.one(`${eventName}.${this.name}.patterns`, eventCallback);\n    },\n    emit(eventName, args) {\n        // args should be a list\n        if (args === undefined) {\n            args = [];\n        }\n        this.$el.trigger(`${eventName}.${this.name}.patterns`, args);\n    },\n};\n\nBase.extend = function (patternProps) {\n    /* Helper function to correctly set up the prototype chain for new patterns.\n     */\n    const parent = this;\n    let child;\n\n    // Check that the required configuration properties are given.\n    if (!patternProps) {\n        throw new Error(\n            \"Pattern configuration properties required when calling Base.extend\"\n        );\n    }\n\n    // The constructor function for the new subclass is either defined by you\n    // (the \"constructor\" property in your `extend` definition), or defaulted\n    // by us to simply call the parent's constructor.\n    if (Object.hasOwnProperty.call(patternProps, \"constructor\")) {\n        child = patternProps.constructor;\n    } else {\n        child = function () {\n            parent.apply(this, arguments);\n        };\n    }\n\n    // Allow patterns to be extended indefinitely\n    child.extend = Base.extend;\n\n    // Static properties required by the Patternslib registry\n    child.init = initBasePattern;\n    child.jquery_plugin = true;\n    child.trigger = patternProps.trigger;\n    child.parser = patternProps?.parser || null;\n\n    // Set the prototype chain to inherit from `parent`, without calling\n    // `parent`'s constructor function.\n    var Surrogate = function () {\n        this.constructor = child;\n    };\n    Surrogate.prototype = parent.prototype;\n    child.prototype = new Surrogate();\n\n    // Add pattern's configuration properties (instance properties) to the subclass,\n    $.extend(true, child.prototype, patternProps);\n\n    // Set a convenience property in case the parent's prototype is needed\n    // later.\n    child.__super__ = parent.prototype;\n\n    // Register the pattern in the Patternslib registry.\n    if (!patternProps.name) {\n        log.warn(\"This pattern without a name attribute will not be registered!\");\n    } else if (!patternProps.trigger) {\n        log.warn(\n            `The pattern ${patternProps.name} does not have a trigger attribute, it will not be registered.`\n        );\n    } else if (patternProps.autoregister !== false) {\n        Registry.register(child, patternProps.name);\n    }\n    return child;\n};\n\nexport default Base;\n","/**\n * A Base pattern for creating scoped patterns.\n *\n * Each instance of a pattern has its own local scope.\n * A new instance is created for each DOM element on which a pattern applies.\n *\n * For usage, see basepattern.md\n */\nimport events from \"./events\";\nimport logging from \"./logging\";\n\nconst log = logging.getLogger(\"basepattern\");\n\nclass BasePattern {\n    static name; // name of pattern used in Registry.\n    static trigger; // A CSS selector to match elements that should trigger the pattern instantiation.\n    static parser; // Options parser.\n\n    constructor(el, options = {}) {\n        // Make static variables available on instance.\n        this.name = this.constructor.name;\n        this.trigger = this.constructor.trigger;\n        this.parser = this.constructor.parser;\n\n        if (!el) {\n            log.warn(`No element given to pattern ${this.name}.`);\n            return;\n        }\n        if (el.jquery) {\n            el = el[0];\n        }\n        this.el = el;\n\n        // Initialize asynchronously.\n        //\n        // 1) We need to call the concrete implementation of ``init``, but the\n        //    inheritance chain is not yet set up and ``init`` not available.\n        //\n        // 2) We want to wait for the init() to successfuly finish and fire an\n        //    event then.\n        //    But the constructer cannot not return a Promise, thus not be\n        //    asynchronous but only return itself.\n        //\n        // Both limitations are gone in next tick.\n        //\n        window.setTimeout(async () => {\n            if (typeof this.el[`pattern-${this.name}`] !== \"undefined\") {\n                // Do not reinstantiate\n                log.debug(`Not reinstatiating the pattern ${this.name}.`, this.el);\n\n                // Notify that not instantiated\n                this.el.dispatchEvent(\n                    new Event(`not-init.${this.name}.patterns`, {\n                        bubbles: true,\n                        cancelable: false,\n                    })\n                );\n                return;\n            }\n\n            // Create the options object by parsing the element and using the\n            // optional options as default.\n            this.options = this.parser?.parse(this.el, options) ?? options;\n\n            // Store pattern instance on element\n            this.el[`pattern-${this.name}`] = this;\n\n            // Initialize the pattern\n            await this.init();\n\n            // Notify that now ready\n            this.el.dispatchEvent(\n                new Event(`init.${this.name}.patterns`, {\n                    bubbles: true,\n                    cancelable: true,\n                })\n            );\n        }, 0);\n    }\n\n    async init() {\n        // Extend this method in your pattern.\n    }\n\n    /**\n     * Listen to an event on the element only once.\n     *\n     * @param {string} event_name - Name of the event to listen to.\n     * @param {function} callback - Callback to call when the event is thrown.\n     */\n    one(event_name, event_callback) {\n        events.add_event_listener(\n            this.el,\n            `${event_name}.${this.name}.patterns`,\n            `basepattern-one--${event_name}.${this.name}.patterns`,\n            event_callback,\n            {\n                once: true,\n            }\n        );\n    }\n\n    /**\n     * Destroy/remove/unload the pattern from the element.\n     */\n    destroy() {\n        delete this.el[`pattern-${this.name}`];\n    }\n}\n\nexport default BasePattern;\nexport { BasePattern };\n","/* Utilities for DOM traversal or navigation */\nimport events from \"./events\";\nimport logging from \"./logging\";\n\nconst logger = logging.getLogger(\"core dom\");\n\nconst DATA_PREFIX = \"__patternslib__data_prefix__\";\nconst DATA_STYLE_DISPLAY = \"__patternslib__style__display\";\n\n/**\n * Return an array of DOM nodes.\n *\n * @param {Node|NodeList|jQuery} nodes - The DOM node to start the search from.\n *\n * @returns {Array} - An array of DOM nodes.\n */\nconst toNodeArray = (nodes) => {\n    if (nodes.jquery || nodes instanceof NodeList) {\n        // jQuery or document.querySelectorAll\n        nodes = [...nodes];\n    } else if (nodes instanceof Array === false) {\n        nodes = [nodes];\n    }\n    return nodes;\n};\n\n/**\n * Like querySelectorAll but including the element where it starts from.\n * Returns an Array, not a NodeList\n *\n * @param {Node} el - The DOM node to start the search from.\n *\n * @returns {Array} - The DOM nodes found.\n */\nconst querySelectorAllAndMe = (el, selector) => {\n    if (!el) {\n        return [];\n    }\n\n    const all = [...el.querySelectorAll(selector)];\n    if (el.matches(selector)) {\n        all.unshift(el); // start element should be first.\n    }\n    return all;\n};\n\n/**\n * Wrap a element with a wrapper element.\n *\n * @param {Node} el - The DOM node to wrap.\n */\nconst wrap = (el, wrapper) => {\n    // See: https://stackoverflow.com/a/13169465/1337474\n    el.parentNode.insertBefore(wrapper, el);\n    wrapper.appendChild(el);\n};\n\n/**\n * Hides the element with ``display: none`` and stores the current display value.\n *\n * @param {Node} el - The DOM node to hide.\n */\nconst hide = (el) => {\n    if (el.style.display === \"none\") {\n        // Nothing to do.\n        return;\n    }\n    if (el.style.display) {\n        el[DATA_STYLE_DISPLAY] = el.style.display;\n    }\n    el.style.display = \"none\";\n};\n\n/**\n * Shows element by removing ``display: none`` and restoring the display value\n * to whatever it was before.\n *\n * @param {Node} el - The DOM node to show.\n */\nconst show = (el) => {\n    const val = el[DATA_STYLE_DISPLAY] || null;\n    el.style.display = val;\n    delete el[DATA_STYLE_DISPLAY];\n};\n\n/**\n * Test, if a element is visible or not.\n *\n * @param {Node} el - The DOM node to test.\n * @returns {Boolean} - True if the element is visible.\n */\nconst is_visible = (el) => {\n    // Check, if element is visible in DOM.\n    // https://stackoverflow.com/a/19808107/1337474\n    return el.offsetWidth > 0 && el.offsetHeight > 0;\n};\n\n/**\n * Test, if a element is a input-type element.\n *\n * This is taken from Sizzle/jQuery at:\n * https://github.com/jquery/sizzle/blob/f2a2412e5e8a5d9edf168ae3b6633ac8e6bd9f2e/src/sizzle.js#L139\n * https://github.com/jquery/sizzle/blob/f2a2412e5e8a5d9edf168ae3b6633ac8e6bd9f2e/src/sizzle.js#L1773\n *\n * @param {Node} el - The DOM node to test.\n * @returns {Boolean} - True if the element is a input-type element.\n */\nconst is_input = (el) => {\n    const re_input = /^(?:input|select|textarea|button)$/i;\n    return re_input.test(el.nodeName);\n};\n\n/**\n * Return all direct parents of ``el`` matching ``selector``.\n * This matches against all parents but not the element itself.\n * The order of elements is from the search starting point up to higher\n * DOM levels.\n *\n * @param {Node} el - The DOM node to start the search from.\n * @param {String} selector - CSS selector to match against.\n * @returns {Array} - List of matching DOM nodes.\n */\nconst find_parents = (el, selector) => {\n    const ret = [];\n    let parent = el;\n    while (parent) {\n        parent = parent.parentNode?.closest?.(selector);\n        if (parent) ret.push(parent);\n    }\n    return ret;\n};\n\n/**\n * Find an element in the whole DOM tree if the selector is an ID selector,\n * otherwise use the given element as the starting point.\n *\n * @param {Node} el - The DOM node to start the search from.\n * @param {String} selector - The CSS selector to search for.\n *\n * @returns {NodeList} - The DOM nodes found.\n *\n */\nconst find_scoped = (el, selector) => {\n    // If the selector starts with an object id do a global search,\n    // otherwise do a local search.\n    return (selector.indexOf(\"#\") === 0 ? document : el).querySelectorAll(selector);\n};\n\n/**\n * Return all HTMLElement parents of el, starting from the direct parent of el.\n * The document itself is excluded because it's not a real DOM node.\n *\n * @param {Node} el - The DOM node to start the search from.\n *\n * @returns {Array} - The DOM nodes found.\n */\nconst get_parents = (el) => {\n    // Return all HTMLElement parents of el, starting from the direct parent of el.\n    const parents = [];\n    let parent = el?.parentNode;\n    while (parent) {\n        parents.push(parent);\n        parent = parent?.parentNode;\n        parent = parent instanceof HTMLElement ? parent : null;\n    }\n    return parents;\n};\n\n/**\n * Return the value of the first attribute found in the list of parents.\n *\n * @param {DOM element} el - The DOM element to start the acquisition search for the given attribute.\n * @param {string} attribute - Name of the attribute to search for.\n * @param {Boolean} include_empty - Also return empty values.\n * @param {Boolean} include_all - Return a list of attribute values found in all parents.\n *\n * @returns {*} - Returns the value of the searched attribute or a list of all attributes.\n */\nconst acquire_attribute = (\n    el,\n    attribute,\n    include_empty = false,\n    include_all = false\n) => {\n    let _el = el;\n    const ret = []; // array for ``include_all`` mode.\n    while (_el) {\n        const val = _el.getAttribute(attribute);\n        if (val || (include_empty && val === \"\")) {\n            if (!include_all) {\n                return val;\n            }\n            ret.push(val);\n        }\n        _el = _el.parentElement;\n    }\n    if (include_all) {\n        return ret;\n    }\n};\n\n/**\n * Return a DocumentFragment from a given string.\n *\n * @param {String} string - The HTML structure as a string.\n *\n * @returns {DocumentFragment} - The DOM nodes as a DocumentFragment.\n */\nconst create_from_string = (string) => {\n    // See: https://davidwalsh.name/convert-html-stings-dom-nodes\n    return document.createRange().createContextualFragment(string.trim());\n};\n\n/**\n * Return a CSS property value for a given DOM node.\n * For length-values, relative values are converted to pixels.\n * Optionally parse as pixels, if applicable.\n *\n * Note: The element must be attached to the body to make CSS caluclations work.\n *\n * @param {Node} el - DOM node.\n * @param {String} property - CSS property to query on DOM node.\n * @param {Boolean} [as_pixels=false] - Convert value to pixels, if applicable.\n * @param {Boolean} [as_float=false] - Convert value to float, if applicable.\n *\n * @returns {(String|Number)} - The CSS value to return.\n */\nfunction get_css_value(el, property, as_pixels = false, as_float = false) {\n    let value = window.getComputedStyle(el).getPropertyValue(property);\n    if (as_pixels || as_float) {\n        value = parseFloat(value) || 0.0;\n    }\n    if (as_pixels && !as_float) {\n        value = parseInt(Math.round(value), 10);\n    }\n    return value;\n}\n\n/**\n * Find a scrollable element up in the DOM tree.\n *\n * Note: Setting the ``overflow`` shorthand property also sets the individual overflow-y and overflow-y properties.\n *\n * @param {Node} el - The DOM element to start the search on.\n * @param {String} [direction=] - Not given: Search for any scrollable element up in the DOM tree.\n *                                ``x``: Search for a horizontally scrollable element.\n *                                ``y``: Search for a vertically scrollable element.\n * @param {(DOM Node|null)} [fallback=document.body] - Fallback, if no scroll container can be found.\n *                                                     The default is to use document.body.\n *\n * @returns {Node} - Return the first scrollable element.\n *                   If no other element could be found, document.body would be returned.\n */\nconst find_scroll_container = (el, direction, fallback = document.body) => {\n    while (el && el !== document.body) {\n        if (!direction || direction === \"y\") {\n            let overflow_y = get_css_value(el, \"overflow-y\");\n            if ([\"auto\", \"scroll\"].includes(overflow_y)) {\n                return el;\n            }\n        }\n        if (!direction || direction === \"x\") {\n            let overflow_x = get_css_value(el, \"overflow-x\");\n            if ([\"auto\", \"scroll\"].includes(overflow_x)) {\n                return el;\n            }\n        }\n        el = el.parentElement;\n    }\n    return fallback;\n};\n\n/**\n * Get data stored directly on the node instance.\n * We are using a prefix to make sure the data doesn't collide with other attributes.\n *\n * @param el {Node} - The DOM node from which we want to retrieve the data.\n * @param name {String} - The name of the variable. Note - this is stored on\n *                        the DOM node prefixed with the DATA_PREFIX.\n * @param default_value {Any} - Optional default value.\n * @returns {Any} - The value which is stored on the DOM node.\n */\nconst get_data = (el, name, default_value) => {\n    return el[`${DATA_PREFIX}${name}`] || default_value;\n};\n\n/**\n * Set and store data directly on the node instance.\n * We are using a prefix to make sure the data doesn't collide with other attributes.\n *\n * @param el {Node} - The DOM node which we want to store the data on.\n * @param name {String} - The name of the variable. Note - this is stored on\n *                        the DOM node prefixed with the DATA_PREFIX.\n * @param value {Any} - The value we want to store on the DOM node.\n */\nconst set_data = (el, name, value) => {\n    el[`${DATA_PREFIX}${name}`] = value;\n};\n\n/**\n * Delete a variable from the node instance.\n * We are using a prefix to make sure the data doesn't collide with other attributes.\n *\n * @param el {Node} - The DOM node which we want to delete the variable from.\n * @param name {String} - The name of the variable. Note - this is stored on\n *                        the DOM node prefixed with the DATA_PREFIX.\n */\nconst delete_data = (el, name) => {\n    delete el[`${DATA_PREFIX}${name}`];\n};\n\n/**\n * Simple template engine, based on JS template literal\n *\n * NOTE: This uses eval and would break if Content-Security-Policy does not\n *       allow 'unsafe-eval'.\n *       Because of this CSR problem the use of this method is not recommended.\n *\n * Please note: You cannot pass a template literal as template_string.\n * JavaScript itself would try to expand it and would fail.\n *\n * See: https://stackoverflow.com/a/37217166/1337474\n *\n * @param {String} template_string - The template string as a JavaScript template literal.\n *                                   For each variable in the template you have to use ``this``.\n *                                   E.g. if you pass ``{message: \"ok\"}`` as template_variables, you can use it like so:\n *                                   `<h1>${this.message}</h1>`\n * @param {Object} template_variables - Object literal with all the variables which should be used in the template.\n *\n * @returns {String} - Returns the a string as template expanded with the template_variables.\n */\nconst template = (template_string, template_variables = {}) => {\n    logger.warn(\n        \"Using dom.template is not recommended due to a problem with Content-Security-Policy.\"\n    );\n    return new Function(\"return `\" + template_string + \"`;\").call(template_variables);\n};\n\nconst dom = {\n    toNodeArray: toNodeArray,\n    querySelectorAllAndMe: querySelectorAllAndMe,\n    wrap: wrap,\n    hide: hide,\n    show: show,\n    find_parents: find_parents,\n    find_scoped: find_scoped,\n    get_parents: get_parents,\n    acquire_attribute: acquire_attribute,\n    is_visible: is_visible,\n    is_input: is_input,\n    create_from_string: create_from_string,\n    get_css_value: get_css_value,\n    find_scroll_container: find_scroll_container,\n    get_data: get_data,\n    set_data: set_data,\n    delete_data: delete_data,\n    template: template,\n    add_event_listener: events.add_event_listener, // BBB export. TODO: Remove in an upcoming version.\n    remove_event_listener: events.remove_event_listener, // BBB export. TODO: Remove in an upcoming version.\n};\n\nexport default dom;\n","// Event related methods and event factories\n\n// Event listener registration for easy-to-remove event listeners.\n// once Safari supports the ``signal`` option for addEventListener we can abort\n// event handlers by calling AbortController.abort().\nexport const event_listener_map = {};\n\n/**\n * Add an event listener to a DOM element under a unique id.\n * If a event is registered under the same id for the same element, the old handler is removed first.\n *\n * @param {DOM Node} el - The element to register the event for.\n * @param {string} event_type - The event type to listen for.\n * @param {string} id - A unique id under which the event is registered.\n * @param {function} cb - The event handler / callback function.\n * @param {Object} opts - Options for the addEventListener API.\n *\n */\nconst add_event_listener = (el, event_type, id, cb, opts = {}) => {\n    if (!el?.addEventListener) {\n        return; // nothing to do.\n    }\n    remove_event_listener(el, id); // do not register one listener twice.\n\n    // Create event_listener_map entry if not existent.\n    if (!event_listener_map[el]) {\n        event_listener_map[el] = {};\n    }\n    let _cb = cb;\n    if (opts?.once === true) {\n        // For `once` events, also remove the entry from the event_listener_map.\n        _cb = (e) => {\n            delete event_listener_map[el][id];\n            cb(e);\n        };\n    }\n    // Only `capture` option is necessary for `removeEventListener`.\n    event_listener_map[el][id] = [event_type, _cb, opts.capture ? opts : undefined];\n    el.addEventListener(event_type, _cb, opts);\n};\n\n/**\n * Remove an event listener from a DOM element under a unique id.\n *\n * @param {DOM Node} el - The element to register the event for.\n * @param {string} id - A unique id under which the event is registered.\n *\n */\nconst remove_event_listener = (el, id) => {\n    if (!el?.removeEventListener) {\n        return; // nothing to do.\n    }\n    const el_events = event_listener_map[el];\n    if (!el_events) {\n        return;\n    }\n    let entries;\n    if (id) {\n        // remove event listener with specific id\n        const entry = el_events[id];\n        entries = entry ? [entry] : [];\n    } else {\n        // remove all event listeners of element\n        entries = Object.entries(el_events);\n    }\n    for (const entry of entries || []) {\n        el.removeEventListener(entry[0], entry[1], entry[2]);\n    }\n};\n\n/**\n * Await an event to be thrown.\n *\n * Usage:\n *     await events.await_event(button, \"click\");\n *\n * @param {DOM Node} el - The element to listen on.\n * @param {String} event_name - The event name to listen for.\n *\n * @returns {Promise} - Returns a Promise which can be used for ``await`` and which will be resolved when the event is throwm.\n *\n */\nconst await_event = (el, event_name) => {\n    // See: https://stackoverflow.com/a/44746691/1337474\n    return new Promise((resolve) =>\n        el.addEventListener(event_name, resolve, { once: true })\n    );\n};\n\n/**\n * Await pattern init.\n *\n * Usage:\n *     await events.await_pattern_init(PATTERN);\n *\n * @param {Pattern instance} pattern - The pattern instance.\n *\n * @returns {Promise} - Returns a Promise which can be used for ``await`` and which will be resolved when the event is throwm.\n *\n */\nconst await_pattern_init = (pattern) => {\n    // See: https://stackoverflow.com/a/44746691/1337474\n    return new Promise((resolve, reject) => {\n        // Case initialized\n        pattern.one(\"init\", () => {\n            // Resolve promise and unregister the not-init event handler.\n            remove_event_listener(\n                pattern.el,\n                `basepattern-one--not-init.${pattern.name}.patterns`\n            );\n            resolve();\n        });\n\n        // Case not initialized\n        pattern.one(\"not-init\", () => {\n            // Reject promise and unregister the init event handler.\n            remove_event_listener(\n                pattern.el,\n                `basepattern-one--init.${pattern.name}.patterns`\n            );\n            reject();\n        });\n    }).catch(() => {\n        throw new Error(`Pattern \"${pattern.name}\" not initialized.`);\n    });\n};\n\n/**\n * Event factories\n */\n\nconst blur_event = () => {\n    return new Event(\"blur\", {\n        bubbles: false,\n        cancelable: false,\n    });\n};\n\nconst click_event = () => {\n    return new Event(\"click\", {\n        bubbles: true,\n        cancelable: true,\n    });\n};\n\nconst change_event = () => {\n    return new Event(\"change\", {\n        bubbles: true,\n        cancelable: false,\n    });\n};\n\nconst focus_event = () => {\n    return new Event(\"focus\", {\n        bubbles: false,\n        cancelable: false,\n    });\n};\n\nconst input_event = () => {\n    return new Event(\"input\", {\n        bubbles: true,\n        cancelable: false,\n    });\n};\n\nconst mousedown_event = () => {\n    return new Event(\"mousedown\", {\n        bubbles: true,\n        cancelable: true,\n    });\n};\n\nconst mouseup_event = () => {\n    return new Event(\"mouseup\", {\n        bubbles: true,\n        cancelable: true,\n    });\n};\n\nconst scroll_event = () => {\n    return new Event(\"scroll\", {\n        bubbles: true,\n        cancelable: false,\n    });\n};\n\nconst submit_event = () => {\n    return new Event(\"submit\", {\n        bubbles: true,\n        cancelable: true,\n    });\n};\n\nconst dragstart_event = () => {\n    return new Event(\"dragstart\", {\n        bubbles: true,\n        cancelable: true,\n    });\n};\n\nconst dragend_event = () => {\n    return new Event(\"dragend\", {\n        bubbles: true,\n        cancelable: true,\n    });\n};\n\nexport default {\n    add_event_listener: add_event_listener,\n    remove_event_listener: remove_event_listener,\n    await_event: await_event,\n    await_pattern_init: await_pattern_init,\n    blur_event: blur_event,\n    click_event: click_event,\n    change_event: change_event,\n    focus_event: focus_event,\n    input_event: input_event,\n    mousedown_event: mousedown_event,\n    mouseup_event: mouseup_event,\n    scroll_event: scroll_event,\n    submit_event: submit_event,\n    dragstart_event: dragstart_event,\n    dragend_event: dragend_event,\n};\n","/**\n * @license\n * Patterns @VERSION@ jquery-ext - various jQuery extensions\n *\n * Copyright 2011 Humberto Sermeo\n */\n\nimport $ from \"jquery\";\n\nvar methods = {\n    init: function (options) {\n        var settings = {\n            time: 3 /* time it will wait before moving to \"timeout\" after a move event */,\n            initialTime: 8 /* time it will wait before first adding the \"timeout\" class */,\n            exceptionAreas: [] /* IDs of elements that, if the mouse is over them, will reset the timer */,\n        };\n        return this.each(function () {\n            var $this = $(this),\n                data = $this.data(\"timeout\");\n\n            if (!data) {\n                if (options) {\n                    $.extend(settings, options);\n                }\n                $this.data(\"timeout\", {\n                    lastEvent: new Date(),\n                    trueTime: settings.time,\n                    time: settings.initialTime,\n                    untouched: true,\n                    inExceptionArea: false,\n                });\n\n                $this.on(\"mouseover.timeout\", methods.mouseMoved);\n                $this.on(\"mouseenter.timeout\", methods.mouseMoved);\n\n                $(settings.exceptionAreas).each(function () {\n                    $this\n                        .find(this)\n                        .live(\n                            \"mouseover.timeout\",\n                            { parent: $this },\n                            methods.enteredException\n                        )\n                        .live(\n                            \"mouseleave.timeout\",\n                            { parent: $this },\n                            methods.leftException\n                        );\n                });\n\n                if (settings.initialTime > 0) $this.timeout(\"startTimer\");\n                else $this.addClass(\"timeout\");\n            }\n        });\n    },\n\n    enteredException: function (event) {\n        var data = event.data.parent.data(\"timeout\");\n        data.inExceptionArea = true;\n        event.data.parent.data(\"timeout\", data);\n        event.data.parent.trigger(\"mouseover\");\n    },\n\n    leftException: function (event) {\n        var data = event.data.parent.data(\"timeout\");\n        data.inExceptionArea = false;\n        event.data.parent.data(\"timeout\", data);\n    },\n\n    destroy: function () {\n        return this.each(function () {\n            var $this = $(this),\n                data = $this.data(\"timeout\");\n\n            $(window).off(\".timeout\");\n            data.timeout.remove();\n            $this.removeData(\"timeout\");\n        });\n    },\n\n    mouseMoved: function () {\n        var $this = $(this),\n            data = $this.data(\"timeout\");\n\n        if ($this.hasClass(\"timeout\")) {\n            $this.removeClass(\"timeout\");\n            $this.timeout(\"startTimer\");\n        } else if (data.untouched) {\n            data.untouched = false;\n            data.time = data.trueTime;\n        }\n\n        data.lastEvent = new Date();\n        $this.data(\"timeout\", data);\n    },\n\n    startTimer: function () {\n        var $this = $(this),\n            data = $this.data(\"timeout\");\n        var fn = function () {\n            var data = $this.data(\"timeout\");\n            if (data && data.lastEvent) {\n                if (data.inExceptionArea) {\n                    setTimeout(fn, Math.floor(data.time * 1000));\n                } else {\n                    var now = new Date();\n                    var diff = Math.floor(data.time * 1000) - (now - data.lastEvent);\n                    if (diff > 0) {\n                        // the timeout has not ocurred, so set the timeout again\n                        setTimeout(fn, diff + 100);\n                    } else {\n                        // timeout ocurred, so set the class\n                        $this.addClass(\"timeout\");\n                    }\n                }\n            }\n        };\n\n        setTimeout(fn, Math.floor(data.time * 1000));\n    },\n};\n\n$.fn.timeout = function (method) {\n    if (methods[method]) {\n        return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));\n    } else if (typeof method === \"object\" || !method) {\n        return methods.init.apply(this, arguments);\n    } else {\n        $.error(\"Method \" + method + \" does not exist on jQuery.timeout\");\n    }\n};\n\n// Custom jQuery selector to find elements with scrollbars\n$.extend($.expr[\":\"], {\n    scrollable: function (element) {\n        var vertically_scrollable, horizontally_scrollable;\n        if (\n            $(element).css(\"overflow\") === \"scroll\" ||\n            $(element).css(\"overflowX\") === \"scroll\" ||\n            $(element).css(\"overflowY\") === \"scroll\"\n        )\n            return true;\n\n        vertically_scrollable =\n            element.clientHeight < element.scrollHeight &&\n            ($.inArray($(element).css(\"overflowY\"), [\"scroll\", \"auto\"]) !== -1 ||\n                $.inArray($(element).css(\"overflow\"), [\"scroll\", \"auto\"]) !== -1);\n\n        if (vertically_scrollable) return true;\n\n        horizontally_scrollable =\n            element.clientWidth < element.scrollWidth &&\n            ($.inArray($(element).css(\"overflowX\"), [\"scroll\", \"auto\"]) !== -1 ||\n                $.inArray($(element).css(\"overflow\"), [\"scroll\", \"auto\"]) !== -1);\n        return horizontally_scrollable;\n    },\n});\n\n// Make Visible in scroll\n$.fn.makeVisibleInScroll = function (parent_id) {\n    var absoluteParent = null;\n    if (typeof parent_id === \"string\") {\n        absoluteParent = $(\"#\" + parent_id);\n    } else if (parent_id) {\n        absoluteParent = $(parent_id);\n    }\n\n    return this.each(function () {\n        var $this = $(this),\n            parent;\n        if (!absoluteParent) {\n            parent = $this.parents(\":scrollable\");\n            if (parent.length > 0) {\n                parent = $(parent[0]);\n            } else {\n                parent = $(window);\n            }\n        } else {\n            parent = absoluteParent;\n        }\n\n        var elemTop = $this.position().top;\n        var elemBottom = $this.height() + elemTop;\n\n        var viewTop = parent.scrollTop();\n        var viewBottom = parent.height() + viewTop;\n\n        if (elemTop < viewTop) {\n            parent.scrollTop(elemTop);\n        } else if (elemBottom > viewBottom - parent.height() / 2) {\n            parent.scrollTop(elemTop - (parent.height() - $this.height()) / 2);\n        }\n    });\n};\n\n//Work around warning for jQuery 3.x:\n//JQMIGRATE: jQuery.fn.offset() requires an element connected to a document\n$.fn.safeOffset = function () {\n    var docElem,\n        elem = this[0],\n        origin = { top: 0, left: 0 };\n\n    if (!elem || !elem.nodeType) {\n        return origin;\n    }\n\n    docElem = (elem.ownerDocument || document).documentElement;\n    if (!$.contains(docElem, elem)) {\n        return origin;\n    }\n\n    return $.fn.offset.apply(this, arguments);\n};\n\n//Make absolute location\n$.fn.setPositionAbsolute = function (element, offsettop, offsetleft) {\n    return this.each(function () {\n        // set absolute location for based on the element passed\n        // dynamically since every browser has different settings\n        var $this = $(this);\n        var thiswidth = $(this).width();\n        var pos = element.safeOffset();\n        var width = element.width();\n        var height = element.height();\n        var setleft = pos.left + width - thiswidth + offsetleft;\n        var settop = pos.top + height + offsettop;\n        $this.css({\n            \"z-index\": 1,\n            \"position\": \"absolute\",\n            \"marginLeft\": 0,\n            \"marginTop\": 0,\n            \"left\": setleft + \"px\",\n            \"top\": settop + \"px\",\n            \"width\": thiswidth,\n        });\n        $this.remove().appendTo(\"body\").show();\n    });\n};\n\n$.fn.positionAncestor = function (selector) {\n    var left = 0;\n    var top = 0;\n    this.each(function () {\n        // check if current element has an ancestor matching a selector\n        // and that ancestor is positioned\n        var $ancestor = $(this).closest(selector);\n        if ($ancestor.length && $ancestor.css(\"position\") !== \"static\") {\n            var $child = $(this);\n            var childMarginEdgeLeft =\n                $child.safeOffset().left - parseInt($child.css(\"marginLeft\"), 10);\n            var childMarginEdgeTop =\n                $child.safeOffset().top - parseInt($child.css(\"marginTop\"), 10);\n            var ancestorPaddingEdgeLeft =\n                $ancestor.safeOffset().left +\n                parseInt($ancestor.css(\"borderLeftWidth\"), 10);\n            var ancestorPaddingEdgeTop =\n                $ancestor.safeOffset().top +\n                parseInt($ancestor.css(\"borderTopWidth\"), 10);\n            left = childMarginEdgeLeft - ancestorPaddingEdgeLeft;\n            top = childMarginEdgeTop - ancestorPaddingEdgeTop;\n            // we have found the ancestor and computed the position\n            // stop iterating\n            return false;\n        }\n    });\n    return {\n        left: left,\n        top: top,\n    };\n};\n\n$.fn.findInclusive = function (selector) {\n    return this.find(\"*\").addBack().filter(selector);\n};\n\n$.fn.slideIn = function (speed, easing, callback) {\n    return this.animate({ width: \"show\" }, speed, easing, callback);\n};\n\n$.fn.slideOut = function (speed, easing, callback) {\n    return this.animate({ width: \"hide\" }, speed, easing, callback);\n};\n\n// case-insensitive :contains\n$.expr[\":\"].Contains = function (a, i, m) {\n    return $(a).text().toUpperCase().indexOf(m[3].toUpperCase()) >= 0;\n};\n\n$.fn.scopedFind = function (selector) {\n    /*  If the selector starts with an object id do a global search,\n     *  otherwise do a local search.\n     */\n    if (selector.indexOf(\"#\") === 0) {\n        return $(selector);\n    } else {\n        return this.find(selector);\n    }\n};\n\nexport default undefined;\n","/**\n * Patterns logging - minimal logging framework\n *\n * Copyright 2012 Simplon B.V.\n */\n\n// source: https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind\nif (!Function.prototype.bind) {\n    Function.prototype.bind = function (oThis) {\n        if (typeof this !== \"function\") {\n            // closest thing possible to the ECMAScript 5 internal IsCallable function\n            throw new TypeError(\n                \"Function.prototype.bind - what is trying to be bound is not callable\"\n            );\n        }\n\n        var aArgs = Array.prototype.slice.call(arguments, 1),\n            fToBind = this,\n            fNOP = function () {},\n            fBound = function () {\n                return fToBind.apply(\n                    this instanceof fNOP && oThis ? this : oThis,\n                    aArgs.concat(Array.prototype.slice.call(arguments))\n                );\n            };\n        fNOP.prototype = this.prototype;\n        fBound.prototype = new fNOP();\n\n        return fBound;\n    };\n}\n\nvar root, // root logger instance\n    writer; // writer instance, used to output log entries\n\nvar Level = {\n    DEBUG: 10,\n    INFO: 20,\n    WARN: 30,\n    ERROR: 40,\n    FATAL: 50,\n};\n\nfunction ConsoleWriter() {}\n\nConsoleWriter.prototype = {\n    output: function (log_name, level, messages) {\n        if (log_name) messages.unshift(log_name + \":\");\n        if (level <= Level.DEBUG) {\n            // console.debug exists but is deprecated\n            messages.unshift(\"[DEBUG]\");\n            console.log.apply(console, messages);\n        } else if (level <= Level.INFO) console.info.apply(console, messages);\n        else if (level <= Level.WARN) console.warn.apply(console, messages);\n        else console.error.apply(console, messages);\n    },\n};\n\nfunction Logger(name, parent) {\n    this._loggers = {};\n    this.name = name || \"\";\n    this._parent = parent || null;\n    if (!parent) {\n        this._enabled = true;\n        this._level = Level.WARN;\n    }\n}\n\nLogger.prototype = {\n    getLogger: function (name) {\n        var path = name.split(\".\"),\n            root = this,\n            route = this.name ? [this.name] : [];\n        while (path.length) {\n            var entry = path.shift();\n            route.push(entry);\n            if (!(entry in root._loggers))\n                root._loggers[entry] = new Logger(route.join(\".\"), root);\n            root = root._loggers[entry];\n        }\n        return root;\n    },\n\n    _getFlag: function (flag) {\n        var context = this;\n        flag = \"_\" + flag;\n        while (context !== null) {\n            if (context[flag] !== undefined) return context[flag];\n            context = context._parent;\n        }\n        return null;\n    },\n\n    setEnabled: function (state) {\n        this._enabled = !!state;\n    },\n\n    isEnabled: function () {\n        this._getFlag(\"enabled\");\n    },\n\n    setLevel: function (level) {\n        if (typeof level === \"number\") this._level = level;\n        else if (typeof level === \"string\") {\n            level = level.toUpperCase();\n            if (level in Level) this._level = Level[level];\n        }\n    },\n\n    getLevel: function () {\n        return this._getFlag(\"level\");\n    },\n\n    log: function (level, messages) {\n        if (\n            !messages.length ||\n            !this._getFlag(\"enabled\") ||\n            level < this._getFlag(\"level\")\n        )\n            return;\n        messages = Array.prototype.slice.call(messages);\n        writer.output(this.name, level, messages);\n    },\n\n    debug: function () {\n        this.log(Level.DEBUG, arguments);\n    },\n\n    info: function () {\n        this.log(Level.INFO, arguments);\n    },\n\n    warn: function () {\n        this.log(Level.WARN, arguments);\n    },\n\n    error: function () {\n        this.log(Level.ERROR, arguments);\n    },\n\n    fatal: function () {\n        this.log(Level.FATAL, arguments);\n    },\n};\n\nfunction getWriter() {\n    return writer;\n}\n\nfunction setWriter(w) {\n    writer = w;\n}\n\nsetWriter(new ConsoleWriter());\n\nroot = new Logger();\n\nvar logconfig = /loglevel(|-[^=]+)=([^&]+)/g,\n    match;\n\nwhile ((match = logconfig.exec(window.location.search)) !== null) {\n    var logger = match[1] === \"\" ? root : root.getLogger(match[1].slice(1));\n    logger.setLevel(match[2].toUpperCase());\n}\n\nvar api = {\n    Level: Level,\n    getLogger: root.getLogger.bind(root),\n    setEnabled: root.setEnabled.bind(root),\n    isEnabled: root.isEnabled.bind(root),\n    setLevel: root.setLevel.bind(root),\n    getLevel: root.getLevel.bind(root),\n    debug: root.debug.bind(root),\n    info: root.info.bind(root),\n    warn: root.warn.bind(root),\n    error: root.error.bind(root),\n    fatal: root.fatal.bind(root),\n    getWriter: getWriter,\n    setWriter: setWriter,\n};\n\nexport default api;\n","// Patterns argument parser\nimport $ from \"jquery\";\nimport utils from \"./utils.js\";\nimport logging from \"./logging\";\n\nclass ArgumentParser {\n    constructor(name) {\n        this.order = [];\n        this.parameters = {};\n        this.attribute = \"data-pat-\" + name;\n        this.enum_values = {};\n        this.enum_conflicts = [];\n        this.groups = {};\n        this.possible_groups = {};\n        this.log = logging.getLogger(name + \".parser\");\n\n        this.group_pattern = /([a-z][a-z0-9]*)-([A-Z][a-z0-0\\-]*)/i;\n        this.json_param_pattern = /^\\s*\\[?\\s*{/i;\n        this.named_param_pattern = /^\\s*([a-z][a-z0-9\\-]*)\\s*:(.*)/is;\n        this.token_pattern = /(([\"']).*?(?!\\\\)\\2)|\\s*(\\S+)\\s*/g;\n    }\n\n    _camelCase(str) {\n        return str.replace(/\\-([a-z])/g, (__, p1) => p1.toUpperCase());\n    }\n\n    addAlias(alias, original) {\n        /* Add an alias for a previously added parser argument.\n         *\n         * Useful when you want to support both US and UK english argument\n         * names.\n         */\n        if (this.parameters[original]) {\n            this.parameters[original].alias = alias;\n        } else {\n            throw (\n                'Attempted to add an alias \"' +\n                alias +\n                '\" for a non-existing parser argument \"' +\n                original +\n                '\".'\n            );\n        }\n    }\n\n    addGroupToSpec(spec) {\n        /* Determine wether an argument being parsed can be grouped and\n         * update its specifications object accordingly.\n         *\n         * Internal method used by addArgument and addJSONArgument\n         */\n        const m = spec.name.match(this.group_pattern);\n        if (m) {\n            const group = m[1];\n            const field = m[2];\n            if (group in this.possible_groups) {\n                const first_spec = this.possible_groups[group];\n                const first_name = first_spec.name.match(this.group_pattern)[2];\n                first_spec.group = group;\n                first_spec.dest = first_name;\n                this.groups[group] = new ArgumentParser();\n                this.groups[group].addArgument(\n                    first_name,\n                    first_spec.value,\n                    first_spec.choices,\n                    first_spec.multiple\n                );\n                delete this.possible_groups[group];\n            }\n            if (group in this.groups) {\n                this.groups[group].addArgument(\n                    field,\n                    spec.value,\n                    spec.choices,\n                    spec.multiple\n                );\n                spec.group = group;\n                spec.dest = field;\n            } else {\n                this.possible_groups[group] = spec;\n                spec.dest = this._camelCase(spec.name);\n            }\n        }\n        return spec;\n    }\n\n    addJSONArgument(name, default_value) {\n        /* Add an argument where the value is provided in JSON format.\n         *\n         * This is a different usecase than specifying all arguments to\n         * the data-pat-... attributes in JSON format, and instead is part\n         * of the normal notation except that a value is in JSON instead of\n         * for example a string.\n         */\n        this.order.push(name);\n        this.parameters[name] = this.addGroupToSpec({\n            name: name,\n            value: default_value,\n            dest: name,\n            group: null,\n            type: \"json\",\n        });\n    }\n\n    addArgument(name, default_value, choices, multiple) {\n        const spec = {\n            name: name,\n            value:\n                multiple && !Array.isArray(default_value)\n                    ? [default_value]\n                    : default_value,\n            multiple: multiple,\n            dest: name,\n            group: null,\n        };\n        if (choices && Array.isArray(choices) && choices.length) {\n            spec.choices = choices;\n            spec.type = this._typeof(choices[0]);\n            for (const choice of choices) {\n                if (this.enum_conflicts.indexOf(choice) !== -1) {\n                    continue;\n                } else if (choice in this.enum_values) {\n                    this.enum_conflicts.push(choice);\n                    delete this.enum_values[choice];\n                } else {\n                    this.enum_values[choice] = name;\n                }\n            }\n        } else if (typeof spec.value === \"string\" && spec.value.slice(0, 1) === \"$\") {\n            spec.type = this.parameters[spec.value.slice(1)].type;\n        } else {\n            // Note that this will get reset by _defaults if default_value is a function.\n            spec.type = this._typeof(multiple ? spec.value[0] : spec.value);\n        }\n        this.order.push(name);\n        this.parameters[name] = this.addGroupToSpec(spec);\n    }\n\n    _typeof(obj) {\n        if (obj === null) {\n            return \"null\";\n        }\n        return typeof obj;\n    }\n\n    _coerce(name, value) {\n        const spec = this.parameters[name];\n        if (typeof value !== spec.type)\n            try {\n                switch (spec.type) {\n                    case \"json\":\n                        value = JSON.parse(value);\n                        break;\n                    case \"boolean\":\n                        if (typeof value === \"string\") {\n                            value = value.toLowerCase();\n                            const num = parseInt(value, 10);\n                            if (!isNaN(num)) value = !!num;\n                            else\n                                value =\n                                    value === \"true\" ||\n                                    value === \"y\" ||\n                                    value === \"yes\" ||\n                                    value === \"y\" ||\n                                    value === \"on\";\n                        } else if (typeof value === \"number\") {\n                            value = !!value;\n                        } else {\n                            throw \"Cannot convert value for \" + name + \" to boolean\";\n                        }\n                        break;\n                    case \"number\":\n                        if (typeof value === \"string\") {\n                            value = parseInt(value, 10);\n                            if (isNaN(value)) {\n                                throw \"Cannot convert value for \" + name + \" to number\";\n                            }\n                        } else if (typeof value === \"boolean\") {\n                            value = value + 0;\n                        } else {\n                            throw \"Cannot convert value for \" + name + \" to number\";\n                        }\n                        break;\n                    case \"string\":\n                        value = value.toString();\n                        break;\n                    case \"null\": // Missing default values\n                    case \"undefined\":\n                        break;\n                    default:\n                        throw (\n                            \"Do not know how to convert value for \" +\n                            name +\n                            \" to \" +\n                            spec.type\n                        );\n                }\n            } catch (e) {\n                this.log.warn(e);\n                return null;\n            }\n\n        if (spec.choices && spec.choices.indexOf(value) === -1) {\n            this.log.warn(\"Illegal value for \" + name + \": \" + value);\n            return null;\n        }\n        return value;\n    }\n\n    _set(opts, name, value) {\n        if (!(name in this.parameters)) {\n            this.log.debug(\"Ignoring value for unknown argument \" + name);\n            return;\n        }\n        const spec = this.parameters[name];\n        let parts;\n        if (spec.multiple) {\n            if (typeof value === \"string\") {\n                parts = value.split(/,+/);\n            } else {\n                parts = value;\n            }\n            value = [];\n            for (const part of parts) {\n                const v = this._coerce(name, part.trim());\n                if (v !== null) {\n                    value.push(v);\n                }\n            }\n        } else {\n            value = this._coerce(name, value);\n            if (value === null) {\n                return;\n            }\n        }\n        opts[name] = value;\n    }\n\n    _split(text) {\n        const tokens = [];\n        text.replace(this.token_pattern, (match, quoted, __, simple) => {\n            if (quoted) {\n                tokens.push(quoted);\n            } else if (simple) {\n                tokens.push(simple);\n            }\n        });\n        return tokens;\n    }\n\n    _parseExtendedNotation(argstring) {\n        const opts = {};\n        const parts = argstring\n            .replace(/;;/g, \"\\0x1f\")\n            .replace(/&amp;/g, \"&amp\\0x1f\")\n            .split(/;/)\n            .map((el) => el.replace(new RegExp(\"\\0x1f\", \"g\"), \";\"));\n        for (const part of parts) {\n            if (!part) {\n                continue;\n            }\n            const matches = part.match(this.named_param_pattern);\n            if (!matches) {\n                this.log.warn(\"Invalid parameter: \" + part + \": \" + argstring);\n                continue;\n            }\n            const name = matches[1];\n            const value = matches[2].trim();\n            const arg = Object.values(this.parameters).filter((it) => it.alias === name);\n\n            const is_alias = arg.length === 1;\n\n            if (is_alias) {\n                this._set(opts, arg[0].name, value);\n            } else if (name in this.parameters) {\n                this._set(opts, name, value);\n            } else if (name in this.groups) {\n                const subopt = this.groups[name]._parseShorthandNotation(value);\n                for (const field in subopt) {\n                    this._set(opts, name + \"-\" + field, subopt[field]);\n                }\n            } else {\n                this.log.warn(\"Unknown named parameter \" + matches[1]);\n                continue;\n            }\n        }\n        return opts;\n    }\n\n    _parseShorthandNotation(parameter) {\n        const parts = this._split(parameter);\n        const opts = {};\n        let i = 0;\n\n        while (parts.length) {\n            const part = parts.shift().trim();\n            let sense;\n            let flag;\n            let positional = true;\n            if (part.slice(0, 3) === \"no-\") {\n                sense = false;\n                flag = part.slice(3);\n            } else {\n                sense = true;\n                flag = part;\n            }\n            if (flag in this.parameters && this.parameters[flag].type === \"boolean\") {\n                positional = false;\n                this._set(opts, flag, sense);\n            } else if (flag in this.enum_values) {\n                positional = false;\n                this._set(opts, this.enum_values[flag], flag);\n            } else if (positional) this._set(opts, this.order[i], part);\n            else {\n                parts.unshift(part);\n                break;\n            }\n            i++;\n            if (i >= this.order.length) {\n                break;\n            }\n        }\n        if (parts.length) this.log.warn(\"Ignore extra arguments: \" + parts.join(\" \"));\n        return opts;\n    }\n\n    _parse(parameter) {\n        if (!parameter) {\n            return {};\n        }\n        if (parameter.match(this.json_param_pattern)) {\n            try {\n                return JSON.parse(parameter);\n            } catch (e) {\n                this.log.warn(\"Invalid JSON argument found: \" + parameter);\n            }\n        }\n        if (parameter.match(this.named_param_pattern)) {\n            return this._parseExtendedNotation(parameter);\n        }\n        const sep = parameter.indexOf(\";\");\n        if (sep === -1) {\n            return this._parseShorthandNotation(parameter);\n        }\n        const opts = this._parseShorthandNotation(parameter.slice(0, sep));\n        const extended = this._parseExtendedNotation(parameter.slice(sep + 1));\n        for (const name in extended) {\n            opts[name] = extended[name];\n        }\n        return opts;\n    }\n\n    _defaults($el) {\n        const result = {};\n        for (const name in this.parameters)\n            if (typeof this.parameters[name].value === \"function\")\n                try {\n                    result[name] = this.parameters[name].value($el, name);\n                    this.parameters[name].type = typeof result[name];\n                } catch (e) {\n                    this.log.error(\"Default function for \" + name + \" failed.\");\n                }\n            else result[name] = this.parameters[name].value;\n        return result;\n    }\n\n    _cleanupOptions(options, group_options = true) {\n        // Resolve references\n        for (const name of Object.keys(options)) {\n            const spec = this.parameters[name];\n            if (spec === undefined) continue;\n\n            if (\n                options[name] === spec.value &&\n                typeof spec.value === \"string\" &&\n                spec.value.slice(0, 1) === \"$\"\n            )\n                options[name] = options[spec.value.slice(1)];\n        }\n        if (group_options) {\n            // Move options into groups and do renames\n            for (const name of Object.keys(options)) {\n                const spec = this.parameters[name];\n                let target;\n                if (spec === undefined) continue;\n\n                if (spec.group) {\n                    if (typeof options[spec.group] !== \"object\")\n                        options[spec.group] = {};\n                    target = options[spec.group];\n                } else {\n                    target = options;\n                }\n\n                if (spec.dest !== name) {\n                    target[spec.dest] = options[name];\n                    delete options[name];\n                }\n            }\n        }\n        return options;\n    }\n\n    parse($el, options, multiple, inherit = true, group_options = true) {\n        if (!$el.jquery) {\n            $el = $($el);\n        }\n        if (typeof options === \"boolean\" && multiple === undefined) {\n            // Fix argument order: ``multiple`` passed instead of ``options``.\n            multiple = options;\n            options = {};\n        }\n        const stack = inherit ? [[this._defaults($el)]] : [[{}]];\n        let $possible_config_providers;\n        let final_length = 1;\n        /*\n         * XXX this is a workaround for:\n         * - https://github.com/Patternslib/Patterns/issues/393\n         *\n         * Prevents the parser to pollute the pat-modal configuration\n         * with data-pat-inject elements define in a `.pat-modal` parent element.\n         *\n         *  Probably this function should be completely revisited, see:\n         * - https://github.com/Patternslib/Patterns/issues/627\n         *\n         */\n        if (\n            !inherit ||\n            ($el.hasClass(\"pat-modal\") && this.attribute === \"data-pat-inject\")\n        ) {\n            $possible_config_providers = $el;\n        } else {\n            $possible_config_providers = $el\n                .parents(\"[\" + this.attribute + \"]\")\n                .addBack();\n        }\n\n        for (const provider of $possible_config_providers) {\n            let frame;\n            const data = ($(provider).attr(this.attribute) || \"\").trim();\n            if (!data) {\n                continue;\n            }\n            const _parse = this._parse.bind(this);\n            if (data.match(/&&/)) {\n                frame = data.split(/\\s*&&\\s*/).map(_parse);\n            } else {\n                frame = _parse(data);\n            }\n            if (!Array.isArray(frame)) {\n                frame = [frame];\n            }\n            final_length = Math.max(frame.length, final_length);\n            stack.push(frame);\n        }\n\n        if (typeof options === \"object\") {\n            if (Array.isArray(options)) {\n                stack.push(options);\n                final_length = Math.max(options.length, final_length);\n            } else {\n                stack.push([options]);\n            }\n        }\n        if (!multiple) {\n            final_length = 1;\n        }\n        const results = utils\n            .removeDuplicateObjects(utils.mergeStack(stack, final_length))\n            .map((current_value) => this._cleanupOptions(current_value, group_options));\n        return multiple ? results : results[0];\n    }\n}\n\n// BBB\nArgumentParser.prototype.add_argument = ArgumentParser.prototype.addArgument;\n\nexport default ArgumentParser;\n","// Polyfills for modern browsers\n\n// SubmitEvent.submitter polyfill for Safari < 15.4 and jsDOM\n// Original code: https://stackoverflow.com/a/61110260/1337474\n// Also see: https://caniuse.com/?search=submitter\n//\n!(function () {\n    let last_btn = null;\n    const submitable_buttons = `button, input[type=\"button\"], input[type=\"submit\"], input[type=\"image\"]`;\n    document.addEventListener(\n        \"click\",\n        function (e) {\n            if (!e.target.closest) return;\n            last_btn = e.target.closest(submitable_buttons);\n        },\n        true\n    );\n    document.addEventListener(\n        \"submit\",\n        function (e) {\n            if (\"submitter\" in e) return;\n            const canditates = [document.activeElement, last_btn];\n            last_btn = null;\n            for (const candidate of canditates) {\n                if (!candidate) continue;\n                if (!candidate.form) continue;\n                if (!candidate.matches(submitable_buttons)) continue;\n                e.submitter = candidate;\n                return;\n            }\n            e.submitter = e.target.querySelector(submitable_buttons);\n        },\n        true\n    );\n})();\n","/**\n * Patterns registry - Central registry and scan logic for patterns\n *\n * Copyright 2012-2013 Simplon B.V.\n * Copyright 2012-2013 Florian Friesdorf\n * Copyright 2013 Marko Durkovic\n * Copyright 2013 Rok Garbas\n * Copyright 2014-2015 Syslab.com GmBH, JC Brand\n */\n\n/*\n * changes to previous patterns.register/scan mechanism\n * - if you want initialised class, do it in init\n * - init returns set of elements actually initialised\n * - handle once within init\n * - no turnstile anymore\n * - set pattern.jquery_plugin if you want it\n */\nimport $ from \"jquery\";\nimport dom from \"./dom\";\nimport logging from \"./logging\";\nimport utils from \"./utils\";\n\nconst log = logging.getLogger(\"registry\");\nconst disable_re = /patterns-disable=([^&]+)/g;\nconst dont_catch_re = /patterns-dont-catch/g;\nconst disabled = {};\nlet dont_catch = false;\nlet match;\n\nwhile ((match = disable_re.exec(window.location.search)) !== null) {\n    disabled[match[1]] = true;\n    log.info(\"Pattern disabled via url config:\", match[1]);\n}\n\nwhile ((match = dont_catch_re.exec(window.location.search)) !== null) {\n    dont_catch = true;\n    log.info(\"I will not catch init exceptions\");\n}\n\n/**\n * Global pattern registry.\n *\n * This is a singleton and shared among any instance of the Patternslib\n * registry since Patternslib version 8.\n *\n * You normally don't need this as the registry handles it for you.\n */\nif (typeof window.__patternslib_registry === \"undefined\") {\n    window.__patternslib_registry = {};\n}\nexport const PATTERN_REGISTRY = window.__patternslib_registry;\nif (typeof window.__patternslib_registry_initialized === \"undefined\") {\n    window.__patternslib_registry_initialized = false;\n}\n\nconst registry = {\n    patterns: PATTERN_REGISTRY, // reference to global patterns registry\n    // as long as the registry is not initialized, pattern\n    // registration just registers a pattern. Once init is called,\n    // the DOM is scanned. After that registering a new pattern\n    // results in rescanning the DOM only for this pattern.\n    init() {\n        $(document).ready(function () {\n            if (window.__patternslib_registry_initialized) {\n                // Do not reinitialize a already initialized registry.\n                return;\n            }\n            window.__patternslib_registry_initialized = true;\n            log.debug(\"Loaded: \" + Object.keys(registry.patterns).sort().join(\", \"));\n            registry.scan(document.body);\n            log.debug(\"Finished initial scan.\");\n        });\n    },\n\n    clear() {\n        // Removes all patterns from the registry. Currently only being\n        // used in tests.\n        for (const name in registry.patterns) {\n            delete registry.patterns[name];\n        }\n    },\n\n    transformPattern(name, content) {\n        /* Call the transform method on the pattern with the given name, if\n         * it exists.\n         */\n        if (disabled[name]) {\n            log.debug(`Skipping disabled pattern: ${name}.`);\n            return;\n        }\n\n        const pattern = registry.patterns[name];\n        const transform = pattern.transform || pattern.prototype?.transform;\n        if (transform) {\n            try {\n                transform($(content));\n            } catch (e) {\n                if (dont_catch) {\n                    throw e;\n                }\n                log.error(`Transform error for pattern ${name}.`, e);\n            }\n        }\n    },\n\n    initPattern(name, el, trigger) {\n        /* Initialize the pattern with the provided name and in the context\n         * of the passed in DOM element.\n         */\n        const $el = $(el);\n        const pattern = registry.patterns[name];\n        const plog = logging.getLogger(`pat.${name}`);\n        if (el.matches(pattern.trigger)) {\n            plog.debug(\"Initialising.\", el);\n            try {\n                if (pattern.init) {\n                    // old style initialisation\n                    pattern.init($el, null, trigger);\n                } else {\n                    // class based pattern initialisation\n                    new pattern($el, null, trigger);\n                }\n\n                plog.debug(\"done.\");\n            } catch (e) {\n                if (dont_catch) {\n                    throw e;\n                }\n                plog.error(\"Caught error:\", e);\n            }\n        }\n    },\n\n    orderPatterns(patterns) {\n        // Always add pat-validation as first pattern, so that it can prevent\n        // other patterns from reacting to submit events if form validation\n        // fails.\n        if (patterns.includes(\"validation\")) {\n            patterns.splice(patterns.indexOf(\"validation\"), 1);\n            patterns.unshift(\"validation\");\n        }\n        // Add clone-code to the very beginning - we want to copy the markup\n        // before any other patterns changed the markup.\n        if (patterns.includes(\"clone-code\")) {\n            patterns.splice(patterns.indexOf(\"clone-code\"), 1);\n            patterns.unshift(\"clone-code\");\n        }\n\n        return patterns;\n    },\n\n    scan(content, patterns, trigger) {\n        if (!content) {\n            return;\n        }\n\n        if (typeof content === \"string\") {\n            content = document.querySelector(content);\n        } else if (content instanceof Text) {\n            // No need to scan a TextNode.\n            return;\n        } else if (content.jquery) {\n            content = content[0];\n        }\n\n        const selectors = [];\n        patterns = this.orderPatterns(patterns || Object.keys(registry.patterns));\n        for (const name of patterns) {\n            this.transformPattern(name, content);\n            const pattern = registry.patterns[name];\n            if (pattern.trigger) {\n                selectors.unshift(pattern.trigger);\n            }\n        }\n\n        let matches = dom.querySelectorAllAndMe(\n            content,\n            selectors.map((it) => it.trim().replace(/,$/, \"\")).join(\",\")\n        );\n        matches = matches.filter((el) => {\n            // Filter out patterns:\n            // - with class ``.disable-patterns``\n            // - wrapped in ``.disable-patterns`` elements\n            // - wrapped in ``<pre>`` elements\n            // - wrapped in ``<template>`` elements\n            return (\n                !el.matches(\".disable-patterns\") &&\n                !el?.parentNode?.closest?.(\".disable-patterns\") &&\n                !el?.parentNode?.closest?.(\"pre\") &&\n                !el?.parentNode?.closest?.(\"template\") && // NOTE: not strictly necessary. Template is a DocumentFragment and not reachable except for IE.\n                !el.matches(\".cant-touch-this\") && // BBB. TODO: Remove with next major version.\n                !el?.parentNode?.closest?.(\".cant-touch-this\") // BBB. TODO: Remove with next major version.\n            );\n        });\n\n        // walk list backwards and initialize patterns inside-out.\n        for (const el of matches.reverse()) {\n            for (const name of patterns) {\n                this.initPattern(name, el, trigger);\n            }\n        }\n        document.body.classList.add(\"patterns-loaded\");\n    },\n\n    register(pattern, name) {\n        name = name || pattern.name;\n        if (!name) {\n            log.error(\"Pattern lacks a name.\", pattern);\n            return false;\n        }\n        if (registry.patterns[name]) {\n            log.debug(`Already have a pattern called ${name}.`);\n            return false;\n        }\n        // register pattern to be used for scanning new content\n        registry.patterns[name] = pattern;\n\n        // register pattern as jquery plugin\n        if (pattern.jquery_plugin) {\n            const plugin_name = (\"pat-\" + name).replace(\n                /-([a-zA-Z])/g,\n                function (match, p1) {\n                    return p1.toUpperCase();\n                }\n            );\n            $.fn[plugin_name] = utils.jqueryPlugin(pattern);\n            // BBB 2012-12-10 and also for Mockup patterns.\n            $.fn[plugin_name.replace(/^pat/, \"pattern\")] = $.fn[plugin_name];\n        }\n        log.debug(`Registered pattern ${name}`, pattern);\n        if (window.__patternslib_registry_initialized) {\n            // Once the first initialization has been done, do only scan for\n            // newly registered patterns.\n            registry.scan(document.body, [name]);\n            log.debug(`Re-scanned dom with newly registered pattern ${name}.`);\n        }\n        return true;\n    },\n};\n\nexport default registry;\n","import $ from \"jquery\";\nimport dom from \"./dom\";\n\nconst _MS_PER_DAY = 1000 * 60 * 60 * 24; // Milliseconds per day.\n\n$.fn.safeClone = function () {\n    var $clone = this.clone();\n    return $clone;\n};\n\n// Production steps of ECMA-262, Edition 5, 15.4.4.18\n// Reference: http://es5.github.io/#x15.4.4.18\nif (!Array.prototype.forEach) {\n    Array.prototype.forEach = function (callback, thisArg) {\n        var T, k;\n        if (this === null) {\n            throw new TypeError(\" this is null or not defined\");\n        }\n        // 1. Let O be the result of calling ToObject passing the |this| value as the argument.\n        var O = Object(this);\n        // 2. Let lenValue be the result of calling the Get internal method of O with the argument \"length\".\n        // 3. Let len be ToUint32(lenValue).\n        var len = O.length >>> 0;\n        // 4. If IsCallable(callback) is false, throw a TypeError exception.\n        // See: http://es5.github.com/#x9.11\n        if (typeof callback !== \"function\") {\n            throw new TypeError(callback + \" is not a function\");\n        }\n        // 5. If thisArg was supplied, let T be thisArg; else let T be undefined.\n        if (arguments.length > 1) {\n            T = thisArg;\n        }\n        // 6. Let k be 0\n        k = 0;\n        // 7. Repeat, while k < len\n        while (k < len) {\n            var kValue;\n            // a. Let Pk be ToString(k).\n            //   This is implicit for LHS operands of the in operator\n            // b. Let kPresent be the result of calling the HasProperty internal method of O with argument Pk.\n            //   This step can be combined with c\n            // c. If kPresent is true, then\n            if (k in O) {\n                // i. Let kValue be the result of calling the Get internal method of O with argument Pk.\n                kValue = O[k];\n                // ii. Call the Call internal method of callback with T as the this value and\n                // argument list containing kValue, k, and O.\n                callback.call(T, kValue, k, O);\n            }\n            // d. Increase k by 1.\n            k++;\n        }\n        // 8. return undefined\n    };\n}\n\nvar singleBoundJQueryPlugin = function (pattern, method, options) {\n    /* This is a jQuery plugin for patterns which are invoked ONCE FOR EACH\n     * matched element in the DOM.\n     *\n     * This is how the Mockup-type patterns behave. They are constructor\n     * functions which need to be invoked once per jQuery-wrapped DOM node\n     * for all DOM nodes on which the pattern applies.\n     */\n    var $this = this;\n    $this.each(function () {\n        var pat,\n            $el = $(this);\n        pat = pattern.init($el, options);\n        if (method) {\n            if (pat[method] === undefined) {\n                $.error(\n                    \"Method \" + method + \" does not exist on jQuery.\" + pattern.name\n                );\n                return false;\n            }\n            if (method.charAt(0) === \"_\") {\n                $.error(\"Method \" + method + \" is private on jQuery.\" + pattern.name);\n                return false;\n            }\n            pat[method].apply(pat, [options]);\n        }\n    });\n    return $this;\n};\n\nvar pluralBoundJQueryPlugin = function (pattern, method, options) {\n    /* This is a jQuery plugin for patterns which are invoked ONCE FOR ALL\n     * matched elements in the DOM.\n     *\n     * This is how the vanilla Patternslib-type patterns behave. They are\n     * simple objects with an init method and this method gets called once\n     * with a list of jQuery-wrapped DOM nodes on which the pattern\n     * applies.\n     */\n    var $this = this;\n    if (method) {\n        if (pattern[method]) {\n            return pattern[method].apply($this, [$this].concat([options]));\n        } else {\n            $.error(\"Method \" + method + \" does not exist on jQuery.\" + pattern.name);\n        }\n    } else {\n        pattern.init.apply($this, [$this].concat([options]));\n    }\n    return $this;\n};\n\nvar jqueryPlugin = function (pattern) {\n    return function (method, options) {\n        var $this = this;\n        if ($this.length === 0) {\n            return $this;\n        }\n        if (typeof method === \"object\") {\n            options = method;\n            method = undefined;\n        }\n        if (typeof pattern === \"function\") {\n            return singleBoundJQueryPlugin.call(this, pattern, method, options);\n        } else {\n            return pluralBoundJQueryPlugin.call(this, pattern, method, options);\n        }\n    };\n};\n\n// Is a given variable an object?\nfunction isObject(obj) {\n    var type = typeof obj;\n    return type === \"function\" || (type === \"object\" && !!obj);\n}\n\n// Extend a given object with all the properties in passed-in object(s).\nfunction extend(obj) {\n    if (!isObject(obj)) return obj;\n    var source, prop;\n    for (var i = 1, length = arguments.length; i < length; i++) {\n        source = arguments[i];\n        for (prop in source) {\n            if (hasOwnProperty.call(source, prop)) {\n                obj[prop] = source[prop];\n            }\n        }\n    }\n    return obj;\n}\n// END: Taken from Underscore.js until here.\n\nfunction findLabel(input) {\n    var $label;\n    for (\n        var label = input.parentNode;\n        label && label.nodeType !== 11;\n        label = label.parentNode\n    ) {\n        if (label.tagName === \"LABEL\") {\n            return label;\n        }\n    }\n    if (input.id) {\n        $label = $('label[for=\"' + input.id + '\"]');\n    }\n    if ($label && $label.length === 0 && input.form) {\n        $label = $('label[for=\"' + input.name + '\"]', input.form);\n    }\n    if ($label && $label.length) {\n        return $label[0];\n    } else {\n        return null;\n    }\n}\n\n// Taken from http://stackoverflow.com/questions/123999/how-to-tell-if-a-dom-element-is-visible-in-the-current-viewport\nfunction elementInViewport(el) {\n    var rect = el.getBoundingClientRect(),\n        docEl = document.documentElement,\n        vWidth = window.innerWidth || docEl.clientWidth,\n        vHeight = window.innerHeight || docEl.clientHeight;\n\n    if (rect.right < 0 || rect.bottom < 0 || rect.left > vWidth || rect.top > vHeight)\n        return false;\n    return true;\n}\n\n// Taken from http://stackoverflow.com/questions/3446170/escape-string-for-use-in-javascript-regex\nfunction escapeRegExp(str) {\n    return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\n}\n\n/**\n * Remove classes from a list of targets if they match a specific pattern.\n *\n * @param {Node, NodeList} targets: Dom Node or NodeList where the classes should be removed.\n * @param {string} classes: String matching classes to be removed.\n *                          You can add a \"*\" as wildcard to search for classes to be removed.\n *                          E.g. \"icon-*-alert\" to remove any of \"icon-1-alert icon-2-alert\".\n *\n * @returns {undefined}: This method directly operates on the targets.\n */\nfunction removeWildcardClass(targets, classes) {\n    targets = utils.ensureArray(targets);\n\n    if (classes.indexOf(\"*\") === -1) {\n        for (const target of targets) {\n            target.classList.remove(classes);\n        }\n    } else {\n        let matcher = classes.replace(/[\\-\\[\\]{}()+?.,\\\\\\^$|#\\s]/g, \"\\\\$&\");\n        matcher = matcher.replace(/[*]/g, \".*\");\n        matcher = new RegExp(\"^\" + matcher + \"$\");\n\n        for (const target of targets) {\n            const class_list = (target.getAttribute(\"class\") || \"\").split(/\\s+/);\n            if (!class_list.length) {\n                continue;\n            }\n            const ok = class_list.filter((it) => !matcher.test(it));\n            if (ok.length) {\n                target.setAttribute(\"class\", ok.join(\" \"));\n            } else {\n                target.removeAttribute(\"class\");\n            }\n        }\n    }\n}\n\nfunction hasValue(el) {\n    if (el.tagName === \"INPUT\") {\n        if (el.type === \"checkbox\" || el.type === \"radio\") {\n            return el.checked;\n        }\n        return el.value !== \"\";\n    }\n    if (el.tagName === \"SELECT\") {\n        return el.selectedIndex !== -1;\n    }\n    if (el.tagName === \"TEXTAREA\") {\n        return el.value !== \"\";\n    }\n    return false;\n}\n\nconst hideOrShow = (nodes, visible, options, pattern_name) => {\n    nodes = dom.toNodeArray(nodes);\n\n    const transitions = {\n        none: { hide: \"hide\", show: \"show\" },\n        fade: { hide: \"fadeOut\", show: \"fadeIn\" },\n        slide: { hide: \"slideUp\", show: \"slideDown\" },\n    };\n\n    const duration =\n        options.transition === \"css\" || options.transition === \"none\"\n            ? null\n            : options.effect.duration;\n\n    const on_complete = (el) => {\n        el.classList.remove(\"in-progress\");\n        el.classList.add(visible ? \"visible\" : \"hidden\");\n        $(el).trigger(\"pat-update\", {\n            pattern: pattern_name,\n            action: \"attribute-changed\",\n            dom: el,\n            transition: \"complete\",\n        });\n    };\n\n    for (const el of nodes) {\n        el.classList.remove(\"visible\");\n        el.classList.remove(\"hidden\");\n        el.classList.remove(\"in-progress\");\n\n        if (duration) {\n            const t = transitions[options.transition];\n            el.classList.add(\"in-progress\");\n            $(el).trigger(\"pat-update\", {\n                pattern: pattern_name,\n                action: \"attribute-changed\",\n                dom: el,\n                transition: \"start\",\n            });\n            $(el)[visible ? t.show : t.hide]({\n                duration: duration,\n                easing: options.effect.easing,\n                complete: () => on_complete(el),\n            });\n        } else {\n            if (options.transition !== \"css\") {\n                dom[visible ? \"show\" : \"hide\"](el);\n            }\n            on_complete(el);\n        }\n    }\n};\n\nfunction addURLQueryParameter(fullURL, param, value) {\n    /* Using a positive lookahead (?=\\=) to find the given parameter,\n     * preceded by a ? or &, and followed by a = with a value after\n     * than (using a non-greedy selector) and then followed by\n     * a & or the end of the string.\n     *\n     * Taken from http://stackoverflow.com/questions/7640270/adding-modify-query-string-get-variables-in-a-url-with-javascript\n     */\n    var val = new RegExp(\"(\\\\?|\\\\&)\" + param + \"=.*?(?=(&|$))\"),\n        parts = fullURL.toString().split(\"#\"),\n        url = parts[0],\n        hash = parts[1],\n        qstring = /\\?.+$/,\n        newURL = url;\n    // Check if the parameter exists\n    if (val.test(url)) {\n        // if it does, replace it, using the captured group\n        // to determine & or ? at the beginning\n        newURL = url.replace(val, \"$1\" + param + \"=\" + value);\n    } else if (qstring.test(url)) {\n        // otherwise, if there is a query string at all\n        // add the param to the end of it\n        newURL = url + \"&\" + param + \"=\" + value;\n    } else {\n        // if there's no query string, add one\n        newURL = url + \"?\" + param + \"=\" + value;\n    }\n    if (hash) {\n        newURL += \"#\" + hash;\n    }\n    return newURL;\n}\n\nfunction removeDuplicateObjects(objs) {\n    /* Given an array of objects, remove any duplicate objects which might\n     * be present.\n     */\n    const comparator = function (k, v) {\n        return this[k] === v;\n    };\n\n    return objs.reduce(function (list, next_obj) {\n        let is_duplicate = false;\n        for (const obj of list) {\n            is_duplicate =\n                Object.keys(obj).length === Object.keys(next_obj).length &&\n                Object.entries(obj).filter(\n                    (it) => !comparator.bind(next_obj)(it[0], it[1])\n                ).length === 0;\n        }\n        if (!is_duplicate) {\n            list.push(next_obj);\n        }\n        return list;\n    }, []);\n}\n\nfunction mergeStack(stack, length) {\n    /* Given a list of lists of objects (which for brevity we call a stack),\n     * return a list of objects where each object is the merge of all the\n     * corresponding original objects at that particular index.\n     *\n     * If a certain sub-list doesn't have an object at that particular\n     * index, the last object in that list is merged.\n     */\n    const results = [];\n    for (let i = 0; i < length; i++) {\n        results.push({});\n    }\n    for (const frame of stack) {\n        const frame_length = frame.length - 1;\n        for (let x = 0; x < length; x++) {\n            results[x] = $.extend(\n                results[x] || {},\n                frame[x > frame_length ? frame_length : x]\n            );\n        }\n    }\n    return results;\n}\n\nfunction isElementInViewport(el, partial = false, offset = 0) {\n    /* returns true if element is visible to the user ie. is in the viewport.\n     * Setting partial parameter to true, will only check if a part of the element is visible\n     * in the viewport, specifically that some part of that element is touching the top part\n     * of the viewport. This only applies to the vertical direction, ie. doesnt check partial\n     * visibility for horizontal scrolling\n     * some code taken from:\n     * http://stackoverflow.com/questions/123999/how-to-tell-if-a-dom-element-is-visible-in-the-current-viewport/7557433#7557433\n     */\n    if (el instanceof $) {\n        el = el[0];\n    }\n\n    const rec = el.getBoundingClientRect();\n    const rec_values = [rec.top, rec.bottom, rec.left, rec.right];\n\n    if (rec_values.every((val) => val === 0)) {\n        // if every property of rec is 0, the element is invisible;\n        return false;\n    } else if (partial) {\n        // when using getBoundingClientRect() (in the vertical case)\n        // negative means above top of viewport, positive means below top of viewport\n        // therefore for part of the element to be touching or crossing the top of the viewport\n        // rec.top must <= 0 and rec.bottom must >= 0\n        // an optional tolerance offset can be added for when the desired element is not exactly\n        // toucing the top of the viewport but needs to be considered as touching.\n        return (\n            rec.top <= 0 + offset && rec.bottom >= 0 + offset\n            //(rec.top >= 0+offset && rec.top <= window.innerHeight) // this checks if the element\n            // touches bottom part of viewport\n            // XXX do we want to include a check for the padding of an element?\n            // using window.getComputedStyle(target).paddingTop\n        );\n    } else {\n        // this will return true if the entire element is completely in the viewport\n        return (\n            rec.top >= 0 &&\n            rec.left >= 0 &&\n            rec.bottom <=\n                (window.innerHeight || document.documentElement.clientHeight) &&\n            rec.right <= (window.innerWidth || document.documentElement.clientWidth)\n        );\n    }\n}\n\n/* parseTime - Parse a duration from a string and return the parsed time in milliseconds.\n *\n * @param {String} time - A duration/time string like ``1ms``, ``1s`` or ``1m``.\n *\n * @returns {Number} - A integer which represents the parsed time in milliseconds.\n */\nfunction parseTime(time) {\n    var m = /^(\\d+(?:\\.\\d+)?)\\s*(\\w*)/.exec(time);\n    if (!m) {\n        throw new Error(\"Invalid time\");\n    }\n    var amount = parseFloat(m[1]);\n    switch (m[2]) {\n        case \"s\":\n            return Math.round(amount * 1000);\n        case \"m\":\n            return Math.round(amount * 1000 * 60);\n        case \"ms\":\n        default:\n            return Math.round(amount);\n    }\n}\n\n// Return a jQuery object with elements related to an input element.\nfunction findRelatives(el) {\n    var $el = $(el),\n        $relatives = $(el),\n        $label = $();\n\n    $relatives = $relatives.add($el.closest(\"label\"));\n    $relatives = $relatives.add($el.closest(\"fieldset\"));\n\n    if (el.id) $label = $(\"label[for='\" + el.id + \"']\");\n    if (!$label.length) {\n        var $form = $el.closest(\"form\");\n        if (!$form.length) $form = $(document.body);\n        $label = $form.find(\"label[for='\" + el.name + \"']\");\n    }\n    $relatives = $relatives.add($label);\n    return $relatives;\n}\n\nfunction get_bounds(el) {\n    // Return bounds of an element with it's values rounded and converted to ints.\n    const bounds = el.getBoundingClientRect();\n    return {\n        x: parseInt(Math.round(bounds.x), 10) || 0,\n        y: parseInt(Math.round(bounds.y), 10) || 0,\n        top: parseInt(Math.round(bounds.top), 10) || 0,\n        bottom: parseInt(Math.round(bounds.bottom), 10) || 0,\n        left: parseInt(Math.round(bounds.left), 10) || 0,\n        right: parseInt(Math.round(bounds.right), 10) || 0,\n        width: parseInt(Math.round(bounds.width), 10) || 0,\n        height: parseInt(Math.round(bounds.height), 10) || 0,\n    };\n}\n\nfunction checkInputSupport(type, invalid_value) {\n    /* Check input type support.\n     *  See: https://stackoverflow.com/a/10199306/1337474\n     */\n    let support = false;\n    const input = document.createElement(\"input\");\n    input.setAttribute(\"type\", type);\n    support = input.type == type;\n\n    if (invalid_value !== undefined) {\n        // Check for input type UI support\n        input.setAttribute(\"value\", invalid_value);\n        support = input.value !== invalid_value;\n    }\n    return support;\n}\n\nconst checkCSSFeature = (attribute, value, tag = \"div\") => {\n    /* Check for browser support of specific CSS feature.\n     */\n    tag = document.createElement(tag);\n    let supported = tag.style[attribute] !== undefined;\n    if (supported && value !== undefined) {\n        tag.style[attribute] = value;\n        supported = tag.style[attribute] === value;\n    }\n    return supported;\n};\n\nconst animation_frame = () => {\n    // Return promise to await next repaint cycle\n    // Use it in your async function like so: ``await utils.animation_frame()``\n    // From: http://www.albertlobo.com/fractals/async-await-requestanimationframe-buddhabrot\n    return new Promise(window.requestAnimationFrame);\n};\n\nconst timeout = (ms) => {\n    return new Promise((resolve) => setTimeout(resolve, ms));\n};\n\nconst debounce = (func, ms, timer = { timer: null }) => {\n    // Returns a function, that, as long as it continues to be invoked, will not\n    // be triggered. The function will be called after it stops being called for\n    // N milliseconds.\n    // From: https://underscorejs.org/#debounce\n    //\n    // Make sure to initialize ``debounce`` only once per to-be-debounced\n    // function to not reinitialize the timer each time and debounce not being\n    // able to cancel previouse runs.\n    //\n    // Pass a module-global timer as an object ``{ timer: null }`` if you want\n    // to also cancel debounced functions from other pattern-invocations.\n    //\n    return function () {\n        clearTimeout(timer.timer);\n        const args = arguments;\n        timer.timer = setTimeout(() => func.apply(this, args), ms);\n    };\n};\n\nconst isIE = () => {\n    // See: https://stackoverflow.com/a/9851769/1337474\n    // Internet Explorer 6-11\n    return /*@cc_on!@*/ false || !!document.documentMode;\n};\n\nconst jqToNode = (el) => {\n    // Return a DOM node if a jQuery node was passed.\n    if (el.jquery) {\n        el = el[0];\n    }\n    return el;\n};\n\n/**\n * Always return an iterable object.\n *\n * @param {any} it: The object which needs to be wrapped in an array or returned as is if it is iterable.\n * @param {boolean} force_array: If the object is iterable but not an Array, convert it to an array (e.g. For jQuery items or NodeList objects).\n *\n * @returns {Array}: Returns the object wrapped in an Array, expanded to an Array or as-is if it is already iterable.\n */\nconst ensureArray = (it, force_array) => {\n    // Ensure to return always an array\n    const array_like = !!(\n        NodeList.prototype.isPrototypeOf(it) || // eslint-disable-line no-prototype-builtins\n        Array.isArray(it) ||\n        it.jquery\n    );\n    return array_like ? (force_array ? [...it] : it) : [it];\n};\n\nconst localized_isodate = (date) => {\n    // Return a iso date (date only) in the current timezone instead of a\n    // UTC ISO 8601 date+time component which toISOString returns.\n\n    const day = date.getDate().toString().padStart(2, \"0\");\n    const month = (date.getMonth() + 1).toString().padStart(2, \"0\");\n    const year = date.getFullYear().toString();\n\n    return `${year}-${month}-${day}`;\n};\n\n/**\n * Replace HTML reserved characters with html entities to add HTML for user\n * editing to e.g. a textarea or a contenteditable.\n *\n * See:\n *  https://stackoverflow.com/a/22706073/1337474\n *  https://developer.mozilla.org/en-US/docs/Glossary/Entity#reserved_characters\n *\n * @param {string} html - The HTML string to encode.\n *\n * @returns {string} - Returns the escaped html string:\n *                     ``&`` will be replaced with ``&amp;``.\n *                     ``<`` will be repalced with ``&lt;``,\n *                     ``>`` will be replaced with ``&gt;``,\n *                     ``\"`` will be replaced with ``&quot;``.\n */\nconst escape_html = (html) => {\n    if (!html) {\n        return \"\";\n    }\n    const el = document.createElement(\"div\");\n    el.appendChild(document.createTextNode(html));\n    // Return escaped html and also replace quotes.\n    return el.innerHTML.replace(/\"/g, \"&quot;\");\n};\n\n/**\n * Return unescaped, raw HTML from an escaped HTML  string.\n *\n * See:\n *  https://stackoverflow.com/a/34064434/1337474\n *  https://developer.mozilla.org/en-US/docs/Glossary/Entity#reserved_characters\n *\n * @param {string} escaped_html - The HTML string to decode.\n *\n * @returns {string} - Returns the escaped html string:\n *                     ``&amp;`` will be replaced with ``&``,\n *                     ``&lt;`` will be repalced with ``<``,\n *                     ``&gt;`` will be replaced with ``>``,\n *                     ``&quot;`` will be replaced with ``\"``.\n */\nconst unescape_html = (escaped_html) => {\n    if (!escaped_html) {\n        return \"\";\n    }\n    const doc = new DOMParser().parseFromString(escaped_html, \"text/html\");\n    // Return unescaped html and also unescape quote named entities.\n    return doc.documentElement.textContent.replace(/&quot;/g, '\"');\n};\n\n/**\n * Return true, if the given value is a valid ISO 8601 date/time string with or without an optional time component.\n *\n * @param {String} value - The date/time value to be checked.\n * @param {Boolean} [optional_time=false] - True, if time component is optional.\n * @return {Boolean} - True, if the given value is a valid Date string. False if not.\n */\nconst is_iso_date_time = (value, optional_time = false) => {\n    const re_date_time = optional_time\n        ? /^\\d{4}-[01]\\d-[0-3]\\d(T[0-2]\\d:[0-5]\\d)?$/\n        : /^\\d{4}-[01]\\d-[0-3]\\dT[0-2]\\d:[0-5]\\d$/;\n    return re_date_time.test(value);\n};\n\n/**\n * Return true, if the given value is a valid ISO 8601 date string and without a time component.\n *\n * @param {String} value - The date value to be checked.\n * @return {Boolean} - True, if the given value is a valid ISO 8601 date string without a time component. False if not.\n */\nconst is_iso_date = (value) => {\n    const re_date_time = /^\\d{4}-[01]\\d-[0-3]\\d$/;\n    return re_date_time.test(value);\n};\n\n/**\n * Return the number of days between two dates.\n * Based on: https://stackoverflow.com/a/15289883/1337474\n *\n * @param {Date} date_1 - First date to compare. We will substract date_2 from date_1.\n * @param {Date} date_2 - Second date to compare.\n * @return {Number} - The number of days between the two dates.\n */\nconst date_diff = (date_1, date_2) => {\n    // Discard the time and time-zone information.\n    const utc_1 = Date.UTC(date_1.getFullYear(), date_1.getMonth(), date_1.getDate());\n    const utc_2 = Date.UTC(date_2.getFullYear(), date_2.getMonth(), date_2.getDate());\n\n    return Math.floor((utc_1 - utc_2) / _MS_PER_DAY);\n};\n\nvar utils = {\n    jqueryPlugin: jqueryPlugin,\n    escapeRegExp: escapeRegExp,\n    isObject: isObject,\n    extend: extend,\n    findLabel: findLabel,\n    elementInViewport: elementInViewport,\n    removeWildcardClass: removeWildcardClass,\n    hideOrShow: hideOrShow,\n    addURLQueryParameter: addURLQueryParameter,\n    removeDuplicateObjects: removeDuplicateObjects,\n    mergeStack: mergeStack,\n    isElementInViewport: isElementInViewport,\n    hasValue: hasValue,\n    parseTime: parseTime,\n    findRelatives: findRelatives,\n    get_bounds: get_bounds,\n    checkInputSupport: checkInputSupport,\n    checkCSSFeature: checkCSSFeature,\n    animation_frame: animation_frame,\n    timeout: timeout,\n    debounce: debounce,\n    isIE: isIE,\n    jqToNode: jqToNode,\n    ensureArray: ensureArray,\n    localized_isodate: localized_isodate,\n    escape_html: escape_html,\n    unescape_html: unescape_html,\n    is_iso_date_time: is_iso_date_time,\n    is_iso_date: is_iso_date,\n    date_diff: date_diff,\n    getCSSValue: dom.get_css_value, // BBB: moved to dom. TODO: Remove in upcoming version.\n};\n\nexport default utils;\n","import Base from \"../../core/base\";\nimport Parser from \"../../core/parser\";\nimport dom from \"../../core/dom\";\nimport utils from \"../../core/utils\";\nimport \"../../core/jquery-ext\";\n\nexport const parser = new Parser(\"checklist\");\nparser.addArgument(\"select\", \".select-all\");\nparser.addArgument(\"deselect\", \".deselect-all\");\nparser.addArgument(\"toggle\", \".toggle-all\");\n\nexport default Base.extend({\n    name: \"checklist\",\n    trigger: \".pat-checklist\",\n    jquery_plugin: true,\n    all_selects: [],\n    all_deselects: [],\n    all_toggles: [],\n    all_checkboxes: [],\n    all_radios: [],\n\n    init() {\n        this.options = parser.parse(this.el, this.options, false);\n        this.$el.on(\"patterns-injected\", this._init.bind(this));\n        this._init();\n    },\n\n    _init() {\n        this.all_checkboxes = this.el.querySelectorAll(`input[type=checkbox]`);\n        this.all_radios = this.el.querySelectorAll(\"input[type=radio]\");\n\n        this.all_selects = dom.find_scoped(this.el, this.options.select);\n        for (const btn of this.all_selects) {\n            btn.addEventListener(\"click\", this.select_all.bind(this));\n        }\n\n        this.all_deselects = dom.find_scoped(this.el, this.options.deselect);\n        for (const btn of this.all_deselects) {\n            btn.addEventListener(\"click\", this.deselect_all.bind(this));\n        }\n\n        this.all_toggles = dom.find_scoped(this.el, this.options.toggle);\n        for (const btn of this.all_toggles) {\n            btn.addEventListener(\"click\", this.toggle_all.bind(this));\n        }\n\n        // update select/deselect button status\n        this.el.addEventListener(\"change\", this._handler_change.bind(this));\n        this.change_buttons_and_toggles();\n        this.change_checked();\n    },\n\n    _handler_change() {\n        utils.debounce(() => this.change_buttons_and_toggles(), 50)();\n        utils.debounce(() => this.change_checked(), 50)();\n    },\n\n    destroy() {\n        for (const it of this.all_selects) {\n            it.removeEventListener(\"click\", this.select_all);\n        }\n        for (const it of this.all_deselects) {\n            it.removeEventListener(\"click\", this.deselect_all);\n        }\n        this.el.removeEventListener(\"change\", this._handler_change);\n        this.$el.off(\"patterns_injected\");\n    },\n\n    find_siblings(el, sel) {\n        // Looks for the closest elements within the `el` tree that match the\n        // `sel` selector\n        let res;\n        let parent = el.parentNode;\n        while (parent) {\n            res = parent.querySelectorAll(`${sel}:not(${this.options.toggle})`);\n            if (res.length || parent === this.el) {\n                // return if results were found or we reached the pattern top\n                return res;\n            }\n            parent = parent.parentNode;\n        }\n    },\n\n    find_checkboxes(ref_el, sel) {\n        let chkbxs = [];\n        if (this.options.select.indexOf(\"#\") === 0) {\n            chkbxs = this.el.querySelectorAll(sel);\n        } else {\n            chkbxs = this.find_siblings(ref_el, sel);\n        }\n        return chkbxs;\n    },\n\n    change_buttons_and_toggles() {\n        let chkbxs;\n        for (const btn of this.all_selects) {\n            chkbxs = this.find_checkboxes(btn, \"input[type=checkbox]\");\n            btn.disabled = [...chkbxs]\n                .map((el) => el.matches(\":checked\"))\n                .every((it) => it === true);\n        }\n        for (const btn of this.all_deselects) {\n            chkbxs = this.find_checkboxes(btn, \"input[type=checkbox]\");\n            btn.disabled = [...chkbxs]\n                .map((el) => el.matches(\":checked\"))\n                .every((it) => it === false);\n        }\n        for (const tgl of this.all_toggles) {\n            chkbxs = this.find_checkboxes(tgl, \"input[type=checkbox]\");\n            tgl.checked = [...chkbxs]\n                .map((el) => el.matches(\":checked\"))\n                .every((it) => it === true);\n        }\n    },\n\n    select_all(e) {\n        e.preventDefault();\n        const chkbxs = this.find_checkboxes(\n            e.target,\n            \"input[type=checkbox]:not(:checked)\"\n        );\n        for (const box of chkbxs) {\n            box.checked = true;\n            box.dispatchEvent(new Event(\"change\", { bubbles: true, cancelable: true }));\n        }\n    },\n\n    deselect_all(e) {\n        e.preventDefault();\n        const chkbxs = this.find_checkboxes(e.target, \"input[type=checkbox]:checked\");\n        for (const box of chkbxs) {\n            box.checked = false;\n            box.dispatchEvent(new Event(\"change\", { bubbles: true, cancelable: true }));\n        }\n    },\n\n    toggle_all(e) {\n        e.preventDefault();\n        const checked = e.target.checked;\n        const chkbxs = this.find_checkboxes(e.target, \"input[type=checkbox]\");\n        for (const box of chkbxs) {\n            box.checked = checked;\n            box.dispatchEvent(new Event(\"change\", { bubbles: true, cancelable: true }));\n        }\n    },\n\n    change_checked() {\n        for (const it of [...this.all_checkboxes, ...this.all_radios]) {\n            for (const label of it.labels) {\n                label.classList.remove(\"checked\", \"unchecked\");\n                label.classList.add(it.checked ? \"checked\" : \"unchecked\");\n            }\n        }\n\n        for (const fieldset of dom.querySelectorAllAndMe(this.el, \"fieldset\")) {\n            if (\n                fieldset.querySelectorAll(\n                    `input[type=checkbox]:checked:not(${this.options.toggle}), input[type=radio]:checked`\n                ).length\n            ) {\n                fieldset.classList.remove(\"unchecked\");\n                fieldset.classList.add(\"checked\");\n            } else {\n                fieldset.classList.remove(\"checked\");\n                fieldset.classList.add(\"unchecked\");\n            }\n        }\n    },\n});\n","/* pat-date-picker  - Polyfill for input type=date */\nimport $ from \"jquery\";\nimport Base from \"../../core/base\";\nimport logging from \"../../core/logging\";\nimport Parser from \"../../core/parser\";\nimport dom from \"../../core/dom\";\nimport events from \"../../core/events\";\nimport utils from \"../../core/utils\";\n\nconst log = logging.getLogger(\"date-picker\");\n\nexport const parser = new Parser(\"date-picker\");\nparser.addArgument(\"behavior\", \"styled\", [\"native\", \"styled\"]);\nparser.addArgument(\"week-numbers\", [], [\"show\", \"hide\"]);\nparser.addArgument(\"i18n\"); // URL pointing to JSON resource with i18n values\nparser.addArgument(\"first-day\", 0);\nparser.addArgument(\"after\");\nparser.addArgument(\"offset-days\", 0);\n\nparser.add_argument(\"output-format\", null);\nparser.add_argument(\"locale\", null);\n\nparser.addAlias(\"behaviour\", \"behavior\");\n\n/* JSON format for i18n\n * { \"previousMonth\": \"Previous Month\",\n *   \"nextMonth\"    : \"Next Month\",\n *   \"months\"       : [\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\n *   \"weekdays\"     : [\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"],\n *   \"weekdaysShort\": [\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"]\n * } */\n\nexport default Base.extend({\n    name: \"date-picker\",\n    trigger: \".pat-date-picker\",\n    parser: parser,\n    format: \"YYYY-MM-DD\",\n\n    async init() {\n        const el = this.el;\n        const disabled = this.el.disabled;\n\n        //TODO: make parser with options extend missing options.\n        //this.options = parser.parse(el, opts);\n        this.options = $.extend(parser.parse(el), this.options);\n\n        if (!disabled && this.options.after) {\n            // Set the date depending on another date which must be ``offset-days``\n            // BEFORE this date. Only set it, if the other date is AFTER this\n            // date.\n            const befores = document.querySelectorAll(this.options.after);\n            for (const b_el of befores) {\n                b_el.addEventListener(\"change\", (e) => {\n                    let b_date = e.target.value; // the \"before-date\"\n                    b_date = b_date ? new Date(b_date) : null;\n                    if (!b_date) {\n                        return;\n                    }\n                    let a_date = this.el.value; // the \"after-date\"\n                    a_date = a_date ? new Date(a_date) : null;\n                    if (!a_date || a_date < b_date) {\n                        const offset = this.options.offsetDays || 0;\n                        b_date.setDate(b_date.getDate() + offset);\n                        this.el.value = b_date.toISOString().substring(0, 10);\n                        this.dispatch_change_event();\n                    }\n                });\n            }\n        }\n\n        let display_el;\n        if (this.options.behavior === \"styled\") {\n            dom.hide(el); // hide input, but keep active (e.g. for validation)\n\n            display_el = document.createElement(\"time\");\n            display_el.setAttribute(\"class\", \"output-field\");\n            display_el.setAttribute(\"datetime\", el.value);\n            if (disabled) {\n                display_el.classList.add(\"disabled\");\n            }\n            el.insertAdjacentElement(\"beforebegin\", display_el);\n\n            // Disable click on label, as this invokes a click on the invisible\n            // input field which opens the calendar in Firefox and masks a\n            // click on display_el on Chrome.\n            const label = display_el.closest(\"label\");\n            if (label) {\n                events.add_event_listener(\n                    label,\n                    \"click\",\n                    \"pat-date-picker--label\",\n                    (e) => {\n                        e.preventDefault();\n                    }\n                );\n            }\n\n            let pat_display_time;\n            if (this.options.outputFormat) {\n                const PatDisplayTime = (await import(\"../display-time/display-time\")).default; // prettier-ignore\n                const display_time_config = { format: this.format };\n                if (this.options.outputFormat) {\n                    display_time_config[\"output-format\"] = this.options.outputFormat;\n                }\n                if (this.options.locale) {\n                    display_time_config.locale = this.options.locale;\n                }\n                pat_display_time = new PatDisplayTime(display_el, display_time_config);\n            } else if (this.el.value) {\n                display_el.textContent = el.value;\n            }\n\n            // Add the additional elements \"clear button\" and placeholder to\n            // the `<time>` element.\n            const _add_additional = () => {\n                this.add_clear_button(display_el);\n                if (!this.el.value && this.el.placeholder) {\n                    display_el.innerHTML = `<span class=\"placeholder\">${this.el.placeholder}</span>`;\n                }\n            };\n            if (pat_display_time) {\n                // Add the additional elements after display time has\n                // eventually cleared the contents or done any other changes.\n                $(display_el).on(\"init.display-time.patterns\", () => {\n                    _add_additional();\n                });\n            } else {\n                // If no `pat-display-time` was used, add immediately.\n                _add_additional();\n            }\n\n            this.el.addEventListener(\"change\", () => {\n                display_el.setAttribute(\"datetime\", this.el.value);\n                if (pat_display_time && this.el.value) {\n                    pat_display_time.format();\n                } else {\n                    //} else if (this.el.value) {\n                    display_el.textContent = this.el.value;\n                }\n                _add_additional();\n            });\n\n            if (disabled) {\n                // nothing else to do here...\n                return;\n            }\n        } else if (disabled) {\n            return;\n        } else if (utils.checkInputSupport(\"date\", \"invalid date\")) {\n            // behavior native with native support.\n            return;\n        } else if (el.getAttribute(\"type\") === \"date\") {\n            // behavior native but no native support.\n            // Fallback JS date picker with a text input field.\n            el.setAttribute(\"type\", \"text\");\n        }\n\n        if (window.__patternslib_import_styles) {\n            import(\"./_date-picker.scss\");\n        }\n        const Pikaday = (await import(\"pikaday\")).default;\n\n        const config = {\n            field: el,\n            trigger: display_el || el,\n            format: this.format,\n            firstDay: this.options.firstDay,\n            showWeekNumber: this.options.weekNumbers === \"show\",\n            onSelect: () => this.dispatch_change_event(),\n            onClose: () => {\n                if (this.options.behavior === \"styled\" && !this.el.value) {\n                    // blur the input field so that pat-validate can kick in when\n                    // nothing was selected.\n                    el.dispatchEvent(events.blur_event());\n                }\n            },\n        };\n\n        if (el.getAttribute(\"min\")) {\n            config.minDate = new Date(el.getAttribute(\"min\"));\n        }\n        if (el.getAttribute(\"max\")) {\n            config.maxDate = new Date(el.getAttribute(\"max\"));\n        }\n\n        if (this.options.i18n) {\n            try {\n                const response = await fetch(this.options.i18n);\n                config.i18n = await response.json();\n            } catch {\n                log.error(`date-picker could not load i18n for ${this.options.i18n}`);\n            }\n        }\n        this.pikaday = new Pikaday(config);\n    },\n\n    add_clear_button(el_append_to) {\n        if (!this.el.disabled && !this.el.required && this.el.value) {\n            // Add clear button\n            const clear_button = document.createElement(\"span\");\n            clear_button.setAttribute(\"class\", \"cancel-button\");\n            clear_button.addEventListener(\"click\", (e) => {\n                e.stopPropagation();\n                this.el.value = null;\n                this.dispatch_change_event();\n            });\n            el_append_to.appendChild(clear_button);\n        }\n    },\n\n    dispatch_change_event() {\n        const event = new Event(\"change\", {\n            bubbles: true,\n            cancelable: true,\n        });\n        // Set ``firedBy` to prevent pikaday to call it's own handler and land\n        // in an infinite loop.\n        event.firedBy = this.pikaday;\n        this.el.dispatchEvent(event);\n\n        // Also trigger input-change\n        $(this.el).trigger(\"input-change\");\n        $(this.el.form).trigger(\"input-change\");\n    },\n});\n","/* pat-datetime-picker  - Polyfill for input type=datetime-local */\nimport Base from \"../../core/base\";\nimport Parser from \"../../core/parser\";\nimport utils from \"../../core/utils\";\nimport dom from \"../../core/dom\";\n\nexport const parser = new Parser(\"datetime-picker\");\nparser.addArgument(\"format\", \"YYYY-MM-DD\");\nparser.addArgument(\"week-numbers\", [], [\"show\", \"hide\"]);\nparser.addArgument(\"i18n\"); // URL pointing to JSON resource with i18n values\nparser.addArgument(\"today\", \"Today\");\nparser.addArgument(\"clear\", \"Clear\");\nparser.addArgument(\"first-day\", 0);\n\nexport default Base.extend({\n    name: \"datetime-picker\",\n    trigger: \".pat-datetime-picker\",\n    parser: parser,\n    el_date: null,\n    el_time: null,\n\n    async init() {\n        const el = this.el;\n        this.options = parser.parse(this.el, this.options);\n\n        if (utils.checkInputSupport(\"datetime-local\", \"invalid date\")) {\n            return;\n        }\n\n        if (window.__patternslib_import_styles) {\n            import(\"./_datetime-picker.scss\");\n        }\n        const DatePicker = (await import(\"../date-picker/date-picker\")).default;\n\n        const value = this.el.value.split(\"T\");\n        const date_value = value[0] || \"\";\n        const time_value = value[1] || \"\";\n\n        const el_wrapper = document.createElement(\"div\");\n        el_wrapper.setAttribute(\"class\", \"pat-datetime-picker__wrapper\");\n\n        dom.hide(el);\n\n        // let the buttons be of type button otherwise they are submit buttons\n        const html_btn_now = `\n            <button type=\"button\" class=\"_btn _now\" title=\"${this.options.today}\">\n                <span class=\"_icon\"/>\n                <span class=\"_text\">${this.options.today}</span>\n            </button>`;\n        const html_btn_clear = `\n            <button type=\"button\" class=\"_btn _clear\" title=\"${this.options.clear}\">\n                <span class=\"_icon\"/>\n                <span class=\"_text\">${this.options.clear}</span>\n            </button>`;\n\n        el_wrapper.innerHTML = `\n            <input type=\"date\" placeholder=\"YYYY-MM-DD\" value=\"${date_value}\" />\n            <input type=\"time\" placeholder=\"hh:mm\" value=\"${time_value}\" />\n            ${this.options.today ? html_btn_now : \"\"}\n            ${this.options.clear ? html_btn_clear : \"\"}\n        `;\n\n        this.el_time = el_wrapper.querySelector(\"input[type=time]\");\n        this.el_time.addEventListener(\"change\", () => this.update());\n\n        this.el_date = el_wrapper.querySelector(\"input[type=date]\");\n        this.el_date.addEventListener(\"change\", () => {\n            if (!this.el_time.value) {\n                // Set time on date change, if time was empty.\n                this.el_time.value = this.isotime();\n            }\n            this.update();\n        });\n\n        const date_options = {\n            behavior: \"native\",\n            format: this.options.format,\n            weekNumbers: this.options.weekNumbers,\n            firstDay: this.options.firstDay,\n        };\n        await DatePicker.init(this.el_date, date_options);\n\n        if (this.options.today) {\n            const btn_now = el_wrapper.querySelector(\"._btn._now\");\n            btn_now.addEventListener(\"click\", (e) => {\n                e.preventDefault();\n                this.el_date.value = this.isodate();\n                this.el_time.value = this.isotime();\n                this.update();\n            });\n        }\n\n        if (this.options.clear) {\n            const btn_clear = el_wrapper.querySelector(\"._btn._clear\");\n            btn_clear.addEventListener(\"click\", (e) => {\n                e.preventDefault();\n                this.el_date.value = \"\";\n                this.el_time.value = \"\";\n                this.update();\n            });\n        }\n\n        // TODO: timezone\n        el.parentNode.insertBefore(el_wrapper, el);\n    },\n\n    update() {\n        if (this.el_date.value && this.el_time.value) {\n            this.el.value = `${this.el_date.value}T${this.el_time.value}`;\n        } else {\n            this.el.value = \"\";\n        }\n        this.el.dispatchEvent(new Event(\"change\", { bubbles: true, cancelable: true }));\n    },\n\n    isodate() {\n        const now = new Date();\n        return now.toISOString().substr(0, 10);\n    },\n\n    isotime() {\n        const now = new Date();\n        return now.toTimeString().substr(0, 5);\n    },\n});\n","import $ from \"jquery\";\nimport Base from \"../../core/base\";\nimport utils from \"../../core/utils\";\nimport logging from \"../../core/logging\";\nimport Parser from \"../../core/parser\";\n\nconst log = logging.getLogger(\"depends\");\n\nexport const parser = new Parser(\"depends\");\nparser.addArgument(\"condition\");\nparser.addArgument(\"action\", \"show\", [\"show\", \"enable\", \"both\"]);\nparser.addArgument(\"transition\", \"none\", [\"none\", \"css\", \"fade\", \"slide\"]);\nparser.addArgument(\"effect-duration\", \"fast\");\nparser.addArgument(\"effect-easing\", \"swing\");\n\nexport default Base.extend({\n    name: \"depends\",\n    trigger: \".pat-depends\",\n    jquery_plugin: true,\n\n    async init($el, opts) {\n        const DependsHandler = (await import(\"../../lib/dependshandler\")).default; // prettier-ignore\n\n        const dependent = this.$el[0];\n        const options = parser.parse(this.$el, opts);\n        this.$modal = this.$el.parents(\".pat-modal\");\n\n        let handler;\n        try {\n            handler = new DependsHandler(this.$el, options.condition);\n        } catch (e) {\n            log.error(\"Invalid condition: \" + e.message, dependent);\n            return;\n        }\n\n        let state = handler.evaluate();\n        switch (options.action) {\n            case \"show\":\n                utils.hideOrShow($el, state, options, this.name);\n                this.updateModal();\n                break;\n            case \"enable\":\n                if (state) this.enable();\n                else this.disable();\n                break;\n            case \"both\":\n                if (state) {\n                    utils.hideOrShow($el, state, options, this.name);\n                    this.updateModal();\n                    this.enable();\n                } else {\n                    utils.hideOrShow($el, state, options, this.name);\n                    this.updateModal();\n                    this.disable();\n                }\n                break;\n        }\n\n        const data = {\n            handler: handler,\n            options: options,\n            dependent: dependent,\n        };\n\n        for (let input of handler.getAllInputs()) {\n            if (input.form) {\n                let $form = $(input.form);\n                let dependents = $form.data(\"patDepends.dependents\");\n                if (!dependents) {\n                    dependents = [data];\n                    $form.on(\"reset.pat-depends\", () => this.onReset);\n                } else if (dependents.indexOf(data) === -1) dependents.push(data);\n                $form.data(\"patDepends.dependents\", dependents);\n            }\n            $(input).on(\"change.pat-depends\", null, data, this.onChange.bind(this));\n            $(input).on(\"keyup.pat-depends\", null, data, this.onChange.bind(this));\n        }\n    },\n\n    async onReset(event) {\n        const dependents = $(event.target).data(\"patDepends.dependents\");\n        await utils.timeout(50);\n        for (let dependent of dependents) {\n            event.data = dependent;\n            this.onChange(event);\n        }\n    },\n\n    updateModal() {\n        // If we're in a modal, make sure that it gets resized.\n        if (this.$modal.length) {\n            $(document).trigger(\"pat-update\", { pattern: \"depends\" });\n        }\n    },\n\n    enable() {\n        if (this.$el.is(\":input\")) {\n            this.$el[0].disabled = null;\n        } else if (this.$el.is(\"a\")) {\n            this.$el.off(\"click.patternDepends\");\n        }\n        this.$el.removeClass(\"disabled\");\n        this.$el.trigger(\"pat-update\", {\n            pattern: \"depends\",\n            action: \"attribute-changed\",\n            dom: this.$el[0],\n            enabled: true,\n        });\n    },\n\n    disable() {\n        if (this.$el.is(\":input\")) {\n            this.$el[0].disabled = \"disabled\";\n        } else if (this.$el.is(\"a\")) {\n            this.$el.on(\"click.patternDepends\", (e) => e.preventDefault());\n        }\n        this.$el.addClass(\"disabled\");\n        this.$el.trigger(\"pat-update\", {\n            pattern: \"depends\",\n            action: \"attribute-changed\",\n            dom: this.$el[0],\n            enabled: false,\n        });\n    },\n\n    onChange(event) {\n        const handler = event.data.handler;\n        const options = event.data.options;\n        const dependent = event.data.dependent;\n        const $depdendent = $(dependent);\n        const state = handler.evaluate();\n\n        switch (options.action) {\n            case \"show\":\n                utils.hideOrShow($depdendent, state, options, this.name);\n                this.updateModal();\n                break;\n            case \"enable\":\n                if (state) {\n                    this.enable();\n                } else {\n                    this.disable();\n                }\n                break;\n            case \"both\":\n                utils.hideOrShow($depdendent, state, options, this.name);\n                this.updateModal();\n                if (state) {\n                    this.enable();\n                } else {\n                    this.disable();\n                }\n                break;\n        }\n    },\n});\n","import Base from \"../../core/base\";\nimport Parser from \"../../core/parser\";\nimport dom from \"../../core/dom\";\nimport logging from \"../../core/logging\";\nimport utils from \"../../core/utils\";\n\n// Lazy loading modules.\nlet Moment;\n\nconst log = logging.getLogger(\"pat-display-time\");\n\nexport const parser = new Parser(\"display-time\");\n// input datetime options\nparser.add_argument(\"format\", \"\");\nparser.add_argument(\"locale\", null);\nparser.add_argument(\"strict\", false);\n// output options\nparser.add_argument(\"from-now\", false);\nparser.add_argument(\"no-suffix\", false);\nparser.add_argument(\"output-format\", null);\n\nexport default Base.extend({\n    name: \"display-time\",\n    trigger: \".pat-display-time\",\n\n    async init() {\n        Moment = (await import(\"moment\")).default;\n\n        this.options = parser.parse(this.el, this.options);\n\n        let lang = this.options.locale || dom.acquire_attribute(this.el, \"lang\") || \"en\";\n        // we don't support any country-specific language variants, always use first 2 letters\n        lang = lang.substr(0, 2).toLowerCase();\n        try {\n            await import(`moment/locale/${lang}.js`);\n            Moment.locale(lang);\n            this.lang = lang;\n        } catch {\n            Moment.locale(\"en\");\n            this.lang = \"en\";\n        }\n        log.debug(`Moment.js language used: ${lang}.`);\n        this.format();\n    },\n\n    format() {\n        const datetime = this.el.getAttribute(\"datetime\");\n        let out = \"\";\n        if (datetime) {\n            const date = Moment(datetime, this.options.format, this.options.strict);\n            if (this.options.fromNow === true) {\n                if (utils.is_iso_date(datetime)) {\n                    // date-only case.\n                    const rtf = new Intl.RelativeTimeFormat(this.lang, {\n                        numeric: \"auto\",\n                    });\n                    const date_diff = utils.date_diff(date.toDate(), new Date());\n                    out = date.calendar(null, {\n                        // when the date is closer, specify custom values\n                        lastWeek: `[${rtf.format(date_diff, \"day\")}]`, // translates to \"x days ago\"\n                        lastDay: `[${rtf.format(-1, \"day\")}]`, // translates to \"yesterday\"\n                        sameDay: `[${rtf.format(0, \"day\")}]`, // translates to \"today\"\n                        nextDay: `[${rtf.format(1, \"day\")}]`, // translates to \"tomorrow\"\n                        nextWeek: \"dddd\", // translates to week day name\n                        // otherwise, just use Intl.RelativeTimeFormat.\n                        sameElse: () => {\n                            return `[${rtf.format(date_diff, \"day\")}]`;\n                        },\n                    });\n                } else {\n                    // datetime case.\n                    out = date.fromNow(this.options.noSuffix);\n                }\n            } else {\n                out = date.format(this.options.outputFormat || undefined);\n            }\n        }\n        this.el.textContent = out;\n    },\n});\n","/**\n * Patterns ajax - AJAX injection for forms and anchors\n *\n * Copyright 2012-2013 Florian Friesdorf\n * Copyright 2012-2013 Marko Durkovic\n */\nimport $ from \"jquery\";\nimport logging from \"../../core/logging\";\nimport Parser from \"../../core/parser\";\nimport registry from \"../../core/registry\";\n\nconst log = logging.getLogger(\"pat.ajax\");\n\nexport const parser = new Parser(\"ajax\");\nparser.addArgument(\"accept\", \"text/html\");\nparser.addArgument(\"url\", function ($el) {\n    return (\n        $el.is(\"a\") ? $el.attr(\"href\") : $el.is(\"form\") ? $el.attr(\"action\") : \"\"\n    ).split(\"#\")[0];\n});\nparser.addArgument(\"browser-cache\", \"no-cache\", [\"cache\", \"no-cache\"]); // Cache ajax requests\n\nconst xhrCount = {};\nxhrCount.get = function (a) {\n    return this[a] !== undefined ? this[a] : 0;\n};\nxhrCount.inc = function (a) {\n    this[a] = this.get(a) + 1;\n    return this.get(a);\n};\n\nconst _ = {\n    name: \"ajax\",\n    trigger: \".pat-ajax\",\n    parser: parser,\n    init($el) {\n        $el.off(\".pat-ajax\");\n        $el.filter(\"a\").on(\"click.pat-ajax\", _.onTriggerEvents);\n        $el.filter(\"form\")\n            .on(\"submit.pat-ajax\", _.onTriggerEvents)\n            .on(\"click.pat-ajax\", \"[type=submit]\", _.onClickSubmit);\n        $el.filter(\":not(form,a)\").each(function () {\n            log.warn(\"Unsupported element:\", this);\n        });\n        return $el;\n    },\n    destroy($el) {\n        $el.off(\".pat-ajax\");\n    },\n    onClickSubmit(event) {\n        const el = event.target;\n        const form = el.closest(\"form\");\n        const data = {};\n        if (el.name) {\n            data[el.name] = el.value;\n        }\n        $(form).data(\"pat-ajax.clicked-data\", data);\n    },\n    onTriggerEvents(event) {\n        if (event) {\n            event.preventDefault();\n        }\n        _.request($(this));\n    },\n    request($el, opts) {\n        return $el.each(function () {\n            _._request($(this), opts);\n        });\n    },\n    _request($el, opts) {\n        const cfg = _.parser.parse($el, opts);\n        const onError = function (jqxhr, status, error) {\n            // error can also stem from a javascript\n            // exception, not only errors described in the\n            // jqxhr.\n            log.error(\"load error for \" + cfg.url + \":\", error, jqxhr);\n            $el.trigger({\n                type: \"pat-ajax-error\",\n                jqxhr: jqxhr,\n            });\n        };\n        const seqNumber = xhrCount.inc(cfg.url);\n        const onSuccess = function (data, status, jqxhr) {\n            log.debug(\"success: jqxhr:\", jqxhr);\n            if (seqNumber === xhrCount.get(cfg.url)) {\n                // if this url is requested multiple time, only return the last result\n                $el.trigger({\n                    type: \"pat-ajax-success\",\n                    jqxhr: jqxhr,\n                });\n            } else {\n                // ignore\n            }\n        };\n        const temp = $el.data(\"pat-ajax.clicked-data\");\n        const clickedData = temp ? $.param(temp) : \"\";\n        const args = {\n            context: $el,\n            data: [$el.serialize(), clickedData].filter(Boolean).join(\"&\"),\n            headers: {},\n            url: cfg.url,\n            method: $el.attr(\"method\") ? $el.attr(\"method\") : \"GET\",\n            cache: cfg.browserCache === \"cache\" ? true : false,\n        };\n\n        if (cfg.accept) {\n            args.headers.Accept = cfg.accept;\n        }\n\n        if (\n            $el.is(\"form\") &&\n            $el.attr(\"method\") &&\n            $el.attr(\"method\").toUpperCase() == \"POST\"\n        ) {\n            const formdata = new FormData($el[0]);\n            for (const key in temp) {\n                formdata.append(key, temp[key]);\n            }\n            args[\"method\"] = \"POST\";\n            args[\"data\"] = formdata;\n            args[\"cache\"] = false;\n            args[\"contentType\"] = false;\n            args[\"processData\"] = false;\n            args[\"type\"] = \"POST\";\n        }\n\n        $el.removeData(\"pat-ajax.clicked-data\");\n        log.debug(\"request:\", args, $el[0]);\n\n        // Make it happen\n        const ajax_deferred = $.ajax(args);\n\n        if (ajax_deferred) ajax_deferred.done(onSuccess).fail(onError);\n    },\n};\n\nregistry.register(_);\n\nexport default _;\n","import \"../../core/jquery-ext\"; // for :scrollable for autoLoading-visible\nimport $ from \"jquery\";\nimport ajax from \"../ajax/ajax\";\nimport dom from \"../../core/dom\";\nimport events from \"../../core/events\";\nimport logging from \"../../core/logging\";\nimport Parser from \"../../core/parser\";\nimport registry from \"../../core/registry\";\nimport utils from \"../../core/utils\";\n\nconst log = logging.getLogger(\"pat.inject\");\n//log.setLevel(logging.Level.DEBUG);\n\nconst TEXT_NODE = 3;\nconst COMMENT_NODE = 8;\n\nexport const parser = new Parser(\"inject\");\nparser.addArgument(\"default-selector\");\nparser.addArgument(\"target\");\nparser.addArgument(\"data-type\", \"html\");\nparser.addArgument(\"next-href\");\nparser.addArgument(\"source\");\nparser.addArgument(\"trigger\", \"default\", [\n    \"default\",\n    \"autoload\",\n    \"autoload-visible\",\n    \"idle\",\n]);\nparser.addArgument(\"delay\"); // only used in autoload\nparser.addArgument(\"browser-cache\", \"no-cache\", [\"cache\", \"no-cache\"]); // Cache ajax requests. Pass to pat-ajax.\nparser.addArgument(\"confirm\", \"class\", [\"never\", \"always\", \"form-data\", \"class\"]);\nparser.addArgument(\"confirm-message\", \"Are you sure you want to leave this page?\");\nparser.addArgument(\"hooks\", [], [\"raptor\"], true); // After injection, pat-inject will trigger an event for each hook: pat-inject-hook-$(hook)\nparser.addArgument(\"loading-class\", \"injecting\"); // Add a class to the target while content is still loading.\nparser.addArgument(\"executing-class\", \"executing\"); // Add a class to the element while content is still loading.\nparser.addArgument(\"executed-class\", \"executed\"); // Add a class to the element when content is loaded.\nparser.addArgument(\"class\"); // Add a class to the injected content.\nparser.addArgument(\"history\", \"none\", [\"none\", \"record\"]);\nparser.addArgument(\"push-marker\");\nparser.addArgument(\"scroll\");\n// XXX: this should not be here but the parser would bail on\n// unknown parameters and expand/collapsible need to pass the url\n// to us\nparser.addArgument(\"url\");\n\nconst inject = {\n    name: \"inject\",\n    trigger:\n        \".raptor-ui .ui-button.pat-inject, a.pat-inject, form.pat-inject, .pat-subform.pat-inject\",\n    parser: parser,\n\n    init($el, opts) {\n        const cfgs = this.extractConfig($el, opts);\n        if (cfgs.some((e) => e.history === \"record\") && !(\"pushState\" in history)) {\n            // if the injection shall add a history entry and HTML5 pushState\n            // is missing, then don't initialize the injection.\n            return $el;\n        }\n        $el.data(\"pat-inject\", cfgs);\n\n        if (cfgs[0].nextHref && cfgs[0].nextHref.indexOf(\"#\") === 0) {\n            // In case the next href is an anchor, and it already\n            // exists in the page, we do not activate the injection\n            // but instead just change the anchors href.\n\n            // XXX: This is used in only one project for linked\n            // fullcalendars, it's sanity is wonky and we should\n            // probably solve it differently.\n            if ($el.is(\"a\") && $(cfgs[0].nextHref).length > 0) {\n                log.debug(\n                    \"Skipping as next href is anchor, which already exists\",\n                    cfgs[0].nextHref\n                );\n                // XXX: reconsider how the injection enters exhausted state\n                return $el.attr({\n                    href: (window.location.href.split(\"#\")[0] || \"\") + cfgs[0].nextHref,\n                });\n            }\n        }\n        if (cfgs[0].pushMarker) {\n            $(\"body\").on(\"push\", (event, data) => {\n                log.debug(\"received push message: \" + data);\n                if (data == cfgs[0].pushMarker) {\n                    log.debug(\"re-injecting \" + data);\n                    this.onTrigger({ currentTarget: $el[0] });\n                }\n            });\n        }\n        if (cfgs[0].idleTrigger) {\n            this._initIdleTrigger($el, cfgs[0].idleTrigger);\n        } else {\n            switch (cfgs[0].trigger) {\n                case \"default\":\n                    cfgs.forEach((cfg) => {\n                        if (cfg.delay) {\n                            cfg.processDelay = cfg.delay;\n                        }\n                    });\n                    // setup event handlers\n                    if ($el.is(\"form\")) {\n                        $el.on(\"submit.pat-inject\", this.onTrigger.bind(this))\n                            .on(\"click.pat-inject\", \"[type=submit]\", ajax.onClickSubmit)\n                            .on(\n                                \"click.pat-inject\",\n                                \"[type=submit][formaction], [type=image][formaction]\",\n                                this.onFormActionSubmit.bind(this)\n                            );\n                    } else if ($el.is(\".pat-subform\")) {\n                        log.debug(\"Initializing subform with injection\");\n                    } else {\n                        $el.on(\"click.pat-inject\", this.onTrigger.bind(this));\n                    }\n                    break;\n                case \"autoload\":\n                    if (!cfgs[0].delay) {\n                        this.onTrigger({ currentTarget: $el[0] });\n                    } else {\n                        // generate UID\n                        const uid = Math.random().toString(36);\n                        $el.attr(\"data-pat-inject-uid\", uid);\n\n                        // function to trigger the autoload and mark as triggered\n                        const delayed_trigger = (uid_) => {\n                            // Check if the element has been removed from the dom\n                            const still_there = $(\n                                \"[data-pat-inject-uid='\" + uid_ + \"']\"\n                            );\n                            if (still_there.length == 0) return false;\n\n                            $el.data(\"pat-inject-autoloaded\", true);\n                            this.onTrigger({ currentTarget: $el[0] });\n                            return true;\n                        };\n                        window.setTimeout(\n                            delayed_trigger.bind(null, uid),\n                            cfgs[0].delay\n                        );\n                    }\n                    break;\n                case \"autoload-visible\":\n                    this._initAutoloadVisible($el, cfgs);\n                    break;\n                case \"idle\":\n                    this._initIdleTrigger($el, cfgs[0].delay);\n                    break;\n            }\n        }\n\n        log.debug(\"initialised:\", $el);\n        return $el;\n    },\n\n    destroy($el) {\n        $el.off(\".pat-inject\");\n        $el.data(\"pat-inject\", null);\n        return $el;\n    },\n\n    onTrigger(e) {\n        /* Injection has been triggered, either via form submission or a\n         * link has been clicked.\n         */\n        const $el = $(e.currentTarget);\n        const cfgs = $el.data(\"pat-inject\");\n        if ($el.is(\"form\")) {\n            $(cfgs).each((i, v) => {\n                v.params = $.param($el.serializeArray());\n            });\n        }\n        e.preventDefault && e.preventDefault();\n        $el.trigger(\"patterns-inject-triggered\");\n        this.execute(cfgs, $el);\n    },\n\n    onFormActionSubmit(e) {\n        ajax.onClickSubmit(e); // make sure the submitting button is sent with the form\n\n        const $button = $(e.target);\n        const formaction = $button.attr(\"formaction\");\n        const $form = $button.parents(\".pat-inject\").first();\n        const opts = {\n            url: formaction,\n        };\n        const $cfg_node = $button.closest(\"[data-pat-inject]\");\n        const cfgs = this.extractConfig($cfg_node, opts);\n\n        $(cfgs).each((i, v) => {\n            v.params = $.param($form.serializeArray());\n        });\n\n        e.preventDefault();\n        $form.trigger(\"patterns-inject-triggered\");\n        this.execute(cfgs, $form);\n    },\n\n    submitSubform($sub) {\n        /* This method is called from pat-subform\n         */\n        const $el = $sub.parents(\"form\");\n        const cfgs = $sub.data(\"pat-inject\");\n\n        // store the params of the subform in the config, to be used by history\n        $(cfgs).each((i, v) => {\n            v.params = $.param($sub.serializeArray());\n        });\n\n        try {\n            $el.trigger(\"patterns-inject-triggered\");\n        } catch (e) {\n            log.error(\"patterns-inject-triggered\", e);\n        }\n        this.execute(cfgs, $el);\n    },\n\n    extractConfig($el, opts) {\n        opts = $.extend({}, opts);\n\n        const cfgs = parser.parse($el, opts, true);\n        cfgs.forEach((cfg) => {\n            cfg.$context = $el;\n            // opts and cfg have priority, fall back to href/action\n            cfg.url =\n                opts.url ||\n                cfg.url ||\n                $el.attr(\"href\") ||\n                $el.attr(\"action\") ||\n                $el.parents(\"form\").attr(\"action\") ||\n                \"\";\n\n            // separate selector from url\n            const urlparts = cfg.url.split(\"#\");\n            cfg.url = urlparts[0];\n\n            if (urlparts.length > 2) {\n                log.warn(\"Ignoring additional source ids:\", urlparts.slice(2));\n            }\n\n            if (!cfg.defaultSelector) {\n                // if no selector, check for selector as part of original url\n                cfg.defaultSelector = (urlparts[1] && \"#\" + urlparts[1]) || \"body\";\n            }\n            if (cfg.delay) {\n                try {\n                    cfg.delay = utils.parseTime(cfg.delay);\n                } catch (e) {\n                    log.warn(\"Invalid delay value: \", cfg.delay);\n                    cfg.delay = null;\n                }\n            }\n            cfg.processDelay = 0;\n        });\n        return cfgs;\n    },\n\n    elementIsDirty(m) {\n        /* Check whether the passed in form element contains a value.\n         */\n        const data = $.map(m.find(\":input:not(select)\"), (i) => {\n            const val = $(i).val();\n            return Boolean(val) && val !== $(i).attr(\"placeholder\");\n        });\n        return $.inArray(true, data) !== -1;\n    },\n\n    askForConfirmation(cfgs) {\n        /* If configured to do so, show a confirmation dialog to the user.\n         * This is done before attempting to perform injection.\n         */\n        let should_confirm = false;\n        let message;\n\n        for (const cfg of cfgs) {\n            let _confirm = false;\n            if (cfg.confirm == \"always\") {\n                _confirm = true;\n            } else if (\n                cfg.confirm === \"form-data\" &&\n                cfg.target &&\n                cfg.target !== \"none\"\n            ) {\n                _confirm = this.elementIsDirty(cfg.$target);\n            } else if (cfg.confirm === \"class\" && cfg.target && cfg.target !== \"none\") {\n                _confirm = cfg.$target.hasClass(\"is-dirty\");\n            }\n            if (_confirm) {\n                should_confirm = true;\n                message = cfg.confirmMessage;\n            }\n        }\n        if (should_confirm) {\n            if (!window.confirm(message)) {\n                return false;\n            }\n        }\n        return true;\n    },\n\n    ensureTarget(cfg) {\n        /* Make sure that a target element exists and that it's assigned to\n         * cfg.$target.\n         */\n        // make sure target exist\n        if (cfg.target === \"none\") {\n            // special case, we don't want to inject anything\n            return true;\n        }\n        cfg.$target =\n            cfg.$target || (cfg.target === \"self\" ? cfg.$context : $(cfg.target));\n        if (cfg.$target.length === 0) {\n            if (!cfg.target) {\n                log.error(\"Need target selector\", cfg);\n                return false;\n            }\n            cfg.$target = this.createTarget(cfg.target);\n            cfg.$injected = cfg.$target;\n        }\n        return true;\n    },\n\n    verifySingleConfig(url, cfg) {\n        /* Verify one of potentially multiple configs (i.e. argument lists).\n         *\n         * Extract modifiers such as ::element or ::after.\n         * Ensure that a target element exists.\n         */\n        if (cfg.url !== url) {\n            // in case of multi-injection, all injections need to use\n            // the same url\n            log.error(\"Unsupported different urls for multi-inject\");\n            return false;\n        }\n        // defaults\n        cfg.source = cfg.source || cfg.defaultSelector;\n        cfg.target = cfg.target || cfg.defaultSelector;\n\n        if (!this.extractModifiers(cfg)) {\n            return false;\n        }\n        if (!this.ensureTarget(cfg)) {\n            return false;\n        }\n        this.listenForFormReset(cfg);\n        return true;\n    },\n\n    verifyConfig(cfgs) {\n        /* Verify and post-process all the configurations.\n         * Each \"config\" is an arguments list separated by the &&\n         * combination operator.\n         *\n         * In case of multi-injection, only one URL is allowed, which\n         * should be specified in the first config (i.e. arguments list).\n         *\n         * Verification for each cfg in the array needs to succeed.\n         */\n        return cfgs.every((cfg) => this.verifySingleConfig(cfgs[0].url, cfg));\n    },\n\n    listenForFormReset(cfg) {\n        /* if pat-inject is used to populate target in some form and when\n         * Cancel button is pressed (this triggers reset event on the\n         * form) you would expect to populate with initial placeholder\n         */\n        if (cfg.target === \"none\")\n            // Special case, we don't want to display any return value.\n            return;\n        const $form = cfg.$target.parents(\"form\");\n        if ($form.length !== 0 && cfg.$target.data(\"initial-value\") === undefined) {\n            cfg.$target.data(\"initial-value\", cfg.$target.html());\n            $form.on(\"reset\", () => {\n                cfg.$target.html(cfg.$target.data(\"initial-value\"));\n            });\n        }\n    },\n\n    extractModifiers(cfg) {\n        /* The user can add modifiers to the source and target arguments.\n         * Modifiers such as ::element, ::before and ::after.\n         * We identifiy and extract these modifiers here.\n         */\n        const source_re = /^(.*?)(::element)?$/;\n        const target_re = /^(.*?)(::element)?(::after|::before)?$/;\n        const source_match = source_re.exec(cfg.source);\n        const target_match = target_re.exec(cfg.target);\n\n        cfg.source = source_match[1];\n        cfg.sourceMod = source_match[2] ? \"element\" : \"content\";\n        cfg.target = target_match[1];\n        const targetMod = target_match[2] ? \"element\" : \"content\";\n        const targetPosition = (target_match[3] || \"::\").slice(2); // position relative to target\n\n        if (cfg.loadingClass) {\n            cfg.loadingClass += \" \" + cfg.loadingClass + \"-\" + targetMod;\n            if (targetPosition && cfg.loadingClass) {\n                cfg.loadingClass += \" \" + cfg.loadingClass + \"-\" + targetPosition;\n            }\n        }\n        cfg.action = targetMod + targetPosition;\n        // Once we start detecting illegal combinations, we'll\n        // return false in case of error\n        return true;\n    },\n\n    createTarget(selector) {\n        /* create a target that matches the selector\n         *\n         * XXX: so far we only support #target and create a div with\n         * that id appended to the body.\n         */\n        if (selector.slice(0, 1) !== \"#\") {\n            log.error(\"only id supported for non-existing target\");\n            return null;\n        }\n        const $target = $(\"<div />\").attr({ id: selector.slice(1) });\n        $(\"body\").append($target);\n        return $target;\n    },\n\n    _performInjection(target, $el, $source, cfg, trigger, title) {\n        /* Called after the XHR has succeeded and we have a new $source\n         * element to inject.\n         */\n        if (cfg.sourceMod === \"content\") {\n            $source = $source.contents();\n        }\n        let $src;\n        $src = $source.safeClone();\n        $src.findInclusive(\"img\").on(\"load\", (e) => {\n            $(e.currentTarget).trigger(\"pat-inject-content-loaded\");\n        });\n\n        const $injected = cfg.$injected || $src;\n        // Now the injection actually happens.\n        if (this._inject(trigger, $src, $(target), cfg)) {\n            // Update history\n            this._update_history(cfg, trigger, title);\n            // Post-injection\n            this._afterInjection($el, $injected, cfg);\n        }\n    },\n\n    _update_history(cfg, trigger, title) {\n        // History support. if subform is submitted, append form params\n        const glue = cfg.url.indexOf(\"?\") > -1 ? \"&\" : \"?\";\n        if (cfg.history === \"record\" && \"pushState\" in history) {\n            if (cfg.params) {\n                history.pushState(\n                    { url: cfg.url + glue + cfg.params },\n                    \"\",\n                    cfg.url + glue + cfg.params\n                );\n            } else {\n                history.pushState({ url: cfg.url }, \"\", cfg.url);\n            }\n            // Also inject title element if we have one\n            if (title)\n                this._inject(trigger, title, $(\"title\"), {\n                    action: \"element\",\n                });\n        }\n    },\n\n    _afterInjection($el, $injected, cfg) {\n        /* Set a class on the injected elements and fire the\n         * patterns-injected event.\n         */\n        $injected\n            .filter((idx, el_) => {\n                return el_.nodeType !== TEXT_NODE;\n            })\n            .data(\"pat-injected\", { origin: cfg.url });\n\n        if ($injected.length === 1 && $injected[0].nodeType == TEXT_NODE) {\n            // Only one element injected, and it was a text node.\n            // So we trigger \"patterns-injected\" on the parent.\n            // The event handler should check whether the\n            // injected element and the triggered element are\n            // the same.\n            $injected.parent().trigger(\"patterns-injected\", [cfg, $el[0], $injected[0]]);\n        } else {\n            $injected.each((idx, el_) => {\n                // patterns-injected event will be triggered for each injected (non-text) element.\n                if (el_.nodeType !== TEXT_NODE) {\n                    $(el_)\n                        .addClass(cfg[\"class\"])\n                        .trigger(\"patterns-injected\", [cfg, $el[0], el_]);\n                }\n            });\n        }\n\n        if (cfg.scroll && cfg.scroll !== \"none\") {\n            let scroll_container = cfg.$target.parents().addBack().filter(\":scrollable\");\n            scroll_container = scroll_container.length ? scroll_container[0] : window;\n\n            // default for scroll===top\n            let top = 0;\n            let left = 0;\n\n            if (cfg.scroll !== \"top\") {\n                const scroll_target =\n                    cfg.scroll === \"target\"\n                        ? cfg.$target[0]\n                        : $injected.filter(cfg.scroll)[0];\n\n                // Get the reference element to which against we calculate\n                // the relative position of the target.\n                // In case of a scroll container of window, we do not have\n                // getBoundingClientRect method, so get the body instead.\n                const scroll_container_ref =\n                    scroll_container === window ? document.body : scroll_container;\n\n                // Calculate absolute [] position difference between\n                // scroll_container and scroll_target.\n                // Substract the container's border from the scrolling\n                // value, as this one isn't respected by\n                // getBoundingClientRect [] and would lead to covered\n                // items [].\n                // ) so that it doesn't make a difference, if the element\n                // is below or above the scrolling container. We just need\n                // to know the absolute difference.\n                // ) Calculations are based from the viewport.\n                // ) See:\n                //      https://docs.microsoft.com/en-us/previous-versions//hh781509(v=vs.85)\n                //      https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect\n                left = Math.abs(\n                    scroll_target.getBoundingClientRect().left +\n                        scroll_container_ref.scrollLeft -\n                        scroll_container_ref.getBoundingClientRect().left -\n                        dom.get_css_value(\n                            scroll_container_ref,\n                            \"border-left-width\",\n                            true\n                        )\n                );\n                top = Math.abs(\n                    scroll_target.getBoundingClientRect().top +\n                        scroll_container_ref.scrollTop -\n                        scroll_container_ref.getBoundingClientRect().top -\n                        dom.get_css_value(scroll_container_ref, \"border-top-width\", true)\n                );\n            }\n            if (scroll_container === window) {\n                scroll_container.scrollTo(left, top);\n            } else {\n                scroll_container.scrollLeft = left;\n                scroll_container.scrollTop = top;\n            }\n        }\n\n        $el[0].dispatchEvent(\n            new Event(\"pat-inject-success\", { bubbles: true, cancelable: true })\n        );\n    },\n\n    async _onInjectSuccess($el, cfgs, ev) {\n        let data = ev?.jqxhr?.responseText;\n        if (!data) {\n            log.warn(\"No response content, aborting\", ev);\n            return;\n        }\n        if (cfgs[0].source === \"none\") {\n            // Special case, we want to call something, but we don't want to inject anything\n            data = \"\";\n        }\n        $.each(cfgs[0].hooks || [], (idx, hook) =>\n            $el.trigger(\"pat-inject-hook-\" + hook)\n        );\n        const sources$ = await this.callTypeHandler(cfgs[0].dataType, \"sources\", $el, [\n            cfgs,\n            data,\n            ev,\n        ]);\n        /* pick the title source for dedicated handling later\n          Title - if present - is always appended at the end. */\n        let title;\n        if (\n            sources$ &&\n            sources$[sources$.length - 1] &&\n            sources$[sources$.length - 1][0] &&\n            sources$[sources$.length - 1][0].nodeName == \"TITLE\"\n        ) {\n            title = sources$[sources$.length - 1];\n        }\n        cfgs.forEach((cfg, idx1) => {\n            const perform_inject = () => {\n                if (cfg.target !== \"none\")\n                    cfg.$target.each((idx2, target) => {\n                        this._performInjection(\n                            target,\n                            $el,\n                            sources$[idx1],\n                            cfg,\n                            ev.target,\n                            title\n                        );\n                    });\n            };\n            if (cfg.processDelay) {\n                setTimeout(() => perform_inject(), cfg.processDelay);\n            } else {\n                perform_inject();\n            }\n        });\n        if (cfgs[0].nextHref && $el.is(\"a\")) {\n            // In case next-href is specified the anchor's href will\n            // be set to it after the injection is triggered.\n            $el.attr({ href: cfgs[0].nextHref.replace(/&amp;/g, \"&\") });\n            this.destroy($el);\n        }\n        $el.off(\"pat-ajax-success.pat-inject\");\n        $el.off(\"pat-ajax-error.pat-inject\");\n    },\n\n    async _onInjectError($el, cfgs, event) {\n        let explanation = \"\";\n        const status = event.jqxhr.status;\n        const timestamp = new Date();\n        if (status % 100 == 4) {\n            explanation =\n                \"Sorry! We couldn't find the page to load. Please make a screenshot and send it to support. Thank you!\";\n        } else if (status % 100 == 5) {\n            explanation =\n                \"I am very sorry! There was an error at the server. Please make a screenshot and contact support. Thank you!\";\n        } else if (status == 0) {\n            explanation =\n                \"It seems, the server is down. Please make a screenshot and contact support. Thank you!\";\n        }\n\n        let error_page;\n        let error_page_fragment;\n        const url_params = new URLSearchParams(window.location.search);\n        if (url_params.get(\"pat-inject-errorhandler.off\") === null) {\n            // Prepare a error page to be injected into the document.\n\n            // Try to get a suitable error message from pre-configured error pages.\n            const error_page_url = document\n                ?.querySelector(`meta[name^=pat-inject-status-${status}]`)\n                ?.getAttribute(\"content\", false);\n            error_page_fragment = error_page_url?.split(\"#\")[1];\n            error_page_fragment = error_page_fragment ? `#${error_page_fragment}` : null;\n\n            if (error_page_fragment) {\n                error_page = document.createElement(\"html\");\n                error_page.innerHTML = event.jqxhr.responseText;\n                error_page = error_page.querySelector(error_page_fragment);\n            }\n\n            if (!error_page && error_page_url) {\n                try {\n                    const error_page_response = await fetch(error_page_url, {\n                        method: \"GET\",\n                    });\n                    error_page = document.createElement(\"html\");\n                    error_page.innerHTML = await error_page_response.text();\n                    error_page = error_page.querySelector(error_page_fragment || \"body\");\n                } catch {\n                    // fall back to standard error message and ignore.\n                }\n            }\n        }\n\n        // clean up\n        cfgs.forEach((cfg) => {\n            if (\"$injected\" in cfg) {\n                cfg.$injected.remove();\n            }\n            cfg.$target.removeClass(cfg.loadingClass);\n            $el.removeClass(cfg.executingClass);\n        });\n        $el.off(\"pat-ajax-success.pat-inject\");\n        $el.off(\"pat-ajax-error.pat-inject\");\n\n        if (error_page) {\n            const error_zone = document.querySelector(error_page_fragment || \"body\");\n            error_zone.innerHTML = error_page.innerHTML;\n            registry.scan(error_zone); // initialize any patterns in error page\n        } else {\n            const msg_attr = `${explanation} Status is ${status} ${event.jqxhr.statusText}, time was ${timestamp}. You can click to close this.`;\n            $(\"body\").attr(\"data-error-message\", msg_attr);\n            $(\"body\").on(\"click\", () => {\n                $(\"body\").removeAttr(\"data-error-message\");\n                window.location.href = window.location.href; // reload\n            });\n        }\n    },\n\n    execute(cfgs, $el) {\n        /* Actually execute the injection.\n         *\n         * Either by making an ajax request or by spoofing an ajax\n         * request when the content is readily available in the current page.\n         */\n        // get a kinda deep copy, we scribble on it\n        cfgs = cfgs.map((cfg) => $.extend({}, cfg));\n        if (!this.verifyConfig(cfgs)) {\n            return;\n        }\n        if (!this.askForConfirmation(cfgs)) {\n            return;\n        }\n        if ($el.data(\"pat-inject-triggered\")) {\n            // Prevent double triggers;\n            return;\n        }\n        $el.data(\"pat-inject-triggered\", true);\n\n        for (const cfg of cfgs) {\n            // Add a execute class on the pat-inject element.\n            if (cfg?.executingClass) {\n                $el[0].classList.add(cfg.executingClass);\n            }\n            // Add a loading class to the target.\n            // Can be used for loading-spinners.\n            if (cfg?.loadingClass && cfg?.target !== \"none\") {\n                cfg.$target.addClass(cfg.loadingClass);\n            }\n        }\n\n        $el.on(\n            \"pat-ajax-success.pat-inject\",\n            this._onInjectSuccess.bind(this, $el, cfgs)\n        );\n        $el.on(\"pat-ajax-error.pat-inject\", this._onInjectError.bind(this, $el, cfgs));\n        $el.on(\"pat-ajax-success.pat-inject pat-ajax-error.pat-inject\", () =>\n            $el.removeData(\"pat-inject-triggered\")\n        );\n\n        // Prevent closing the panel while injection is in progress.\n        let do_close_panel = false;\n        events.add_event_listener(\n            $el[0],\n            \"close-panel\",\n            \"pat-inject--close-panel\",\n            (e) => {\n                e.stopPropagation();\n                e.stopImmediatePropagation();\n                do_close_panel = true;\n            }\n        );\n        $el.on(\"pat-ajax-success.pat-inject\", async () => {\n            // Wait for the next tick to ensure that the close-panel listener\n            // is called before this one, even for non-async local injects.\n            await utils.timeout(1);\n            // Remove the close-panel event listener.\n            events.remove_event_listener($el[0], \"pat-inject--close-panel\");\n            // Only close the panel if a close-panel event was catched previously.\n            if (do_close_panel) {\n                do_close_panel = false;\n                // Re-trigger close-panel event if it was caught while injection was in progress.\n                $el[0].dispatchEvent(\n                    new Event(\"close-panel\", { bubbles: true, cancelable: true })\n                );\n            }\n        });\n\n        if (cfgs[0].url.length) {\n            ajax.request($el, {\n                \"url\": cfgs[0].url,\n                \"browser-cache\": cfgs[0].browserCache,\n            });\n        } else {\n            // If there is no url specified, then content is being fetched\n            // from the same page.\n            // No need to do an ajax request for this, so we spoof the ajax\n            // event.\n            $el.trigger({\n                type: \"pat-ajax-success\",\n                jqxhr: {\n                    responseText: $(\"body\").html(),\n                },\n            });\n        }\n    },\n\n    _inject(trigger, $source, $target, cfg) {\n        // action to jquery method mapping, except for \"content\"\n        // and \"element\"\n        const method = {\n            contentbefore: \"prepend\",\n            contentafter: \"append\",\n            elementbefore: \"before\",\n            elementafter: \"after\",\n        }[cfg.action];\n\n        if (cfg.source === \"none\") {\n            $target.replaceWith(\"\");\n            return true;\n        }\n        if ($source.length === 0) {\n            log.warn(\"Aborting injection, source not found:\", $source);\n            $(trigger).trigger(\"pat-inject-missingSource\", {\n                url: cfg.url,\n                selector: cfg.source,\n            });\n            return false;\n        }\n        if (cfg.target === \"none\")\n            // Special case. Don't do anything, we don't want any result\n            return true;\n        if ($target.length === 0) {\n            log.warn(\"Aborting injection, target not found:\", $target);\n            $(trigger).trigger(\"pat-inject-missingTarget\", {\n                selector: cfg.target,\n            });\n            return false;\n        }\n        if (cfg.action === \"content\") {\n            $target.empty().append($source);\n        } else if (cfg.action === \"element\") {\n            $target.replaceWith($source);\n        } else {\n            $target[method]($source);\n        }\n        return true;\n    },\n\n    _sourcesFromHtml(html, url, sources) {\n        const $html = this._parseRawHtml(html, url);\n        return sources.map((source) => {\n            if (source === \"body\") {\n                source = \"#__original_body\";\n            }\n            if (source === \"none\") {\n                return $(\"<!-- -->\");\n            }\n            const $source = $html.find(source);\n\n            if ($source.length === 0) {\n                if (source != \"title\") {\n                    log.warn(\"No source elements for selector:\", source, $html);\n                }\n            }\n\n            $source.find('a[href^=\"#\"]').each((idx, el_) => {\n                const href = el_.getAttribute(\"href\");\n                if (href.indexOf(\"#{1}\") !== -1) {\n                    // We ignore hrefs containing #{1} because they're not\n                    // valid and only applicable in the context of\n                    // pat-clone.\n                    return;\n                }\n                // Skip in-document links pointing to an id that is inside\n                // this fragment.\n                if (href.length === 1) {\n                    // Special case for top-of-page links\n                    el_.href = url;\n                } else if (!$source.find(href).length) {\n                    el_.href = url + href;\n                }\n            });\n            return $source;\n        });\n    },\n\n    _rebaseAttrs: {\n        A: \"href\",\n        FORM: \"action\",\n        IMG: \"data-pat-inject-rebase-src\",\n        OBJECT: \"data\",\n        SOURCE: \"data-pat-inject-rebase-src\",\n        VIDEO: \"data-pat-inject-rebase-src\",\n    },\n\n    _rebaseOptions: {\n        \"calendar\": [\"url\", \"event-sources\"],\n        \"collapsible\": [\"load-content\"],\n        \"date-picker\": [\"i18n\"],\n        \"datetime-picker\": [\"i18n\"],\n        \"inject\": [\"url\"],\n    },\n\n    _rebaseURL(base, url) {\n        if (url.indexOf(\"://\") !== -1 || url[0] === \"/\" || url.indexOf(\"data:\") === 0) {\n            return url;\n        }\n        base = new URL(base, window.location).href; // If base is relative make it absolute.\n        return base.slice(0, base.lastIndexOf(\"/\") + 1) + url;\n    },\n\n    _rebaseHTML(base, html) {\n        if (html === \"\") {\n            // Special case, source is none\n            return \"\";\n        }\n        const $page = $(\n            html.replace(/(\\s)(src\\s*)=/gi, '$1src=\"\" data-pat-inject-rebase-$2=').trim()\n        )\n            .wrapAll(\"<div>\")\n            .parent();\n\n        $page.find(Object.keys(this._rebaseAttrs).join(\",\")).each((idx, el_) => {\n            const $el_ = $(el_);\n            const attrName = this._rebaseAttrs[el_.tagName];\n            let value = $el_.attr(attrName);\n\n            if (\n                value &&\n                value.slice(0, 2) !== \"@@\" &&\n                value[0] !== \"#\" &&\n                value.slice(0, 7) !== \"mailto:\" &&\n                value.slice(0, 4) !== \"tel:\" &&\n                value.slice(0, 4) !== \"fax:\" &&\n                value.slice(0, 7) !== \"callto:\" &&\n                value.slice(0, 10) !== \"ts3server:\" &&\n                value.slice(0, 6) !== \"teams:\" &&\n                value.slice(0, 11) !== \"javascript:\"\n            ) {\n                value = this._rebaseURL(base, value);\n                $el_.attr(attrName, value);\n            }\n        });\n\n        for (const [pattern_name, opts] of Object.entries(this._rebaseOptions)) {\n            for (const el_ of dom.querySelectorAllAndMe(\n                $page[0],\n                `[data-pat-${pattern_name}]`\n            )) {\n                const pattern = registry.patterns?.[pattern_name];\n                const pattern_parser = pattern?.parser;\n                if (!pattern_parser) {\n                    continue;\n                }\n                // parse: no default options, possibly multiple configs, no grouping.\n                const options = pattern_parser.parse(el_, {}, true, false, false);\n                let changed = false;\n                for (const config of options) {\n                    for (const opt of opts) {\n                        const val = config[opt];\n                        if (!val) {\n                            continue;\n                        }\n                        changed = true;\n                        if (Array.isArray(val)) {\n                            config[opt] = val.map((it) => this._rebaseURL(base, it));\n                        } else {\n                            config[opt] = this._rebaseURL(base, val);\n                        }\n                    }\n                }\n                if (changed) {\n                    el_.setAttribute(\n                        `data-pat-${pattern_name}`,\n                        JSON.stringify(options.length === 1 ? options[0] : options)\n                    );\n                }\n            }\n        }\n\n        return $page\n            .html()\n            .replace(/src=\"\" data-pat-inject-rebase-/g, \"\")\n            .trim();\n    },\n\n    _parseRawHtml(html, url = \"\") {\n        // remove script tags and head and replace body by a div\n        const title = html.match(/\\<title\\>(.*)\\<\\/title\\>/);\n        let clean_html = html\n            .replace(/<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi, \"\")\n            .replace(/<head\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/head>/gi, \"\")\n            .replace(/<body([^>]*?)>/gi, '<div id=\"__original_body\">')\n            .replace(/<\\/body([^>]*?)>/gi, \"</div>\");\n        if (title && title.length == 2) {\n            clean_html = title[0] + clean_html;\n        }\n        try {\n            clean_html = this._rebaseHTML(url, clean_html);\n        } catch (e) {\n            log.error(\"Error rebasing urls\", e);\n        }\n        const $html = $(\"<div/>\").html(clean_html);\n        if ($html.children().length === 0) {\n            log.warn(\"Parsing html resulted in empty jquery object:\", clean_html);\n        }\n        return $html;\n    },\n\n    _initAutoloadVisible($el, cfgs) {\n        if ($el.data(\"pat-inject-autoloaded\")) {\n            // ignore executed autoloads\n            return false;\n        }\n\n        const el = $el[0];\n\n        // delay: default is 200ms to allow scrolling over and past autoload-visible elements without loading them.\n        const delay = cfgs[0].delay || 200;\n        log.debug(`Delay time: ${delay}`);\n\n        // function to trigger the autoload and mark as triggered\n        const trigger = (event) => {\n            if ($el.data(\"pat-inject-autoloaded\")) {\n                log.debug(`autoload-visible trigger skipped ${el}`);\n                return false;\n            }\n            $el.data(\"pat-inject-autoloaded\", true);\n            this.onTrigger({ currentTarget: el });\n            event && event.preventDefault();\n            log.debug(`autoload-visible trigger run ${el}`);\n            return true;\n        };\n\n        // Config see: https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API\n        const intersection_observer_config = {\n            threshold: 0, // If even one pixel is visible, the callback will be run.\n            root: null, // Root is browser viewport. If the element is visible to the user, the callback will be run.\n            margin: \"0px\", // No margins. The element is not preloaded.\n        };\n\n        let timeout_id = null;\n        const observer = new IntersectionObserver((entries) => {\n            for (const entry of entries) {\n                if (entry.isIntersecting) {\n                    // Run the callback after 200ms to prevent loading all\n                    // visible elements when scrolling over.\n                    timeout_id = window.setTimeout(() => {\n                        observer.disconnect(); // Stop observing loaded elements.\n                        trigger();\n                    }, delay);\n                    log.debug(`autoload-visible intersecting ${el}`);\n                } else {\n                    window.clearTimeout(timeout_id);\n                    log.debug(`autoload-visible not intersecting ${el}`);\n                }\n            }\n        }, intersection_observer_config);\n        observer.observe(el);\n    },\n\n    _initIdleTrigger($el, delay) {\n        // XXX TODO: handle item removed from DOM\n        const timeout = parseInt(delay, 10);\n        let timer;\n\n        const onTimeout = () => {\n            this.onTrigger({ currentTarget: $el[0] });\n            unsub();\n            clearTimeout(timer);\n        };\n\n        const onInteraction = utils.debounce(() => {\n            if (!document.body.contains($el[0])) {\n                unsub();\n                return;\n            }\n            clearTimeout(timer);\n            timer = setTimeout(onTimeout, timeout);\n        }, timeout);\n\n        const unsub = () => {\n            [\"scroll\", \"resize\"].forEach((e) =>\n                window.removeEventListener(e, onInteraction)\n            );\n            [\n                \"click\",\n                \"keypress\",\n                \"keyup\",\n                \"mousemove\",\n                \"touchstart\",\n                \"touchend\",\n            ].forEach((e) => document.removeEventListener(e, onInteraction));\n        };\n\n        onInteraction();\n\n        [\"scroll\", \"resize\"].forEach((e) => window.addEventListener(e, onInteraction));\n        [\"click\", \"keypress\", \"keyup\", \"mousemove\", \"touchstart\", \"touchend\"].forEach(\n            (e) => document.addEventListener(e, onInteraction)\n        );\n    },\n\n    // XXX: simple so far to see what the team thinks of the idea\n    registerTypeHandler(type, handler) {\n        this.handlers[type] = handler;\n    },\n\n    async callTypeHandler(type, fn, context, params) {\n        type = type || \"html\";\n        if (this.handlers[type] && $.isFunction(this.handlers[type][fn])) {\n            return await this.handlers[type][fn].bind(this)(...params);\n        } else {\n            return null;\n        }\n    },\n\n    handlers: {\n        html: {\n            sources(cfgs, data) {\n                const sources = cfgs.map((cfg) => cfg.source);\n                sources.push(\"title\");\n                return this._sourcesFromHtml(data, cfgs[0].url, sources);\n            },\n        },\n    },\n};\n\n$(document).on(\"patterns-injected.inject\", async (ev, cfg, trigger, injected) => {\n    /* Listen for the patterns-injected event.\n     *\n     * Remove the \"loading-class\" classes from all injection targets and\n     * then scan the injected content for new patterns.\n     */\n    if (cfg && cfg.skipPatInjectHandler) {\n        // Allow skipping this handler but still have other handlers in other\n        // patterns listen to ``patterns-injected``.\n        return;\n    }\n    if (cfg) {\n        cfg.$target.removeClass(cfg.loadingClass);\n        // Remove the executing class, add the executed class to the element with pat.inject on it.\n        $(trigger).removeClass(cfg.executingClass).addClass(cfg.executedClass);\n    }\n    if (injected.nodeType !== TEXT_NODE && injected.nodeType !== COMMENT_NODE) {\n        registry.scan(injected, null, { type: \"injection\", element: trigger });\n        $(injected).trigger(\"patterns-injected-scanned\");\n\n        await utils.timeout(10); // Wait a bit before dispatching next event.\n        injected.dispatchEvent(\n            new CustomEvent(\"patterns-injected-delayed\", {\n                bubbles: true,\n                cancelable: true,\n                detail: {\n                    injected: injected,\n                },\n            })\n        );\n    }\n});\n\n$(window).on(\"popstate\", (event) => {\n    // popstate also triggers on traditional anchors\n    if (!event.originalEvent.state && \"replaceState\" in history) {\n        try {\n            history.replaceState(\"anchor\", \"\", document.location.href);\n        } catch (e) {\n            log.debug(e);\n        }\n        return;\n    }\n    // Not only change the URL, also reload the page.\n    window.location.reload();\n});\n\n// this entry ensures that the initally loaded page can be reached with\n// the back button\nif (\"replaceState\" in history) {\n    try {\n        history.replaceState(\"pageload\", \"\", document.location.href);\n    } catch (e) {\n        log.debug(e);\n    }\n}\n\nregistry.register(inject);\nexport default inject;\n","import Base from \"../../core/base\";\nimport events from \"../../core/events\";\nimport utils from \"../../core/utils\";\n\nexport default Base.extend({\n    name: \"close-panel\",\n    trigger: \".close-panel\",\n\n    init() {\n        // Close panel support for dialog panels\n        // Other modals are handled in pat-modal.\n        const dialog_panel = this.el.closest(\"dialog\");\n        if (dialog_panel) {\n            events.add_event_listener(\n                dialog_panel,\n                \"close-panel\",\n                \"close-panel--dialog\",\n                () => {\n                    dialog_panel.close();\n                }\n            );\n        }\n\n        this.el.addEventListener(\"click\", async (e) => {\n            await utils.timeout(0); // Wait for other patterns, like pat-validation.\n\n            if (\n                e.target.matches(\"[type=submit], button:not([type=button])\") &&\n                this.el.closest(\"form\")?.checkValidity() === false\n            ) {\n                // Prevent closing an invalid form when submitting.\n                return;\n            }\n\n            this.el.dispatchEvent(\n                new Event(\"close-panel\", { bubbles: true, cancelable: true })\n            );\n        });\n    },\n});\n","import $ from \"jquery\";\nimport { BasePattern } from \"../../core/basepattern\";\nimport logging from \"../../core/logging\";\nimport Parser from \"../../core/parser\";\nimport events from \"../../core/events\";\nimport registry from \"../../core/registry\";\nimport utils from \"../../core/utils\";\n\n// Initialize close-panel functionality.\nimport \"../close-panel/close-panel\";\n\nconst log = logging.getLogger(\"pat-tooltip\");\n\nexport const parser = new Parser(\"tooltip\");\nconst all_positions = [\n    \"tl\",\n    \"tm\",\n    \"tr\",\n    \"rt\",\n    \"rm\",\n    \"rb\",\n    \"br\",\n    \"bm\",\n    \"bl\",\n    \"lb\",\n    \"lm\",\n    \"lt\",\n];\nparser.addArgument(\"position-list\", [], all_positions, true);\nparser.addArgument(\"position-policy\", \"auto\", [\"auto\", \"force\"]);\nparser.addArgument(\"trigger\", \"click\", [\"click\", \"hover\", \"none\"]);\nparser.addArgument(\"source\", \"title\", [\"ajax\", \"content\", \"title\"]);\nparser.addArgument(\"ajax-data-type\", \"html\", [\"html\", \"markdown\"]);\nparser.addArgument(\"closing\", \"auto\", [\"auto\", \"sticky\", \"close-button\"]);\nparser.addArgument(\"delay\");\nparser.addArgument(\"mark-inactive\", true);\nparser.addArgument(\"class\");\nparser.addArgument(\"target\", \"body\");\nparser.addArgument(\"arrow-padding\", null);\nparser.addArgument(\"url\", null);\n\n// Tippy Lifecycle-hooks\n// See: https://tippyjs.bootcss.com/lifecycle-hooks/\n// onCreate\n// onTrigger\n// onShow\n// onMount\n// onShown\n// onUntrigger\n// onHide\n// onHidden\n//\n// onBeforeUpdate\n// onAfterUpdate\n// onDestroy\n\nclass Pattern extends BasePattern {\n    static name = \"tooltip\";\n    static trigger = \".pat-tooltip, .pat-tooltip-ng\";\n    static parser = parser;\n\n    tippy = null;\n\n    active_class = \"tooltip-active-hover\";\n    inactive_class = \"tooltip-inactive\";\n\n    async init() {\n        const el = this.el;\n\n        if (window.__patternslib_import_styles) {\n            import(\"tippy.js/dist/tippy.css\");\n        }\n        const Tippy = (await import(\"tippy.js\")).default;\n        this.tippy_options = this.parseOptionsForTippy(this.options);\n\n        const defaultProps = {\n            animation: false,\n            arrow: true,\n            //'delay': [0, 1800],\n            //'duration': [325, 275],\n            hideOnClick: this.options.closing === \"close-button\" ? false : true,\n            ignoreAttributes: true,\n            interactive: true,\n            onHide: this._onHide.bind(this),\n            onShow: this._onShow.bind(this),\n            trigger: \"click\",\n        };\n\n        Tippy.setDefaultProps(defaultProps);\n        this.tippy = new Tippy(el, this.tippy_options);\n\n        if (this.options.source === \"title\") {\n            // Remove ``title`` attribute when source is set to ``title`` to\n            // disable the browser's built-in tooltip feature\n            el.removeAttribute(\"title\");\n        }\n\n        if (this.options.trigger === \"click\" && this.options.source === \"ajax\") {\n            // prevent default action for \"click\" and \"mouseenter click\"\n            events.add_event_listener(\n                el,\n                \"click\",\n                \"pat-tooltip--click-prevent-default\",\n                (event) => {\n                    event.preventDefault();\n                    event.stopPropagation();\n                }\n            );\n        }\n\n        if (this.options.trigger === \"click\") {\n            this.active_class = \"tooltip-active-click\";\n        }\n        if (this.options.markInactive) {\n            // Initially mark as inactive\n            el.classList.add(this.inactive_class);\n        }\n    }\n\n    show() {\n        // Show this tooltip\n        this.tippy.show();\n    }\n\n    async hide() {\n        // Hide this tooltip\n        await utils.timeout(1); // wait a tick for event being processed by other handlers.\n        this.tippy.hide();\n    }\n\n    destroy() {\n        // Remove this tooltip\n        super.destroy(); // Unregister\n        this.tippy.destroy();\n    }\n\n    parseOptionsForTippy(opts) {\n        const placement = (pos) => {\n            // note that Cornelis needs the positioning to be the placement of the thingy on the bubble\n            // tippy though refers to positioning as the placement of the bubble relatively to the reference element\n            // so we invert the meaning below. It's intentional.\n            const primary = (pos0) =>\n                ({\n                    t: \"bottom\",\n                    r: \"left\",\n                    b: \"top\",\n                    l: \"right\",\n                }[pos0]);\n\n            const secondary = (pos1) =>\n                ({\n                    l: \"-start\",\n                    r: \"-end\",\n                    m: \"\",\n                    t: \"-start\",\n                    b: \"-end\",\n                }[pos1]);\n\n            return `${primary(pos[0])}${secondary(pos[1])}`;\n        };\n\n        const tippy_options = { popperOptions: { modifiers: [] } };\n\n        if (opts.arrowPadding !== null) {\n            tippy_options.popperOptions.modifiers.push({\n                name: \"arrow\",\n                options: {\n                    padding: parseInt(opts.arrowPadding, 10),\n                },\n            });\n        }\n\n        const parsers = {\n            position: () => {\n                if (!opts.position?.list?.length) {\n                    return;\n                }\n                tippy_options.placement = placement(opts.position.list[0]); // main position\n\n                const flip_options = {\n                    name: \"flip\",\n                    enabled: true,\n                };\n\n                if (opts.position.policy === \"force\") {\n                    flip_options.enabled = false;\n                } else if (opts.position.length > 1) {\n                    const fallbacks = opts.position.list.slice(1).map(placement);\n                    flip_options.fallbackPlacements = fallbacks;\n                }\n\n                tippy_options.popperOptions.modifiers.push(flip_options);\n            },\n\n            trigger() {\n                if (opts.trigger === \"hover\") {\n                    tippy_options.trigger = \"mouseenter focus\";\n                } else if (opts.trigger === \"none\") {\n                    tippy_options.trigger = \"manual\";\n                    tippy_options.hideOnClick = false;\n                }\n            },\n\n            source: () => {\n                let content;\n                if (opts.source === \"title\") {\n                    // Tooltip content from title attribute\n                    content = this.el.getAttribute(\"title\");\n                } else if (opts.source === \"content\") {\n                    // Tooltip content from trigger childs.\n                    content = this.el.innerHTML;\n                    tippy_options.allowHTML = true;\n                } else if (opts.source === \"ajax\") {\n                    // Tooltiop content from AJAX request.\n                    content = document.createElement(\"progress\");\n                    tippy_options.allowHTML = true;\n                }\n                tippy_options.content = content;\n            },\n\n            delay() {\n                if (opts.delay) {\n                    tippy_options.delay = [utils.parseTime(opts.delay), 0];\n                }\n            },\n\n            target: () => {\n                if (!opts.target) {\n                    return;\n                }\n                if (opts.target === \"parent\") {\n                    tippy_options.appendTo = \"parent\";\n                } else if (opts.target === \"body\") {\n                    tippy_options.appendTo = document.body;\n                } else {\n                    tippy_options.appendTo = document.querySelector(opts.target);\n                }\n            },\n        };\n\n        for (let arg in opts) {\n            switch (arg) {\n                case \"ajax-data-type\":\n                    arg = \"ajaxDataType\";\n                    break;\n                case \"mark-inactive\":\n                    arg = \"markInactive\";\n                    break;\n            }\n            parsers[arg] && parsers[arg](arg);\n        }\n\n        return tippy_options;\n    }\n\n    _initialize_content() {\n        // Initialize any other patterns.\n        registry.scan(this.tippy.popper);\n    }\n\n    async _onShow() {\n        const tippy_classes = [];\n\n        // Group DOM manipulations\n\n        if (this.options.class) {\n            tippy_classes.push(...this.options.class.split(\" \"));\n        }\n\n        // Add a generic non-tippy related class to identify the tooltip container\n        tippy_classes.push(\"tooltip-container\");\n\n        if (this.options.closing === \"close-button\") {\n            // First, remove previously automatically added close buttons.\n            // Otherwise we would end up adding another close button with every\n            // click on it.\n            for (const close_button of this.tippy.popper.querySelectorAll(\n                \".pat-tooltip--close-button\"\n            )) {\n                close_button.remove();\n            }\n\n            const close_button = document.createElement(\"button\");\n            close_button.setAttribute(\"class\", \"close-panel pat-tooltip--close-button\");\n            const content = this.tippy.popper.querySelector(\".tippy-content\");\n            content.parentNode.insertBefore(close_button, content);\n        }\n\n        // Store reference to method for closing panels on the tooltip element instance.\n        events.add_event_listener(\n            this.tippy.popper,\n            \"close-panel\",\n            \"pat-tooltip--close-panel\",\n            () => this.hide()\n        );\n\n        this.tippy.popper.classList.add(...tippy_classes);\n\n        if (this.options.markInactive) {\n            this.el.classList.remove(this.inactive_class);\n            this.el.classList.add(this.active_class);\n        }\n\n        if (this.options.closing !== \"auto\" && this.options.trigger === \"hover\") {\n            // no auto-close when hovering when closing mode is \"sticky\" or \"close-button\".\n            this.tippy.setProps({ trigger: \"click\" });\n        }\n\n        if (this.options.source === \"ajax\") {\n            await this._get_content();\n        }\n\n        // Notify parent patterns about injected content.\n        // Do not call pat-inject's handler, because all necessary\n        // initialization after injection is done here.\n        $(this.tippy.popper).trigger(\"patterns-injected\", [\n            { skipPatInjectHandler: true },\n            this.el,\n            this.tippy.popper,\n        ]);\n\n        this._initialize_content();\n    }\n\n    _onHide() {\n        if (this.options.markInactive) {\n            this.el.classList.remove(this.active_class);\n            this.el.classList.add(this.inactive_class);\n        }\n\n        if (this.options.closing !== \"auto\" && this.options.trigger === \"hover\") {\n            // re-set hover behavior\n            this.tippy.setProps({ trigger: \"mouseenter focus\" });\n        }\n\n        if (this.options.source === \"ajax\") {\n            this.tippy.setContent(document.createElement(\"progress\"));\n        }\n    }\n\n    async _get_content(url = this.options.url) {\n        let selector;\n        ({ url, selector } = this.get_url_parts(url || this.el.getAttribute(\"href\")));\n        let content;\n        if (url) {\n            // Tooltip from remote page.\n            const handler = this.data_type_handlers[this.options.ajaxDataType];\n            try {\n                // TODO: use pat-inject, once it supports async\n                const response = await fetch(url, {\n                    headers: {\n                        Accept: \"text/html,application/xhtml+xml,application/xml\",\n                    },\n                });\n                const text = await response.text();\n                content = await handler(text, url, selector);\n            } catch (e) {\n                log.error(\"Error on ajax request. ${e}\");\n            }\n        } else if (selector) {\n            // Tooltip content from current DOM tree.\n            content = document.querySelector(selector);\n            content = content?.innerHTML || undefined;\n        }\n        if (content) {\n            this.tippy.setContent(content);\n            await utils.timeout(1); // Wait a tick before forceUpdate. Might fail due to unset popperInstance.\n            this.tippy.popperInstance.forceUpdate(); // re-position tippy after content is known.\n        }\n    }\n\n    async get_content(url = this.options.url) {\n        // API method: _get_content + _initialize_content\n        await this._get_content(url);\n        this._initialize_content();\n    }\n\n    get_url_parts(href) {\n        // Return the URL and a CSS ID selector.\n        let url, selector, query;\n        if (!href) {\n            return { url, selector };\n        }\n        [url, selector] = href.split(\"#\");\n        if (selector) {\n            selector = `#${selector}`;\n            [selector, query] = selector.split(\"?\");\n        }\n        if (query) {\n            url = `${url}?${query}`;\n        }\n        return { url, selector };\n    }\n\n    static data_type_handlers = {\n        html(text, url, selector) {\n            let tmp = document.createElement(\"div\");\n            tmp.innerHTML = text;\n            if (selector) {\n                tmp = tmp.querySelector(selector);\n            }\n            return tmp?.innerHTML || \"\";\n        },\n\n        async markdown(text, url, selector) {\n            const Markdown = registry.patterns.markdown;\n            if (!Markdown) {\n                return text;\n            }\n\n            const instance = new Markdown($(\"<div/>\"));\n            await events.await_pattern_init(instance);\n\n            const cfg = { url };\n            if (selector) {\n                cfg.source = selector;\n            }\n\n            const ret = await instance.renderForInjection(cfg, text);\n            return ret[0];\n        },\n    };\n\n    static register_type_handler(type, handler) {\n        Pattern.data_type_handlers[type] = handler;\n    }\n\n    constructor(...args) {\n        super(...args);\n\n        this.register_type_handler = this.constructor.register_type_handler;\n        this.data_type_handlers = this.constructor.data_type_handlers;\n    }\n}\n\nregistry.register(Pattern);\nexport default Pattern;\nexport { Pattern };\n","// Patterns validate - Form vlidation\nimport \"../../core/polyfills\"; // SubmitEvent.submitter for Safari < 15.4 and jsDOM\nimport $ from \"jquery\";\nimport { BasePattern } from \"../../core/basepattern\";\nimport Parser from \"../../core/parser\";\nimport dom from \"../../core/dom\";\nimport events from \"../../core/events\";\nimport logging from \"../../core/logging\";\nimport utils from \"../../core/utils\";\nimport registry from \"../../core/registry\";\n\nconst logger = logging.getLogger(\"pat-validation\");\n//logger.setLevel(logging.Level.DEBUG);\n\nexport const parser = new Parser(\"validation\");\nparser.addArgument(\"disable-selector\", \"[type=submit], button:not([type=button])\"); // Elements which must be disabled if there are errors\nparser.addArgument(\"message-date\", \"\"); // \"This value must be a valid date\");\nparser.addArgument(\"message-datetime\", \"\"); // \"This value must be a valid date and time\");\nparser.addArgument(\"message-email\", \"\"); // \"This value must be a valid email address\");\nparser.addArgument(\"message-max\", \"\"); // \"This value must be less than or equal to %{count}\");\nparser.addArgument(\"message-min\", \"\"); // \"This value must be greater than or equal to %{count}\"); // prettier-ignore\nparser.addArgument(\"message-number\", \"\"); // \"This value must be a number\");\nparser.addArgument(\"message-required\", \"\"); // \"This field is required\");\nparser.addArgument(\"message-equality\", \"is not equal to %{attribute}.\");\nparser.addArgument(\"not-after\", null);\nparser.addArgument(\"not-before\", null);\nparser.addArgument(\"equality\", null);\nparser.addArgument(\"delay\", 100); // Delay before validation is done to avoid validating while typing.\n\n// BBB\n// TODO: deprecated. Will be removed with next major version.\nparser.addAlias(\"message-integer\", \"message-number\");\nparser.addArgument(\"error-template\");\n\nconst KEY_ERROR_EL = \"__patternslib__input__error__el\";\nconst KEY_ERROR_MSG = \"__patternslib__input__error__msg\";\n\nclass Pattern extends BasePattern {\n    static name = \"validation\";\n    static trigger = \"form.pat-validation\";\n    static parser = parser;\n\n    init() {\n        events.add_event_listener(\n            this.el,\n            \"submit\",\n            `pat-validation--submit--validator`,\n            (e) => {\n                // On submit, check all.\n                // Immediate, non-debounced check with submit. Otherwise submit\n                // is not cancelable.\n                for (const input of this.inputs) {\n                    logger.debug(\"Checking input for submit\", input, e);\n                    this.check_input({ input: input, event: e });\n                }\n            },\n            // Make sure this event handler is run early, in the capturing\n            // phase in order to be able to cancel later non-capturing submit\n            // events.\n            { capture: true }\n        );\n\n        this.initialize_inputs();\n        $(this.el).on(\"pat-update\", () => {\n            this.initialize_inputs();\n        });\n\n        // Set ``novalidate`` attribute to disable the browser's validation\n        // bubbles but not disable the validation API.\n        this.el.setAttribute(\"novalidate\", \"\");\n    }\n\n    initialize_inputs() {\n        this.inputs = [\n            ...this.el.querySelectorAll(\"input[name], select[name], textarea[name]\"),\n        ];\n        this.disabled_elements = [\n            ...this.el.querySelectorAll(this.options.disableSelector),\n        ];\n\n        for (const [cnt, input] of this.inputs.entries()) {\n            // Cancelable debouncer.\n            const debouncer = utils.debounce((e) => {\n                logger.debug(\"Checking input for event\", input, e);\n                this.check_input({ input: input, event: e });\n            }, this.options.delay);\n\n            events.add_event_listener(\n                input,\n                \"input\",\n                `pat-validation--input-${input.name}--${cnt}--validator`,\n                (e) => debouncer(e)\n            );\n            events.add_event_listener(\n                input,\n                \"change\",\n                `pat-validation--change-${input.name}--${cnt}--validator`,\n                (e) => debouncer(e)\n            );\n            events.add_event_listener(\n                input,\n                \"blur\",\n                `pat-validation--blur-${input.name}--${cnt}--validator`,\n                (e) => debouncer(e)\n            );\n        }\n    }\n\n    check_input({ input, event, stop = false }) {\n        if (input.disabled) {\n            // No need to check disabled inputs.\n            return;\n        }\n\n        // In any case, clear the custom validity first.\n        this.set_validity({ input: input, msg: \"\" });\n        const validity_state = input.validity;\n\n        if (event?.submitter?.hasAttribute(\"formnovalidate\")) {\n            // Do not submit when a button with ``formnovalidate`` was used.\n            return;\n        }\n\n        logger.debug(`\n            validity_state.badInput ${validity_state.badInput}\n            validity_state.customError ${validity_state.customError}\n            validity_state.patternMismatch ${validity_state.patternMismatch}\n            validity_state.rangeOverflow ${validity_state.rangeOverflow}\n            validity_state.rangeUnderflow ${validity_state.rangeUnderflow}\n            validity_state.stepMismatch ${validity_state.stepMismatch}\n            validity_state.tooLong ${validity_state.tooLong}\n            validity_state.tooShort ${validity_state.tooShort}\n            validity_state.typeMismatch ${validity_state.typeMismatch}\n            validity_state.valid ${validity_state.valid}\n            validity_state.valueMissing ${validity_state.valueMissing}\n        `);\n\n        const input_options = parser.parse(input);\n\n        if (validity_state.valid) {\n            // Custom error cases or no invalid state.\n\n            if (\n                input_options.equality &&\n                this.el.querySelector(`[name=${input_options.equality}]`)?.value !==\n                    input.value\n            ) {\n                const message =\n                    input_options.message.equality ||\n                    `The value is not equal to %{attribute}`;\n                this.set_validity({\n                    input: input,\n                    msg: message,\n                    attribute: input_options.equality,\n                });\n            } else if (input_options.not.after || input_options.not.before) {\n                const msg = input_options.message.date || input_options.message.datetime;\n                const msg_default_not_before = \"The date must be after %{attribute}\";\n                const msg_default_not_after = \"The date must be before %{attribute}\";\n\n                let not_after;\n                let not_after_el;\n                if (input_options.not.after) {\n                    if (utils.is_iso_date_time(input_options.not.after, true)) {\n                        not_after = new Date(input_options.not.after);\n                    } else {\n                        // Handle value as selector\n                        not_after_el = document.querySelector(input_options.not.after);\n                        not_after = not_after_el?.value\n                            ? new Date(not_after_el?.value)\n                            : undefined;\n                    }\n\n                    // Use null if no valid date.\n                    not_after = isNaN(not_after) ? null : not_after;\n                }\n\n                let not_before;\n                let not_before_el;\n                if (input_options.not.before) {\n                    if (utils.is_iso_date_time(input_options.not.before, true)) {\n                        not_before = new Date(input_options.not.before);\n                    } else {\n                        // Handle value as selector\n                        not_before_el = document.querySelector(input_options.not.before);\n                        not_before = not_before_el?.value\n                            ? new Date(not_before_el?.value)\n                            : undefined;\n                    }\n\n                    // Use null if no valid date.\n                    not_before = isNaN(not_before) ? null : not_before;\n                }\n\n                if (\n                    input.value &&\n                    utils.is_iso_date_time(input.value, true) &&\n                    !isNaN(new Date(input.value))\n                ) {\n                    // That's 1 valid date!\n                    const date = new Date(input.value);\n\n                    if (not_after && date > not_after) {\n                        let msg_attr;\n                        // Try to construct a meaningfull error message\n                        if (!not_after_el && input_options.not.after) {\n                            // fixed date case\n                            msg_attr = input_options.not.after;\n                        } else {\n                            // Get the label + other text content within the\n                            // label and replace all whitespace and newlines\n                            // with a single space.\n                            msg_attr = not_after_el?.labels?.[0]?.textContent.replace(\n                                /\\s\\s+/g, // replace all whitespace\n                                \" \" // with a single space\n                            );\n                            msg_attr = msg_attr || not_after_el.name;\n                        }\n                        this.set_validity({\n                            input: input,\n                            msg: msg || msg_default_not_after,\n                            attribute: msg_attr.trim(),\n                        });\n                    } else if (not_before && date < not_before) {\n                        let msg_attr;\n                        // Try to construct a meaningfull error message\n                        if (!not_before_el && input_options.not.before) {\n                            // fixed date case\n                            msg_attr = input_options.not.before;\n                        } else {\n                            // Get the label + other text content within the\n                            // label and replace all whitespace and newlines\n                            // with a single space.\n                            msg_attr = not_before_el?.labels?.[0]?.textContent.replace(\n                                /\\s\\s+/g, // replace all whitespace\n                                \" \" // with a single space\n                            );\n                            msg_attr = msg_attr || not_before_el.name;\n                        }\n                        this.set_validity({\n                            input: input,\n                            msg: msg || msg_default_not_before,\n                            attribute: msg_attr.trim(),\n                        });\n                    }\n                }\n\n                // always check the other input to clear/set errors\n                // do not re-check when stop is set to avoid infinite loops\n                if (!stop && not_after_el) {\n                    logger.debug(\"Check `not-after` input.\", not_after_el);\n                    this.check_input({ input: not_after_el, stop: true });\n                }\n                if (!stop && not_before_el) {\n                    logger.debug(\"Check `no-before` input.\", not_after_el);\n                    this.check_input({ input: not_before_el, stop: true });\n                }\n            }\n\n            if (!validity_state.customError) {\n                // No error to handle. Return.\n                this.remove_error(input, true);\n                return;\n            }\n        } else {\n            // Default error cases with custom messages.\n\n            if (validity_state.valueMissing && input_options.message.required) {\n                this.set_validity({ input: input, msg: input_options.message.required });\n            } else if (validity_state.rangeUnderflow && input_options.message.min) {\n                this.set_validity({\n                    input: input,\n                    msg: input_options.message.min,\n                    min: input.getAttribute(\"min\"),\n                });\n            } else if (validity_state.rangeOverflow && input_options.message.max) {\n                this.set_validity({\n                    input: input,\n                    msg: input_options.message.max,\n                    max: input.getAttribute(\"max\"),\n                });\n            } else if (\n                (validity_state.badInput || validity_state.stepMismatch) &&\n                input.type === \"number\" &&\n                input_options.message.number\n            ) {\n                this.set_validity({ input: input, msg: input_options.message.number });\n            } else if (\n                validity_state.typeMismatch &&\n                input.type === \"email\" &&\n                input_options.message.email\n            ) {\n                this.set_validity({ input: input, msg: input_options.message.email });\n            } else if (\n                validity_state.rangeUnderflow &&\n                input.type === \"date\" &&\n                input_options.message.date\n            ) {\n                this.set_validity({ input: input, msg: input_options.message.date });\n            } else if (\n                validity_state.rangeOverflow &&\n                input.type === \"date\" &&\n                input_options.message.date\n            ) {\n                this.set_validity({ input: input, msg: input_options.message.date });\n            } else if (\n                validity_state.rangeUnderflow &&\n                input.type === \"datetime\" &&\n                input_options.message.datetime\n            ) {\n                this.set_validity({ input: input, msg: input_options.message.datetime });\n            } else if (\n                validity_state.rangeOverflow &&\n                input.type === \"datetime\" &&\n                input_options.message.datetime\n            ) {\n                this.set_validity({ input: input, msg: input_options.message.datetime });\n            }\n        }\n\n        if (event?.type === \"submit\") {\n            // Do not submit in error case and prevent other handlers to take action.\n            event.preventDefault();\n            event.stopPropagation();\n            event.stopImmediatePropagation();\n        }\n        this.set_error_message(input);\n    }\n\n    set_validity({ input, msg, attribute = null, min = null, max = null }) {\n        // Replace some variables, as like validate.js\n        if (attribute) {\n            msg = msg.replace(/%{attribute}/g, attribute);\n        }\n        if (min) {\n            msg = msg.replace(/%{count}/g, min);\n        }\n        if (max) {\n            msg = msg.replace(/%{count}/g, max);\n        }\n        msg = msg.replace(/%{value}/g, JSON.stringify(input.value));\n\n        input.setCustomValidity(msg);\n        // Store the error message on the input.\n        // Hidden inputs do not participate in validation but we need this\n        // (e.g. styled date input).\n        input[KEY_ERROR_MSG] = msg;\n    }\n\n    remove_error(input, all_of_group = false) {\n        // Remove error message and related referencesfrom input.\n\n        let inputs = [input];\n        if (all_of_group) {\n            // Get all inputs with the same name - e.g. radio buttons, checkboxes.\n            inputs = this.inputs.filter((it) => it.name === input.name);\n        }\n        for (const it of inputs) {\n            const error_node = it[KEY_ERROR_EL];\n            it[KEY_ERROR_EL] = null;\n            error_node?.remove();\n        }\n\n        // disable selector\n        if (this.el.checkValidity()) {\n            for (const it of this.disabled_elements) {\n                if (it.disabled) {\n                    it.removeAttribute(\"disabled\");\n                    it.classList.remove(\"disabled\");\n                }\n            }\n        }\n    }\n\n    set_error_message(input) {\n        this.remove_error(input);\n\n        // Do not set a error message for a input group like radio buttons or\n        // checkboxes where one has already been set.\n        const inputs = this.inputs.filter((it) => it.name === input.name);\n        if (inputs.length > 1 && inputs.some((it) => !!it[KEY_ERROR_EL])) {\n            // error message for input group already set.\n            return;\n        }\n\n        // Create the validation error DOM node from the template\n        const validation_message = input.validationMessage || input[KEY_ERROR_MSG];\n        const error_node = dom.create_from_string(\n            this.error_template(validation_message)\n        ).firstChild;\n\n        let fieldset;\n        if (input.type === \"radio\" || input.type === \"checkbox\") {\n            fieldset = input.closest(\"fieldset.pat-checklist\");\n        }\n        if (fieldset) {\n            fieldset.append(error_node);\n        } else {\n            input.after(error_node);\n        }\n        input[KEY_ERROR_EL] = error_node;\n\n        let did_disable = false;\n        for (const it of this.disabled_elements) {\n            if (!it.disabled) {\n                did_disable = true;\n                it.setAttribute(\"disabled\", \"disabled\");\n                it.classList.add(\"disabled\");\n                logger.debug(\"Disable element\", it);\n            }\n        }\n\n        // Do an initial check of the whole form when a form element (e.g. the\n        // submit button) was disabled. We want to show the user all possible\n        // errors at once and after the submit button is disabled there is no\n        // way to check the whole form at once. ... well we also do not want to\n        // check the whole form when one input was changed....\n        if (did_disable) {\n            logger.debug(\"Checking whole form after element was disabled.\");\n            for (const _input of this.inputs.filter((it) => it !== input)) {\n                this.check_input({ input: _input, stop: true });\n            }\n        }\n    }\n\n    error_template(message) {\n        // Template for the validation message\n        return `<em class=\"validation warning message\">${message}</em>`;\n    }\n}\n\nregistry.register(Pattern);\n\nexport default Pattern;\nexport { Pattern };\n"],"names":["parser","Parser","addArgument","language_mapping","atom","html","plist","rss","svg","wsf","xhtml","xjb","xsd","xsl","Pattern","BasePattern","async","CodeJar","hljs","default","theme","el","this","options","window","__patternslib_import_styles","highlight","editor","textContent","highlightElement","highlight_wrapper","linenumbers","withLineNumbers","class","language","classList","filter","it","startsWith","replace","hljs_language","registerLanguage","includes","nodeName","toLowerCase","pre_el","document","createElement","innerHTML","querySelector","value","parentNode","insertBefore","setAttribute","add","config","tab","indentOn","RegExp","spellcheck","catchTab","preserveIdent","addClosing","history","codeeditor","onUpdate","code","trim","dispatchEvent","events","_defineProperty","registry","getOptions","$el","patternName","length","$","parent","elOptions","data","tmpOptions","split","i","item","reverse","key","pop","join","log","logging","initBasePattern","trigger","jquery","name","prototype","plog","pattern","undefined","Registry","mockupParser","e","error","Base","warn","defaults","init","emit","constructor","on","eventName","eventCallback","one","args","extend","patternProps","child","Error","Object","hasOwnProperty","call","apply","arguments","jquery_plugin","Surrogate","__super__","autoregister","setTimeout","debug","Event","bubbles","cancelable","parse","event_name","event_callback","once","destroy","logger","DATA_PREFIX","DATA_STYLE_DISPLAY","get_css_value","property","as_pixels","as_float","getComputedStyle","getPropertyValue","parseFloat","parseInt","Math","round","dom","toNodeArray","nodes","NodeList","Array","querySelectorAllAndMe","selector","all","querySelectorAll","matches","unshift","wrap","wrapper","appendChild","hide","style","display","show","val","find_parents","ret","closest","push","find_scoped","indexOf","get_parents","parents","HTMLElement","acquire_attribute","attribute","include_empty","include_all","_el","getAttribute","parentElement","is_visible","offsetWidth","offsetHeight","is_input","test","create_from_string","string","createRange","createContextualFragment","find_scroll_container","direction","fallback","body","overflow_y","overflow_x","get_data","default_value","set_data","delete_data","template","template_string","template_variables","Function","add_event_listener","remove_event_listener","event_listener_map","id","removeEventListener","el_events","entries","entry","event_type","cb","opts","addEventListener","_cb","capture","await_event","Promise","resolve","await_pattern_init","reject","catch","blur_event","click_event","change_event","focus_event","input_event","mousedown_event","mouseup_event","scroll_event","submit_event","dragstart_event","dragend_event","methods","settings","time","initialTime","exceptionAreas","each","$this","lastEvent","Date","trueTime","untouched","inExceptionArea","mouseMoved","find","live","enteredException","leftException","timeout","addClass","event","off","remove","removeData","hasClass","removeClass","startTimer","fn","floor","now","diff","method","slice","scrollable","element","css","clientHeight","scrollHeight","clientWidth","scrollWidth","parent_id","absoluteParent","elemTop","position","top","elemBottom","height","viewTop","scrollTop","viewBottom","docElem","elem","origin","left","nodeType","ownerDocument","documentElement","offsettop","offsetleft","thiswidth","width","pos","safeOffset","setleft","settop","appendTo","$ancestor","$child","childMarginEdgeLeft","childMarginEdgeTop","ancestorPaddingEdgeLeft","ancestorPaddingEdgeTop","addBack","speed","easing","callback","animate","a","m","text","toUpperCase","root","writer","bind","oThis","TypeError","aArgs","fToBind","fNOP","fBound","concat","Level","DEBUG","INFO","WARN","ERROR","FATAL","ConsoleWriter","Logger","_loggers","_parent","_enabled","_level","setWriter","w","output","log_name","level","messages","console","info","getLogger","path","route","shift","_getFlag","flag","context","setEnabled","state","isEnabled","setLevel","getLevel","fatal","match","logconfig","exec","location","search","api","getWriter","ArgumentParser","order","parameters","enum_values","enum_conflicts","groups","possible_groups","group_pattern","json_param_pattern","named_param_pattern","token_pattern","_camelCase","str","__","p1","addAlias","alias","original","addGroupToSpec","spec","group","field","first_spec","first_name","dest","choices","multiple","addJSONArgument","type","isArray","_typeof","choice","obj","_coerce","JSON","num","isNaN","toString","_set","parts","part","v","_split","tokens","quoted","simple","_parseExtendedNotation","argstring","map","arg","values","subopt","_parseShorthandNotation","parameter","sense","positional","_parse","sep","extended","_defaults","result","_cleanupOptions","group_options","keys","target","inherit","stack","$possible_config_providers","final_length","provider","frame","attr","max","results","utils","current_value","add_argument","last_btn","submitable_buttons","canditates","activeElement","candidate","form","submitter","disable_re","dont_catch_re","disabled","dont_catch","__patternslib_registry","PATTERN_REGISTRY","__patternslib_registry_initialized","patterns","ready","sort","scan","clear","transformPattern","content","transform","initPattern","orderPatterns","splice","Text","selectors","register","plugin_name","clone","forEach","thisArg","T","k","O","len","kValue","singleBoundJQueryPlugin","pat","charAt","pluralBoundJQueryPlugin","isObject","jqueryPlugin","escapeRegExp","source","prop","findLabel","input","$label","label","tagName","elementInViewport","rect","getBoundingClientRect","docEl","vWidth","innerWidth","vHeight","innerHeight","right","bottom","removeWildcardClass","targets","classes","ensureArray","matcher","class_list","ok","removeAttribute","hideOrShow","visible","pattern_name","transitions","none","fade","slide","duration","transition","effect","on_complete","action","t","complete","addURLQueryParameter","fullURL","param","url","hash","newURL","removeDuplicateObjects","objs","comparator","reduce","list","next_obj","is_duplicate","mergeStack","frame_length","x","isElementInViewport","partial","offset","rec","every","hasValue","checked","selectedIndex","parseTime","amount","findRelatives","$relatives","$form","get_bounds","bounds","y","checkInputSupport","invalid_value","support","checkCSSFeature","tag","supported","animation_frame","requestAnimationFrame","ms","debounce","func","timer","clearTimeout","isIE","documentMode","jqToNode","force_array","isPrototypeOf","localized_isodate","date","day","getDate","padStart","month","getMonth","getFullYear","escape_html","createTextNode","unescape_html","escaped_html","DOMParser","parseFromString","is_iso_date_time","is_iso_date","date_diff","date_1","date_2","utc_1","UTC","utc_2","getCSSValue","all_selects","all_deselects","all_toggles","all_checkboxes","all_radios","_init","select","btn","select_all","deselect","deselect_all","toggle","toggle_all","_handler_change","change_buttons_and_toggles","change_checked","find_siblings","sel","res","find_checkboxes","ref_el","chkbxs","tgl","preventDefault","box","labels","fieldset","format","after","befores","b_el","b_date","a_date","offsetDays","setDate","toISOString","substring","dispatch_change_event","display_el","behavior","insertAdjacentElement","pat_display_time","outputFormat","PatDisplayTime","display_time_config","locale","_add_additional","add_clear_button","placeholder","Pikaday","firstDay","showWeekNumber","weekNumbers","onSelect","onClose","minDate","maxDate","i18n","response","fetch","json","pikaday","el_append_to","required","clear_button","stopPropagation","firedBy","el_date","el_time","DatePicker","date_value","time_value","el_wrapper","html_btn_now","today","html_btn_clear","update","isotime","date_options","isodate","substr","toTimeString","DependsHandler","dependent","handler","$modal","condition","message","evaluate","updateModal","enable","disable","getAllInputs","dependents","onReset","onChange","is","enabled","$depdendent","Moment","lang","datetime","out","strict","fromNow","rtf","Intl","RelativeTimeFormat","numeric","toDate","calendar","lastWeek","lastDay","sameDay","nextDay","nextWeek","sameElse","noSuffix","xhrCount","get","_","onTriggerEvents","onClickSubmit","request","_request","cfg","seqNumber","inc","temp","clickedData","serialize","Boolean","headers","cache","browserCache","accept","Accept","formdata","FormData","append","ajax_deferred","done","status","jqxhr","fail","inject","cfgs","extractConfig","some","nextHref","href","pushMarker","onTrigger","currentTarget","idleTrigger","_initIdleTrigger","delay","processDelay","ajax","onFormActionSubmit","uid","random","delayed_trigger","uid_","_initAutoloadVisible","params","serializeArray","execute","$button","formaction","first","$cfg_node","submitSubform","$sub","$context","urlparts","defaultSelector","elementIsDirty","askForConfirmation","should_confirm","_confirm","confirm","$target","confirmMessage","ensureTarget","createTarget","$injected","verifySingleConfig","extractModifiers","listenForFormReset","verifyConfig","source_match","target_match","sourceMod","targetMod","targetPosition","loadingClass","_performInjection","$source","title","$src","contents","safeClone","findInclusive","_inject","_update_history","_afterInjection","glue","pushState","idx","el_","scroll","scroll_container","scroll_target","scroll_container_ref","abs","scrollLeft","scrollTo","ev","responseText","hooks","hook","sources$","callTypeHandler","dataType","idx1","perform_inject","idx2","explanation","timestamp","error_page","error_page_fragment","URLSearchParams","error_page_url","error_page_response","executingClass","error_zone","msg_attr","statusText","removeAttr","_onInjectSuccess","_onInjectError","do_close_panel","stopImmediatePropagation","contentbefore","contentafter","elementbefore","elementafter","replaceWith","empty","_sourcesFromHtml","sources","$html","_parseRawHtml","_rebaseAttrs","A","FORM","IMG","OBJECT","SOURCE","VIDEO","_rebaseOptions","_rebaseURL","base","URL","lastIndexOf","_rebaseHTML","$page","wrapAll","$el_","attrName","pattern_parser","changed","opt","stringify","clean_html","children","timeout_id","observer","IntersectionObserver","isIntersecting","disconnect","threshold","margin","observe","onTimeout","unsub","onInteraction","contains","registerTypeHandler","handlers","injected","skipPatInjectHandler","executedClass","CustomEvent","detail","originalEvent","reload","replaceState","dialog_panel","close","checkValidity","Tippy","tippy_options","parseOptionsForTippy","defaultProps","animation","arrow","hideOnClick","closing","ignoreAttributes","interactive","onHide","_onHide","onShow","_onShow","setDefaultProps","tippy","active_class","markInactive","inactive_class","super","placement","pos0","r","b","l","pos1","popperOptions","modifiers","arrowPadding","padding","parsers","flip_options","policy","fallbacks","fallbackPlacements","allowHTML","_initialize_content","popper","tippy_classes","close_button","setProps","_get_content","setContent","get_url_parts","data_type_handlers","ajaxDataType","popperInstance","forceUpdate","query","static","register_type_handler","tmp","Markdown","instance","renderForInjection","KEY_ERROR_EL","KEY_ERROR_MSG","inputs","check_input","initialize_inputs","disabled_elements","disableSelector","cnt","debouncer","_ref","stop","set_validity","msg","validity_state","validity","hasAttribute","badInput","customError","patternMismatch","rangeOverflow","rangeUnderflow","stepMismatch","tooLong","tooShort","typeMismatch","valid","valueMissing","input_options","equality","not","before","msg_default_not_before","msg_default_not_after","not_after","not_after_el","not_before","not_before_el","remove_error","min","number","email","set_error_message","_ref2","setCustomValidity","error_node","validation_message","validationMessage","error_template","firstChild","did_disable","_input"],"sourceRoot":""}