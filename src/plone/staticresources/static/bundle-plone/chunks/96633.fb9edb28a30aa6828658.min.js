"use strict";(self.webpackChunkplone_staticresources=self.webpackChunkplone_staticresources||[]).push([[96633],{96633:function(t,e,i){i.r(e),i.d(e,{default:function(){return Vt}});var n=i(85330),s=i.n(n),o=i(24481),a=i.n(o),r=i(10354),l=i(32218),c=i(62832),p=i(7424),h=i(54232),u=i.n(h),d=i(5749),f=i.n(d),g=f().View.extend({isUIView:!0,eventPrefix:"ui",template:null,idPrefix:"base-",appendInContainer:!0,initialize:function(t){for(var e in this.options=t,this.options)this[e]=this.options[e];this.options._t=r.ZP},render:function(){return this.applyTemplate(),this.trigger("render",this),this.afterRender(),this.options.id&&this.$el.attr("id",this.idPrefix+this.options.id),this},afterRender:function(){},serializedModel:function(){return this.options},applyTemplate:function(){if(null!==this.template){var t=s().extend({_t:r.ZP},this.options,this.serializedModel()),e=this.template;"string"==typeof e&&(e=a().template(e)),this.$el.html(e(t))}},propagateEvent:function(t){if(t.indexOf(":")>0){var e=t.split(":")[0];if(""!==this.eventPrefix&&(e===this.eventPrefix||e===this.eventPrefix+"."+this.id))return!0}return!1},uiEventTrigger:function(t){var e=[].slice.call(arguments,0);""!==this.eventPrefix&&(e[0]=this.eventPrefix+":"+t,f().View.prototype.trigger.apply(this,e),this.id&&(e[0]=this.eventPrefix+"."+this.id+":"+t,f().View.prototype.trigger.apply(this,e)))}}),m=g.extend({id:"",items:[],itemContainer:null,isOffsetParent:!0,idPrefix:"container-",render:function(){return this.options.id&&this.$el.attr("id",this.idPrefix+this.options.id),this.applyTemplate(),this.renderItems(),this.bindEvents(),this.isOffsetParent&&this.$el.addClass("ui-offset-parent"),this.trigger("render",this),this.afterRender(),this.$el.data("component",this),this},renderItems:function(){var t;if(null!==this.itemContainer){if(0===(t=s()(this.itemContainer,this.$el)).length)throw"Item Container element not found."}else t=this.$el;a().each(this.items,(function(e){!0===e.appendInContainer?t.append(e.render().$el):e.render()}),this)},bindEvents:function(){var t=this;a().each(this.items,(function(e){e.on("all",(function(){var e,i=[].slice,n=arguments[0],s=""!==t.id?t.id+"."+n:n;if(arguments.length>1&&(e=arguments[1]),s!==n){var o=i.call(arguments,0);o[0]=s,t.trigger.apply(t,o)}void 0!==e&&!0===e.isUIView&&!0===e.propagateEvent(n)&&t.trigger.apply(t,arguments)}))}))},get:function(t){return a().findWhere(this.items,{id:t})},add:function(t){if(void 0!==t.id&&this.get(t.id))throw"Another item with the same `id` already exists.";this.items.push(t)}}),b=m.extend({tagName:"div",className:"navbar",idPrefix:"toolbar-"}),v=m.extend({tagName:"div",className:"btn-group",idPrefix:"btngroup-",disable:function(){a().each(this.items,(function(t){t.disable()}))},enable:function(){a().each(this.items,(function(t){t.enable()}))}}),y=i(36382),w=g.extend({tagName:"a",className:"btn",eventPrefix:"button",context:"outline-secondary",idPrefix:"btn-",attributes:{href:"#"},extraClasses:[],tooltip:null,template:"<%= title %>",events:{click:"handleClick"},initialize:function(t){if(!t.id){const e=t.title||"";t.id=""!==e?e.toLowerCase().replace(" ","-"):this.cid}g.prototype.initialize.apply(this,[t]),this.on("render",(async function(){if(this.$el.attr("title",this.options.title||""),this.$el.attr("aria-label",this.options.title||this.options.tooltip||""),null!==this.context&&this.$el.addClass("btn-"+this.context),a().each(this.extraClasses,function(t){this.$el.addClass(t)}.bind(this)),this.icon&&"string"==typeof this.icon){const t=await c.Z.resolveIcon(this.icon),e=l.Z.create_from_string(t);e&&this.$el.prepend(e)}null!==this.tooltip&&(this.$el.attr("title",this.tooltip),new y.ZP(this.$el),this.$el.on("hidden",(function(t){"hidden"===t.type&&t.stopPropagation()})))}),this)},handleClick:function(t){t.preventDefault(),this.$el.is(".disabled")||this.uiEventTrigger("click",this,t)},serializedModel:function(){return a().extend({icon:"",title:""},this.options)},disable:function(){this.$el.addClass("disabled")},enable:function(){this.$el.removeClass("disabled")}}),C=i(18742),P=i(50033);i(43067);const _={openItem:{url:"#",title:(0,r.ZP)("Open"),category:"button",icon:"plone-view",css:"",modal:!1},editItem:{url:"#",title:(0,r.ZP)("Edit"),category:"button",icon:"plone-edit",css:"",modal:!1},cutItem:{method:"cutClicked",url:"#",title:(0,r.ZP)("Cut"),category:"dropdown",icon:"plone-cut",css:"",modal:!1},copyItem:{method:"copyClicked",url:"#",title:(0,r.ZP)("Copy"),category:"dropdown",icon:"plone-copy",css:"",modal:!1},pasteItem:{method:"pasteClicked",url:"#",title:(0,r.ZP)("Paste"),category:"dropdown",icon:"plone-paste",css:"",modal:!1},"move-top":{method:"moveTopClicked",url:"#",title:(0,r.ZP)("Move to top of folder"),category:"dropdown",icon:"arrow-bar-up",css:"",modal:!1},"move-bottom":{method:"moveBottomClicked",url:"#",title:(0,r.ZP)("Move to bottom of folder"),category:"dropdown",icon:"arrow-bar-down",css:"",modal:!1},"set-default-page":{method:"setDefaultPageClicked",url:"#",title:(0,r.ZP)("Set as default page"),category:"dropdown",icon:"check-circle",css:"",modal:!1},selectAll:{method:"selectAll",url:"#",title:(0,r.ZP)("Select all contained items"),category:"dropdown",icon:"check-all",css:"",modal:!1}};var x=function(t){if(null!==t.app.menuOptions)return t.app.menuOptions;const e=t.model.attributes,i=t.app,n=!!i.options.moveUrl,s=JSON.parse(JSON.stringify(_));i.pasteAllowed()&&e.is_folderish||delete s.pasteItem,(i.inQueryMode()||!1===n)&&(delete s["move-top"],delete s["move-bottom"]),-1!==i.defaultPageTypes.indexOf(e.portal_type)&&i.setDefaultPageUrl||delete s["set-default-page"],e.is_folderish||delete s.selectAll;const o=i.options.typeToViewAction,a=o&&o[e.portal_type]||"";return s.openItem.url=e.getURL+a,s.editItem.url=e.getURL+"/edit",s},S=f().Model.extend({defaults:function(){return{is_folderish:!1,review_state:"",getURL:""}},uid:function(){return this.attributes.UID}}),k=f().Model.extend({initialize:function(t){this.options=t,this.app=t.app,this.model=t.model,this.selectedCollection=this.app.selectedCollection},selectAll:async function(t){t.preventDefault();let e=1,i=0;const n=async()=>{this.app.loading.show();const t=new URL(this.app.collection.url);t.searchParams.append("query",this.app.collection.queryParser({searchPath:this.model.attributes.path})),t.searchParams.append("batch",JSON.stringify({page:e,size:100})),t.searchParams.append("attributes",JSON.stringify(this.app.collection.queryHelper.options.attributes));const s=await fetch(t,{headers:{Accept:"application/json"}}),o=await s.json(),a=this.app.collection.parse(o,i);i+=a.length;for(const t of a)this.app.selectedCollection.add(new S(t));e+=1,o.total>i?await n():(this.app.loading.hide(),await this.app.tableView.render())};await n()},doAction:async function(t,e,i){const n=new URL(this.app.buttons.get(t).options.url),s=await fetch(n,{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},method:"POST",body:new URLSearchParams({selection:JSON.stringify([this.model.attributes.UID]),folder:this.model.attributes.path,_authenticator:c.Z.getAuthenticator()})}),o=await s.json();let a,l="warning";"success"===o.status?(a=(0,r.ZP)(`${e} "${this.model.attributes.Title}"`),this.app.collection.fetch(),this.app.updateButtons()):(a=(0,r.ZP)("Error")+`: ${i} "${this.model.attributes.Title}"`,l="danger"),this.app.clearStatus(),this.app.setStatus({text:a,type:o.status||l})},cutClicked:function(t){t.preventDefault(),this.doAction("cut",(0,r.ZP)("Cut"),(0,r.ZP)("cutting"))},copyClicked:function(t){t.preventDefault(),this.doAction("copy",(0,r.ZP)("Copied"),(0,r.ZP)("copying"))},pasteClicked:function(t){t.preventDefault(),this.doAction("paste",(0,r.ZP)("Pasted into"),(0,r.ZP)("Error pasting into"))},moveTopClicked:function(t){t.preventDefault(),this.app.moveItem(this.model.attributes.id,"top")},moveBottomClicked:function(t){t.preventDefault(),this.app.moveItem(this.model.attributes.id,"bottom")},setDefaultPageClicked:async function(t){t.preventDefault();try{const t=new URL(this.app.getAjaxUrl(this.app.setDefaultPageUrl)),e=await fetch(t,{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},method:"POST",body:new URLSearchParams({id:this.model.attributes.id,_authenticator:c.Z.getAuthenticator()})}),i=await e.json();this.app.ajaxSuccessResponse.apply(this.app,[i])}catch(t){this.app.ajaxSuccessResponse.apply(this.app,[t])}}}),$=g.extend({className:"btn-group actionmenu",template:a().template('<% _.each(menuOptions.button, (menuOption) => { %>\n<a class="btn btn-sm action pat-tooltip <%- menuOption.classes.join(\' \') %>"\n    href="<%- menuOption.url %>"\n    title="<%- _t(menuOption.title) %>"\n    aria-label="<%- _t(menuOption.title) %>">\n  <% if (menuOption.iconSVG) { %>\n    <%= menuOption.iconSVG %>\n  <% } else { %>\n  <%- _t(menuOption.title) %>\n  <% } %>\n</a>\n<% }); %>\n\n\n<% if (menuOptions.dropdown) { %>\n<div class="dropdown">\n  <button class="dropdown-toggle btn btn-sm"\n      type="button"\n      data-bs-toggle="dropdown"\n      aria-haspopup="true"\n      aria-expanded="false"\n      id="<%- id %>"\n      title=\'<%- _t("Actions") %>\'>\n    <%= dropdownIcon %><span class="caret"></span>\n  </button>\n  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="<%- id %>">\n    <% if (header) { %>\n      <li class="dropdown-header"><%- header %></li>\n      <li class="divider"></li>\n    <% } %>\n\n    <% _.each(menuOptions.dropdown, (menuOption) => { %>\n    <li>\n      <a class="dropdown-item action <%- menuOption.classes.join(\' \') %>"\n          href="<%- menuOption.url %>">\n        <% if (menuOption.iconSVG) { %>\n          <%= menuOption.iconSVG %>\n        <% } %>\n        <%- _t(menuOption.title) %>\n      </a>\n    </li>\n    <% }); %>\n  </ul>\n</div>\n<% } %>\n'),menuOptions:null,generate_events:function(){const t={};return a().each(this.menuOptions,((e,i)=>{const n=e.method;if(!n||!this.actions[n])return!1;t[`click a.${i}`]=this.actions[n].bind(this.actions)})),t},initialize:function(t){this.actions=new k(t),g.prototype.initialize.apply(this,[t]),this.options=t,this.selectedCollection=this.app.selectedCollection,this.menuOptions=x(this),this.events=this.generate_events(),this.delegateEvents()},menuOptionsCategorized:async function(){const t={};return a().each(this.menuOptions,(async(e,i)=>{e.idx=c.Z.generateId(),e.name=i;const n=e.category||"dropdown";void 0===t[n]&&(t[n]=[]),t[n].push(e),e.classes=[e.name,e.idx],e.css&&e.classes.push(e.css),!0===e.modal&&(e.css+=" pat-plone-modal"),e.icon&&(e.iconSVG=await c.Z.resolveIcon(e.icon))})),t},render:async function(){this.el.innerHTML="";const t=this.model.toJSON();return t.header=this.options.header||null,t.menuOptions=await this.menuOptionsCategorized(),this.el.innerHTML=this.template(s().extend({dropdownIcon:await c.Z.resolveIcon("plone-settings"),_t:r.ZP,id:c.Z.generateId()},t)),this.options.className&&this.$el.addClass(this.options.className),P.Z.scan(this.$el),this.el}}),O=f().View.extend({tagName:"tr",className:"itemRow",template:a().template('<td class="selection" data-order="<%- attributes[\'_sort\'] %>"><label for="select<%- attributes[\'_sort\'] %>InputCheckbox" class="hiddenStructure" aria-label="<%- _t(\'Select\') %>"><%- _t(\'Select\') %></label><input class="form-check-input" id="select<%- attributes[\'_sort\'] %>InputCheckbox" <% if(selected){ %> checked="checked" <% } %> type="checkbox"/></td>\n\n<td class="title">\n  <div>\n    <div>\n      <a href="<%- viewURL %>"\n          class="manage state-<%- review_state %> contenttype-<%- contenttype %>"\n          title="<%- portal_type %>">\n        <%= mimeIcon %>\n        <% if(Title){ %>\n          <%- Title %>\n        <% } else { %>\n          <em><%- id %></em>\n        <% } %>\n      </a>\n      <% if(exclude_from_nav){ %>\n        <span class="badge text-bg-secondary plone-item-exclude-from-nav"><%- _t(\'Excluded from navigation\') %></span>\n      <% } %>\n      <% if(expired){ %>\n        <span class="badge text-bg-danger plone-item-expired"><%- _t(\'Expired\') %></span>\n      <% } %>\n      <% if(ineffective){ %>\n        <span class="badge text-bg-warning plone-item-ineffective"><%- _t(\'Before publishing date\') %></span>\n      <% } %>\n      <% if(activeColumns.indexOf(\'Description\') !== -1 && _.has(availableColumns, \'Description\') && Description) { %>\n      <p class="Description">\n        <small>\n          <%- Description %>\n        </small>\n      </p>\n      <% } %>\n    </div>\n    <% if(attributes["getIcon"] && thumb_scale) { %>\n      <div class="lead-img">\n        <img class="thumb-<%- thumb_scale %>" alt="<%- _t(\'Preview image\') %> <%- Title || id %>" src="<%- getURL %>/@@images/image/<%- thumb_scale %>">\n      </div>\n    <% } %>\n  </div>\n</td>\n\n<% _.each(activeColumns, (column) => { %>\n  <% if(column !== \'Description\' && _.has(availableColumns, column)) { %>\n    <td class="<%- column %>" <% if (column === \'review_state\') { %>style="color: var(--plone-state-<%-attributes[column]%>)"<% } %> data-order="<%- attributes[column] %>"><%- convertColumnValue(column, attributes[column]) %></td>\n  <% } %>\n<% }); %>\n\n<td class="actionmenu-container"></td>\n'),events:{"change input":"itemSelected","click td.title a.manage":"itemClicked"},initialize:function(t){this.options=t,this.app=t.app,this.selectedCollection=this.app.selectedCollection,this.table=this.options.table,this.now=new Date,this.listenTo(this.table,"context-info:set",this.render)},expired:function(t){if(!t.attributes.ExpirationDate)return!1;const e=new Date(t.attributes.ExpirationDate);return this.now>e},ineffective:function(t){if(!t.attributes.EffectiveDate)return!1;const e=new Date(t.attributes.EffectiveDate);return this.now<e},render:async function(){const t=this.model.toJSON();t.selected=!!this.selectedCollection.findWhere({UID:t.UID}),t.attributes=this.model.attributes,t.activeColumns=this.app.activeColumns,t.availableColumns=this.app.availableColumns,t.portal_type=t.portal_type?t.portal_type:"",t.contenttype=t.portal_type.toLowerCase().replace(/\.| /g,"-"),t._authenticator=c.Z.getAuthenticator(),t.thumb_scale=this.app.thumb_scale,t.mimeIcon=await c.Z.resolveIcon(`contenttype/${t.contenttype}`);const e=this.app.typeToViewAction&&this.app.typeToViewAction[t.attributes.portal_type]||"";t.viewURL=t.attributes.getURL+e,t._t=r.ZP,t.convertColumnValue=this.convertColumnValue.bind(this),t.expired=this.expired(t),t.ineffective=this.ineffective(t),t.exclude_from_nav=t.exclude_from_nav||!1,this.$el.html(this.template(t));const i=this.model.attributes;this.$el.addClass([`state-${i.review_state}`,`type-${i.portal_type}`]),this.$el.attr("data-path",t.path),this.$el.attr("data-UID",t.UID),this.$el.attr("data-id",t.id),this.$el.attr("data-type",t.portal_type),this.$el.attr("data-folderish",t.is_folderish),this.$el.toggleClass("folder",t.is_folderish),this.$el.toggleClass("default-page",t.id===this.table.contextInfo?.defaultPage),this.$el.toggleClass("expired",t.expired),this.$el.toggleClass("ineffective",t.ineffective),this.el.model=this.model;const n=new $({app:this.app,model:this.model});return s()(".actionmenu-container",this.$el).append(await n.render()),this},convertColumnValue:function(t,e){if(this.table.dateColumns.includes(t)){const t=new Date(e);return t instanceof Date&&"Invalid Date"===t.toString()?e:t.toLocaleString(this.app.language,this.app.dateFormat)}return this.table.translatableColumns.includes(t)?(0,r.O4)(e):e},itemClicked:function(t){const e=this.app.keyEvent;if(e&&e.ctrlKey||!this.model.attributes.is_folderish)return null;t.preventDefault(),this.app.setCurrentPath(this.model.attributes.path),this.app.collection.getFirstPage()},itemSelected:function(){const t=this.$("input")[0],e=this.app.selectedCollection;t.checked?e.add(this.model.clone()):e.removeResult(this.model);const i=this.app.keyEvent;if(i&&i.shiftKey&&this.app.last_selected&&null!==this.app.last_selected.parentNode){let i=s()(this.app.last_selected);const n=i.index(),o=this.$el.index();for(const a of this.app.tableView.$('input[type="checkbox"]')){i=s()(a);const r=i.parents("tr").index();if(r>n&&r<o||r<n&&r>o){this.checked=t.checked;const i=s()(this).closest("tr.itemRow");if(i.length>0){const t=i[0].model,n=e.getByUID(t.attributes.UID);this.checked?n||e.add(t.clone()):n&&e.removeResult(n)}}}}this.app.last_selected=this.el}}),T=i(71015);i(62027);const E=new Map;var I={set(t,e,i){E.has(t)||E.set(t,new Map);const n=E.get(t);n.has(e)||0===n.size?n.set(e,i):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(n.keys())[0]}.`)},get(t,e){return E.has(t)&&E.get(t).get(e)||null},remove(t,e){if(!E.has(t))return;const i=E.get(t);i.delete(e),0===i.size&&E.delete(t)}};const D="transitionend",A=t=>(t&&window.CSS&&window.CSS.escape&&(t=t.replace(/#([^\s"#']+)/g,((t,e)=>`#${CSS.escape(e)}`))),t),N=t=>!(!t||"object"!=typeof t)&&(void 0!==t.jquery&&(t=t[0]),void 0!==t.nodeType),Z=t=>N(t)?t.jquery?t[0]:t:"string"==typeof t&&t.length>0?document.querySelector(A(t)):null,V=t=>!t||t.nodeType!==Node.ELEMENT_NODE||(!!t.classList.contains("disabled")||(void 0!==t.disabled?t.disabled:t.hasAttribute("disabled")&&"false"!==t.getAttribute("disabled"))),U=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,z=[],j=(t,e=[],i=t)=>"function"==typeof t?t(...e):i,R=(t,e,i=!0)=>{if(!i)return void j(t);const n=(t=>{if(!t)return 0;let{transitionDuration:e,transitionDelay:i}=window.getComputedStyle(t);const n=Number.parseFloat(e),s=Number.parseFloat(i);return n||s?(e=e.split(",")[0],i=i.split(",")[0],1e3*(Number.parseFloat(e)+Number.parseFloat(i))):0})(e)+5;let s=!1;const o=({target:i})=>{i===e&&(s=!0,e.removeEventListener(D,o),j(t))};e.addEventListener(D,o),setTimeout((()=>{s||e.dispatchEvent(new Event(D))}),n)},M=/[^.]*(?=\..*)\.|.*/,q=/\..*/,L=/::\d+$/,B={};let F=1;const J={mouseenter:"mouseover",mouseleave:"mouseout"},H=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function K(t,e){return e&&`${e}::${F++}`||t.uidEvent||F++}function W(t){const e=K(t);return t.uidEvent=e,B[e]=B[e]||{},B[e]}function Q(t,e,i=null){return Object.values(t).find((t=>t.callable===e&&t.delegationSelector===i))}function Y(t,e,i){const n="string"==typeof e,s=n?i:e||i;let o=et(t);return H.has(o)||(o=t),[n,s,o]}function G(t,e,i,n,s){if("string"!=typeof e||!t)return;let[o,a,r]=Y(e,i,n);if(e in J){const t=t=>function(e){if(!e.relatedTarget||e.relatedTarget!==e.delegateTarget&&!e.delegateTarget.contains(e.relatedTarget))return t.call(this,e)};a=t(a)}const l=W(t),c=l[r]||(l[r]={}),p=Q(c,a,o?i:null);if(p)return void(p.oneOff=p.oneOff&&s);const h=K(a,e.replace(M,"")),u=o?function(t,e,i){return function n(s){const o=t.querySelectorAll(e);for(let{target:a}=s;a&&a!==this;a=a.parentNode)for(const r of o)if(r===a)return nt(s,{delegateTarget:a}),n.oneOff&&it.off(t,s.type,e,i),i.apply(a,[s])}}(t,i,a):function(t,e){return function i(n){return nt(n,{delegateTarget:t}),i.oneOff&&it.off(t,n.type,e),e.apply(t,[n])}}(t,a);u.delegationSelector=o?i:null,u.callable=a,u.oneOff=s,u.uidEvent=h,c[h]=u,t.addEventListener(r,u,o)}function X(t,e,i,n,s){const o=Q(e[i],n,s);o&&(t.removeEventListener(i,o,Boolean(s)),delete e[i][o.uidEvent])}function tt(t,e,i,n){const s=e[i]||{};for(const[o,a]of Object.entries(s))o.includes(n)&&X(t,e,i,a.callable,a.delegationSelector)}function et(t){return t=t.replace(q,""),J[t]||t}const it={on(t,e,i,n){G(t,e,i,n,!1)},one(t,e,i,n){G(t,e,i,n,!0)},off(t,e,i,n){if("string"!=typeof e||!t)return;const[s,o,a]=Y(e,i,n),r=a!==e,l=W(t),c=l[a]||{},p=e.startsWith(".");if(void 0===o){if(p)for(const i of Object.keys(l))tt(t,l,i,e.slice(1));for(const[i,n]of Object.entries(c)){const s=i.replace(L,"");r&&!e.includes(s)||X(t,l,a,n.callable,n.delegationSelector)}}else{if(!Object.keys(c).length)return;X(t,l,a,o,s?i:null)}},trigger(t,e,i){if("string"!=typeof e||!t)return null;const n=U();let s=null,o=!0,a=!0,r=!1;e!==et(e)&&n&&(s=n.Event(e,i),n(t).trigger(s),o=!s.isPropagationStopped(),a=!s.isImmediatePropagationStopped(),r=s.isDefaultPrevented());const l=nt(new Event(e,{bubbles:o,cancelable:!0}),i);return r&&l.preventDefault(),a&&t.dispatchEvent(l),l.defaultPrevented&&s&&s.preventDefault(),l}};function nt(t,e={}){for(const[i,n]of Object.entries(e))try{t[i]=n}catch{Object.defineProperty(t,i,{configurable:!0,get(){return n}})}return t}var st=it;function ot(t){if("true"===t)return!0;if("false"===t)return!1;if(t===Number(t).toString())return Number(t);if(""===t||"null"===t)return null;if("string"!=typeof t)return t;try{return JSON.parse(decodeURIComponent(t))}catch{return t}}function at(t){return t.replace(/[A-Z]/g,(t=>`-${t.toLowerCase()}`))}var rt={setDataAttribute(t,e,i){t.setAttribute(`data-bs-${at(e)}`,i)},removeDataAttribute(t,e){t.removeAttribute(`data-bs-${at(e)}`)},getDataAttributes(t){if(!t)return{};const e={},i=Object.keys(t.dataset).filter((t=>t.startsWith("bs")&&!t.startsWith("bsConfig")));for(const n of i){let i=n.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1,i.length),e[i]=ot(t.dataset[n])}return e},getDataAttribute(t,e){return ot(t.getAttribute(`data-bs-${at(e)}`))}};var lt=class{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(t){return t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t}_mergeConfigObj(t,e){const i=N(e)?rt.getDataAttribute(e,"config"):{};return{...this.constructor.Default,..."object"==typeof i?i:{},...N(e)?rt.getDataAttributes(e):{},..."object"==typeof t?t:{}}}_typeCheckConfig(t,e=this.constructor.DefaultType){for(const[n,s]of Object.entries(e)){const e=t[n],o=N(e)?"element":null==(i=e)?`${i}`:Object.prototype.toString.call(i).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(s).test(o))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${n}" provided type "${o}" but expected type "${s}".`)}var i}};var ct=class extends lt{constructor(t,e){super(),(t=Z(t))&&(this._element=t,this._config=this._getConfig(e),I.set(this._element,this.constructor.DATA_KEY,this))}dispose(){I.remove(this._element,this.constructor.DATA_KEY),st.off(this._element,this.constructor.EVENT_KEY);for(const t of Object.getOwnPropertyNames(this))this[t]=null}_queueCallback(t,e,i=!0){R(t,e,i)}_getConfig(t){return t=this._mergeConfigObj(t,this._element),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}static getInstance(t){return I.get(Z(t),this.DATA_KEY)}static getOrCreateInstance(t,e={}){return this.getInstance(t)||new this(t,"object"==typeof e?e:null)}static get VERSION(){return"5.3.0"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(t){return`${t}${this.EVENT_KEY}`}};const pt=t=>{let e=t.getAttribute("data-bs-target");if(!e||"#"===e){let i=t.getAttribute("href");if(!i||!i.includes("#")&&!i.startsWith("."))return null;i.includes("#")&&!i.startsWith("#")&&(i=`#${i.split("#")[1]}`),e=i&&"#"!==i?i.trim():null}return A(e)},ht={find(t,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,t))},findOne(t,e=document.documentElement){return Element.prototype.querySelector.call(e,t)},children(t,e){return[].concat(...t.children).filter((t=>t.matches(e)))},parents(t,e){const i=[];let n=t.parentNode.closest(e);for(;n;)i.push(n),n=n.parentNode.closest(e);return i},prev(t,e){let i=t.previousElementSibling;for(;i;){if(i.matches(e))return[i];i=i.previousElementSibling}return[]},next(t,e){let i=t.nextElementSibling;for(;i;){if(i.matches(e))return[i];i=i.nextElementSibling}return[]},focusableChildren(t){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map((t=>`${t}:not([tabindex^="-"])`)).join(",");return this.find(e,t).filter((t=>!V(t)&&(t=>{if(!N(t)||0===t.getClientRects().length)return!1;const e="visible"===getComputedStyle(t).getPropertyValue("visibility"),i=t.closest("details:not([open])");if(!i)return e;if(i!==t){const e=t.closest("summary");if(e&&e.parentNode!==i)return!1;if(null===e)return!1}return e})(t)))},getSelectorFromElement(t){const e=pt(t);return e&&ht.findOne(e)?e:null},getElementFromSelector(t){const e=pt(t);return e?ht.findOne(e):null},getMultipleElementsFromSelector(t){const e=pt(t);return e?ht.find(e):[]}};var ut=ht;const dt=".bs.alert",ft=`close${dt}`,gt=`closed${dt}`;class mt extends ct{static get NAME(){return"alert"}close(){if(st.trigger(this._element,ft).defaultPrevented)return;this._element.classList.remove("show");const t=this._element.classList.contains("fade");this._queueCallback((()=>this._destroyElement()),this._element,t)}_destroyElement(){this._element.remove(),st.trigger(this._element,gt),this.dispose()}static jQueryInterface(t){return this.each((function(){const e=mt.getOrCreateInstance(this);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}var bt,vt;((t,e="hide")=>{const i=`click.dismiss${t.EVENT_KEY}`,n=t.NAME;st.on(document,i,`[data-bs-dismiss="${n}"]`,(function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),V(this))return;const s=ut.getElementFromSelector(this)||this.closest(`.${n}`);t.getOrCreateInstance(s)[e]()}))})(mt,"close"),bt=mt,vt=()=>{const t=U();if(t){const e=bt.NAME,i=t.fn[e];t.fn[e]=bt.jQueryInterface,t.fn[e].Constructor=bt,t.fn[e].noConflict=()=>(t.fn[e]=i,bt.jQueryInterface)}},"loading"===document.readyState?(z.length||document.addEventListener("DOMContentLoaded",(()=>{for(const t of z)t()})),z.push(vt)):vt();var yt=i(37834),wt=g.extend({tagName:"div",template:a().template('<div class="fc-breadcrumbs-container">\n  <div class="fc-breadcrumbs">\n    <a href="#" title="<%- _t(\'Root\') %>" aria-label="<%- _t(\'Root\') %>" data-path="/">\n      <%= homeIcon %> /\n    </a>\n    <% pathParts.forEach((part, idx) => {\n      if(part){\n        if(idx > 0){ %>\n          /\n        <% } %>\n        <a href="#" class="crumb" data-path="<%- part %>"><%- part %></a>\n      <% }\n    }); %>\n  </div>\n</div>\n\n<table class="pat-datatables table table-striped table-bordered"\n       data-pat-datatables="<%- datatables_options %>">\n  <thead>\n    <tr>\n      <th class="selection"><label for="selectAllInputCheckbox" class="hiddenStructure" aria-label="<%- _t(\'Select all\') %>"><%- _t(\'Select all\') %></label><input id="selectAllInputCheckbox" type="checkbox" class="select-all form-check-input" /></th>\n      <th class="title"><%- _t(\'Title\') %></th>\n      <% activeColumns.forEach((column, idx) => { %>\n        <% if(column !== \'Description\' && hasOwnProperty.call(availableColumns, column)) { %>\n          <th><%- availableColumns[column] %></th>\n        <% } %>\n      <% }); %>\n      <th class="actions"><%- _t("Actions") %></th>\n    </tr>\n  </thead>\n  <tbody>\n  </tbody>\n</table>\n'),tableSortable:null,initialize:function(t){var e=this;g.prototype.initialize.apply(e,[t]),e.collection=e.app.collection,e.selectedCollection=e.app.selectedCollection,e.subsetIds=[],e.contextInfo=null,e.tableSortable=null,e.listenTo(e.collection,"sync",e.render),e.listenTo(e.selectedCollection,"remove",e.render),e.listenTo(e.selectedCollection,"reset",e.render),s()("body").on("context-info-loaded",((t,i)=>{e.contextInfo=i,e.setContextInfo()})),e.dateColumns=["ModificationDate","EffectiveDate","CreationDate","ExpirationDate","start","end","last_comment_date"],e.translatableColumns=["review_state"]},events:{"click .fc-breadcrumbs a":"breadcrumbClicked","change .select-all":"selectAll"},setContextInfo:function(){const t=this.contextInfo,e=t&&t.breadcrumbs;if(e&&e.length){const t=this.$(".fc-breadcrumbs a.crumb");a().each(e,((e,i)=>{t.eq(i).html(yt.Z.escape_html(e.title))}))}this.trigger("context-info:set")},render:async function(){const t={order:[0,"asc"],columnDefs:[{orderable:!1,targets:[0,this.app.activeColumns.length+1]}],paging:!1,searching:!1,info:!1,...this.app.options.datatables_options};if(this.$el.html(this.template({_t:r.ZP,homeIcon:await c.Z.resolveIcon("house"),pathParts:this.app.getCurrentPath().split("/").slice(1).filter((t=>t.length>0)),activeColumns:this.app.activeColumns,availableColumns:this.app.availableColumns,datatables_options:JSON.stringify(t)})),this.collection.length){const t=s()("tbody",this.$el),e=this.collection.length;let i=0;this.collection.each((async n=>{this.dateColumns.map((t=>{!Object.prototype.hasOwnProperty.call(n.attributes,t)||"None"!==n.attributes[t]&&n.attributes[t]||(n.attributes[t]="")}));const s=new O({model:n,app:this.app,table:this});await s.render(),t.append(s.el),i++,i===e&&this.el.dispatchEvent(new Event("table_row_rendering_finished"))}));const n=()=>new Promise((t=>C.Z.add_event_listener(this.el,"table_row_rendering_finished","table_row_rendering_finished__listener",t,{once:!0})));await n(),C.Z.remove_event_listener=(this.el,"table_row_rendering_finished__listener"),P.Z.scan(this.$el)}return this.$el.find("table").on("init.dt",(()=>{this.app.options.moveUrl&&this.addReordering(),this.storeOrder()})).on("order.dt",((t,e,i)=>{if(1===i.length){const t=i[0];if(0===t.col&&"asc"===t.dir)return this.tableSortable&&this.tableSortable.enableSort(),void this.app.clearStatus("sorting_dndreordering_disabled")}const n=t.target,o=s()('<button type="button" class="btn btn-danger btn-sm"></button>').text((0,r.ZP)("Reset column sorting")).on("click",(()=>{const t=s()(n).dataTable().api();t.order([0,"asc"]),t.draw()}));this.app.setStatus({text:(0,r.ZP)("Notice: Drag and drop reordering is disabled when viewing the contents sorted by a column."),type:"warning"},o,!1,"sorting_dndreordering_disabled"),this.tableSortable&&this.tableSortable.disableSort(),this.$el.removeClass("order-support")})),this},breadcrumbClicked:function(t){t.preventDefault();let e=s()(t.target);"A"!==e[0].tagName&&(e=e.parent("a"));let i="";for(const t of s()(e.prevAll("a").get().reverse())){let e=s()(t).attr("data-path");i+=e,"/"!==e&&(i+="/")}i+=e.attr("data-path"),this.app.setCurrentPath(i),this.app.collection.getPage(this.app.collection.state.firstPage)},selectAll:function(t){s()(t.target).is(":checked")?s()('input[type="checkbox"]',this.$("tbody")).prop("checked",!0).trigger("change"):(this.selectedCollection.remove(this.collection.models,{silent:!0}),this.selectedCollection.trigger("remove")),this.setContextInfo()},toggleSelectAll:function(t){s()(t.target).is(":checked")||this.$(".select-all").prop("checked",!1)},addReordering:function(){this.app.inQueryMode()?this.$el.removeClass("order-support"):(this.$el.addClass("order-support"),this.tableSortable=new T.Z(this.$("tbody"),{selector:"tr",createDragItem:(t,e)=>{const i=e.clone(),n=s()("<table><tbody></tbody></table>");return s()("tbody",n).append(i),n.addClass("structure-dragging").css({opacity:.85,position:"absolute"}),n.width(e.width()),n.height(e.height()),n.appendTo(document.body),n},drop:(t,e)=>{0!==e&&(this.app.moveItem(t.attr("data-id"),e,this.subsetIds),this.storeOrder())}}))},storeOrder:function(){const t=[];this.$("tbody tr.itemRow").each((function(){t.push(s()(this).attr("data-id"))})),this.subsetIds=t}}),Ct=i(57887),Pt=m.extend({tagName:"div",className:"popover",eventPrefix:"popover",template:'<div class="arrow"></div>\n<div class="popover-title">\n</div>\n<div class="items popover-content">\n</div>\n\n',content:null,title:null,triggerView:null,idPrefix:"popover-",triggerEvents:{"button:click":"toggle"},placement:"bottom",events:{},opened:!1,closeOnOutClick:!0,appendInContainer:!0,backdrop:void 0,$backdrop:null,useBackdrop:!0,backdropOptions:{zIndex:"1009",opacity:"0.4",className:"backdrop backdrop-popover",classActiveName:"backdrop-active",closeOnEsc:!1,closeOnClick:!0},initialize:function(t){var e=this;m.prototype.initialize.apply(this,[t]),this.bindTriggerEvents(),this.on("render",(function(){this.$el.attr("role","tooltip").attr("aria-hidden","false"),this.renderTitle(),this.renderContent()}),this),this.$el.on("keyup",(function(t){27===t.keyCode&&e.hide()}))},afterRender:function(){},getTemplateOptions:function(){return this.options},renderTitle:function(){var t=this.title;"function"==typeof t&&(t=t(this.getTemplateOptions())),this.$(".popover-title").empty().append(t)},renderContent:function(){this.$(".popover-content").empty().append(this.content(this.getTemplateOptions()))},bindTriggerEvents:function(){this.triggerView&&a().each(this.triggerEvents,(function(t,e){var i=this[t];i||s().error("Function not found."),this.stopListening(this.triggerView,e),this.listenTo(this.triggerView,e,i)}),this)},getPosition:function(){var t=this.triggerView.$el;return s().extend({},{width:t[0].offsetWidth,height:t[0].offsetHeight},t.offset())},getBodyClassName:function(){var t="popover-";return this.options.id&&(t+=this.options.id+"-"),t+="active"},show:function(){s()(".popover:visible").each((function(){var t=s()(this).data("component");t&&t.hide()})),this.position(),this.setBackdrop(),!0===this.useBackdrop&&this.backdrop.show(),this.opened=!0,this.triggerView&&this.triggerView.$el.addClass("active"),this.uiEventTrigger("show",this),this.$el.attr("aria-hidden","false"),s()("body").addClass(this.getBodyClassName())},position:function(){var t,e,i,n,s=this.getPosition(),o=this.$el;switch(e=this.placement,o.css({top:0,left:0}).addClass("active"),i=o[0].offsetWidth,n=o[0].offsetHeight,e){case"bottom-right":t={top:s.top+s.height,left:s.left+s.width-40};break;case"bottom":t={top:s.top+s.height,left:s.left+s.width/2-i/2};break;case"top":t={top:s.top-n,left:s.left+s.width/2-i/2};break;case"left":t={top:s.top+s.height/2-n/2,left:s.left-i};break;case"right":t={top:s.top+s.height/2-n/2,left:s.left+s.width}}this.applyPlacement(t,e)},applyPlacement:function(t,e){var i,n,s,o,a=this.$el,r=this.$el,l=r[0].offsetWidth,c=r[0].offsetHeight;a.removeClass(e),a.offset(t).addClass(e).addClass("active"),i=r[0].offsetWidth,n=r[0].offsetHeight,"top"===e&&n!==c&&(t.top=t.top+c-n,o=!0),"bottom"===e||"top"===e?(s=0,t.left<0&&(s=-2*t.left,t.left=0,a.removeClass(e),a.offset(t).addClass(e),i=r[0].offsetWidth,n=r[0].offsetHeight),this.positionArrow(s-l+i,i,"left")):"bottom-right"!==e&&this.positionArrow(n-c,n,"top"),o&&a.offset(t)},positionArrow:function(t,e,i){this.$(".arrow").css(i,t?50*(1-t/e)+"%":"")},hide:function(){this.opened=!1,this.$el.removeClass("active"),this.triggerView&&(this.triggerView.$el.removeClass("active"),this.triggerView.$el.attr("aria-hidden","true")),this.uiEventTrigger("hide",this),this.$el.attr("aria-hidden","true"),s()("body").removeClass(this.getBodyClassName())},toggle:function(t,e){this.opened?this.hide():this.show()},setBackdrop:function(){if(!0===this.useBackdrop&&void 0===this.backdrop){var t=this;this.$backdrop=this.$el.closest(".ui-backdrop-element"),0===this.$backdrop.length&&(this.$backdrop=s()("body")),this.backdrop=new Ct.Z(this.$backdrop,this.backdropOptions),this.backdrop.$el.on("hidden.backdrop.patterns",(function(e){"backdrop.patterns"===e.namespace&&(e.stopPropagation(),!0===t.opened&&t.hide())})),this.on("popover:hide",(function(){this.backdrop.hide()}),this)}}}),_t=Pt.extend({className:"popover selected-items",title:a().template('<input type="text" class="filter" placeholder="<%- _t("Filter") %>" /><a href="#" class=" remove-all"><%= removeIcon %> <%- _t("remove all") %></a>'),content:a().template("<% collection.each(function(item) { %><%= item_template($.extend({'removeIcon': removeIcon}, item.toJSON())) %><% }); %>"),events:{"click a.remove":"itemRemoved","keyup input.filter":"filterSelected","click .remove-all":"removeAll"},initialize:function(t){Pt.prototype.initialize.apply(this,[t]);let e=0;this.listenTo(this.collection,"reset all add remove",(()=>{clearTimeout(e),e=setTimeout((()=>{this.render()}),50)})),this.options.item_template=a().template('<span class="selected-item">\n  <a href="#" data-uid="<%- UID %>" title="remove" class="remove">\n    <%= removeIcon %>\n  </a>\n  <%- Title %>\n</span>\n')},render:async function(){return this.options.removeIcon=await c.Z.resolveIcon("x-circle"),Pt.prototype.render.call(this),0===this.collection.length&&this.$el.removeClass("active"),this},itemRemoved:function(t){t.preventDefault();const e=s()(t.currentTarget).data("uid");this.collection.removeByUID(e),0!==this.collection.length&&this.show()},filterSelected:function(t){const e=s()(t.target).val().toLowerCase();for(const t of s()(".selected-item",this.$el)){const i=s()(t);-1===i.text().toLowerCase().indexOf(e)?i.hide():i.show()}},removeAll:function(t){t.preventDefault(),this.collection.reset(),this.hide()}}),xt=Pt.extend({events:{"click button.applyBtn":"applyButtonClicked","click button.closeBtn":"toggle"},submitText:(0,r.ZP)("Apply"),initialize:function(t){this.app=t.app,this.className="popover "+t.id,this.title=t.form.title||t.title,this.submitText=t.form.submitText||(0,r.ZP)("Apply"),this.submitContext=t.form.submitContext||"primary",this.data={},this.options=t,this.setContent(t.form.template),Pt.prototype.initialize.apply(this,[t])},setContent:function(t){let e="<form>"+t+"</form>";e+='<button class="btn btn-block btn-'+this.submitContext+' applyBtn">'+this.submitText+" </button>",this.options.form.closeText&&(e+='<button class="btn btn-block btn-secondary closeBtn">'+this.options.form.closeText+" </button>"),this.content=a().template(e)},getTemplateOptions:function(){const t=[];for(const e of this.app.selectedCollection.models){let i=e.toJSON();i.Title=yt.Z.escape_html(i.Title),t.push(i)}return s().extend({},!0,this.options,{items:t,data:this.data})},applyButtonClicked:function(){const t={};for(const e of this.$el.find("form").serializeArray())e.name in t?t[e.name]+=","+e.value:t[e.name]=e.value;this.app.buttonClickEvent(this.triggerView,t),this.hide()},afterRender:function(){if(this.options.form.dataUrl){this.$(".popover-content").html((0,r.ZP)("Loading...")),this.app.loading.show();const t=this.app.getAjaxUrl(this.options.form.dataUrl);s().ajax({url:t,dataType:"json",type:"POST",cache:!1,data:{selection:JSON.stringify(this.app.getSelectedUids()),transitions:!0,render:"yes"}}).done((t=>{this.data=t.data||t,this.renderContent(),P.Z.scan(this.$el)})).fail((()=>{const t=this.content;this.setContent("<p>"+(0,r.ZP)("Error loading popover from server.")+"</p>",!1),this.renderContent(),this.content=t})).always((()=>{this.app.loading.hide(),this.position()}))}else P.Z.scan(this.$el),this.position()},toggle:function(t,e){Pt.prototype.toggle.apply(this,[t,e]),this.opened&&(this.$el.replaceWith(this.render().el),this.position())}}),St=Pt.extend({className:"popover rearrange",title:a().template('<%- _t("Rearrange items in this folder") %>'),content:a().template('<div class="form-group"><label><%- _t("What to rearrange on") %></label><select name="rearrange_on" class="form-select"><% _.each(rearrangeProperties, function(title, property) { %><option value="<%- property %>"><%- title %></option><% }); %></select><p class="help-block"><b><%- _t("This permanently changes the order of items in this folder. This operation may take a long time depending on the size of the folder.") %></b></p></div><div class="form-check"><input class="form-check-input" type="checkbox" name="reversed" /><label class="form-check-label"><%- _t("Reverse") %></label></div><button class="btn btn-block btn-primary btn-sm"><%- _t("Rearrange") %></button>'),events:{"click button":"rearrangeButtonClicked"},initialize:function(t){this.app=t.app,Pt.prototype.initialize.apply(this,[t]),this.options.rearrangeProperties=this.app.options.rearrange.properties},render:function(){return Pt.prototype.render.call(this),this.$rearrangeOn=this.$('[name="rearrange_on"]'),this.$reversed=this.$('[name="reversed"]'),this},rearrangeButtonClicked:function(){if("/"===this.app.collection.getCurrentPath()&&!window.confirm((0,r.ZP)("Sorting the content on the base of the site could affect your navigation order. Are you certain you want to do this?")))return;const t={rearrange_on:this.$rearrangeOn.val(),reversed:!1};this.$reversed[0].checked&&(t.reversed=!0),this.app.buttonClickEvent(this.triggerView,t),this.hide()}}),kt=w.extend({collection:null,template:'<span class="glyphicon glyphicon-list"></span>\n<%- title %>\n<span class="label<% if (length > 0) { %> label-success<% } else { %> label-default<% } %>">\n  <%- length %>\n</span>\n',initialize:function(t){w.prototype.initialize.apply(this,[t]),this.timeout=0,null!==this.collection&&this.collection.on("add remove reset",(()=>{clearTimeout(this.timeout),this.timeout=setTimeout((()=>{this.render(),0===this.collection.length&&this.$el.removeClass("active")}),50)}),this)},serializedModel:function(){const t={icon:"",title:this.options.title,length:0};return null!==this.collection&&(t.length=this.collection.length),t}});p.Z.getLogger("pat-structure/table").setLevel("DEBUG");var $t=f().View.extend({events:{"click a.servernext":"nextResultPage","click a.serverprevious":"previousResultPage","click a.serverlast":"gotoLast","click a.page":"gotoPage","click a.serverfirst":"gotoFirst","click a.serverpage":"gotoPage","click .serverhowmany a":"changeCount"},tagName:"aside",template:a().template('  <ul class="pagination pagination-sm pagination-centered">\n    <li class="page-item <% if (currentPage === 1) { %>disabled<% } %>">\n      <a href="#" class="page-link serverfirst">\n        &laquo;\n      </a>\n    </li>\n    <li class="page-item <% if (currentPage === 1) { %>disabled<% } %>">\n      <a href="#" class="page-link serverprevious">\n        &lt;\n      </a>\n    </li>\n    <% _.each(pages, (p) => { %>\n    <li class="page-item <% if (currentPage == p) { %>active<% } else if ( p == \'...\' ) { %>disabled<% }%>">\n      <a href="#" class="page-link page"><%- p %></a>\n    </li>\n    <% }); %>\n    <li class="page-item <% if (currentPage === totalPages) { %>disabled<% } %>">\n      <a href="#" class="page-link servernext">\n        &gt;\n      </a>\n    </li>\n    <li class="page-item <% if (currentPage === totalPages) { %>disabled<% } %>">\n      <a href="#" class="page-link serverlast">\n        &raquo;\n      </a>\n    </li>\n  </ul>\n\n  <div class="pagination-info"><%- _t("Show:") %></div>\n\n  <ul class="pagination pagination-sm">\n    <li class="page-item serverhowmany serverhowmany15 <% if(pageSize == 15){ %>disabled<% } %>">\n      <a href="#" class="page-link">15</a>\n    </li>\n    <li class="page-item serverhowmany serverhowmany30 <% if(pageSize == 30){ %>disabled<% } %>">\n      <a href="#" class="page-link">30</a>\n    </li>\n    <li class="page-item serverhowmany serverhowmany50 <% if(pageSize == 50){ %>disabled<% } %>">\n      <a href="#" class="page-link">50</a>\n    </li>\n    <li class="page-item serverhowmany serverhowmany250 <% if(pageSize == 250){ %>disabled<% } %>">\n      <a href="#" class="page-link">250</a>\n    </li>\n  </ul>\n\n  <div class="pagination-info">\n    <%- _t("Page:") %> <span class="current"><%- currentPage %></span>\n    <%- _t("of") %>\n    <span class="total"><%- totalPages %></span>\n          <%- _t("shown") %>\n  </div>\n'),maxPages:7,initialize:function(t){this.options=t,this.app=this.options.app,this.collection=this.app.collection,this.listenTo(this.collection,"reset",this.render),this.listenTo(this.collection,"sync",this.render)},render:function(){const t=this.collection.state;t.pages=this.getPages(t);const e=this.template(s().extend({_t:r.ZP},t));return this.$el.html(e),this},getPages:function(t){const e=t.totalPages;if(!e)return[];let i=1,n=e;e>this.maxPages&&(i=Math.max(1,Math.floor(t.currentPage-this.maxPages/2)),n=Math.min(i+this.maxPages,e),n-i<this.maxPages&&(i-=Math.floor(this.maxPages/2)));let s=[];for(let t=i;t<=n;t+=1)s.push(t);return s[0]>1&&(s[0]>2&&(s=["..."].concat(s)),s=[1].concat(s)),s[s.length-1]<e-1&&(s[s.length-2]<e-2&&s.push("..."),s.push(e)),s},nextResultPage:function(t){t.preventDefault(),this.app.clearStatus(),this.collection.getNextPage()},previousResultPage:function(t){t.preventDefault(),this.app.clearStatus(),this.collection.getPreviousPage()},gotoFirst:function(t){t.preventDefault(),this.app.clearStatus(),this.collection.getPage(this.collection.state.firstPage)},gotoLast:function(t){t.preventDefault(),this.app.clearStatus(),this.collection.getPage(this.collection.state.totalPages)},gotoPage:function(t){t.preventDefault(),this.app.clearStatus();const e=parseInt(s()(t.target).text());this.collection.getPage(e)},changeCount:function(t){t.preventDefault(),this.app.clearStatus();const e=parseInt(s()(t.target).text());this.collection.setPageSize(e,{first:!0}),this.app.setCookieSetting("pageSize",e)}}),Ot=Pt.extend({className:"popover attribute-columns",title:a().template('<%- _t("Columns") %>'),content:a().template('\n        <label>\n            <%- _t("Select columns to show, drag and drop to reorder") %>\n        </label>\n        <ul>\n        </ul>\n        <button class="btn btn-block btn-primary btn-sm"><%- _t("Save") %></button>'),itemTemplate:a().template('\n        <li>\n            <label>\n                <input type="checkbox" value="<%- id %>"/>\n                <%- title %>\n            </label>\n        </li>'),events:{"click button":"applyButtonClicked"},initialize:function(t){this.app=t.app,Pt.prototype.initialize.apply(this,[t])},afterRender:function(){this.$container=this.$("ul");for(const t of this.app.activeColumns){const e=s()(this.itemTemplate({title:this.app.availableColumns[t],id:t}));e.find("input")[0].checked=!0,this.$container.append(e)}const t=a().keys(a().omit(this.app.availableColumns,this.app.activeColumns)).sort(((t,e)=>{const i=this.app.availableColumns[t],n=this.app.availableColumns[e];return i<n?-1:i==n?0:1}));for(const e of t){const t=s()(this.itemTemplate({title:this.app.availableColumns[e],id:e}));this.$container.append(t)}return new T.Z(this.$container,{selector:"li"}),this},async applyButtonClicked(){this.hide(),this.app.activeColumns=[];for(const t of this.$("input:checked"))this.app.activeColumns.push(s()(t).val());this.app.setCookieSetting(this.app.activeColumnsCookie,this.app.activeColumns),await this.app.tableView.render()}}),Tt=i(73918),Et=g.extend({tagName:"div",className:"navbar-search form-search ui-offset-parent",template:a().template('<div class="input-group"><input id="textFilterInput" type="text" class="form-control search-query" aria-label="<%- _t("Search") %>" placeholder="<%- _t("Search") %>"></div>'),popoverContent:a().template('<input class="pat-querystring" />'),events:{"keyup .search-query":"filter"},term:null,timeoutId:null,keyupDelay:300,statusKeyFilter:"textfilter_status_message_filter",statusKeySorting:"textfilter_status_message_sorting",initialize:function(t){g.prototype.initialize.apply(this,[t]),this.app=this.options.app},setFilterStatusMessage:function(){const t=s()('<button type="button" class="btn btn-primary btn-sm"></button>').text((0,r.ZP)("Clear")).on("click",(()=>this.clearFilter())),e=(0,r.ZP)("This listing has filters applied. Not all items are shown.");this.app.setStatus({text:e,type:"success"},t,!0,this.statusKeyFilter);const i=(0,r.ZP)("Drag and drop reordering is disabled while filters are applied.");this.app.setStatus({text:i,type:"warning"},null,!0,this.statusKeySorting)},clearFilterStatusMessage:function(){this.term||this.app.additionalCriterias.length||(this.app.clearStatus(this.statusKeyFilter),this.app.clearStatus(this.statusKeySorting))},setTerm:function(t,e){const i=this.$el[0].querySelector(".search-query");if(this.term=encodeURIComponent(t),e&&(i.value=t),this.app.collection.currentPage=1,this.app.collection.fetch(),t)i.classList.add("has-filter"),this.setFilterStatusMessage();else{let t=!1;try{const e=this.$queryString.val();e&&JSON.parse(e).length>0&&(t=!0)}finally{t||(i.classList.remove("has-filter"),this.clearFilterStatusMessage())}}},setQuery:function(t,e){let i=null,n=null;try{"string"==typeof t?(n=JSON.parse(t),i=t):(i=JSON.stringify(t),n=t)}catch(t){n=[],i="[]"}e&&this.$queryString.val(i),this.app.additionalCriterias=n,this.app.collection.currentPage=1,this.app.collection.fetch(),n.length?(this.button.$el[0].classList.add("has-filter"),this.setFilterStatusMessage()):this.term||(this.button.$el[0].classList.remove("has-filter"),this.clearFilterStatusMessage())},clearTerm:function(){this.setTerm("",!0)},clearFilter:function(){this.setTerm("",!0),this.setQuery([],!0)},render:function(){return this.$el.html(this.template({_t:r.ZP})),this.button=new w({title:(0,r.ZP)("Filter"),icon:"filter",extraClasses:["btn-queryfilter"]}),this.popover=new Pt({triggerView:this.button,id:"structure-query",title:a().template((0,r.ZP)("Filter")),content:this.popoverContent,placement:"left"}),this.$el.find(".input-group").append(this.button.render().el),this.$el.append(this.popover.render().el),this.popover.$el.addClass("query"),this.$queryString=this.popover.$("input.pat-querystring"),this.queryString=new Tt.Z(this.$queryString,{indexOptionsUrl:this.app.options.indexOptionsUrl,showPreviews:!1}),this.queryString.$el.on("change",(()=>{this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout((()=>{this.setQuery(this.$queryString.val(),!1)}),this.keyupDelay)})),this.queryString.$el.on("initialized",(()=>{this.queryString.$sortOn.on("change",(()=>{this.app.sort_on=this.queryString.$sortOn.val(),this.app.collection.currentPage=1,this.app.collection.fetch()})),this.queryString.$sortOrder.change((()=>{this.queryString.$sortOrder[0].checked?this.app.sort_order="reverse":this.app.sort_order="ascending",this.app.collection.currentPage=1,this.app.collection.fetch()}))})),this},filter:function(t){this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout((()=>{const e=s()(t.currentTarget);this.setTerm(e.val(),!1)}),this.keyupDelay)}}),It=i(37103),Dt=Pt.extend({className:"popover upload",title:a().template('<%- _t("Upload files") %>'),content:a().template('<input type="text" name="upload" style="display:none" /><div class="uploadify-me"></div>'),initialize(t){this.app=t.app,Pt.prototype.initialize.apply(this,[t]),this.currentPathData=null,s()("body").on("context-info-loaded",((t,e)=>{this.currentPathData=e}))},render(){Pt.prototype.render.call(this);var t=this.app.options.upload;return t.success=()=>{this.app.collection.fetch()},t.currentPath=this.app.getCurrentPath(),t.allowPathSelection=!1,this.upload=new It.default(this.$(".uploadify-me").addClass("pat-upload"),t),this},toggle(t,e){if(Pt.prototype.toggle.apply(this,[t,e]),this.opened){var i=this.app.getCurrentPath();this.currentPathData&&i!==this.upload.currentPath&&this.upload.setPath(i)}}}),At=f().Collection.extend({model:S,removeResult:function(t){return this.removeByUID(t.uid())},removeByUID:function(t){var e=this.getByUID(t);return e&&this.remove(e),e},getByUID:function(t){return this.findWhere({UID:t})}}),Nt=(i(88816),f().PageableCollection.extend({model:S,mode:"server",initialize:function(t,e){this.options=e,this.view=e.view,this.url=e.url,this.queryHelper=c.Z.QueryHelper({attributes:this.view.options.queryHelperAttributes,...this.view.options}),this.queryParser=function(t){void 0===t&&(t={});const e=this.view?.toolbar?.get?.("filter")?.term||null,i=this.view?.sort_on||"getObjPositionInParent",n=this.view.sort_order;return JSON.stringify({criteria:this.queryHelper.getCriterias(e,{additionalCriterias:this.view.additionalCriterias,...t}),sort_on:i,sort_order:n})},"#/"===window.location.hash.substring(0,2)&&(this.queryHelper.currentPath=window.location.hash.substring(1)),f().PageableCollection.prototype.initialize.apply(this,[t,e])},getCurrentPath:function(){return this.queryHelper.getCurrentPath()},setCurrentPath:function(t){this.queryHelper.currentPath=t},queryParams:{query:function(){return this.queryParser()},batch:function(){return this.queryHelper.options.batchSize=this.state.pageSize,JSON.stringify(this.queryHelper.getBatch(this.state.currentPage))},attributes:function(){return JSON.stringify(this.queryHelper.options.attributes)}},parseState:function(t,e,i,n){this.state.totalRecords=t.total,this.state.totalPages=Math.ceil(t.total/i.pageSize)},parseRecords:function(t,e){const i=t.results;return i.forEach(((t,e)=>{t._sort=e})),i}}));const Zt=p.Z.getLogger("pat-structure/app");var Vt=g.extend({tagName:"div",statusTemplate:a().template('<div class="alert alert-<%- type %> status fc-status">\n  <strong class="fc-status-label"><%- label %></strong>\n  <span class="fc-status-text">\n    <% if(text){ %>\n    <%- text %>\n    <% } else { %>\n    &nbsp;<% // &nbsp; to get correct height for empty alerts %>\n    <% } %>\n  </span>\n</div>\n'),statusMessages:[],sort_on:"getObjPositionInParent",sort_order:"ascending",additionalCriterias:[],cookieSettingPrefix:"_fc_",buttons:null,textfilter:null,forms:[],pasteAllowed:function(){return!!u().get("__cp")},initialize:function(t){g.prototype.initialize.apply(this,[t]),this.loading=new c.Z.Loading,this.loading.show(),s()(document).on("click",(t=>{const e=s()(t.target);if(!e.is(":visible")||"hidden"===e.css("visibility")||"0"===e.css("opacity"))return;if(e.is("a")||e.parent().is("a"))return;const i=s()(".popover:visible");if(i.length>0&&!s().contains(i[0],e[0])){const t=i.data("component");t&&t.hide()}})),this.collection=new Nt([],{view:this,url:this.options.collectionUrl}),this.activeColumns=this.getCookieSetting(this.activeColumnsCookie,this.activeColumns),this.selectedCollection=new At,this.pagingView=new $t({app:this}),this.tableView=new wt({app:this}),this.collection.state.pageSize=this.getCookieSetting("pageSize",15),this.collection.fetch(),this.setupButtons(),this.wellView=new _t({collection:this.selectedCollection,triggerView:this.toolbar.get("selected-items"),app:this,id:"selected-items"}),this.toolbar.get("selected-items").disable(),this.buttons.disable();let e=0;this.selectedCollection.on("add remove reset",(()=>{clearTimeout(e),e=setTimeout((()=>{this.updateButtons()}),100)}),this),this.collection.on("sync",(()=>{if(this.contextInfoUrl&&s().ajax({url:this.getAjaxUrl(this.contextInfoUrl),dataType:"json",success:t=>{s()("body").trigger("context-info-loaded",[t])},error:t=>{404===t.status&&Zt.info("context info url not found")}}),this.doNotPushState)return void(this.doNotPushState=!1);this.loading.show(),this.updateButtons();let t,e=this.getCurrentPath();if("/"===e&&(e=""),this.options.pushStateUrl){t=this.options.pushStateUrl.replace("/{path}","{path}").replace("{path}",e),window.history.pushState(null,null,t)}else this.options.urlStructure&&(t=this.options.urlStructure.base+e+this.options.urlStructure.appended,window.history.pushState(null,null,t));this.options.traverseView&&(e=""),s()("body").trigger("structure-url-changed",[e]),this.loading.hide()})),(this.options.pushStateUrl||this.options.urlStructure)&&c.Z.featureSupport.history()&&(s()(window).on("popstate",(()=>{let t,e,i=c.Z.getWindow().location.href;if(-1!==i.indexOf("?")&&(i=i.split("?")[0]),-1!==i.indexOf("#")&&(i=i.split("#")[0]),this.options.pushStateUrl){const i=this.options.pushStateUrl.split("{path}");t=i[0],e=i[1]}else t=this.options.urlStructure.base,e=this.options.urlStructure.appended;let n=i.substring(t.length);n.substring(n.length-e.length)===e&&(n=n.substring(0,n.length-e.length)),n||(n="/"),this.setCurrentPath(n),s()("body").trigger("structure-url-changed",[n]),this.doNotPushState=!0,this.collection.getPage(this.collection.state.firstPage)})),s()(document).on("keyup keydown",(t=>{this.keyEvent=t}))),this.togglePasteBtn()},updateButtons:function(){this.selectedCollection.length?(this.toolbar.get("selected-items").enable(),this.buttons.enable()):(this.toolbar.get("selected-items").disable(),this.buttons.disable()),this.togglePasteBtn()},togglePasteBtn:function(){a().find(this.buttons.items,(t=>"paste"===t.id))&&(this.pasteAllowed()?this.buttons.get("paste").enable():this.buttons.get("paste").disable())},inQueryMode:function(){return!(!this.toolbar||!this.toolbar.get("filter").term)||(this.additionalCriterias.length>0||(!(!this.sort_on||"getObjPositionInParent"===this.sort_on)||"ascending"!==this.sort_order))},getSelectedUids:function(t){void 0===t&&(t=this.selectedCollection);const e=[];return t.each((function(t){e.push(t.uid())})),e},getCurrentPath:function(){return this.collection.getCurrentPath()},setCurrentPath:function(t){this.collection.setCurrentPath(t),this.clearStatus()},getAjaxUrl:function(t){return t.replace("{path}",this.getCurrentPath())},buttonClickEvent:function(t){let e=null,i=null;if(t.url){if(this.loading.show(),arguments.length>1){const t=arguments[1];t.preventDefault||(e=t)}if(arguments.length>2){const t=arguments[2];"function"==typeof t&&(i=t)}null===e&&(e={}),void 0===e.selection&&(e.selection=JSON.stringify(this.getSelectedUids())),e._authenticator=c.Z.getAuthenticator(),void 0===e.folder&&(e.folder=this.getCurrentPath());const n=this.getAjaxUrl(t.url);s().ajax({url:n,type:"POST",data:e,success:t=>{this.ajaxSuccessResponse.apply(this,[t,i]),this.loading.hide()},error:t=>{this.ajaxErrorResponse.apply(this,[t,n]),this.loading.hide()}},this)}},ajaxSuccessResponse:function(t,e){this.clearStatus(),this.selectedCollection.reset(),"success"===t.status&&this.collection.reset(),t.msg&&this.setStatus({text:t.msg,type:t.status||"warning"}),null!=e&&e(t),this.collection.fetch()},ajaxErrorResponse:function(t,e){404===t.status?window.alert((0,r.ZP)("operation url ${url} is not valid",{url:e})):window.alert((0,r.ZP)("there was an error performing the action"))},setupButtons:function(){const t=[],e=new w({id:"structure-columns",tooltip:(0,r.ZP)("Configure displayed columns"),icon:"plone-three-dots"});if(this.columnsView=new Ot({app:this,triggerView:e,id:"structure-columns",placement:"bottom-right"}),t.push(e),t.push(new kt({title:(0,r.ZP)("Selected"),id:"selected-items",tooltip:(0,r.ZP)("Manage selection"),collection:this.selectedCollection,icon:"plone-selection"})),this.options.rearrange){const e=new w({id:"structure-rearrange",title:(0,r.ZP)("Rearrange"),icon:"plone-rearrange",tooltip:(0,r.ZP)("Rearrange folder contents"),url:this.options.rearrange.url});this.rearrangeView=new St({triggerView:e,app:this,id:"structure-rearrange"}),t.push(e)}if(this.options.upload&&c.Z.featureSupport.dragAndDrop()&&c.Z.featureSupport.fileApi()){const e=new w({id:"upload",title:(0,r.ZP)("Upload"),tooltip:(0,r.ZP)("Upload files"),icon:"upload"});this.uploadView=new Dt({triggerView:e,app:this,id:"upload"}),t.push(e)}const i=[];for(const t of this.options.buttons)try{const e=new w(t);if(i.push(e),e.form){t.triggerView=e,t.app=this;const i=new xt(t);this.forms.push(i.el)}else e.on("button:click",(()=>this.buttonClickEvent(e)),this)}catch(e){Zt.error(`Error initializing button ${t.title||t.id} ${e}`)}this.buttons=new v({items:i,id:"mainbuttons",app:this}),t.push(this.buttons),this.textfilter=new Et({id:"filter",app:this}),t.push(this.textfilter),this.toolbar=new b({items:t})},moveItem:function(t,e,i){s().ajax({url:this.getAjaxUrl(this.options.moveUrl),type:"POST",data:{delta:e,id:t,_authenticator:c.Z.getAuthenticator(),subsetIds:JSON.stringify(i)},dataType:"json",success:t=>{this.clearStatus(),t.msg?this.setStatus({text:t.msg}):"success"!==t.status&&this.setStatus({text:(0,r.ZP)("Error moving item"),type:"danger"}),this.collection.fetch()},error:()=>{this.clearStatus(),this.setStatus({text:(0,r.ZP)("Error moving item"),type:"danger"})}})},clearStatus:function(t){const e=this.$el[0].querySelector(".fc-status-container");let i=[];t?(i=this.statusMessages.filter((function(e){return e.key===t})),i.forEach((function(t){try{e.removeChild(t.el)}catch(t){}})),this.statusMessages=this.statusMessages.filter((function(e){return e.key!==t}))):(this.statusMessages.forEach(function(t){if(!t.fixed)try{e.removeChild(t.el),i.push(t)}catch(t){}}.bind(this)),this.statusMessages=this.statusMessages.filter((function(t){return-1===i.indexOf(t)})))},setStatus:function(t,e,i,n){if(n&&this.statusMessages.filter((function(t){return t.key===n})).length>0)return;const o=l.Z.create_from_string(this.statusTemplate({label:t.label||"",text:t.text,type:t.type||"warning"})).lastChild;e&&(e=s()(e)[0],o.appendChild(e)),t={el:o,fixed:i,key:n};return this.$el[0].querySelector(".fc-status-container").appendChild(t.el),this.statusMessages.push(t),t},render:async function(){this.$el.append(this.toolbar.render().el),this.wellView&&this.$el.find("#btn-"+this.wellView.id).after((await this.wellView.render()).el);for(const t of this.forms){const e=s()(t).attr("id"),i=this.$el.find("#btn-"+e);i.closest(".btn-group").length?i.closest(".btn-group").after(t):this.$el.find("#btn-"+e).after(t)}return this.$el.append(l.Z.create_from_string('<div class="fc-status-container"></div>')),this.columnsView&&this.$el.find("#btn-"+this.columnsView.id).after(this.columnsView.render().el),this.rearrangeView&&this.$el.find("#btn-"+this.rearrangeView.id).after(this.rearrangeView.render().el),this.uploadView&&this.$el.find("#btn-"+this.uploadView.id).after(this.uploadView.render().el),this.$el.append(this.tableView.el),this.$el.append(this.pagingView.el),null!==this.options.backdropSelector?s()(this.options.backdropSelector).addClass("ui-backdrop-element"):this.$el.addClass("ui-backdrop-element"),this},getCookieSetting:function(t,e){let i;void 0===e&&(e=null);try{i=u().get(this.cookieSettingPrefix+t),i=JSON.parse(i).value}catch(t){return e}return null==i?e:i},setCookieSetting:function(t,e){u().set(this.cookieSettingPrefix+t,JSON.stringify({value:e}))}})}}]);
//# sourceMappingURL=96633.fb9edb28a30aa6828658.min.js.map