define("mockup-patterns-inlinevalidation",["jquery","pat-base"],function(r,e){"use strict";return e.extend({name:"inlinevalidation",trigger:".pat-inlinevalidation",parser:"mockup",render_error:function(e,t){var n=r("div.fieldErrorBox",e);""!==t?(e.addClass("error"),n.html(t)):(e.removeClass("error"),n.html(""))},render_error_bootstrap:function(e,t){var n=r("input",e),i=r(".invalid-feedback",e);""!==t?(n.addClass("is-invalid"),i.length?i.html(t):r('<div class="invalid-feedback">'+t+"</div>").appendTo(e)):(n.removeClass("is-invalid"),i.length&&i.remove())},append_url_path:function(e,t){var n,i=e.split(/\?/),o=i[0];for("/"!==o[o.length-1]&&(o+="/"),o+=t,n=1;n<i.length;n+=1)o+="?"+i[n];return o},queue:function(e,t){void 0===t&&(t=e,e="fx"),r(window).queue(e,t)},validate_archetypes_field:function(e){var t=r(e),n=t.closest(".field"),i=n.attr("data-uid"),o=n.attr("data-fieldname"),e=t.val();t.prop("multiple")&&null===e&&(e=r([]).serialize());var a=r.param({uid:i,fname:o,value:e},!0);n&&i&&o&&this.queue(r.proxy(function(t){r.ajax({type:"POST",url:r("base").attr("href")+"/at_validate_field?"+a,iframe:!1,success:r.proxy(function(e){this.render_error(n,e.errmsg),t()},this),error:function(){t()},dataType:"json"})},this))},validate_formlib_field:function(e){var n=r(e).closest(".field"),i=n.closest("form").clone(),o=n.attr("data-fieldname");i.find("input[type=file]").remove(),this.queue(r.proxy(function(t){i.ajaxSubmit({url:this.append_url_path(i.attr("action"),"@@formlib_validate_field"),data:{fname:o},iframe:!1,success:r.proxy(function(e){this.render_error(n,e.errmsg),t()},this),error:function(){t()},dataType:"json"})},this))},validate_z3cform_field:function(e){var t=r(e),n=t.closest(".field"),e=n.closest("form"),i=e.clone(),o=t.closest("fieldset").data("fieldset"),a=n.data("fieldname");r.each(r("select",e),function(e,t){r('select[name="'+t.name+'"]',i).val(r(t).val())}),i.find("input[type=file]").remove(),a&&this.queue(r.proxy(function(t){i.ajaxSubmit({url:this.append_url_path(i.attr("action"),"@@z3cform_validate_field"),data:{fname:a,fset:o},iframe:!1,success:r.proxy(function(e){this.render_error_bootstrap(n,e.errmsg),t()},this),error:function(){t()},dataType:"json"})},this))},init:function(){this.$el.find('input[type="text"], input[type="password"], input[type="checkbox"], select, textarea').on("blur",r.proxy(function(e){"archetypes"===this.options.type?this.validate_archetypes_field(e.target):"z3c.form"===this.options.type?this.validate_z3cform_field(e.target):"formlib"===this.options.type&&this.validate_formlib_field(e.target)},this))}})}),function(e){define("resource-plone-app-jquerytools-js",["jquery"],function(){return function(){function p(e,t){var n=f(t);return n.length<2?n:e.parent().find(t)}function n(e,a){var i,o,t,r=this,s=e.add(r),l=e.children(),c=0,d=a.vertical;m=m||r,1<l.length&&(l=f(a.items,e)),1<a.size&&(a.circular=!1),f.extend(r,{getConf:function(){return a},getIndex:function(){return c},getSize:function(){return r.getItems().size()},getNaviButtons:function(){return n.add(h)},getRoot:function(){return e},getItemWrap:function(){return l},getItems:function(){return l.find(a.item).not("."+a.clonedClass)},move:function(e,t){return r.seekTo(c+e,t)},next:function(e){return r.move(a.size,e)},prev:function(e){return r.move(-a.size,e)},begin:function(e){return r.seekTo(0,e)},end:function(e){return r.seekTo(r.getSize()-1,e)},focus:function(){return m=r},addItem:function(e){return e=f(e),a.circular?(l.children().last().before(e),l.children().first().replaceWith(e.clone().addClass(a.clonedClass))):(l.append(e),h.removeClass("disabled")),s.trigger("onAddItem",[e]),r},seekTo:function(e,t,n){if(e.jquery||(e*=1),a.circular&&0===e&&-1==c&&0!==t)return r;if(!a.circular&&e<0||e>r.getSize()||e<-1)return r;var i=e;e.jquery?e=r.getItems().index(e):i=r.getItems().eq(e);var o=f.Event("onBeforeSeek");if(!n&&(s.trigger(o,[e,t]),o.isDefaultPrevented()||!i.length))return r;i=d?{top:-i.position().top}:{left:-i.position().left};return c=e,m=r,void 0===t&&(t=a.speed),l.animate(i,t,a.easing,n||function(){s.trigger("onSeek",[e])}),r}}),f.each(["onBeforeSeek","onSeek","onAddItem"],function(e,t){f.isFunction(a[t])&&f(r).on(t,a[t]),r[t]=function(e){return e&&f(r).on(t,e),r}}),a.circular&&(i=r.getItems().slice(-1).clone().prependTo(l),o=r.getItems().eq(1).clone().appendTo(l),i.add(o).addClass(a.clonedClass),r.onBeforeSeek(function(e,t,n){if(!e.isDefaultPrevented())return-1==t?(r.seekTo(i,n,function(){r.end(0)}),e.preventDefault()):void(t==r.getSize()&&r.seekTo(o,n,function(){r.begin(0)}))}),(t=e.parents().add(e).filter(function(){if("none"===f(this).css("display"))return!0})).length?(t.show(),r.seekTo(0,0,function(){}),t.hide()):r.seekTo(0,0,function(){}));var u,n=p(e,a.prev).click(function(e){e.stopPropagation(),r.prev()}),h=p(e,a.next).click(function(e){e.stopPropagation(),r.next()});a.circular||(r.onBeforeSeek(function(e,t){setTimeout(function(){e.isDefaultPrevented()||(n.toggleClass(a.disabledClass,t<=0),h.toggleClass(a.disabledClass,t>=r.getSize()-1))},1)}),a.initialIndex||n.addClass(a.disabledClass)),r.getSize()<2&&n.add(h).addClass(a.disabledClass),a.mousewheel&&f.fn.mousewheel&&e.mousewheel(function(e,t){if(a.mousewheel)return r.move(t<0?1:-1,a.wheelSpeed||50),!1}),a.touch&&(u={},l[0].ontouchstart=function(e){e=e.touches[0];u.x=e.clientX,u.y=e.clientY},l[0].ontouchmove=function(e){var t,n;1!=e.touches.length||l.is(":animated")||(n=e.touches[0],t=u.x-n.clientX,n=u.y-n.clientY,r[d&&0<n||!d&&0<t?"next":"prev"](),e.preventDefault())}),a.keyboard&&f(document).on("keydown.scrollable",function(e){if(!(!a.keyboard||e.altKey||e.ctrlKey||e.metaKey||f(e.target).is(":input")||"static"!=a.keyboard&&m!=r)){var t=e.keyCode;return!d||38!=t&&40!=t?d||37!=t&&39!=t?void 0:(r.move(37==t?-1:1),e.preventDefault()):(r.move(38==t?-1:1),e.preventDefault())}}),a.initialIndex&&r.seekTo(a.initialIndex,0,function(){})}var f,m,i,o,a,r,t,s,l,c,d,u,h,g;function v(e){var t;e&&((t=a.contentWindow.document).open().close(),t.location.hash=e)}function y(){if(/msie/.test(navigator.userAgent.toLowerCase())){var e=s(document).height(),t=s(window).height();return[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,e-t<20?t:e]}return[s(document).width(),s(document).height()]}function b(e){if(e)return e.call(s.mask)}!function(f){f.tools=f.tools||{version:"@VERSION"},f.tools.overlay={addEffect:function(e,t,n){g[e]=[t,n]},conf:{close:null,closeOnClick:!0,closeOnEsc:!0,closeSpeed:"fast",effect:"default",fixed:!/msie/.test(navigator.userAgent.toLowerCase())||6<navigator.appVersion,left:"center",load:!1,mask:null,oneInstance:!0,speed:"normal",target:null,top:"10%"}};var m=[],g={};function n(e,r){var t,s,l=this,c=e.add(l),d=f(window),u=f.tools.expose&&(r.mask||r.expose),h=Math.random().toString().slice(10);u&&("string"==typeof u&&(u={color:u}),u.closeOnClick=u.closeOnEsc=!1);var p,n=r.target||e.attr("rel");if(!(p=n?f(n):e).length)throw"Could not find Overlay: "+n;e&&-1==e.index(p)&&e.click(function(e){return l.load(e),e.preventDefault()}),f.extend(l,{load:function(e){if(l.isOpened())return l;var t=g[r.effect];if(!t)throw'Overlay: cannot find effect : "'+r.effect+'"';if(r.oneInstance&&f.each(m,function(){this.close(e)}),(e=e||f.Event()).type="onBeforeLoad",c.trigger(e),e.isDefaultPrevented())return l;s=!0,u&&f(p).expose(u);var n=r.top,i=r.left,o=p.outerWidth(!0),a=p.outerHeight(!0);return"string"==typeof n&&(n="center"==n?Math.max((d.height()-a)/2,0):parseInt(n,10)/100*d.height()),"center"==i&&(i=Math.max((d.width()-o)/2,0)),t[0].call(l,{top:n,left:i},function(){s&&(e.type="onLoad",c.trigger(e))}),u&&r.closeOnClick&&f.mask.getMask().one("click",l.close),r.closeOnClick&&f(document).on("click."+h,function(e){f(e.target).parents(p).length||l.close(e)}),r.closeOnEsc&&f(document).on("keydown."+h,function(e){27==e.keyCode&&l.close(e)}),l},close:function(e){return l.isOpened()?((e=e||f.Event()).type="onBeforeClose",c.trigger(e),e.isDefaultPrevented()?void 0:(s=!1,g[r.effect][1].call(l,function(){e.type="onClose",c.trigger(e)}),f(document).off("click."+h+" keydown."+h),u&&f.mask.close(),l)):l},getOverlay:function(){return p},getTrigger:function(){return e},getClosers:function(){return t},isOpened:function(){return s},getConf:function(){return r}}),f.each("onBeforeLoad,onStart,onLoad,onBeforeClose,onClose".split(","),function(e,t){f.isFunction(r[t])&&f(l).on(t,r[t]),l[t]=function(e){return e&&f(l).on(t,e),l}}),(t=p.find(r.close||".close")).length||r.close||(t=f('<a class="close"></a>'),p.prepend(t)),t.click(function(e){l.close(e)}),r.load&&l.load()}f.tools.overlay.addEffect("default",function(e,t){var n=this.getConf(),i=f(window);n.fixed||(e.top+=i.scrollTop(),e.left+=i.scrollLeft()),e.position=n.fixed?"fixed":"absolute",this.getOverlay().css(e).fadeIn(n.speed,t)},function(e){this.getOverlay().fadeOut(this.getConf().closeSpeed,e)}),f.fn.overlay=function(e){var t=this.data("overlay");return t||(f.isFunction(e)&&(e={onBeforeLoad:e}),e=f.extend(!0,{},f.tools.overlay.conf,e),this.each(function(){t=new n(f(this),e),m.push(t),f(this).data("overlay",t)}),e.api?t:this)}}(jQuery),(f=jQuery).tools=f.tools||{version:"@VERSION"},f.tools.scrollable={conf:{activeClass:"active",circular:!1,clonedClass:"cloned",disabledClass:"disabled",easing:"swing",initialIndex:0,item:"> *",items:".items",keyboard:!0,mousewheel:!1,next:".next",prev:".prev",size:1,speed:400,vertical:!1,touch:!0,wheelSpeed:0}},f.fn.scrollable=function(e){var t=this.data("scrollable");return t||(e=f.extend({},f.tools.scrollable.conf,e),this.each(function(){t=new n(f(this),e),f(this).data("scrollable",t)}),e.api?t:this)},function(u){u.tools=u.tools||{version:"@VERSION"},u.tools.tabs={conf:{tabs:"a",current:"current",onBeforeClick:null,onClick:null,effect:"default",initialEffect:!1,initialIndex:0,event:"click",rotate:!1,slideUpSpeed:400,slideDownSpeed:400,history:!1},addEffect:function(e,t){h[e]=t}};var i,o,h={default:function(e,t){this.getPanes().hide().eq(e).show(),t.call()},fade:function(e,t){var n=this.getConf(),i=n.fadeOutSpeed,o=this.getPanes();i?o.fadeOut(i):o.hide(),o.eq(e).fadeIn(n.fadeInSpeed,t)},slide:function(e,t){var n=this.getConf();this.getPanes().slideUp(n.slideUpSpeed),this.getPanes().eq(e).slideDown(n.slideDownSpeed,t)},ajax:function(e,t){this.getPanes().eq(0).load(this.getTabs().eq(e).attr("href"),t)}};function a(a,e,r){var s,l=this,c=a.add(this),d=a.find(r.tabs),t=e.jquery?e:a.children(e);d.length||(d=a.children()),t.length||(t=a.parent().find(e)),t.length||(t=u(e)),u.extend(this,{click:function(e,t){var n=d.eq(e),i=!a.data("tabs");if("string"==typeof e&&e.replace("#","")&&(n=d.filter('[href*="'+e.replace("#","")+'"]'),e=Math.max(d.index(n),0)),r.rotate){var o=d.length-1;if(e<0)return l.click(o,t);if(o<e)return l.click(0,t)}if(!n.length){if(0<=s)return l;e=r.initialIndex,n=d.eq(e)}if(e===s)return l;if((t=t||u.Event()).type="onBeforeClick",c.trigger(t,[e]),!t.isDefaultPrevented()){i=i?r.initialEffect&&r.effect||"default":r.effect;return h[i].call(l,e,function(){s=e,t.type="onClick",c.trigger(t,[e])}),d.removeClass(r.current),n.addClass(r.current),l}},getConf:function(){return r},getTabs:function(){return d},getPanes:function(){return t},getCurrentPane:function(){return t.eq(s)},getCurrentTab:function(){return d.eq(s)},getIndex:function(){return s},next:function(){return l.click(s+1)},prev:function(){return l.click(s-1)},destroy:function(){return d.off(r.event).removeClass(r.current),t.find('a[href^="#"]').off("click.T"),l}}),u.each("onBeforeClick,onClick".split(","),function(e,t){u.isFunction(r[t])&&u(l).on(t,r[t]),l[t]=function(e){return e&&u(l).on(t,e),l}}),r.history&&u.fn.history&&(u.tools.history.init(d),r.event="history"),d.each(function(t){u(this).on(r.event,function(e){return l.click(t,e),e.preventDefault()})}),t.find('a[href^="#"]').on("click.T",function(e){l.click(u(this).attr("href"),e)}),location.hash&&"a"==r.tabs&&a.find('[href="'+location.hash+'"]').length?l.click(location.hash):(0===r.initialIndex||0<r.initialIndex)&&l.click(r.initialIndex)}u.tools.tabs.addEffect("horizontal",function(e,t){var n;i||(n=this.getPanes().eq(e),e=this.getCurrentPane(),o=o||this.getPanes().eq(0).width(),i=!0,n.show(),e.animate({width:0},{step:function(e){n.css("width",o-e)},complete:function(){u(this).hide(),t.call(),i=!1}}),e.length||(t.call(),i=!1))}),u.fn.tabs=function(e,t){var n=this.data("tabs");return n&&(n.destroy(),this.removeData("tabs")),u.isFunction(t)&&(t={onBeforeClick:t}),t=u.extend({},u.tools.tabs.conf,t),this.each(function(){n=new a(u(this),e,t),u(this).data("tabs",n)}),t.api?n:this}}(jQuery),(i=jQuery).tools=i.tools||{version:"@VERSION"},i.tools.history={init:function(e){t||(i.browser.msie&&i.browser.version<"8"?a||(a=i("<iframe/>").attr("src","javascript:false;").hide().get(0),i("body").append(a),setInterval(function(){var e=a.contentWindow.document.location.hash;o!==e&&i(window).trigger("hash",e)},100),v(location.hash||"#")):setInterval(function(){var e=location.hash;e!==o&&i(window).trigger("hash",e)},100),r=r?r.add(e):e,e.click(function(e){var t=i(this).attr("href");if(a&&v(t),"#"!=t.slice(0,1))return location.href="#"+t,e.preventDefault()}),t=!0)}},i(window).on("hash",function(e,t){(t?r.filter(function(){var e=i(this).attr("href");return e==t||e==t.replace("#","")}):r.eq(0)).trigger("history",[t]),o=t}),i.fn.history=function(e){return i.tools.history.init(this),this.on("history",e)},(s=jQuery).tools=s.tools||{version:"@VERSION"},l=s.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",closeSpeed:"fast",closeOnClick:!0,closeOnEsc:!0,zIndex:9998,opacity:.8,startOpacity:0,color:"#fff",onLoad:null,onClose:null}},s.mask={load:function(e,t){if(u)return this;"string"==typeof e&&(e={color:e}),e=e||h,h=e=s.extend(s.extend({},l.conf),e),(c=s("#"+e.maskId)).length||(c=s("<div/>").attr("id",e.maskId),s("body").append(c));var n=y();return c.css({position:"absolute",top:0,left:0,width:n[0],height:n[1],display:"none",opacity:e.startOpacity,zIndex:e.zIndex}),e.color&&c.css("backgroundColor",e.color),!1===b(e.onBeforeLoad)||(e.closeOnEsc&&s(document).on("keydown.mask",function(e){27==e.keyCode&&s.mask.close(e)}),e.closeOnClick&&c.on("click.mask",function(e){s.mask.close(e)}),s(window).on("resize.mask",function(){s.mask.fit()}),t&&t.length&&(g=t.eq(0).css("zIndex"),s.each(t,function(){var e=s(this);/relative|absolute|fixed/i.test(e.css("position"))||e.css("position","relative")}),d=t.css({zIndex:Math.max(e.zIndex+1,"auto"==g?0:g)})),c.css({display:"block"}).fadeTo(e.loadSpeed,e.opacity,function(){s.mask.fit(),b(e.onLoad),u="full"}),u=!0),this},close:function(){if(u){if(!1===b(h.onBeforeClose))return this;c.fadeOut(h.closeSpeed,function(){d&&d.css({zIndex:g}),u=!1,b(h.onClose)}),s(document).off("keydown.mask"),c.off("click.mask"),s(window).off("resize.mask")}return this},fit:function(){var e;u&&(e=y(),c.css({width:e[0],height:e[1]}))},getMask:function(){return c},isLoaded:function(e){return e?"full"==u:u},getConf:function(){return h},getExposed:function(){return d}},s.fn.mask=function(e){return s.mask.load(e),this},s.fn.expose=function(e){return s.mask.load(e,this),this},function(m){m.tools=m.tools||{version:"@VERSION"},m.tools.tooltip={conf:{effect:"toggle",fadeOutSpeed:"fast",predelay:0,delay:30,opacity:1,tip:0,fadeIE:!1,position:["top","center"],offset:[0,0],relative:!1,cancelDefault:!0,events:{def:"mouseenter,mouseleave",input:"focus,blur",widget:"focus mouseenter,blur mouseleave",tooltip:"mouseenter,mouseleave"},layout:"<div/>",tipClass:"tooltip"},addEffect:function(e,t,n){g[e]=[t,n]}};var g={toggle:[function(e){var t=this.getConf(),n=this.getTip(),t=t.opacity;t<1&&n.css({opacity:t}),n.show(),e.call()},function(e){this.getTip().hide(),e.call()}],fade:[function(e){var t=this.getConf();!/msie/.test(navigator.userAgent.toLowerCase())||t.fadeIE?this.getTip().fadeTo(t.fadeInSpeed,t.opacity,e):(this.getTip().show(),e())},function(e){var t=this.getConf();!/msie/.test(navigator.userAgent.toLowerCase())||t.fadeIE?this.getTip().fadeOut(t.fadeOutSpeed,e):(this.getTip().hide(),e())}]};function v(e,t,n){var i=(n.relative?e.position():e.offset()).top,o=(n.relative?e.position():e.offset()).left,a=n.position[0];i-=t.outerHeight()-n.offset[0],o+=e.outerWidth()+n.offset[1],/iPad/i.test(navigator.userAgent)&&(i-=m(window).scrollTop());var r=t.outerHeight()+e.outerHeight();"center"==a&&(i+=r/2),"bottom"==a&&(i+=r),a=n.position[1];e=t.outerWidth()+e.outerWidth();return"center"==a&&(o-=e/2),"left"==a&&(o-=e),{top:i,left:o}}function n(n,i){var o,a,r=this,s=n.add(r),l=0,c=0,d=n.attr("title"),u=n.attr("data-tooltip"),h=g[i.effect],e=n.is(":input"),t=e&&n.is(":checkbox, :radio, select, :button, :submit"),p=n.attr("type"),f=i.events[p]||i.events[e?t?"widget":"input":"def"];if(!h)throw'Nonexistent effect "'+i.effect+'"';if(2!=(f=f.split(/,\s*/)).length)throw"Tooltip: bad events configuration for "+p;n.on(f[0],function(e){clearTimeout(l),i.predelay?c=setTimeout(function(){r.show(e)},i.predelay):r.show(e)}).on(f[1],function(e){clearTimeout(c),i.delay?l=setTimeout(function(){r.hide(e)},i.delay):r.hide(e)}),d&&i.cancelDefault&&(n.removeAttr("title"),n.data("title",d)),m.extend(r,{show:function(e){if(!o&&(u?o=m(u):i.tip?o=m(i.tip).eq(0):d?o=m(i.layout).addClass(i.tipClass).appendTo(document.body).hide().append(d):((o=n.find("."+i.tipClass)).length||(o=n.next()),o.length||(o=n.parent().next())),!o.length))throw"Cannot find tooltip for "+n;if(r.isShown())return r;o.stop(!0,!0);var t=v(n,o,i);if(i.tip&&o.html(n.data("title")),(e=m.Event()).type="onBeforeShow",s.trigger(e,[t]),e.isDefaultPrevented())return r;t=v(n,o,i),o.css({position:"absolute",top:t.top,left:t.left}),a=!0,h[0].call(r,function(){e.type="onShow",a="full",s.trigger(e)});t=i.events.tooltip.split(/,\s*/);return o.data("__set")||(o.off(t[0]).on(t[0],function(){clearTimeout(l),clearTimeout(c)}),t[1]&&!n.is("input:not(:checkbox, :radio), textarea")&&o.off(t[1]).on(t[1],function(e){e.relatedTarget!=n[0]&&n.trigger(f[1].split(" ")[0])}),i.tip||o.data("__set",!0)),r},hide:function(e){return o&&r.isShown()?((e=m.Event()).type="onBeforeHide",s.trigger(e),e.isDefaultPrevented()?void 0:(a=!1,g[i.effect][1].call(r,function(){e.type="onHide",s.trigger(e)}),r)):r},isShown:function(e){return e?"full"==a:a},getConf:function(){return i},getTip:function(){return o},getTrigger:function(){return n}}),m.each("onHide,onBeforeShow,onShow,onBeforeHide".split(","),function(e,t){m.isFunction(i[t])&&m(r).on(t,i[t]),r[t]=function(e){return e&&m(r).on(t,e),r}})}m.fn.tooltip=function(e){var t=this.data("tooltip");return t||("string"==typeof(e=m.extend(!0,{},m.tools.tooltip.conf,e)).position&&(e.position=e.position.split(/,?\s/)),this.each(function(){t=new n(m(this),e),m(this).data("tooltip",t)}),e.api?t:this)}}(jQuery)}.apply(e,arguments)})}(this),function(e){define("resource-plone-app-jquerytools-dateinput-js",["jquery"],function(){return function(){!function(_,M){function R(e,t){return new Date(e,t+1,0).getDate()}function l(e,t){for(e=""+e,t=t||2;e.length<t;)e="0"+e;return e}function c(e,t,n,i){var o=t.getDate(),a=t.getDay(),r=t.getMonth(),s=t.getFullYear(),s={d:o,dd:l(o),ddd:F[i].shortDays[a],dddd:F[i].days[a],m:r+1,mm:l(r+1),mmm:F[i].shortMonths[r],mmmm:F[i].months[r],yy:String(s).slice(2),yyyy:s},i=u[e](n,t,s,i);return p.html(i).html()}function N(e){return parseInt(e,10)}function P(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()==t.getMonth()&&e.getDate()==t.getDate()}function j(e){if(e!==M){if(e.constructor==Date)return e;if("string"==typeof e){var t=e.split("-");if(3==t.length)return new Date(N(t[0]),N(t[1])-1,N(t[2]));if(!/^-?\d+$/.test(e))return;e=N(e)}t=new Date;return t.setDate(t.getDate()+e),t}}function i(a,p){function f(e,t,n){return a.attr("readonly")?void k.hide(n):(v=(C=e).getFullYear(),y=e.getMonth(),b=e.getDate(),"click"!=(n=n||_.Event("api")).type||/msie/.test(navigator.userAgent.toLowerCase())||a.focus(),n.type="beforeChange",r.trigger(n,[e]),void(n.isDefaultPrevented()||(a.val(c(t.formatter,e,t.format,t.lang)),n.type="change",n.target=a[0],r.trigger(n),a.data("date",e),k.hide(n))))}function n(e){e.type="onShow",r.trigger(e),_(document).on("keydown.d",function(e){if(e.ctrlKey)return!0;var t=e.keyCode;if(8==t||46==t)return a.val(""),k.hide(e);if(27==t||9==t)return k.hide(e);if(0<=_(h).index(t)){if(!w)return k.show(e),e.preventDefault();var n=_("#"+S.weeks+" a"),i=_("."+S.focus),o=n.index(i);return i.removeClass(S.focus),74==t||40==t?o+=7:75==t||38==t?o-=7:76==t||39==t?o+=1:72!=t&&37!=t||--o,(i=41<o?(k.addMonth(),_("#"+S.weeks+" a:eq("+(o-42)+")")):o<0?(k.addMonth(-1),_("#"+S.weeks+" a:eq("+(o+42)+")")):n.eq(o)).addClass(S.focus),e.preventDefault()}return 34==t?k.addMonth():33==t?k.addMonth(-1):36==t?k.today():(13==t&&(_(e.target).is("select")||_("."+S.focus).click()),0<=_([16,17,18,9]).index(t))}),_(document).on("click.d",function(e){var t=e.target;t.id==S.root||_(t).parents("#"+S.root).length||t==a[0]||i&&t==i[0]||k.hide(e)})}var i,m,g,v,y,b,w,e,k=this,x=new Date,t=x.getFullYear(),S=p.css,T=F[p.lang],o=_("#"+S.root),E=o.find("#"+S.title),C=a.attr("data-value")||p.value||a.val(),D=a.attr("min")||p.min,O=a.attr("max")||p.max;if(0===D&&(D="0"),C=j(C)||x,D=j(D||new Date(t+p.yearRange[0],1,1)),O=j(O||new Date(t+p.yearRange[1]+1,1,-1)),!T)throw"Dateinput: invalid language: "+p.lang;"date"==a.attr("type")&&(t=(e=a.clone()).wrap("<div/>").parent().html(),t=_(t.replace(/type/i,"type=text data-orig-type")),p.value&&t.val(p.value),a.replaceWith(t),a=t),a.addClass(S.input);var r=a.add(k);if(!o.length){(o=_("<div><div><a/><div/><a/></div><div><div/><div/></div></div>").hide().css({position:"absolute"}).attr("id",S.root)).children().eq(0).attr("id",S.head).end().eq(1).attr("id",S.body).children().eq(0).attr("id",S.days).end().eq(1).attr("id",S.weeks).end().end().end().find("a").eq(0).attr("id",S.prev).end().eq(1).attr("id",S.next),E=o.find("#"+S.head).find("div").attr("id",S.title),p.selectors&&(I=_("<select/>").attr("id",S.month),A=_("<select/>").attr("id",S.year),E.html(I.add(A)));for(var s=o.find("#"+S.days),l=0;l<7;l++)s.append(_("<span/>").text(T.shortDays[(l+p.firstDay)%7]));_("body").append(o)}p.trigger&&(i=_("<a/>").attr("href","#").addClass(S.trigger).click(function(e){return p.toggle?k.toggle():k.show(),e.preventDefault()}).insertAfter(a));var $=o.find("#"+S.weeks),A=o.find("#"+S.year),I=o.find("#"+S.month);_.extend(k,{show:function(e){if(!a.attr("disabled")&&!w&&((e=e||_.Event()).type="onBeforeShow",r.trigger(e),!e.isDefaultPrevented())){_.each(d,function(){this.hide()}),w=!0,I.off("change").change(function(){k.setValue(N(A.val()),N(_(this).val()))}),A.off("change").change(function(){k.setValue(N(_(this).val()),N(I.val()))}),m=o.find("#"+S.prev).off("click").click(function(){return m.hasClass(S.disabled)||k.addMonth(-1),!1}),g=o.find("#"+S.next).off("click").click(function(){return g.hasClass(S.disabled)||k.addMonth(),!1}),k.setValue(C);var t=a.offset();return/iPad/i.test(navigator.userAgent)&&(t.top-=_(window).scrollTop()),o.css({top:t.top+a.outerHeight(!0)+p.offset[0],left:t.left+p.offset[1]}),p.speed?o.show(p.speed,function(){n(e)}):(o.show(),n(e)),k}},setValue:function(n,e,t){var i=-1<=N(e)?new Date(N(n),N(e),N(t==M||isNaN(t)?1:t)):n||C;if(i<D?i=D:O<i&&(i=O),"string"==typeof n&&(i=j(n)),n=i.getFullYear(),e=i.getMonth(),t=i.getDate(),-1==e?(e=11,n--):12==e&&(e=0,n++),!w)return f(i,p),k;y=e,v=n,b=t;var o,a=new Date(n,e,1-p.firstDay).getDay(),r=R(n,e),s=R(n,e-1);if(p.selectors){I.empty(),_.each(T.months,function(e,t){D<new Date(n,e+1,1)&&O>new Date(n,e,0)&&I.append(_("<option/>").html(t).attr("value",e))}),A.empty();for(var l=x.getFullYear(),c=l+p.yearRange[0];c<l+p.yearRange[1];c++)D<new Date(c+1,0,1)&&O>new Date(c,0,0)&&A.append(_("<option/>").text(c));I.val(e),A.val(n)}else E.html(T.months[e]+" "+n);$.empty(),m.add(g).removeClass(S.disabled);for(var d,u,h=a?0:-7;h<(a?42:35);h++)d=_("<a/>"),h%7==0&&(o=_("<div/>").addClass(S.week),$.append(o)),h<a?(d.addClass(S.off),u=s-a+h+1,i=new Date(n,e-1,u)):a+r<=h?(d.addClass(S.off),u=h-r-a+1,i=new Date(n,e+1,u)):(u=h-a+1,i=new Date(n,e,u),P(C,i)?d.attr("id",S.current).addClass(S.focus):P(x,i)&&d.attr("id",S.today)),D&&i<D&&d.add(m).addClass(S.disabled),O&&O<i&&d.add(g).addClass(S.disabled),d.attr("href","#"+u).text(u).data("date",i),o.append(d);return $.find("a").click(function(e){var t=_(this);return t.hasClass(S.disabled)||(_("#"+S.current).removeAttr("id"),t.attr("id",S.current),f(t.data("date"),p,e)),!1}),S.sunday&&$.find("."+S.week).each(function(){var e=p.firstDay?7-p.firstDay:0;_(this).children().slice(e,1+e).addClass(S.sunday)}),k},setMin:function(e,t){return D=j(e),t&&C<D&&k.setValue(D),k},setMax:function(e,t){return O=j(e),t&&O<C&&k.setValue(O),k},today:function(){return k.setValue(x)},addDay:function(e){return this.setValue(v,y,b+(e||1))},addMonth:function(e){var t=y+(e||1),e=R(v,t),e=b<=e?b:e;return this.setValue(v,t,e)},addYear:function(e){return this.setValue(v+(e||1),y,b)},destroy:function(){a.add(document).off("click.d keydown.d"),o.add(i).remove(),a.removeData("dateinput").removeClass(S.input),e&&a.replaceWith(e)},hide:function(e){if(w){if((e=_.Event()).type="onHide",r.trigger(e),e.isDefaultPrevented())return;_(document).off("click.d keydown.d"),o.hide(),w=!1}return k},toggle:function(){return k.isOpen()?k.hide():k.show()},getConf:function(){return p},getInput:function(){return a},getCalendar:function(){return o},getValue:function(e){return e?c(p.formatter,C,e,p.lang):C},isOpen:function(){return w}}),_.each(["onBeforeShow","onShow","change","onHide"],function(e,t){_.isFunction(p[t])&&_(k).on(t,p[t]),k[t]=function(e){return e&&_(k).on(t,e),k}}),p.editable||a.on("focus.d click.d",k.show).keydown(function(e){var t=e.keyCode;return!w&&0<=_(h).index(t)?(k.show(e),e.preventDefault()):(8!=t&&46!=t||a.val(""),!!(e.shiftKey||e.ctrlKey||e.altKey||9==t)||e.preventDefault())}),j(a.val())&&f(C,p)}_.tools=_.tools||{version:"@VERSION"};var d=[],u={},h=[75,76,38,39,74,72,40,37],F={},e=_.tools.dateinput={conf:{format:"mm/dd/yy",formatter:"default",selectors:!1,yearRange:[-5,5],lang:"en",offset:[0,0],speed:0,firstDay:0,min:M,max:M,trigger:0,toggle:0,editable:0,css:{prefix:"cal",input:"date",root:0,head:0,title:0,prev:0,next:0,month:0,year:0,days:0,body:0,weeks:0,today:0,current:0,week:0,off:0,sunday:0,focus:0,disabled:0,trigger:0}},addFormatter:function(e,t){u[e]=t},localize:function(e,n){_.each(n,function(e,t){n[e]=t.split(",")}),F[e]=n}};e.localize("en",{months:"January,February,March,April,May,June,July,August,September,October,November,December",shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec",days:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday",shortDays:"Sun,Mon,Tue,Wed,Thu,Fri,Sat"});var p=_("<a/>");e.addFormatter("default",function(e,t,n){return e.replace(/d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*'/g,function(e){return e in n?n[e]:e})}),e.addFormatter("prefixed",function(e,t,n){return e.replace(/%(d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*')/g,function(e,t){return t in n?n[t]:e})}),_.expr[":"].date=function(e){var t=e.getAttribute("type");return t&&"date"==t||!!_(e).data("dateinput")},_.fn.dateinput=function(n){return this.data("dateinput")?this:(n=_.extend(!0,{},e.conf,n),_.each(n.css,function(e,t){t||"prefix"==e||(n.css[e]=(n.css.prefix||"")+(t||e))}),this.each(function(){var e=new i(_(this),n);d.push(e);e=e.getInput().data("dateinput",e);t=t?t.add(e):e}),t||this);var t}}(jQuery)}.apply(e,arguments)})}(this),function(e){define("jquery.tmpl",["jquery"],function(){return function(){function c(e,t,n,i){i={data:i||(t?t.data:{}),_wrap:t?t._wrap:null,tmpl:null,parent:t||null,nodes:[],calls:o,nest:u,wrap:h,html:p,update:f};return e&&m.extend(i,e,{nodes:[],parent:t}),n&&(i.tmpl=n,i._ctnt=i._ctnt||i.tmpl(m,i),i.key=++x,(T.length?w:b)[x]=i),i}function a(t,e,n){var o,n=n?m.map(n,function(e){return"string"==typeof e?t.key?e.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+y+'="'+t.key+'" $2'):e:a(e,t,e._ctnt)}):t;return e?n:((n=n.join("")).replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(e,t,n,i){l(o=m(n).get()),t&&(o=r(t).concat(o)),i&&(o=o.concat(r(i)))}),o||r(n))}function r(e){var t=document.createElement("div");return t.innerHTML=e,m.makeArray(t.childNodes)}function n(e){return new Function("jQuery","$item","var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('"+m.trim(e).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(e,t,n,i,o,a,r){var s,l=m.tmpl.tag[n];if(!l)throw"Template command not found: "+n;return n=l._default||[],a&&!/\w$/.test(o)&&(o+=a,a=""),a=o?(o=d(o),r=r?","+d(r)+")":a?")":"",s=a?-1<o.indexOf(".")?o+a:"("+o+").call($item"+r:o,a?s:"(typeof("+o+")==='function'?("+o+").call($item):("+o+"))"):s=n.$1||"null",i=d(i),"');"+l[t?"close":"open"].split("$notnull_1").join(o?"typeof("+o+")!=='undefined' && ("+o+")!=null":"true").split("$1a").join(a).split("$1").join(s).split("$2").join(i?i.replace(/\s*([^\(]+)\s*(\((.*?)\))?/g,function(e,t,n,i){return(i=i?","+i+")":n?")":"")?"("+t+").call($item"+i:e}):n.$2||"")+"_.push('"})+"');}return _;")}function s(e,t){e._wrap=a(e,!0,m.isArray(t)?t:[i.test(t)?t:m(t).html()]).join("")}function d(e){return e?e.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function l(e){for(var t,n,i,s="_"+S,l={},o=0,a=e.length;o<a;o++)if(1===(t=e[o]).nodeType){for(i=(n=t.getElementsByTagName("*")).length-1;0<=i;i--)r(n[i]);r(t)}function r(e){var t,n,i,o,a=e;if(o=e.getAttribute(y)){for(;a.parentNode&&1===(a=a.parentNode).nodeType&&!(t=a.getAttribute(y)););t!==o&&(a=a.parentNode&&11!==a.nodeType&&a.getAttribute(y)||0,(i=b[o])||((i=c(i=w[o],b[a]||w[a],null,!0)).key=++x,b[x]=i),S&&r(o)),e.removeAttribute(y)}else S&&(i=m.data(e,"tmplItem"))&&(r(i.key),b[i.key]=i,a=(a=m.data(e.parentNode,"tmplItem"))?a.key:0);if(i){for(n=i;n&&n.key!=a;)n.nodes.push(e),n=n.parent;delete i._ctnt,delete i._wrap,m.data(e,"tmplItem",i)}function r(e){i=l[e+=s]=l[e]||c(i,b[i.parent.key+s]||i.parent,null,!0)}}}function o(e,t,n,i){if(!e)return T.pop();T.push({_:e,tmpl:t,item:this,data:n,options:i})}function u(e,t,n){return m.tmpl(m.template(e),t,n,this)}function h(e,t){var n=e.options||{};return n.wrapped=t,m.tmpl(m.template(e.tmpl),e.data,n,e.item)}function p(e,n){var t=this._wrap;return m.map(m(m.isArray(t)?t.join(""):t).filter(e||"*"),function(e){return n?e.innerText||e.textContent:e.outerHTML||(t=e,(e=document.createElement("div")).appendChild(t.cloneNode(!0)),e.innerHTML);var t})}function f(){var e=this.nodes;m.tmpl(null,null,null,this).insertBefore(e[0]),m(e).remove()}var m,g,v,y,i,b,w,k,x,S,T;m=jQuery,v=m.fn.domManip,y="_tmplitem",i=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,b={},w={},k={key:0,data:{}},S=x=0,T=[],m.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(r,s){m.fn[r]=function(e){var t,n,i,o=[],a=m(e),e=1===this.length&&this[0].parentNode;if(g=b||{},e&&11===e.nodeType&&1===e.childNodes.length&&1===a.length)a[s](this[0]),o=this;else{for(n=0,i=a.length;n<i;n++)t=(0<(S=n)?this.clone(!0):this).get(),m.fn[s].apply(m(a[n]),t),o=o.concat(t);S=0,o=this.pushStack(o,r,a.selector)}return e=g,g=null,m.tmpl.complete(e),o}}),m.fn.extend({tmpl:function(e,t,n){return m.tmpl(this[0],e,t,n)},tmplItem:function(){return m.tmplItem(this[0])},template:function(e){return m.template(e,this[0])},domManip:function(e,t,n,i){if(e[0]&&e[0].nodeType){for(var o,a=m.makeArray(arguments),r=e.length,s=0;s<r&&!(o=m.data(e[s++],"tmplItem")););1<r&&(a[0]=[m.makeArray(e)]),o&&S&&(a[2]=function(e){m.tmpl.afterManip(this,e,n)}),v.apply(this,a)}else v.apply(this,arguments);return S=0,g||m.tmpl.complete(b),this}}),m.extend({tmpl:function(t,e,n,i){var o=!i;if(o)i=k,t=m.template[t]||m.template(null,t),w={};else if(!t)return t=i.tmpl,(b[i.key]=i).nodes=[],i.wrapped&&s(i,i.wrapped),m(a(i,null,i.tmpl(m,i)));return t?("function"==typeof e&&(e=e.call(i||{})),n&&n.wrapped&&s(n,n.wrapped),e=m.isArray(e)?m.map(e,function(e){return e?c(n,i,t,e):null}):[c(n,i,t,e)],o?m(a(i,null,e)):e):[]},tmplItem:function(e){var t;for(e instanceof m&&(e=e[0]);e&&1===e.nodeType&&!(t=m.data(e,"tmplItem"))&&(e=e.parentNode););return t||k},template:function(e,t){return t?("string"==typeof t?t=n(t):t instanceof m&&(t=t[0]||{}),t.nodeType&&(t=m.data(t,"tmpl")||m.data(t,"tmpl",n(t.innerHTML))),"string"==typeof e?m.template[e]=t:t):e?"string"!=typeof e?m.template(null,e):m.template[e]||m.template(null,i.test(e)?e:m(e)):null},encode:function(e){return(""+e).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}}),m.extend(m.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},if:{open:"if(($notnull_1) && $1a){",close:"}"},else:{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode($1a));}"},"!":{open:""}},complete:function(e){b={}},afterManip:function(e,t,n){var i=11===t.nodeType?m.makeArray(t.childNodes):1===t.nodeType?[t]:[];n.call(e,t),l(i),S++}})}.apply(e,arguments)})}(this),function(e){define("jquery.recurrenceinput",["jquery","resource-plone-app-jquerytools-js","resource-plone-app-jquerytools-dateinput-js","jquery.tmpl"],function(){return function(){!function($){$.tools=$.tools||{version:"@VERSION"};var o,p={};(o=$.tools.recurrenceinput={conf:{lang:"en",readOnly:!1,firstDay:0,startField:null,startFieldYear:null,startFieldMonth:null,startFieldDay:null,ajaxURL:null,ajaxContentType:"application/json; charset=utf8",ributtonExtraClass:"",hasRepeatForeverButton:!0,formOverlay:{speed:"fast",fixed:!1},template:{form:"#jquery-recurrenceinput-form-tmpl",display:"#jquery-recurrenceinput-display-tmpl"},rtemplate:{daily:{rrule:"FREQ=DAILY",fields:["ridailyinterval","rirangeoptions"]},mondayfriday:{rrule:"FREQ=WEEKLY;BYDAY=MO,FR",fields:["rirangeoptions"]},weekdays:{rrule:"FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR",fields:["rirangeoptions"]},weekly:{rrule:"FREQ=WEEKLY",fields:["riweeklyinterval","riweeklyweekdays","rirangeoptions"]},monthly:{rrule:"FREQ=MONTHLY",fields:["rimonthlyinterval","rimonthlyoptions","rirangeoptions"]},yearly:{rrule:"FREQ=YEARLY",fields:["riyearlyinterval","riyearlyoptions","rirangeoptions"]}}},localize:function(e,t){p[e]=t},setTemplates:function(e,t){var n,i;for(n in o.conf.rtemplate=e,t)if(t.hasOwnProperty(n))for(i in t[n])t[n].hasOwnProperty(i)&&(p[n].rtemplate[i]=t[n][i])}}).localize("en",{displayUnactivate:"Does not repeat",displayActivate:"Repeats every",add_rules:"Add",edit_rules:"Edit",delete_rules:"Delete",add:"Add",refresh:"Refresh",title:"Repeat",preview:"Selected dates",addDate:"Add date",recurrenceType:"Repeats:",dailyInterval1:"Repeat every:",dailyInterval2:"days",weeklyInterval1:"Repeat every:",weeklyInterval2:"week(s)",weeklyWeekdays:"Repeat on:",weeklyWeekdaysHuman:"on:",monthlyInterval1:"Repeat every:",monthlyInterval2:"month(s)",monthlyDayOfMonth1:"Day",monthlyDayOfMonth1Human:"on day",monthlyDayOfMonth2:"of the month",monthlyDayOfMonth3:"month(s)",monthlyWeekdayOfMonth1:"The",monthlyWeekdayOfMonth1Human:"on the",monthlyWeekdayOfMonth2:"",monthlyWeekdayOfMonth3:"of the month",monthlyRepeatOn:"Repeat on:",yearlyInterval1:"Repeat every:",yearlyInterval2:"year(s)",yearlyDayOfMonth1:"Every",yearlyDayOfMonth1Human:"on",yearlyDayOfMonth2:"",yearlyDayOfMonth3:"",yearlyWeekdayOfMonth1:"The",yearlyWeekdayOfMonth1Human:"on the",yearlyWeekdayOfMonth2:"",yearlyWeekdayOfMonth3:"of",yearlyWeekdayOfMonth4:"",yearlyRepeatOn:"Repeat on:",range:"End recurrence:",rangeNoEnd:"Never",rangeByOccurrences1:"After",rangeByOccurrences1Human:"ends after",rangeByOccurrences2:"occurrence(s)",rangeByEndDate:"On",rangeByEndDateHuman:"ends on",including:", and also",except:", except for",cancel:"Cancel",save:"Save",recurrenceStart:"Start of the recurrence",additionalDate:"Additional date",include:"Include",exclude:"Exclude",remove:"Remove",orderIndexes:["first","second","third","fourth","last"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortWeekdays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longDateFormat:"mmmm dd, yyyy",shortDateFormat:"mm/dd/yyyy",unsupportedFeatures:"Warning: This event uses recurrence features not supported by this widget. Saving the recurrence may change the recurrence in unintended ways:",noTemplateMatch:"No matching recurrence template",multipleDayOfMonth:"This widget does not support multiple days in monthly or yearly recurrence",bysetpos:"BYSETPOS is not supported",noRule:"No RRULE in RRULE data",noRepeatEvery:'Error: The "Repeat every"-field must be between 1 and 1000',noEndDate:"Error: End date is not set. Please set a correct value",noRepeatOn:'Error: "Repeat on"-value must be selected',pastEndDate:"Error: End date cannot be before start date",noEndAfterNOccurrences:'Error: The "After N occurrences"-field must be between 1 and 1000',alreadyAdded:"This date was already added",rtemplate:{daily:"Daily",mondayfriday:"Monday and Friday",weekdays:"Weekday",weekly:"Weekly",monthly:"Monthly",yearly:"Yearly"}});var e=['<div class="rioccurrences">',"{{each occurrences}}",'<div class="occurrence ${occurrences[$index].type}">',"<span>","${occurrences[$index].formattedDate}",'{{if occurrences[$index].type === "start"}}','<span class="rlabel">${i18n.recurrenceStart}</span>',"{{/if}}",'{{if occurrences[$index].type === "rdate"}}','<span class="rlabel">${i18n.additionalDate}</span>',"{{/if}}","</span>","{{if !readOnly}}",'<span class="action">','{{if occurrences[$index].type === "rrule"}}','<a date="${occurrences[$index].date}" href="#"','class="${occurrences[$index].type}" title="${i18n.exclude}">',"${i18n.exclude}","</a>","{{/if}}",'{{if occurrences[$index].type === "rdate"}}','<a date="${occurrences[$index].date}" href="#"','class="${occurrences[$index].type}" title="${i18n.remove}" >',"${i18n.remove}","</a>","{{/if}}",'{{if occurrences[$index].type === "exdate"}}','<a date="${occurrences[$index].date}" href="#"','class="${occurrences[$index].type}" title="${i18n.include}">',"${i18n.include}","</a>","{{/if}}","</span>","{{/if}}","</div>","{{/each}}",'<div class="batching">',"{{each batch.batches}}",'{{if $index === batch.currentBatch}}<span class="current">{{/if}}','<a href="#" start="${batch.batches[$index][0]}">[${batch.batches[$index][0]} - ${batch.batches[$index][1]}]</a>',"{{if $index === batch.currentBatch}}</span>{{/if}}","{{/each}}","</div></div>"].join("\n");$.template("occurrenceTmpl",e),e=['<div class="ridisplay">','<div class="rimain">',"{{if !readOnly}}",'<button name="riedit">${i18n.add_rules}</button>','<button name="ridelete" style="display:none">${i18n.delete_rules}</button>',"{{/if}}",'<label class="ridisplay">${i18n.displayUnactivate}</label>',"</div>",'<div class="rioccurrences" style="display:none" /></div>'].join("\n"),$.template("displayTmpl",e),e=['<div class="riform">',"<form>","<h1>${i18n.title}</h1>",'<div id="messagearea" style="display: none;">',"</div>",'<div id="rirtemplate">','<label for="${name}rtemplate" class="label">',"${i18n.recurrenceType}","</label>",'<select id="rirtemplate" name="rirtemplate" class="field">',"{{each rtemplate}}",'<option value="${$index}">${i18n.rtemplate[$index]}</value>',"{{/each}}","</select>","<div>",'<div id="riformfields">','<div id="ridailyinterval" class="rifield">','<label for="${name}dailyinterval" class="label">',"${i18n.dailyInterval1}","</label>",'<div class="field">','<input type="text" size="2"','value="1"','name="ridailyinterval"','id="${name}dailyinterval" />',"${i18n.dailyInterval2}","</div>","</div>",'<div id="riweeklyinterval" class="rifield">','<label for="${name}weeklyinterval" class="label">',"${i18n.weeklyInterval1}","</label>",'<div class="field">','<input type="text" size="2"','value="1"','name="riweeklyinterval"','id="${name}weeklyinterval"/>',"${i18n.weeklyInterval2}","</div>","</div>",'<div id="riweeklyweekdays" class="rifield">','<label for="${name}weeklyinterval" class="label">${i18n.weeklyWeekdays}</label>','<div class="field">',"{{each orderedWeekdays}}",'<div class="riweeklyweekday">','<input type="checkbox"','name="riweeklyweekdays${weekdays[$value]}"','id="${name}weeklyWeekdays${weekdays[$value]}"','value="${weekdays[$value]}" />','<label for="${name}weeklyWeekdays${weekdays[$value]}">${i18n.shortWeekdays[$value]}</label>',"</div>","{{/each}}","</div>","</div>",'<div id="rimonthlyinterval" class="rifield">','<label for="rimonthlyinterval" class="label">${i18n.monthlyInterval1}</label>','<div class="field">','<input type="text" size="2"','value="1" ','name="rimonthlyinterval"/>',"${i18n.monthlyInterval2}","</div>","</div>",'<div id="rimonthlyoptions" class="rifield">','<label for="rimonthlytype" class="label">${i18n.monthlyRepeatOn}</label>','<div class="field">',"<div>","<input",'type="radio"','value="DAYOFMONTH"','name="rimonthlytype"','id="${name}monthlytype:DAYOFMONTH" />','<label for="${name}monthlytype:DAYOFMONTH">',"${i18n.monthlyDayOfMonth1}","</label>",'<select name="rimonthlydayofmonthday"','id="${name}monthlydayofmonthday">',"{{each [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,","18,19,20,21,22,23,24,25,26,27,28,29,30,31]}}",'<option value="${$value}">${$value}</option>',"{{/each}}","</select>","${i18n.monthlyDayOfMonth2}","</div>","<div>","<input",'type="radio"','value="WEEKDAYOFMONTH"','name="rimonthlytype"','id="${name}monthlytype:WEEKDAYOFMONTH" />','<label for="${name}monthlytype:WEEKDAYOFMONTH">',"${i18n.monthlyWeekdayOfMonth1}","</label>",'<select name="rimonthlyweekdayofmonthindex">',"{{each i18n.orderIndexes}}",'<option value="${orderIndexes[$index]}">${$value}</option>',"{{/each}}","</select>","${i18n.monthlyWeekdayOfMonth2}",'<select name="rimonthlyweekdayofmonth">',"{{each orderedWeekdays}}",'<option value="${weekdays[$value]}">${i18n.weekdays[$value]}</option>',"{{/each}}","</select>","${i18n.monthlyWeekdayOfMonth3}","</div>","</div>","</div>",'<div id="riyearlyinterval" class="rifield">','<label for="riyearlyinterval" class="label">${i18n.yearlyInterval1}</label>','<div class="field">','<input type="text" size="2"','value="1" ','name="riyearlyinterval"/>',"${i18n.yearlyInterval2}","</div>","</div>",'<div id="riyearlyoptions" class="rifield">','<label for="riyearlyType" class="label">${i18n.yearlyRepeatOn}</label>','<div class="field">',"<div>","<input",'type="radio"','value="DAYOFMONTH"','name="riyearlyType"','id="${name}yearlytype:DAYOFMONTH" />','<label for="${name}yearlytype:DAYOFMONTH">',"${i18n.yearlyDayOfMonth1}","</label>",'<select name="riyearlydayofmonthmonth">',"{{each i18n.months}}",'<option value="${$index+1}">${$value}</option>',"{{/each}}","</select>","${i18n.yearlyDayOfMonth2}",'<select name="riyearlydayofmonthday">',"{{each [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,","18,19,20,21,22,23,24,25,26,27,28,29,30,31]}}",'<option value="${$value}">${$value}</option>',"{{/each}}","</select>","${i18n.yearlyDayOfMonth3}","</div>","<div>","<input",'type="radio"','value="WEEKDAYOFMONTH"','name="riyearlyType"','id="${name}yearlytype:WEEKDAYOFMONTH"/>','<label for="${name}yearlytype:WEEKDAYOFMONTH">',"${i18n.yearlyWeekdayOfMonth1}","</label>",'<select name="riyearlyweekdayofmonthindex">',"{{each i18n.orderIndexes}}",'<option value="${orderIndexes[$index]}">${$value}</option>',"{{/each}}","</select>",'<label for="${name}yearlytype:WEEKDAYOFMONTH">',"${i18n.yearlyWeekdayOfMonth2}","</label>",'<select name="riyearlyweekdayofmonthday">',"{{each orderedWeekdays}}",'<option value="${weekdays[$value]}">${i18n.weekdays[$value]}</option>',"{{/each}}","</select>","${i18n.yearlyWeekdayOfMonth3}",'<select name="riyearlyweekdayofmonthmonth">',"{{each i18n.months}}",'<option value="${$index+1}">${$value}</option>',"{{/each}}","</select>","${i18n.yearlyWeekdayOfMonth4}","</div>","</div>","</div>",'<div id="rirangeoptions" class="rifield">','<label class="label">${i18n.range}</label>','<div class="field">',"{{if hasRepeatForeverButton}}","<div>","<input",'type="radio"','value="NOENDDATE"','name="rirangetype"','id="${name}rangetype:NOENDDATE"/>','<label for="${name}rangetype:NOENDDATE">',"${i18n.rangeNoEnd}","</label>","</div>","{{/if}}","<div>","<input",'type="radio"','checked="checked"','value="BYOCCURRENCES"','name="rirangetype"','id="${name}rangetype:BYOCCURRENCES"/>','<label for="${name}rangetype:BYOCCURRENCES">',"${i18n.rangeByOccurrences1}","</label>","<input",'type="text" size="3"','value="7"','name="rirangebyoccurrencesvalue" />',"${i18n.rangeByOccurrences2}","</div>","<div>","<input",'type="radio"','value="BYENDDATE"','name="rirangetype"','id="${name}rangetype:BYENDDATE"/>','<label for="${name}rangetype:BYENDDATE">',"${i18n.rangeByEndDate}","</label>","<input",'type="date"','name="rirangebyenddatecalendar" />',"</div>","</div>","</div>","</div>",'<div class="rioccurrencesactions">','<div class="rioccurancesheader">',"<h2>${i18n.preview}</h2>",'<span class="refreshbutton action">','<a class="rirefreshbutton" href="#" title="${i18n.refresh}">',"${i18n.refresh}","</a>","</span>","</div>","</div>",'<div class="rioccurrences">',"</div>",'<div class="rioccurrencesactions">','<div class="rioccurancesheader">',"<h2>${i18n.addDate}</h2>","</div>",'<div class="riaddoccurrence">','<div class="errorarea"></div>','<input type="date" name="adddate" id="adddate" />','<input type="button" name="addaction" id="addaction" value="${i18n.add}">',"</div>","</div>",'<div class="ributtons">',"<input",'type="submit"','class="ricancelbutton ${ributtonExtraClass}"','value="${i18n.cancel}" />',"<input",'type="submit"','class="risavebutton ${ributtonExtraClass}"','value="${i18n.save}" />',"</div>","</form></div>"].join("\n"),$.template("formTmpl",e);var s=/d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*'/g;function l(e,t){for(e=e.toString(),t=t||2;e.length<t;)e="0"+e;return e}function k(e,t,n){var i=e.getDate(),o=e.getDay(),a=e.getMonth(),e=e.getFullYear(),r={d:i,dd:l(i),ddd:n.i18n.shortWeekdays[o],dddd:n.i18n.weekdays[o],m:a+1,mm:l(a+1),mmm:n.i18n.shortMonths[a],mmmm:n.i18n.months[a],yy:String(e).slice(2),yyyy:e};return t.replace(s,function(e){return r.hasOwnProperty(e)?r[e]:e.slice(1,e.length-1)})}function x(e,t,n){for(var i,o,a,r,s,l,c,d,u,h,p,f=e.find("select[name=rirtemplate]").val(),m=t.rtemplate[f],g=m.rrule,v=t.i18n.rtemplate[f],y=0;y<m.fields.length;y++)switch((i=e.find("#"+m.fields[y])).attr("id")){case"ridailyinterval":"1"!==(h=i.find("input[name=ridailyinterval]").val())&&(g+=";INTERVAL="+h),v=h+" "+t.i18n.dailyInterval2;break;case"riweeklyinterval":"1"!==(h=i.find("input[name=riweeklyinterval]").val())&&(g+=";INTERVAL="+h),v=h+" "+t.i18n.weeklyInterval2;break;case"riweeklyweekdays":for(a=o="",r=0;r<t.weekdays.length;r++)i.find("input[name=riweeklyweekdays"+t.weekdays[r]+"]").is(":checked")&&(o&&(o+=",",a+=", "),o+=t.weekdays[r],a+=t.i18n.weekdays[r]);o&&(g+=";BYDAY="+o,v+=" "+t.i18n.weeklyWeekdaysHuman+" "+a);break;case"rimonthlyinterval":"1"!==(h=i.find("input[name=rimonthlyinterval]").val())&&(g+=";INTERVAL="+h),v=h+" "+t.i18n.monthlyInterval2;break;case"rimonthlyoptions":switch($("input[name=rimonthlytype]:checked",e).val()){case"DAYOFMONTH":g+=";BYMONTHDAY="+(c=$("select[name=rimonthlydayofmonthday]",e).val()),v+=", "+t.i18n.monthlyDayOfMonth1Human+" "+c+" "+t.i18n.monthlyDayOfMonth2;break;case"WEEKDAYOFMONTH":s=$("select[name=rimonthlyweekdayofmonthindex]",e).val(),c=$("select[name=rimonthlyweekdayofmonth]",e).val(),-1<$.inArray(c,["MO","TU","WE","TH","FR","SA","SU"])&&(g+=";BYDAY="+s+c,v+=", "+t.i18n.monthlyWeekdayOfMonth1Human+" ",v+=" "+t.i18n.orderIndexes[$.inArray(s,t.orderIndexes)],v+=" "+t.i18n.monthlyWeekdayOfMonth2,v+=" "+t.i18n.weekdays[$.inArray(c,t.weekdays)],v+=" "+t.i18n.monthlyDayOfMonth2)}break;case"riyearlyinterval":"1"!==(h=i.find("input[name=riyearlyinterval]").val())&&(g+=";INTERVAL="+h),v=h+" "+t.i18n.yearlyInterval2;break;case"riyearlyoptions":switch($("input[name=riyearlyType]:checked",e).val()){case"DAYOFMONTH":g+=";BYMONTH="+(d=$("select[name=riyearlydayofmonthmonth]",e).val()),g+=";BYMONTHDAY="+(c=$("select[name=riyearlydayofmonthday]",e).val()),v+=", "+t.i18n.yearlyDayOfMonth1Human+" "+t.i18n.months[d-1]+" "+c;break;case"WEEKDAYOFMONTH":s=$("select[name=riyearlyweekdayofmonthindex]",e).val(),c=$("select[name=riyearlyweekdayofmonthday]",e).val(),g+=";BYMONTH="+(d=$("select[name=riyearlyweekdayofmonthmonth]",e).val()),-1<$.inArray(c,["MO","TU","WE","TH","FR","SA","SU"])&&(g+=";BYDAY="+s+c,v+=", "+t.i18n.yearlyWeekdayOfMonth1Human,v+=" "+t.i18n.orderIndexes[$.inArray(s,t.orderIndexes)],v+=" "+t.i18n.yearlyWeekdayOfMonth2,v+=" "+t.i18n.weekdays[$.inArray(c,t.weekdays)],v+=" "+t.i18n.yearlyWeekdayOfMonth3,v+=" "+t.i18n.months[d-1],v+=" "+t.i18n.yearlyWeekdayOfMonth4)}break;case"rirangeoptions":switch(e.find("input[name=rirangetype]:checked").val()){case"BYOCCURRENCES":g+=";COUNT="+(p=e.find("input[name=rirangebyoccurrencesvalue]").val()),v+=", "+t.i18n.rangeByOccurrences1Human,v+=" "+p,v+=" "+t.i18n.rangeByOccurrences2;break;case"BYENDDATE":g+=";UNTIL="+(i=e.find("input[name=rirangebyenddatecalendar]")).data("dateinput").getValue("yyyymmdd")+"T000000",!0===n&&(g+="Z"),v+=", "+t.i18n.rangeByEndDateHuman,v+=" "+i.data("dateinput").getValue(t.i18n.longDateFormat)}}if(void 0!==e.ical.RDATE&&0<e.ical.RDATE.length){for(e.ical.RDATE.sort(),l=[],y=0;y<e.ical.RDATE.length;y++)""!==e.ical.RDATE[y]&&(u=parseInt(e.ical.RDATE[y].substring(0,4),10),d=parseInt(e.ical.RDATE[y].substring(4,6),10)-1,c=parseInt(e.ical.RDATE[y].substring(6,8),10),l.push(k(new Date(u,d,c),t.i18n.longDateFormat,t)));0!==l.length&&(v=v+t.i18n.including+" "+l.join("; "))}if(void 0!==e.ical.EXDATE&&0<e.ical.EXDATE.length){for(e.ical.EXDATE.sort(),l=[],y=0;y<e.ical.EXDATE.length;y++)""!==e.ical.EXDATE[y]&&(u=parseInt(e.ical.EXDATE[y].substring(0,4),10),d=parseInt(e.ical.EXDATE[y].substring(4,6),10)-1,c=parseInt(e.ical.EXDATE[y].substring(6,8),10),l.push(k(new Date(u,d,c),t.i18n.longDateFormat,t)));0!==l.length&&(v=v+t.i18n.except+" "+l.join("; "))}return g="RRULE:"+g,void 0!==e.ical.EXDATE&&""!==e.ical.EXDATE.join()&&(g=g+"\nEXDATE:"+(l=$.map(e.ical.EXDATE,function(e){return 8===e.length&&(e+="T000000"),!0===n&&(e+="Z"),e}))),void 0!==e.ical.RDATE&&""!==e.ical.RDATE.join()&&(g=g+"\nRDATE:"+(l=$.map(e.ical.RDATE,function(e){return 8===e.length&&(e+="T000000"),!0===n&&(e+="Z"),e}))),{result:g,description:v}}function A(e){var t,n,i,o,a,r=[],s={},l=null;for((r=e.split("\n")).reverse();;){if(0<r.length){if(" "===(t=r.pop()).charAt(0)||"\t"===t.charAt(0)){l+=t;continue}}else t="";if(null!==l&&(a=o=i=void 0,i={},o=(n=l).indexOf(":"),a=n.substring(0,o),i.value=n.substring(o+1),-1!==a.indexOf(";")?(o=a.indexOf(";"),i.parameters=a.substring(o+1),i.property=a.substring(0,o)):(i.parameters=null,i.property=a),"RDATE"===(l=i).property||"EXDATE"===l.property?s[l.property]=function(e){var t,n=[],i=e.split(",");for(t in i)i.hasOwnProperty(t)&&(-1!==i[t].indexOf("Z")?n.push(i[t].substring(0,15)):n.push(i[t]));return n}(l.value):s[l.property]=l.value),""===(l=t))break}return s}function S(e,t,n,i){var o,a,r,s,l,c,d,u,h,p,f,m,g,v,y,b,w,k,x,S,T=[];if(e.ical=A(n),void 0===e.ical.RRULE){if(T.push(t.i18n.noRule),!i)return-1}else{for(o in f=(O=/INTERVAL=([0-9]+);?/.exec(e.ical.RRULE))?O[1]:"1",m=(O=/BYDAY=([^;]+);?/.exec(e.ical.RRULE))?O[1]:"",v=(O=/BYMONTHDAY=([^;]+);?/.exec(e.ical.RRULE))?O[1].split(","):null,g=(O=/BYMONTH=([^;]+);?/.exec(e.ical.RRULE))?O[1].split(","):null,y=(O=/COUNT=([0-9]+);?/.exec(e.ical.RRULE))?O[1]:null,b=(O=/UNTIL=([0-9T]+);?/.exec(e.ical.RRULE))?O[1]:null,(O=/BYSETPOS=([^;]+);?/.exec(e.ical.RRULE))&&T.push(t.i18n.bysetpos),a="",r=null,t.rtemplate)t.rtemplate.hasOwnProperty(o)&&(s=t.rtemplate[o],0===e.ical.RRULE.indexOf(s.rrule)&&e.ical.RRULE.length>a.length&&(a=e.ical.RRULE,r=o));if(a)s=t.rtemplate[r],e.find("select[name=rirtemplate]").val(r);else{for(s in t.rtemplate)if(t.rtemplate.hasOwnProperty(s)){s=t.rtemplate[s];break}T.push(t.i18n.noTemplateMatch)}for(o=0;o<s.fields.length;o++)switch((h=e.find("#"+s.fields[o])).attr("id")){case"ridailyinterval":h.find("input[name=ridailyinterval]").val(f);break;case"riweeklyinterval":h.find("input[name=riweeklyinterval]").val(f);break;case"riweeklyweekdays":for(m=m.split(","),l=0;l<t.weekdays.length;l++)w=t.weekdays[l],(c=h.find("input[name=riweeklyweekdays"+w+"]")).attr("checked",-1!==$.inArray(w,m));break;case"rimonthlyinterval":h.find("input[name=rimonthlyinterval]").val(f);break;case"rimonthlyoptions":var E="DAYOFMONTH";for(v&&(E="DAYOFMONTH",1<v.length&&(T.push(t.i18n.multipleDayOfMonth),v=v[0]),h.find("select[name=rimonthlydayofmonthday]").val(v)),m&&(E="WEEKDAYOFMONTH",-1!==m.indexOf(",")&&(T.push(t.i18n.multipleDayOfMonth),m=m.split(",")[0]),"+"!==(d=m.slice(0,-2)).charAt(0)&&"-"!==d.charAt(0)&&(d="+"+d),S=m.slice(-2),h.find("select[name=rimonthlyweekdayofmonthindex]").val(d),h.find("select[name=rimonthlyweekdayofmonth]").val(S)),u=h.find("input[name=rimonthlytype]"),d=0;d<u.length;d++)p=u[d],$(p).attr("checked",p.value===E);break;case"riyearlyinterval":h.find("input[name=riyearlyinterval]").val(f);break;case"riyearlyoptions":var C="DAYOFMONTH";for(v&&(C="DAYOFMONTH",1<v.length&&(T.push(t.i18n.multipleDayOfMonth),v=v[0]),h.find("select[name=riyearlydayofmonthmonth]").val(g),h.find("select[name=riyearlydayofmonthday]").val(v)),m&&(C="WEEKDAYOFMONTH",-1!==m.indexOf(",")&&(T.push(t.i18n.multipleDayOfMonth),m=m.split(",")[0]),"+"!==(d=m.slice(0,-2)).charAt(0)&&"-"!==d.charAt(0)&&(d="+"+d),S=m.slice(-2),h.find("select[name=riyearlyweekdayofmonthindex]").val(d),h.find("select[name=riyearlyweekdayofmonthday]").val(S),h.find("select[name=riyearlyweekdayofmonthmonth]").val(g)),u=h.find("input[name=riyearlyType]"),d=0;d<u.length;d++)p=u[d],$(p).attr("checked",p.value===C);break;case"rirangeoptions":var D="NOENDDATE";for(y&&(D="BYOCCURRENCES",h.find("input[name=rirangebyoccurrencesvalue]").val(y)),b&&(D="BYENDDATE",c=h.find("input[name=rirangebyenddatecalendar]"),x=b.slice(0,4),k=b.slice(4,6),k=parseInt(k,10)-1,w=b.slice(6,8),c.data("dateinput").setValue(new Date(x,k,w))),u=h.find("input[name=rirangetype]"),d=0;d<u.length;d++)p=u[d],$(p).attr("checked",p.value===D)}}var O=e.find("#messagearea");return 0!==T.length?(O.text(t.i18n.unsupportedFeatures+" "+T.join("; ")),O.show(),1):(O.text(""),O.hide(),0)}function n(f,t){for(var m,g,e,n=[],i=0;i<7;i++)6<(e=i+f.firstDay)&&(e-=7),n.push(e);function o(e){m.find(".rifield").hide();e=e.val();if(e)for(var t=f.rtemplate[e],n=0;n<t.fields.length;n++)m.find("#"+t.fields[n]).show()}function v(e){e.preventDefault(),void 0===m.ical.EXDATE&&(m.ical.EXDATE=[]),m.ical.EXDATE.push(this.attributes.date.value);var t=$(this);t.attr("class","exdate"),t.parent().parent().addClass("exdate"),t.unbind(e),t.click(y)}function y(e){e.preventDefault(),m.ical.EXDATE.splice($.inArray(this.attributes.date.value,m.ical.EXDATE),1);var t=$(this);t.attr("class","rrule"),t.parent().parent().removeClass("exdate"),t.unbind(e),t.click(v)}function b(e){e.preventDefault(),m.ical.RDATE.splice($.inArray(this.attributes.date.value,m.ical.RDATE),1),$(this).parent().parent().hide("slow",function(){$(this).remove()})}function w(d,u,e,h){var t=h?g:m,p=t.find(".rioccurrences");p.hide();e={year:d.getFullYear(),month:d.getMonth()+1,day:d.getDate(),rrule:u,format:f.i18n.longDateFormat,start:e},e={url:f.ajaxURL,async:!1,type:"post",dataType:"json",contentType:f.ajaxContentType,cache:!1,data:e,success:function(e,t,n){var i,o,a,r,s,l,c=h?g:m;for(l in e.readOnly=h,e.i18n=f.i18n,e.occurrences)e.occurrences.hasOwnProperty(l)&&(s=(o=e.occurrences[l]).date,a=parseInt(s.substring(0,4),10),r=parseInt(s.substring(4,6),10)-1,s=parseInt(s.substring(6,8),10),o.formattedDate=k(new Date(a,r,s),f.i18n.longDateFormat,f));i=$.tmpl("occurrenceTmpl",e),(p=c.find(".rioccurrences")).replaceWith(i),c.find(".rioccurrences .batching a").click(function(e){e.preventDefault(),w(d,u,this.attributes.start.value,h)}),h||(c.find(".rioccurrences .action a.rrule").click(v),c.find(".rioccurrences .action a.exdate").click(y),c.find(".rioccurrences .action a.rdate").click(b)),c.find(".rioccurrences").show()},error:function(e,t,n){alert(t)}};$.ajax(e)}function a(e){var t=$(e);return t.length||(t=$("#"+e)),t.length||(t=$("input[name='"+e+"']")),t}function r(){var e,t,n,i=null;if(f.startField){if(!(n=a(f.startField)).length)return null;(i=n.data("dateinput"))?i=i.getValue():""===(i=n.val())&&(i=n.text()),"string"==typeof i&&(i=i.replace(" ","T")),i=new Date(i)}else if(f.startFieldYear&&f.startFieldMonth&&f.startFieldDay){if(e=a(f.startFieldYear),t=a(f.startFieldMonth),n=a(f.startFieldDay),!e.length&&!t.length&&!n.length)return null;i=new Date(e.val(),t.val()-1,n.val())}return null===i||isNaN(i)?null:i}function s(e,t){t=t.find("input[name="+e+"]"),e=t.val();return isNaN(e)||-1!==e.toString().indexOf(".")||""===t.val()?null:e}function l(e){var t,n;e&&S(m,f,e,!0),null!==(t=r())?(m.find("select[name=rimonthlydayofmonthday]").val(t.getDate()),n=f.orderIndexes[Math.floor((t.getDate()-1)/7)],e=f.weekdays[t.getDay()],m.find("select[name=rimonthlyweekdayofmonthindex]").val(n),m.find("select[name=rimonthlyweekdayofmonth]").val(e),m.find("select[name=riyearlydayofmonthmonth]").val(t.getMonth()+1),m.find("select[name=riyearlydayofmonthday]").val(t.getDate()),m.find("select[name=riyearlyweekdayofmonthindex]").val(n),m.find("select[name=riyearlyweekdayofmonthday]").val(e),m.find("select[name=riyearlyweekdayofmonthmonth]").val(t.getMonth()+1),w(t,x(m,f,!1).result,0,!1),m.find("div.rioccurrencesactions").show()):m.find("div.rioccurrencesactions").hide(),o(m.find("select[name=rirtemplate]"))}function c(){var e=x(m,f,!1);g.find("label[class=ridisplay]").text(f.i18n.displayActivate+" "+e.description),t.val(e.result).change();e=r();null!==e&&w(e,x(m,f,!1).result,0,!0),g.find('button[name="riedit"]').text(f.i18n.edit_rules),g.find('button[name="ridelete"]').show()}function d(e){var t,n=r(),i=e.find("#messagearea");if(i.text(""),i.hide(),e.find(".riaddoccurrence div.errorarea").text("").hide(),"block"===e.find("#ridailyinterval").css("display")&&(!(t=s("ridailyinterval",e))||t<1||1e3<t))i.text(f.i18n.noRepeatEvery).show();else if("block"===e.find("#riweeklyinterval").css("display")&&(!(t=s("riweeklyinterval",e))||t<1||1e3<t))i.text(f.i18n.noRepeatEvery).show();else{if("block"===e.find("#rimonthlyinterval").css("display")){if(!(t=s("rimonthlyinterval",e))||t<1||1e3<t)return void i.text(f.i18n.noRepeatEvery).show();if(0===e.find("#rimonthlyoptions input:checked").length)return void i.text(f.i18n.noRepeatOn).show()}if("block"===e.find("#riyearlyinterval").css("display")){if(!(t=s("riyearlyinterval",e))||t<1||1e3<t)return void i.text(f.i18n.noRepeatEvery).show();if(0===e.find("#riyearlyoptions input:checked").length)return void i.text(f.i18n.noRepeatOn).show()}if(!(0<e.find('input[value="BYOCCURRENCES"]:visible:checked').length&&(!(t=s("rirangebyoccurrencesvalue",e))||t<1||1e3<t))){if(0<e.find('input[value="BYENDDATE"]:visible:checked').length){if(t=(t=(e=(t=e).find("input[name=rirangebyenddatecalendar]")).data("dateinput"))?t.getValue():e.val(),t=new Date(t),!(t=isNaN(t)||""===e.val()?null:t))return void i.text(f.i18n.noEndDate).show();if(t<n)return void i.text(f.i18n.pastEndDate).show()}return 1}i.text(f.i18n.noEndAfterNOccurrences).show()}}function u(e){e.preventDefault(),d(m)&&(m.overlay().close(),c())}function h(){var e=r();d(m)&&w(e,x(m,f,!1).result,0,!1)}$.extend(f,{orderIndexes:["+1","+2","+3","+4","-1"],weekdays:["SU","MO","TU","WE","TH","FR","SA"],orderedWeekdays:n}),g=$.tmpl("displayTmpl",f),(m=$.tmpl("formTmpl",f)).overlay(f.formOverlay).hide(),m.ical={RDATE:[],EXDATE:[]},$.tools.dateinput.localize(f.lang,{months:p[f.lang].months.join(),shortMonths:p[f.lang].shortMonths.join(),days:p[f.lang].weekdays.join(),shortDays:p[f.lang].shortWeekdays.join()}),m.find("input[name=rirangebyenddatecalendar]").dateinput({selectors:!0,lang:f.lang,format:f.i18n.shortDateFormat,firstDay:f.firstDay,yearRange:[-5,10]}).data("dateinput").setValue(new Date),t.val()&&(-1===S(m,f,t.val(),!1)?g.find("label[class=ridisplay]").text(f.i18n.noRule):c()),g.find("button[name=ridelete]").click(function(e){e.preventDefault(),g.find("label[class=ridisplay]").text(f.i18n.displayUnactivate),t.val("").change(),g.find(".rioccurrences").hide(),g.find('button[name="riedit"]').text(f.i18n.add_rules),g.find('button[name="ridelete"]').hide()}),g.find("button[name=riedit]").click(function(e){l(t.val()),e.preventDefault(),m.overlay().load()}),m.find("div.riaddoccurrence input#adddate").dateinput({selectors:!0,lang:f.lang,format:f.i18n.shortDateFormat,firstDay:f.firstDay,yearRange:[-5,10]}).data("dateinput").setValue(new Date),m.find("input#addaction").click(function(e){e.preventDefault();var t=m.find(".riaddoccurrence input#adddate").data("dateinput"),n=t.getValue("yyyymmddT000000");void 0===m.ical.RDATE&&(m.ical.RDATE=[]),(e=m.find(".riaddoccurrence div.errorarea")).text(""),e.hide(),-1===$.inArray(n,m.ical.RDATE)?(m.ical.RDATE.push(n),n=['<div class="occurrence rdate" style="display: none;">','<span class="rdate">',t.getValue(f.i18n.longDateFormat),'<span class="rlabel">'+f.i18n.additionalDate+"</span>","</span>",'<span class="action">','<a date="'+n+'" href="#" class="rdate" >',"Include","</a>","</span>","</div>"].join("\n"),m.find("div.rioccurrences").prepend(n),$(m.find("div.rioccurrences div")[0]).slideDown(),$(m.find("div.rioccurrences .action a.rdate")[0]).click(b)):e.text(f.i18n.alreadyAdded).show()}),m.find("a.rirefreshbutton").click(function(e){e.preventDefault(),h()}),m.find("select[name=rirtemplate]").change(function(e){o($(this))}),m.find("select").change(function(e){$(this).parent().find("> input").click().change()}),m.find("input[name=rirangebyoccurrencesvalue]").change(function(e){$(this).parent().find("input[name=rirangetype]").click().change()}),m.find("input[name=rirangebyenddatecalendar]").change(function(){$(this).parent().find("input[name=rirangetype]").click(),0!==m.find(".rioccurrencesactions:visible").length&&h()}),m.find("input:radio, .riweeklyweekday > input, input[name=ridailyinterval], input[name=riweeklyinterval], input[name=rimonthlyinterval], input[name=riyearlyinterval]").change(function(e){0!==m.find(".rioccurrencesactions:visible").length&&h()}),m.find(".ricancelbutton").click(function(e){e.preventDefault(),m.overlay().close()}),m.find(".risavebutton").click(u),$.extend(this,{display:g,form:m,loadData:l,save:u})}$.fn.recurrenceinput=function(e){if(this.data("recurrenceinput"))return this.data("recurrenceinput");var t=$.extend({},o.conf);$.extend(t,e),$.extend(t,{i18n:p[t.lang],name:this.attr("name")});t=new n(t,this);return t.form.appendTo("body"),this.after(t.display),this.hide(),this.data("recurrenceinput",t),t}}(jQuery)}.apply(e,arguments)})}(this),define("mockup-patterns-recurrence",["jquery","pat-base","jquery.recurrenceinput"],function(e,t){"use strict";return t.extend({name:"recurrence",trigger:".pat-recurrence",parser:"mockup",defaults:{language:"en",localization:null,configuration:{}},init:function(){this.$el.addClass("recurrence-widget"),this.options.localization&&e.tools.recurrenceinput.localize(this.options.language,this.options.localization),this.$el.recurrenceinput(this.options.configuration)}})}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("sortable",t):(e=e||self).Sortable=t()}(this,function(){function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,i=arguments[t];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function e(e){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var b=e(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),w=e(/Edge/i),l=e(/firefox/i),d=e(/safari/i)&&!e(/chrome/i)&&!e(/android/i),t=e(/iP(ad|od|hone)/i),n=e(/chrome/i)&&e(/android/i),i={capture:!1,passive:!1};function c(e,t,n){e.addEventListener(t,n,!b&&i)}function a(e,t,n){e.removeEventListener(t,n,!b&&i)}function r(e,t){if(t&&(">"===t[0]&&(t=t.substring(1)),e))try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(e){return}}function $(e,t,n,i){if(e){n=n||document;do{if(null!=t&&(">"!==t[0]||e.parentNode===n)&&r(e,t)||i&&e===n)return e}while(e!==n&&(e=(o=e).host&&o!==document&&o.host.nodeType?o.host:o.parentNode))}var o;return null}var o,s=/\s+/g;function A(e,t,n){var i;e&&t&&(e.classList?e.classList[n?"add":"remove"](t):(i=(" "+e.className+" ").replace(s," ").replace(" "+t+" "," "),e.className=(i+(n?" "+t:"")).replace(s," ")))}function I(e,t,n){var i=e&&e.style;if(i){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),void 0===t?n:n[t];t in i||-1!==t.indexOf("webkit")||(t="-webkit-"+t),i[t]=n+("string"==typeof n?"":"px")}}function p(e,t){var n="";if("string"==typeof e)n=e;else do{var i=I(e,"transform")}while(i&&"none"!==i&&(n=i+" "+n),!t&&(e=e.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(n)}function u(e,t,n){if(e){var i=e.getElementsByTagName(t),o=0,a=i.length;if(n)for(;o<a;o++)n(i[o],o);return i}return[]}function _(){return document.scrollingElement||document.documentElement}function M(e,t,n,i,o){if(e.getBoundingClientRect||e===window){var a,r,s,l,c,d,u=e!==window&&e!==_()?(r=(a=e.getBoundingClientRect()).top,s=a.left,l=a.bottom,c=a.right,d=a.height,a.width):(s=r=0,l=window.innerHeight,c=window.innerWidth,d=window.innerHeight,window.innerWidth);if((t||n)&&e!==window&&(o=o||e.parentNode,!b))do{if(o&&o.getBoundingClientRect&&("none"!==I(o,"transform")||n&&"static"!==I(o,"position"))){var h=o.getBoundingClientRect();r-=h.top+parseInt(I(o,"border-top-width")),s-=h.left+parseInt(I(o,"border-left-width")),l=r+a.height,c=s+a.width;break}}while(o=o.parentNode);return i&&e!==window&&(i=(t=p(o||e))&&t.a,e=t&&t.d,t&&(l=(r/=e)+(d/=e),c=(s/=i)+(u/=i))),{top:r,left:s,bottom:l,right:c,width:u,height:d}}}function R(e,t,n){for(var i=j(e,!0),o=M(e)[t];i;){var a=M(i)[n];if(!("top"===n||"left"===n?a<=o:o<=a))return i;if(i===_())break;i=j(i,!1)}return!1}function h(e,t,n){for(var i=0,o=0,a=e.children;o<a.length;){if("none"!==a[o].style.display&&a[o]!==Ie.ghost&&a[o]!==Ie.dragged&&$(a[o],n.draggable,e,!1)){if(i===t)return a[o];i++}o++}return null}function N(e,t){for(var n=e.lastElementChild;n&&(n===Ie.ghost||"none"===I(n,"display")||t&&!r(n,t));)n=n.previousElementSibling;return n||null}function P(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"===e.nodeName.toUpperCase()||e===Ie.clone||t&&!r(e,t)||n++;return n}function f(e){var t=0,n=0,i=_();if(e)do{var o=p(e)}while(t+=e.scrollLeft*o.a,n+=e.scrollTop*o.d,e!==i&&(e=e.parentNode));return[t,n]}function j(e,t){if(!e||!e.getBoundingClientRect)return _();var n=e,i=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var o=I(n);if(n.clientWidth<n.scrollWidth&&("auto"==o.overflowX||"scroll"==o.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==o.overflowY||"scroll"==o.overflowY)){if(!n.getBoundingClientRect||n===document.body)return _();if(i||t)return n;i=!0}}}while(n=n.parentNode);return _()}function m(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function g(t,n){return function(){var e;o||(1===(e=arguments).length?t.call(this,e[0]):t.apply(this,e),o=setTimeout(function(){o=void 0},n))}}function F(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function v(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}function y(e,t){I(e,"position","absolute"),I(e,"top",t.top),I(e,"left",t.left),I(e,"width",t.width),I(e,"height",t.height)}function k(e){I(e,"position",""),I(e,"top",""),I(e,"left",""),I(e,"width",""),I(e,"height","")}var L="Sortable"+(new Date).getTime(),x=[],S={initializeByDefault:!0},T={mount:function(e){for(var t in S)!S.hasOwnProperty(t)||t in e||(e[t]=S[t]);x.push(e)},pluginEvent:function(t,n,i){var e=this;this.eventCanceled=!1,i.cancel=function(){e.eventCanceled=!0};var o=t+"Global";x.forEach(function(e){n[e.pluginName]&&(n[e.pluginName][o]&&n[e.pluginName][o](O({sortable:n},i)),n.options[e.pluginName]&&n[e.pluginName][t]&&n[e.pluginName][t](O({sortable:n},i)))})},initializePlugins:function(n,i,o,e){for(var t in x.forEach(function(e){var t=e.pluginName;(n.options[t]||e.initializeByDefault)&&((e=new e(n,i,n.options)).sortable=n,e.options=n.options,n[t]=e,Object.assign(o,e.defaults))}),n.options){var a;!n.options.hasOwnProperty(t)||void 0!==(a=this.modifyOption(n,t,n.options[t]))&&(n.options[t]=a)}},getEventProperties:function(t,n){var i={};return x.forEach(function(e){"function"==typeof e.eventProperties&&Object.assign(i,e.eventProperties.call(n[e.pluginName],t))}),i},modifyOption:function(t,n,i){var o;return x.forEach(function(e){t[e.pluginName]&&e.optionListeners&&"function"==typeof e.optionListeners[n]&&(o=e.optionListeners[n].call(t[e.pluginName],i))}),o}};function E(e){var t=e.sortable,n=e.rootEl,i=e.name,o=e.targetEl,a=e.cloneEl,r=e.toEl,s=e.fromEl,l=e.oldIndex,c=e.newIndex,d=e.oldDraggableIndex,u=e.newDraggableIndex,h=e.originalEvent,p=e.putSortable,f=e.extraEventProperties;if(t=t||n&&n[L]){var m,g=t.options,e="on"+i.charAt(0).toUpperCase()+i.substr(1);!window.CustomEvent||b||w?(m=document.createEvent("Event")).initEvent(i,!0,!0):m=new CustomEvent(i,{bubbles:!0,cancelable:!0}),m.to=r||n,m.from=s||n,m.item=o||n,m.clone=a,m.oldIndex=l,m.newIndex=c,m.oldDraggableIndex=d,m.newDraggableIndex=u,m.originalEvent=h,m.pullMode=p?p.lastPutMode:void 0;var v,y=O({},f,T.getEventProperties(i,t));for(v in y)m[v]=y[v];n&&n.dispatchEvent(m),g[e]&&g[e].call(t,m)}}function U(e,t,n){var i=(n=void 0===n?{}:n).evt,n=function(e,t){if(null==e)return{};for(var n,i={},o=Object.keys(e),a=0;a<o.length;a++)0<=t.indexOf(n=o[a])||(i[n]=e[n]);return i}(n,["evt"]);T.pluginEvent.bind(Ie)(e,t,O({dragEl:z,parentEl:W,ghostEl:Y,rootEl:B,nextEl:q,lastDownEl:C,cloneEl:D,cloneHidden:V,dragStarted:re,putSortable:Z,activeSortable:Ie.active,originalEvent:i,oldIndex:X,oldDraggableIndex:G,newIndex:K,newDraggableIndex:J,hideGhostForTarget:Ce,unhideGhostForTarget:De,cloneNowHidden:function(){V=!0},cloneNowShown:function(){V=!1},dispatchSortableEvent:function(e){H({sortable:t,name:e,originalEvent:i})}},n))}function H(e){E(O({putSortable:Z,cloneEl:D,targetEl:z,rootEl:B,oldIndex:X,oldDraggableIndex:G,newIndex:K,newDraggableIndex:J},e))}var z,W,Y,B,q,C,D,V,X,K,G,J,Q,Z,ee,te,ne,ie,oe,ae,re,se,le,ce,de,ue=!1,he=!1,pe=[],fe=!1,me=!1,ge=[],ve=!1,ye=[],be="undefined"!=typeof document,we=t,ke=w||b?"cssFloat":"float",xe=be&&!n&&!t&&"draggable"in document.createElement("div"),Se=function(){if(be){if(b)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),Te=function(e,t){var n=I(e),i=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),o=h(e,0,t),a=h(e,1,t),r=o&&I(o),s=a&&I(a),e=r&&parseInt(r.marginLeft)+parseInt(r.marginRight)+M(o).width,t=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+M(a).width;return"flex"===n.display?"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal":"grid"===n.display?n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal":o&&r.float&&"none"!==r.float?!a||"both"!==s.clear&&s.clear!==("left"===r.float?"left":"right")?"horizontal":"vertical":o&&("block"===r.display||"flex"===r.display||"table"===r.display||"grid"===r.display||i<=e&&"none"===n[ke]||a&&"none"===n[ke]&&i<e+t)?"vertical":"horizontal"},Ee=function(e){function r(o,a){return function(e,t,n,i){if(null==o&&(a||e.options.group.name&&t.options.group.name&&e.options.group.name===t.options.group.name))return!0;if(null==o||!1===o)return!1;if(a&&"clone"===o)return o;if("function"==typeof o)return r(o(e,t,n,i),a)(e,t,n,i);t=(a?e:t).options.group.name;return!0===o||"string"==typeof o&&o===t||o.join&&-1<o.indexOf(t)}}var t={},n=e.group;n&&"object"==typeof n||(n={name:n}),t.name=n.name,t.checkPull=r(n.pull,!0),t.checkPut=r(n.put),t.revertClone=n.revertClone,e.group=t},Ce=function(){!Se&&Y&&I(Y,"display","none")},De=function(){!Se&&Y&&I(Y,"display","")};be&&document.addEventListener("click",function(e){if(he)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),he=!1},!0);function Oe(e){if(z){var t=(o=(e=e.touches?e.touches[0]:e).clientX,a=e.clientY,pe.some(function(e){if(!N(e)){var t=M(e),n=e[L].options.emptyInsertThreshold;return n&&o>=t.left-n&&o<=t.right+n&&a>=t.top-n&&a<=t.bottom+n?r=e:void 0}}),r);if(t){var n,i={};for(n in e)e.hasOwnProperty(n)&&(i[n]=e[n]);i.target=i.rootEl=t,i.preventDefault=void 0,i.stopPropagation=void 0,t[L]._onDragOver(i)}}var o,a,r}function $e(e){z&&z.parentNode[L]._isOutsideThisEl(e.target)}var Ae;function Ie(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not "+{}.toString.call(e);this.el=e,this.options=t=Object.assign({},t),e[L]=this;var n,i,o,a,r={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Te(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Ie.supportPointer&&"PointerEvent"in window,emptyInsertThreshold:5};for(o in T.initializePlugins(this,e,r),r)o in t||(t[o]=r[o]);for(a in Ee(t),this)"_"===a.charAt(0)&&"function"==typeof this[a]&&(this[a]=this[a].bind(this));this.nativeDraggable=!t.forceFallback&&xe,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?c(e,"pointerdown",this._onTapStart):(c(e,"mousedown",this._onTapStart),c(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(c(e,"dragover",this),c(e,"dragenter",this)),pe.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),Object.assign(this,(i=[],{captureAnimationState:function(){i=[],this.options.animation&&[].slice.call(this.el.children).forEach(function(e){var t,n;"none"!==I(e,"display")&&void 0!==e&&(i.push({target:e,rect:M(e)}),t=O({},i[i.length-1].rect),!e.thisAnimationDuration||(n=p(e,!0))&&(t.top-=n.f,t.left-=n.e),e.fromRect=t)})},addAnimationState:function(e){i.push(e)},removeAnimationState:function(e){i.splice(function(e,t){for(var n in e)if(e.hasOwnProperty(n))for(var i in t)if(t.hasOwnProperty(i)&&t[i]===e[n][i])return Number(n);return-1}(i,{target:e}),1)},animateAll:function(e){var c=this;if(!this.options.animation)return clearTimeout(n),void("function"==typeof e&&e());var d=!1,u=0;i.forEach(function(e){var t=0,n=e.target,i=n.fromRect,o=M(n),a=n.prevFromRect,r=n.prevToRect,s=e.rect,l=p(n,!0);l&&(o.top-=l.f,o.left-=l.e),n.toRect=o,n.thisAnimationDuration&&m(a,o)&&!m(i,o)&&(s.top-o.top)/(s.left-o.left)==(i.top-o.top)/(i.left-o.left)&&(e=s,l=a,a=r,r=c.options,t=Math.sqrt(Math.pow(l.top-e.top,2)+Math.pow(l.left-e.left,2))/Math.sqrt(Math.pow(l.top-a.top,2)+Math.pow(l.left-a.left,2))*r.animation),m(o,i)||(n.prevFromRect=i,n.prevToRect=o,t=t||c.options.animation,c.animate(n,s,o,t)),t&&(d=!0,u=Math.max(u,t),clearTimeout(n.animationResetTimer),n.animationResetTimer=setTimeout(function(){n.animationTime=0,n.prevFromRect=null,n.fromRect=null,n.prevToRect=null,n.thisAnimationDuration=null},t),n.thisAnimationDuration=t)}),clearTimeout(n),d?n=setTimeout(function(){"function"==typeof e&&e()},u):"function"==typeof e&&e(),i=[]},animate:function(e,t,n,i){var o,a;i&&(I(e,"transition",""),I(e,"transform",""),a=p(this.el),o=(t.left-n.left)/(a&&a.a||1),a=(t.top-n.top)/(a&&a.d||1),e.animatingX=!!o,e.animatingY=!!a,I(e,"transform","translate3d("+o+"px,"+a+"px,0)"),this.forRepaintDummy=e.offsetWidth,I(e,"transition","transform "+i+"ms"+(this.options.easing?" "+this.options.easing:"")),I(e,"transform","translate3d(0,0,0)"),"number"==typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout(function(){I(e,"transition",""),I(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1},i))}}))}function _e(e,t,n,i,o,a,r,s){var l,c,d=e[L],u=d.options.onMove;return!window.CustomEvent||b||w?(l=document.createEvent("Event")).initEvent("move",!0,!0):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=t,l.from=e,l.dragged=n,l.draggedRect=i,l.related=o||t,l.relatedRect=a||M(t),l.willInsertAfter=s,l.originalEvent=r,e.dispatchEvent(l),u&&(c=u.call(d,l,r)),c}function Me(e){e.draggable=!1}function Re(){ve=!1}function Ne(e){return setTimeout(e,0)}function Pe(e){return clearTimeout(e)}Ie.prototype={constructor:Ie,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(se=null)},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,z):this.options.direction},_onTapStart:function(t){if(t.cancelable){var n=this,i=this.el,e=this.options,o=e.preventOnFilter,a=t.type,r=t.touches&&t.touches[0]||t.pointerType&&"touch"===t.pointerType&&t,s=(r||t).target,l=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||s,c=e.filter;if(function(e){ye.length=0;for(var t=e.getElementsByTagName("input"),n=t.length;n--;){var i=t[n];i.checked&&ye.push(i)}}(i),!z&&!(/mousedown|pointerdown/.test(a)&&0!==t.button||e.disabled)&&!l.isContentEditable&&(this.nativeDraggable||!d||!s||"SELECT"!==s.tagName.toUpperCase())&&!((s=$(s,e.draggable,i,!1))&&s.animated||C===s)){if(X=P(s),G=P(s,e.draggable),"function"==typeof c){if(c.call(this,t,s,this))return H({sortable:n,rootEl:l,name:"filter",targetEl:s,toEl:i,fromEl:i}),U("filter",n,{evt:t}),void(o&&t.cancelable&&t.preventDefault())}else if(c=c&&c.split(",").some(function(e){if(e=$(l,e.trim(),i,!1))return H({sortable:n,rootEl:e,name:"filter",targetEl:s,fromEl:i,toEl:i}),U("filter",n,{evt:t}),!0}))return void(o&&t.cancelable&&t.preventDefault());e.handle&&!$(l,e.handle,i,!1)||this._prepareDragStart(t,r,s)}}},_prepareDragStart:function(e,t,n){var i,o=this,a=o.el,r=o.options,s=a.ownerDocument;n&&!z&&n.parentNode===a&&(i=M(n),B=a,W=(z=n).parentNode,q=z.nextSibling,C=n,Q=r.group,oe=(ee={target:Ie.dragged=z,clientX:(t||e).clientX,clientY:(t||e).clientY}).clientX-i.left,ae=ee.clientY-i.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,z.style["will-change"]="all",i=function(){U("delayEnded",o,{evt:e}),Ie.eventCanceled?o._onDrop():(o._disableDelayedDragEvents(),!l&&o.nativeDraggable&&(z.draggable=!0),o._triggerDragStart(e,t),H({sortable:o,name:"choose",originalEvent:e}),A(z,r.chosenClass,!0))},r.ignore.split(",").forEach(function(e){u(z,e.trim(),Me)}),c(s,"dragover",Oe),c(s,"mousemove",Oe),c(s,"touchmove",Oe),c(s,"mouseup",o._onDrop),c(s,"touchend",o._onDrop),c(s,"touchcancel",o._onDrop),l&&this.nativeDraggable&&(this.options.touchStartThreshold=4,z.draggable=!0),U("delayStart",this,{evt:e}),!r.delay||r.delayOnTouchOnly&&!t||this.nativeDraggable&&(w||b)?i():Ie.eventCanceled?this._onDrop():(c(s,"mouseup",o._disableDelayedDrag),c(s,"touchend",o._disableDelayedDrag),c(s,"touchcancel",o._disableDelayedDrag),c(s,"mousemove",o._delayedDragTouchMoveHandler),c(s,"touchmove",o._delayedDragTouchMoveHandler),r.supportPointer&&c(s,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(i,r.delay)))},_delayedDragTouchMoveHandler:function(e){e=e.touches?e.touches[0]:e;Math.max(Math.abs(e.clientX-this._lastX),Math.abs(e.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){z&&Me(z),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;a(e,"mouseup",this._disableDelayedDrag),a(e,"touchend",this._disableDelayedDrag),a(e,"touchcancel",this._disableDelayedDrag),a(e,"mousemove",this._delayedDragTouchMoveHandler),a(e,"touchmove",this._delayedDragTouchMoveHandler),a(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?c(document,this.options.supportPointer?"pointermove":t?"touchmove":"mousemove",this._onTouchMove):(c(z,"dragend",this),c(B,"dragstart",this._onDragStart));try{document.selection?Ne(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(e,t){var n;ue=!1,B&&z?(U("dragStarted",this,{evt:t}),this.nativeDraggable&&c(document,"dragover",$e),n=this.options,e||A(z,n.dragClass,!1),A(z,n.ghostClass,!0),Ie.active=this,e&&this._appendGhost(),H({sortable:this,name:"start",originalEvent:t})):this._nulling()},_emulateDragOver:function(){if(te){this._lastX=te.clientX,this._lastY=te.clientY,Ce();for(var e=document.elementFromPoint(te.clientX,te.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(te.clientX,te.clientY))!==t;)t=e;if(z.parentNode[L]._isOutsideThisEl(e),t)for(;(!t[L]||!t[L]._onDragOver({clientX:te.clientX,clientY:te.clientY,target:e,rootEl:t})||this.options.dragoverBubble)&&(t=(e=t).parentNode););De()}},_onTouchMove:function(e){if(ee){var t=this.options,n=t.fallbackTolerance,i=t.fallbackOffset,o=e.touches?e.touches[0]:e,a=Y&&p(Y,!0),r=Y&&a&&a.a,s=Y&&a&&a.d,t=we&&de&&f(de),r=(o.clientX-ee.clientX+i.x)/(r||1)+(t?t[0]-ge[0]:0)/(r||1),s=(o.clientY-ee.clientY+i.y)/(s||1)+(t?t[1]-ge[1]:0)/(s||1);if(!Ie.active&&!ue){if(n&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}Y&&(a?(a.e+=r-(ne||0),a.f+=s-(ie||0)):a={a:1,b:0,c:0,d:1,e:r,f:s},a="matrix("+a.a+","+a.b+","+a.c+","+a.d+","+a.e+","+a.f+")",I(Y,"webkitTransform",a),I(Y,"mozTransform",a),I(Y,"msTransform",a),I(Y,"transform",a),ne=r,ie=s,te=o),e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!Y){var e=this.options.fallbackOnBody?document.body:B,t=M(z,!0,we,!0,e),n=this.options;if(we){for(de=e;"static"===I(de,"position")&&"none"===I(de,"transform")&&de!==document;)de=de.parentNode;de!==document.body&&de!==document.documentElement?(de===document&&(de=_()),t.top+=de.scrollTop,t.left+=de.scrollLeft):de=_(),ge=f(de)}A(Y=z.cloneNode(!0),n.ghostClass,!1),A(Y,n.fallbackClass,!0),A(Y,n.dragClass,!0),I(Y,"transition",""),I(Y,"transform",""),I(Y,"box-sizing","border-box"),I(Y,"margin",0),I(Y,"top",t.top),I(Y,"left",t.left),I(Y,"width",t.width),I(Y,"height",t.height),I(Y,"opacity","0.8"),I(Y,"position",we?"absolute":"fixed"),I(Y,"zIndex","100000"),I(Y,"pointerEvents","none"),Ie.ghost=Y,e.appendChild(Y),I(Y,"transform-origin",oe/parseInt(Y.style.width)*100+"% "+ae/parseInt(Y.style.height)*100+"%")}},_onDragStart:function(e,t){var n=this,i=e.dataTransfer,o=n.options;U("dragStart",this,{evt:e}),Ie.eventCanceled?this._onDrop():(U("setupClone",this),Ie.eventCanceled||((D=v(z)).draggable=!1,D.style["will-change"]="",this._hideClone(),A(D,this.options.chosenClass,!1),Ie.clone=D),n.cloneId=Ne(function(){U("clone",n),Ie.eventCanceled||(n.options.removeCloneOnHide||B.insertBefore(D,z),n._hideClone(),H({sortable:n,name:"clone"}))}),t||A(z,o.dragClass,!0),t?(he=!0,n._loopId=setInterval(n._emulateDragOver,50)):(a(document,"mouseup",n._onDrop),a(document,"touchend",n._onDrop),a(document,"touchcancel",n._onDrop),i&&(i.effectAllowed="move",o.setData&&o.setData.call(n,i,z)),c(document,"drop",n),I(z,"transform","translateZ(0)")),ue=!0,n._dragStartId=Ne(n._dragStarted.bind(n,t,e)),c(document,"selectstart",n),re=!0,d&&I(document.body,"user-select","none"))},_onDragOver:function(c){var n,d,i,u,o=this.el,h=c.target,t=this.options,e=t.group,a=Ie.active,r=Q===e,s=t.sort,l=Z||a,p=this,f=!1;if(!ve){if(void 0!==c.preventDefault&&c.cancelable&&c.preventDefault(),h=$(h,t.draggable,o,!0),T("dragOver"),Ie.eventCanceled)return f;if(z.contains(c.target)||h.animated&&h.animatingX&&h.animatingY||p._ignoreWhileAnimating===h)return C(!1);if(he=!1,a&&!t.disabled&&(r?s||(i=!B.contains(z)):Z===this||(this.lastPutMode=Q.checkPull(this,a,z,c))&&e.checkPut(this,a,z,c))){if(u="vertical"===this._getDirection(c,h),n=M(z),T("dragOverValid"),Ie.eventCanceled)return f;if(i)return W=B,E(),this._hideClone(),T("revert"),Ie.eventCanceled||(q?B.insertBefore(z,q):B.appendChild(z)),C(!0);var m=N(o,t.draggable);if(!m||function(e,t,n){n=M(N(n.el,n.options.draggable));return t?e.clientX>n.right+10||e.clientX<=n.right&&e.clientY>n.bottom&&e.clientX>=n.left:e.clientX>n.right&&e.clientY>n.top||e.clientX<=n.right&&e.clientY>n.bottom+10}(c,u,this)&&!m.animated){if(m===z)return C(!1);if(m&&o===c.target&&(h=m),h&&(d=M(h)),!1!==_e(B,o,z,n,h,d,c,!!h))return E(),o.appendChild(z),W=o,D(),C(!0)}else if(h.parentNode===o){d=M(h);var g,v,y,b=z.parentNode!==o,m=(k=z.animated&&z.toRect||n,S=h.animated&&h.toRect||d,w=u?k.left:k.top,e=u?S.left:S.top,!(w===e||(u?k.right:k.bottom)===(u?S.right:S.bottom)||w+(u?k.width:k.height)/2===e+(u?S.width:S.height)/2)),w=u?"top":"left",k=R(h,"top","top")||R(z,"top","top"),e=k?k.scrollTop:void 0;if(se!==h&&(v=d[w],fe=!1,me=!m&&t.invertSwap||b),0!==(g=function(e,t,n,i){var o=u?c.clientY:c.clientX,a=u?d.height:d.width,r=u?d.top:d.left,s=u?d.bottom:d.right,l=!1;if(!n)if(i&&ce<a*e){if(!fe&&(1===le?r+a*t/2<o:o<s-a*t/2)&&(fe=!0),fe)l=!0;else if(1===le?o<r+ce:s-ce<o)return-le}else if(r+a*(1-e)/2<o&&o<s-a*(1-e)/2)return e=h,P(z)<P(e)?1:-1;return(l=l||n)&&(o<r+a*t/2||s-a*t/2<o)?r+a/2<o?1:-1:0}(m?1:t.swapThreshold,null==t.invertedSwapThreshold?t.swapThreshold:t.invertedSwapThreshold,me,se===h)))for(var x=P(z);y=W.children[x-=g],y&&("none"===I(y,"display")||y===Y););if(0===g||y===h)return C(!1);le=g;var S=(se=h).nextElementSibling,b=!1,m=_e(B,o,z,n,h,d,c,b=1===g);if(!1!==m)return 1!==m&&-1!==m||(b=1===m),ve=!0,setTimeout(Re,30),E(),b&&!S?o.appendChild(z):h.parentNode.insertBefore(z,b?S:h),k&&F(k,0,e-k.scrollTop),W=z.parentNode,void 0===v||me||(ce=Math.abs(v-M(h)[w])),D(),C(!0)}if(o.contains(z))return C(!1)}return!1}function T(e,t){U(e,p,O({evt:c,isOwner:r,axis:u?"vertical":"horizontal",revert:i,dragRect:n,targetRect:d,canSort:s,fromSortable:l,target:h,completed:C,onMove:function(e,t){return _e(B,o,z,n,e,M(e),c,t)},changed:D},t))}function E(){T("dragOverAnimationCapture"),p.captureAnimationState(),p!==l&&l.captureAnimationState()}function C(e){return T("dragOverCompleted",{insertion:e}),e&&(r?a._hideClone():a._showClone(p),p!==l&&(A(z,(Z||a).options.ghostClass,!1),A(z,t.ghostClass,!0)),Z!==p&&p!==Ie.active?Z=p:p===Ie.active&&Z&&(Z=null),l===p&&(p._ignoreWhileAnimating=h),p.animateAll(function(){T("dragOverAnimationComplete"),p._ignoreWhileAnimating=null}),p!==l&&(l.animateAll(),l._ignoreWhileAnimating=null)),(h===z&&!z.animated||h===o&&!h.animated)&&(se=null),t.dragoverBubble||c.rootEl||h===document||(z.parentNode[L]._isOutsideThisEl(c.target),e||Oe(c)),!t.dragoverBubble&&c.stopPropagation&&c.stopPropagation(),f=!0}function D(){K=P(z),J=P(z,t.draggable),H({sortable:p,name:"change",toEl:o,newIndex:K,newDraggableIndex:J,originalEvent:c})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){a(document,"mousemove",this._onTouchMove),a(document,"touchmove",this._onTouchMove),a(document,"pointermove",this._onTouchMove),a(document,"dragover",Oe),a(document,"mousemove",Oe),a(document,"touchmove",Oe)},_offUpEvents:function(){var e=this.el.ownerDocument;a(e,"mouseup",this._onDrop),a(e,"touchend",this._onDrop),a(e,"pointerup",this._onDrop),a(e,"touchcancel",this._onDrop),a(document,"selectstart",this)},_onDrop:function(e){var t=this.el,n=this.options;K=P(z),J=P(z,n.draggable),U("drop",this,{evt:e}),W=z&&z.parentNode,K=P(z),J=P(z,n.draggable),Ie.eventCanceled||(fe=me=ue=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Pe(this.cloneId),Pe(this._dragStartId),this.nativeDraggable&&(a(document,"drop",this),a(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),d&&I(document.body,"user-select",""),I(z,"transform",""),e&&(re&&(e.cancelable&&e.preventDefault(),n.dropBubble||e.stopPropagation()),Y&&Y.parentNode&&Y.parentNode.removeChild(Y),(B===W||Z&&"clone"!==Z.lastPutMode)&&D&&D.parentNode&&D.parentNode.removeChild(D),z&&(this.nativeDraggable&&a(z,"dragend",this),Me(z),z.style["will-change"]="",re&&!ue&&A(z,(Z||this).options.ghostClass,!1),A(z,this.options.chosenClass,!1),H({sortable:this,name:"unchoose",toEl:W,newIndex:null,newDraggableIndex:null,originalEvent:e}),B!==W?(0<=K&&(H({rootEl:W,name:"add",toEl:W,fromEl:B,originalEvent:e}),H({sortable:this,name:"remove",toEl:W,originalEvent:e}),H({rootEl:W,name:"sort",toEl:W,fromEl:B,originalEvent:e}),H({sortable:this,name:"sort",toEl:W,originalEvent:e})),Z&&Z.save()):K!==X&&0<=K&&(H({sortable:this,name:"update",toEl:W,originalEvent:e}),H({sortable:this,name:"sort",toEl:W,originalEvent:e})),Ie.active&&(null!=K&&-1!==K||(K=X,J=G),H({sortable:this,name:"end",toEl:W,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){U("nulling",this),B=z=W=Y=q=D=C=V=ee=te=re=K=J=X=G=se=le=Z=Q=Ie.dragged=Ie.ghost=Ie.clone=Ie.active=null,ye.forEach(function(e){e.checked=!0}),ye.length=ne=ie=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":z&&(this._onDragOver(e),(t=e).dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault());break;case"selectstart":e.preventDefault()}var t},toArray:function(){for(var e,t=[],n=this.el.children,i=0,o=n.length,a=this.options;i<o;i++)$(e=n[i],a.draggable,this.el,!1)&&t.push(e.getAttribute(a.dataIdAttr)||function(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,i=0;n--;)i+=t.charCodeAt(n);return i.toString(36)}(e));return t},sort:function(e){var n={},i=this.el;this.toArray().forEach(function(e,t){t=i.children[t];$(t,this.options.draggable,i,!1)&&(n[e]=t)},this),e.forEach(function(e){n[e]&&(i.removeChild(n[e]),i.appendChild(n[e]))})},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return $(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var n=this.options;if(void 0===t)return n[e];var i=T.modifyOption(this,e,t);n[e]=void 0!==i?i:t,"group"===e&&Ee(n)},destroy:function(){U("destroy",this);var e=this.el;e[L]=null,a(e,"mousedown",this._onTapStart),a(e,"touchstart",this._onTapStart),a(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(a(e,"dragover",this),a(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),pe.splice(pe.indexOf(this.el),1),this.el=e=null},_hideClone:function(){V||(U("hideClone",this),Ie.eventCanceled||(I(D,"display","none"),this.options.removeCloneOnHide&&D.parentNode&&D.parentNode.removeChild(D),V=!0))},_showClone:function(e){"clone"===e.lastPutMode?V&&(U("showClone",this),Ie.eventCanceled||(z.parentNode!=B||this.options.group.revertClone?q?B.insertBefore(D,q):B.appendChild(D):B.insertBefore(D,z),this.options.group.revertClone&&this.animate(z,D),I(D,"display",""),V=!1)):this._hideClone()}},be&&c(document,"touchmove",function(e){(Ie.active||ue)&&e.cancelable&&e.preventDefault()}),Ie.utils={on:c,off:a,css:I,find:u,is:function(e,t){return!!$(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},throttle:g,closest:$,toggleClass:A,clone:v,index:P,nextTick:Ne,cancelNextTick:Pe,detectDirection:Te,getChild:h},Ie.get=function(e){return e[L]},Ie.mount=function(){var e=[].slice.call(arguments);e[0].constructor===Array&&(e=e[0]),e.forEach(function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not "+{}.toString.call(e);e.utils&&(Ie.utils=O({},Ie.utils,e.utils)),T.mount(e)})},Ie.create=function(e,t){return new Ie(e,t)};var je,Fe,Le,Ue,He,ze=[],We=[],Ye=!(Ie.version="1.12.0"),Be=!1,qe=!1;function Ve(n,i){We.forEach(function(e,t){t=i.children[e.sortableIndex+(n?Number(t):0)];t?i.insertBefore(e,t):i.appendChild(e)})}function Xe(){ze.forEach(function(e){e!==Le&&e.parentNode&&e.parentNode.removeChild(e)})}t=function(e){var t,n=e.originalEvent,i=e.putSortable,o=e.dragEl,a=e.dispatchSortableEvent,r=e.unhideGhostForTarget;n&&(t=i||e.activeSortable,(0,e.hideGhostForTarget)(),n=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,n=document.elementFromPoint(n.clientX,n.clientY),r(),t&&!t.el.contains(n)&&(a("spill"),this.onSpill({dragEl:o,putSortable:i})))};function Ke(){}function Ge(){}Ke.prototype={startIndex:null,dragStart:function(e){this.startIndex=e.oldDraggableIndex},onSpill:function(e){var t=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();e=h(this.sortable.el,this.startIndex,this.options);e?this.sortable.el.insertBefore(t,e):this.sortable.el.appendChild(t),this.sortable.animateAll(),n&&n.animateAll()},drop:t},Object.assign(Ke,{pluginName:"revertOnSpill"}),Ge.prototype={onSpill:function(e){var t=e.dragEl,e=e.putSortable||this.sortable;e.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),e.animateAll()},drop:t},Object.assign(Ge,{pluginName:"removeOnSpill"});var Je,Qe,Ze,et,tt,nt,it=[],ot=!1;function at(){it.forEach(function(e){clearInterval(e.pid)}),it=[]}function rt(){clearInterval(nt)}var st=g(function(n,e,t,i){if(e.scroll){var o,a=(n.touches?n.touches[0]:n).clientX,r=(n.touches?n.touches[0]:n).clientY,s=e.scrollSensitivity,l=e.scrollSpeed,c=_(),d=!1;Qe!==t&&(Qe=t,at(),o=e.scrollFn,!0===(Je=e.scroll)&&(Je=j(t,!0)));var u=0,h=Je;do{var p=h,f=M(p),m=f.top,g=f.bottom,v=f.left,y=f.right,b=f.width,w=f.height,k=void 0,x=void 0,S=p.scrollWidth,T=p.scrollHeight,E=I(p),C=p.scrollLeft,f=p.scrollTop,x=p===c?(k=b<S&&("auto"===E.overflowX||"scroll"===E.overflowX||"visible"===E.overflowX),w<T&&("auto"===E.overflowY||"scroll"===E.overflowY||"visible"===E.overflowY)):(k=b<S&&("auto"===E.overflowX||"scroll"===E.overflowX),w<T&&("auto"===E.overflowY||"scroll"===E.overflowY)),C=k&&(Math.abs(y-a)<=s&&C+b<S)-(Math.abs(v-a)<=s&&!!C),f=x&&(Math.abs(g-r)<=s&&f+w<T)-(Math.abs(m-r)<=s&&!!f);if(!it[u])for(var D=0;D<=u;D++)it[D]||(it[D]={});it[u].vx==C&&it[u].vy==f&&it[u].el===p||(it[u].el=p,it[u].vx=C,it[u].vy=f,clearInterval(it[u].pid),0==C&&0==f||(d=!0,it[u].pid=setInterval(function(){i&&0===this.layer&&Ie.active._onTouchMove(tt);var e=it[this.layer].vy?it[this.layer].vy*l:0,t=it[this.layer].vx?it[this.layer].vx*l:0;"function"==typeof o&&"continue"!==o.call(Ie.dragged.parentNode[L],t,e,n,tt,it[this.layer].el)||F(it[this.layer].el,t,e)}.bind({layer:u}),24))),u++}while(e.bubbleScroll&&h!==c&&(h=j(h,!1)));ot=d}},30);return Ie.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){e=e.originalEvent;this.sortable.nativeDraggable?c(document,"dragover",this._handleAutoScroll):c(document,this.options.supportPointer?"pointermove":e.touches?"touchmove":"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){e=e.originalEvent;this.options.dragOverBubble||e.rootEl||this._handleAutoScroll(e)},drop:function(){this.sortable.nativeDraggable?a(document,"dragover",this._handleAutoScroll):(a(document,"pointermove",this._handleFallbackAutoScroll),a(document,"touchmove",this._handleFallbackAutoScroll),a(document,"mousemove",this._handleFallbackAutoScroll)),rt(),at(),clearTimeout(o),o=void 0},nulling:function(){tt=Qe=Je=ot=nt=Ze=et=null,it.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(t,n){var i,o=this,a=(t.touches?t.touches[0]:t).clientX,r=(t.touches?t.touches[0]:t).clientY,e=document.elementFromPoint(a,r);tt=t,n||w||b||d?(st(t,this.options,e,n),i=j(e,!0),!ot||nt&&a===Ze&&r===et||(nt&&rt(),nt=setInterval(function(){var e=j(document.elementFromPoint(a,r),!0);e!==i&&(i=e,at()),st(t,o.options,e,n)},10),Ze=a,et=r)):this.options.bubbleScroll&&j(e,!0)!==_()?st(t,this.options,j(e,!1),!1):at()}},Object.assign(e,{pluginName:"scroll",initializeByDefault:!0})}),Ie.mount(Ge,Ke),Ie.mount(new function(){function e(){this.defaults={swapClass:"sortable-swap-highlight"}}return e.prototype={dragStart:function(e){Ae=e.dragEl},dragOverValid:function(e){var t,n,i=e.completed,o=e.target,a=e.changed,r=e.cancel;e.activeSortable.options.swap&&(t=this.options,o&&o!==this.sortable.el&&(n=Ae,Ae=!1!==(0,e.onMove)(o)?(A(o,t.swapClass,!0),o):null,n&&n!==Ae&&A(n,t.swapClass,!1)),a(),i(!0),r())},drop:function(e){var t,n,i=e.activeSortable,o=e.putSortable,a=e.dragEl,r=o||this.sortable,s=this.options;Ae&&A(Ae,s.swapClass,!1),Ae&&(s.swap||o&&o.options.swap)&&a!==Ae&&(r.captureAnimationState(),r!==i&&i.captureAnimationState(),n=(t=Ae).parentNode,(s=(e=a).parentNode)&&n&&!s.isEqualNode(t)&&!n.isEqualNode(e)&&(o=P(e),a=P(t),s.isEqualNode(n)&&o<a&&a++,s.insertBefore(t,s.children[o]),n.insertBefore(e,n.children[a])),r.animateAll(),r!==i&&i.animateAll())},nulling:function(){Ae=null}},Object.assign(e,{pluginName:"swap",eventProperties:function(){return{swapItem:Ae}}})}),Ie.mount(new function(){function e(i){for(var e in this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this));i.options.supportPointer?c(document,"pointerup",this._deselectMultiDrag):(c(document,"mouseup",this._deselectMultiDrag),c(document,"touchend",this._deselectMultiDrag)),c(document,"keydown",this._checkKeyDown),c(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(e,t){var n="";ze.length&&Fe===i?ze.forEach(function(e,t){n+=(t?", ":"")+e.textContent}):n=t.textContent,e.setData("Text",n)}}}return e.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(e){Le=e.dragEl},delayEnded:function(){this.isMultiDrag=~ze.indexOf(Le)},setupClone:function(e){var t=e.sortable,e=e.cancel;if(this.isMultiDrag){for(var n=0;n<ze.length;n++)We.push(v(ze[n])),We[n].sortableIndex=ze[n].sortableIndex,We[n].draggable=!1,We[n].style["will-change"]="",A(We[n],this.options.selectedClass,!1),ze[n]===Le&&A(We[n],this.options.chosenClass,!1);t._hideClone(),e()}},clone:function(e){var t=e.dispatchSortableEvent,n=e.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||ze.length&&Fe===e.sortable&&(Ve(!0,e.rootEl),t("clone"),n()))},showClone:function(e){var t=e.cloneNowShown,n=e.cancel;this.isMultiDrag&&(Ve(!1,e.rootEl),We.forEach(function(e){I(e,"display","")}),t(),He=!1,n())},hideClone:function(e){var t=this,n=e.cloneNowHidden,e=e.cancel;this.isMultiDrag&&(We.forEach(function(e){I(e,"display","none"),t.options.removeCloneOnHide&&e.parentNode&&e.parentNode.removeChild(e)}),n(),He=!0,e())},dragStartGlobal:function(e){!this.isMultiDrag&&Fe&&Fe.multiDrag._deselectMultiDrag(),ze.forEach(function(e){e.sortableIndex=P(e)}),ze=ze.sort(function(e,t){return e.sortableIndex-t.sortableIndex}),qe=!0},dragStarted:function(e){var t,n=this,e=e.sortable;this.isMultiDrag&&(this.options.sort&&(e.captureAnimationState(),this.options.animation)&&(ze.forEach(function(e){e!==Le&&I(e,"position","absolute")}),t=M(Le,!1,!0,!0),ze.forEach(function(e){e!==Le&&y(e,t)}),Ye=Be=!0),e.animateAll(function(){Ye=Be=!1,n.options.animation&&ze.forEach(function(e){k(e)}),n.options.sort&&Xe()}))},dragOver:function(e){var t=e.completed,n=e.cancel;Be&&~ze.indexOf(e.target)&&(t(!1),n())},revert:function(e){var n,i,t=e.fromSortable,o=e.rootEl,a=e.sortable,r=e.dragRect;1<ze.length&&(ze.forEach(function(e){a.addAnimationState({target:e,rect:Be?M(e):r}),k(e),e.fromRect=r,t.removeAnimationState(e)}),Be=!1,n=!this.options.removeCloneOnHide,i=o,ze.forEach(function(e,t){t=i.children[e.sortableIndex+(n?Number(t):0)];t?i.insertBefore(e,t):i.appendChild(e)}))},dragOverCompleted:function(e){var t,n=e.sortable,i=e.isOwner,o=e.activeSortable,a=e.parentEl,r=e.putSortable,s=this.options;e.insertion&&(i&&o._hideClone(),Ye=!1,s.animation&&1<ze.length&&(Be||!i&&!o.options.sort&&!r)&&(t=M(Le,!1,!0,!0),ze.forEach(function(e){e!==Le&&(y(e,t),a.appendChild(e))}),Be=!0),i||(Be||Xe(),1<ze.length?(i=He,o._showClone(n),o.options.animation&&!He&&i&&We.forEach(function(e){o.addAnimationState({target:e,rect:Ue}),e.fromRect=Ue,e.thisAnimationDuration=null})):o._showClone(n)))},dragOverAnimationCapture:function(e){var t=e.dragRect,n=e.isOwner,e=e.activeSortable;ze.forEach(function(e){e.thisAnimationDuration=null}),e.options.animation&&!n&&e.multiDrag.isMultiDrag&&(Ue=Object.assign({},t),t=p(Le,!0),Ue.top-=t.f,Ue.left-=t.e)},dragOverAnimationComplete:function(){Be&&(Be=!1,Xe())},drop:function(e){var t=e.originalEvent,n=e.rootEl,i=e.parentEl,o=e.sortable,a=e.dispatchSortableEvent,r=e.oldIndex,s=e.putSortable,l=s||this.sortable;if(t){var c,d,u,h=this.options,p=i.children;if(!qe)if(h.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),A(Le,h.selectedClass,!~ze.indexOf(Le)),~ze.indexOf(Le))ze.splice(ze.indexOf(Le),1),je=null,E({sortable:o,rootEl:n,name:"deselect",targetEl:Le,originalEvt:t});else{if(ze.push(Le),E({sortable:o,rootEl:n,name:"select",targetEl:Le,originalEvt:t}),t.shiftKey&&je&&o.el.contains(je)){var f,m,g=P(je),e=P(Le);if(~g&&~e&&g!==e)for(f=g<e?(m=g,e):(m=e,g+1);m<f;m++)~ze.indexOf(p[m])||(A(p[m],h.selectedClass,!0),ze.push(p[m]),E({sortable:o,rootEl:n,name:"select",targetEl:p[m],originalEvt:t}))}else je=Le;Fe=l}qe&&this.isMultiDrag&&((i[L].options.sort||i!==n)&&1<ze.length&&(c=M(Le),d=P(Le,":not(."+this.options.selectedClass+")"),!Ye&&h.animation&&(Le.thisAnimationDuration=null),l.captureAnimationState(),Ye||(h.animation&&(Le.fromRect=c,ze.forEach(function(e){var t;e.thisAnimationDuration=null,e!==Le&&(t=Be?M(e):c,e.fromRect=t,l.addAnimationState({target:e,rect:t}))})),Xe(),ze.forEach(function(e){p[d]?i.insertBefore(e,p[d]):i.appendChild(e),d++}),r!==P(Le))||(u=!1,ze.forEach(function(e){e.sortableIndex===P(e)||(u=!0)}),u&&a("update")),ze.forEach(function(e){k(e)}),l.animateAll()),Fe=l),(n===i||s&&"clone"!==s.lastPutMode)&&We.forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)})}},nullingGlobal:function(){this.isMultiDrag=qe=!1,We.length=0},destroyGlobal:function(){this._deselectMultiDrag(),a(document,"pointerup",this._deselectMultiDrag),a(document,"mouseup",this._deselectMultiDrag),a(document,"touchend",this._deselectMultiDrag),a(document,"keydown",this._checkKeyDown),a(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(e){if(!(void 0!==qe&&qe||Fe!==this.sortable||e&&$(e.target,this.options.draggable,this.sortable.el,!1)||e&&0!==e.button))for(;ze.length;){var t=ze[0];A(t,this.options.selectedClass,!1),ze.shift(),E({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:t,originalEvt:e})}},_checkKeyDown:function(e){e.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(e){e.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},Object.assign(e,{pluginName:"multiDrag",utils:{select:function(e){var t=e.parentNode[L];t&&t.options.multiDrag&&!~ze.indexOf(e)&&(Fe&&Fe!==t&&(Fe.multiDrag._deselectMultiDrag(),Fe=t),A(e,t.options.selectedClass,!0),ze.push(e))},deselect:function(e){var t=e.parentNode[L],n=ze.indexOf(e);t&&t.options.multiDrag&&~n&&(A(e,t.options.selectedClass,!1),ze.splice(n,1))}},eventProperties:function(){var n=this,i=[],o=[];return ze.forEach(function(e){var t;i.push({multiDragElement:e,index:e.sortableIndex}),t=Be&&e!==Le?-1:Be?P(e,":not(."+n.options.selectedClass+")"):P(e),o.push({multiDragElement:e,index:t})}),{items:[].concat(ze),clones:[].concat(We),oldIndicies:i,newIndicies:o}},optionListeners:{multiDragKey:function(e){return"ctrl"===(e=e.toLowerCase())?e="Control":1<e.length&&(e=e.charAt(0).toUpperCase()+e.substr(1)),e}}})}),Ie}),function(e){define("select2",[],function(){return function(){var o;void 0===(o=jQuery).fn.each2&&o.extend(o.fn,{each2:function(e){for(var t=o([0]),n=-1,i=this.length;++n<i&&(t.context=t[0]=this[n])&&!1!==e.call(t[0],n,t););return this}}),function(b,v){"use strict";var e,t,n,y,o,s,w,c,i,a,r;function l(e){var t=b(document.createTextNode(""));e.before(t),t.before(e),t.remove()}function d(e){return e.replace(/[^\u0000-\u007E]/g,function(e){return i[e]||e})}function u(e,t){for(var n=0,i=t.length;n<i;n+=1)if(h(e,t[n]))return n;return-1}function h(e,t){return e===t||e!==v&&t!==v&&(null!==e&&null!==t&&(e.constructor===String?e+""==t+"":t.constructor===String&&t+""==e+""))}function p(e,t,n){var i,o,a;if(null===e||e.length<1)return[];for(o=0,a=(i=e.split(t)).length;o<a;o+=1)i[o]=n(i[o]);return i}function f(e){return e.outerWidth(!1)-e.width()}function m(t){var n="keyup-change-value";t.on("keydown",function(){b.data(t,n)===v&&b.data(t,n,t.val())}),t.on("keyup",function(){var e=b.data(t,n);e!==v&&t.val()!==e&&(b.removeData(t,n),t.trigger("keyup-change"))})}function g(t,n,i){var o;return i=i||v,function(){var e=arguments;window.clearTimeout(o),o=window.setTimeout(function(){n.apply(i,e)},t)}}function k(e){e.preventDefault(),e.stopPropagation()}function x(e,t,n){var i,o=[],a=b.trim(e.attr("class"));a&&b((a=""+a).split(/\s+/)).each2(function(){0===this.indexOf("select2-")&&o.push(this)}),(a=b.trim(t.attr("class")))&&b((a=""+a).split(/\s+/)).each2(function(){0!==this.indexOf("select2-")&&(i=n(this))&&o.push(i)}),e.attr("class",o.join(" "))}function S(e,t,n,i){var o=d(e.toUpperCase()).indexOf(d(t.toUpperCase())),t=t.length;o<0?n.push(i(e)):(n.push(i(e.substring(0,o))),n.push("<span class='select2-match'>"),n.push(i(e.substring(o,o+t))),n.push("</span>"),n.push(i(e.substring(o+t,e.length))))}function T(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})}function E(a){var e,r=null,t=a.quietMillis||100,s=a.url,l=this;return function(o){window.clearTimeout(e),e=window.setTimeout(function(){var e=a.data,t=s,n=a.transport||b.fn.select2.ajaxDefaults.transport,i={type:a.type||"GET",cache:a.cache||!1,jsonpCallback:a.jsonpCallback||v,dataType:a.dataType||"json"},i=b.extend({},b.fn.select2.ajaxDefaults.params,i),e=e?e.call(l,o.term,o.page,o.context):null,t="function"==typeof t?t.call(l,o.term,o.page,o.context):t;r&&"function"==typeof r.abort&&r.abort(),a.params&&(b.isFunction(a.params)?b.extend(i,a.params.call(l)):b.extend(i,a.params)),b.extend(i,{url:t,dataType:a.dataType,data:e,success:function(e){e=a.results(e,o.page,o);o.callback(e)},error:function(e,t,n){n={hasError:!0,jqXHR:e,textStatus:t,errorThrown:n};o.callback(n)}}),r=n.call(l,i)},t)}}function C(e){var t,n,i=e,s=function(e){return""+e.text};b.isArray(i)&&(i={results:n=i}),!1===b.isFunction(i)&&(n=i,i=function(){return n});e=i();return e.text&&(s=e.text,b.isFunction(s)||(t=e.text,s=function(e){return e[t]})),function(o){var a,r=o.term,n={results:[]};""!==r?(a=function(e,t){var n,i;if((e=e[0]).children){for(i in n={},e)e.hasOwnProperty(i)&&(n[i]=e[i]);n.children=[],b(e.children).each2(function(e,t){a(t,n.children)}),(n.children.length||o.matcher(r,s(n),e))&&t.push(n)}else o.matcher(r,s(e),e)&&t.push(e)},b(i().results).each2(function(e,t){a(t,n.results)}),o.callback(n)):o.callback(i())}}function D(t){var a=b.isFunction(t);return function(n){var i=n.term,o={results:[]},e=a?t(n):t;b.isArray(e)&&(b(e).each(function(){var e=this.text!==v,t=e?this.text:this;""!==i&&!n.matcher(i,t)||o.results.push(e?this:{id:this,text:this})}),n.callback(o))}}function O(e,t){if(b.isFunction(e))return 1;if(e){if("string"==typeof e)return 1;throw new Error(t+" must be a string, function, or falsy value")}}function $(e,t){if(b.isFunction(e)){var n=Array.prototype.slice.call(arguments,2);return e.apply(t,n)}return e}function A(){var n=this;b.each(arguments,function(e,t){n[t].remove(),n[t]=null})}function I(e,t){function n(){}return((n.prototype=new e).constructor=n).prototype.parent=e.prototype,n.prototype=b.extend(n.prototype,t),n}window.Select2===v&&(s={x:0,y:0},c={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){switch(e=e.which||e){case c.LEFT:case c.RIGHT:case c.UP:case c.DOWN:return!0}return!1},isControl:function(e){switch(e.which){case c.SHIFT:case c.CTRL:case c.ALT:return!0}return!!e.metaKey},isFunctionKey:function(e){return 112<=(e=e.which||e)&&e<=123}},i={"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ω":"ω","ς":"σ"},r=b(document),a=1,y=function(){return a++},e=I(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(e){var a,t,n,i,o,r=".select2-results";this.opts=e=this.prepareOpts(e),this.id=e.id,e.element.data("select2")!==v&&null!==e.element.data("select2")&&e.element.data("select2").destroy(),this.container=this.createContainer(),this.liveRegion=b(".select2-hidden-accessible"),0==this.liveRegion.length&&(this.liveRegion=b("<span>",{role:"status","aria-live":"polite"}).addClass("select2-hidden-accessible").appendTo(document.body)),this.containerId="s2id_"+(e.element.attr("id")||"autogen"+y()),this.containerEventName=this.containerId.replace(/([.])/g,"_").replace(/([;&,\-\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.container.attr("title",e.element.attr("title")),this.body=b(document.body),x(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.attr("style",e.element.attr("style")),this.container.css($(e.containerCss,this.opts.element)),this.container.addClass($(e.containerCssClass,this.opts.element)),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",k),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),x(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass($(e.dropdownCssClass,this.opts.element)),this.dropdown.data("select2",this),this.dropdown.on("click",k),this.results=a=this.container.find(r),this.search=t=this.container.find("input.select2-input"),this.queryCount=0,this.resultsPage=0,this.context=null,this.initContainer(),this.container.on("click",k),this.results.on("mousemove",function(e){s!==v&&s.x===e.pageX&&s.y===e.pageY||b(e.target).trigger("mousemove-filtered",e)}),this.dropdown.on("mousemove-filtered",r,this.bind(this.highlightUnderEvent)),this.dropdown.on("touchstart touchmove touchend",r,this.bind(function(e){this._touchEvent=!0,this.highlightUnderEvent(e)})),this.dropdown.on("touchmove",r,this.bind(this.touchMoved)),this.dropdown.on("touchstart touchend",r,this.bind(this.clearTouchMoved)),this.dropdown.on("click",this.bind(function(e){this._touchEvent&&(this._touchEvent=!1,this.selectHighlighted())})),n=80,i=this.results,o=g(n,function(e){i.trigger("scroll-debounced",e)}),i.on("scroll",function(e){0<=u(e.target,i.get())&&o(e)}),this.dropdown.on("scroll-debounced",r,this.bind(this.loadMoreIfNeeded)),b(this.container).on("change",".select2-input",function(e){e.stopPropagation()}),b(this.dropdown).on("change",".select2-input",function(e){e.stopPropagation()}),b.fn.mousewheel&&a.mousewheel(function(e,t,n,i){var o=a.scrollTop();0<i&&o-i<=0?(a.scrollTop(0),k(e)):i<0&&a.get(0).scrollHeight-a.scrollTop()+i<=a.height()&&(a.scrollTop(a.get(0).scrollHeight-a.height()),k(e))}),m(t),t.on("keyup-change input paste",this.bind(this.updateResults)),t.on("focus",function(){t.addClass("select2-focused")}),t.on("blur",function(){t.removeClass("select2-focused")}),this.dropdown.on("mouseup",r,this.bind(function(e){0<b(e.target).closest(".select2-result-selectable").length&&(this.highlightUnderEvent(e),this.selectHighlighted(e))})),this.dropdown.on("click mouseup mousedown touchstart touchend focusin",function(e){e.stopPropagation()}),this.lastSearchTerm=v,b.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),null!==e.maximumInputLength&&this.search.attr("maxlength",e.maximumInputLength);r=e.element.prop("disabled");r===v&&(r=!1),this.enable(!r);r=e.element.prop("readonly");r===v&&(r=!1),this.readonly(r),w=w||function(){var e=b("<div class='select2-measure-scrollbar'></div>");e.appendTo(document.body);var t={width:e.width()-e[0].clientWidth,height:e.height()-e[0].clientHeight};return e.remove(),t}(),this.autofocus=e.element.prop("autofocus"),e.element.prop("autofocus",!1),this.autofocus&&this.focus(),this.search.attr("placeholder",e.searchInputPlaceholder)},destroy:function(){var e=this.opts.element,t=e.data("select2"),n=this;this.close(),e.length&&e[0].detachEvent&&n._sync&&e.each(function(){n._sync&&this.detachEvent("onpropertychange",n._sync)}),this.propertyObserver&&(this.propertyObserver.disconnect(),this.propertyObserver=null),this._sync=null,t!==v&&(t.container.remove(),t.liveRegion.remove(),t.dropdown.remove(),e.removeData("select2").off(".select2"),e.is("input[type='hidden']")?e.css("display",""):(e.show().prop("autofocus",this.autofocus||!1),this.elementTabIndex?e.attr({tabindex:this.elementTabIndex}):e.removeAttr("tabindex"),e.show())),A.call(this,"container","liveRegion","dropdown","results","search")},optionToData:function(e){return e.is("option")?{id:e.prop("value"),text:e.text(),element:e.get(),css:e.attr("class"),disabled:e.prop("disabled"),locked:h(e.attr("locked"),"locked")||h(e.data("locked"),!0)}:e.is("optgroup")?{text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")}:void 0},prepareOpts:function(m){var t,e,n,g=this,r=m.element;if("select"===r.get(0).tagName.toLowerCase()&&(this.select=e=m.element),e&&b.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in m)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),m.debug=m.debug||b.fn.select2.defaults.debug,m.debug&&console&&console.warn&&(null!=m.id&&console.warn("Select2: The `id` option has been removed in Select2 4.0.0, consider renaming your `id` property or mapping the property before your data makes it to Select2. You can read more at https://select2.github.io/announcements-4.0.html#changed-id"),null!=m.text&&console.warn("Select2: The `text` option has been removed in Select2 4.0.0, consider renaming your `text` property or mapping the property before your data makes it to Select2. You can read more at https://select2.github.io/announcements-4.0.html#changed-id"),null!=m.sortResults&&console.warn("Select2: the `sortResults` option has been renamed to `sorter` in Select2 4.0.0. "),null!=m.selectOnBlur&&console.warn("Select2: The `selectOnBlur` option has been renamed to `selectOnClose` in Select2 4.0.0."),null!=m.ajax&&null!=m.ajax.results&&console.warn("Select2: The `ajax.results` option has been renamed to `ajax.processResults` in Select2 4.0.0."),null!=m.formatNoResults&&console.warn("Select2: The `formatNoResults` option has been renamed to `language.noResults` in Select2 4.0.0."),null!=m.formatSearching&&console.warn("Select2: The `formatSearching` option has been renamed to `language.searching` in Select2 4.0.0."),null!=m.formatInputTooShort&&console.warn("Select2: The `formatInputTooShort` option has been renamed to `language.inputTooShort` in Select2 4.0.0."),null!=m.formatInputTooLong&&console.warn("Select2: The `formatInputTooLong` option has been renamed to `language.inputTooLong` in Select2 4.0.0."),null!=m.formatLoading&&console.warn("Select2: The `formatLoading` option has been renamed to `language.loadingMore` in Select2 4.0.0."),null!=m.formatSelectionTooBig&&console.warn("Select2: The `formatSelectionTooBig` option has been renamed to `language.maximumSelected` in Select2 4.0.0."),m.element.data("select2Tags")&&console.warn("Select2: The `data-select2-tags` attribute has been renamed to `data-tags` in Select2 4.0.0.")),null!=m.element.data("tags")&&(n=m.element.data("tags"),b.isArray(n)||(n=[]),m.element.data("select2Tags",n)),null!=m.sorter&&(m.sortResults=m.sorter),null!=m.selectOnClose&&(m.selectOnBlur=m.selectOnClose),null!=m.ajax&&b.isFunction(m.ajax.processResults)&&(m.ajax.results=m.ajax.processResults),null!=m.language&&(n=m.language,b.isFunction(n.noMatches)&&(m.formatNoMatches=n.noMatches),b.isFunction(n.searching)&&(m.formatSearching=n.searching),b.isFunction(n.inputTooShort)&&(m.formatInputTooShort=n.inputTooShort),b.isFunction(n.inputTooLong)&&(m.formatInputTooLong=n.inputTooLong),b.isFunction(n.loadingMore)&&(m.formatLoading=n.loadingMore),b.isFunction(n.maximumSelected)&&(m.formatSelectionTooBig=n.maximumSelected)),"function"!=typeof(m=b.extend({},{populateResults:function(e,t,u){var h=this.opts.id,p=this.liveRegion,f=function(e,t,n){for(var i,o,a,r,s,l=[],c=0,d=(e=m.sortResults(e,t,u)).length;c<d;c+=1)a=!(s=!0===(i=e[c]).disabled)&&h(i)!==v,r=i.children&&0<i.children.length,(o=b("<li></li>")).addClass("select2-results-dept-"+n),o.addClass("select2-result"),o.addClass(a?"select2-result-selectable":"select2-result-unselectable"),s&&o.addClass("select2-disabled"),r&&o.addClass("select2-result-with-children"),o.addClass(g.opts.formatResultCssClass(i)),o.attr("role","presentation"),(a=b(document.createElement("div"))).addClass("select2-result-label"),a.attr("id","select2-result-label-"+y()),a.attr("role","option"),(s=m.formatResult(i,a,u,g.opts.escapeMarkup))!==v&&(a.html(s),o.append(a)),r&&((r=b("<ul></ul>")).addClass("select2-result-sub"),f(i.children,r,n+1),o.append(r)),o.data("select2-data",i),l.push(o[0]);t.append(l),p.text(m.formatMatches(e.length))};f(t,e,0)}},b.fn.select2.defaults,m)).id&&(t=m.id,m.id=function(e){return e[t]}),b.isArray(m.element.data("select2Tags"))){if("tags"in m)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+m.element.attr("id");m.tags=m.element.data("select2Tags")}if(e?(m.query=this.bind(function(i){var e,n={results:[],more:!1},o=i.term,a=function(e,t){var n;e.is("option")?i.matcher(o,e.text(),e)&&t.push(g.optionToData(e)):e.is("optgroup")&&(n=g.optionToData(e),e.children().each2(function(e,t){a(t,n.children)}),0<n.children.length&&t.push(n))},t=r.children();this.getPlaceholder()!==v&&0<t.length&&(e=this.getPlaceholderOption())&&(t=t.not(e)),t.each2(function(e,t){a(t,n.results)}),i.callback(n)}),m.id=function(e){return e.id}):"query"in m||("ajax"in m?((e=m.element.data("ajax-url"))&&0<e.length&&(m.ajax.url=e),m.query=E.call(m.element,m.ajax)):"data"in m?m.query=C(m.data):"tags"in m&&(m.query=D(m.tags),m.createSearchChoice===v&&(m.createSearchChoice=function(e){return{id:b.trim(e),text:b.trim(e)}}),m.initSelection===v&&(m.initSelection=function(e,t){var n=[];b(p(e.val(),m.separator,m.transformVal)).each(function(){var e={id:this,text:this},t=m.tags;b.isFunction(t)&&(t=t()),b(t).each(function(){if(h(this.id,e.id))return e=this,!1}),n.push(e)}),t(n)}))),"function"!=typeof m.query)throw"query function not defined for Select2 "+m.element.attr("id");if("top"===m.createSearchChoicePosition)m.createSearchChoicePosition=function(e,t){e.unshift(t)};else if("bottom"===m.createSearchChoicePosition)m.createSearchChoicePosition=function(e,t){e.push(t)};else if("function"!=typeof m.createSearchChoicePosition)throw"invalid createSearchChoicePosition option must be 'top', 'bottom' or a custom function";return m},monitorSource:function(){var e,t=this.opts.element,n=this;t.on("change.select2",this.bind(function(e){!0!==this.opts.element.data("select2-change-triggered")&&this.initSelection()})),this._sync=this.bind(function(){var e=t.prop("disabled");e===v&&(e=!1),this.enable(!e);e=t.prop("readonly");e===v&&(e=!1),this.readonly(e),this.container&&(x(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass($(this.opts.containerCssClass,this.opts.element))),this.dropdown&&(x(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass($(this.opts.dropdownCssClass,this.opts.element)))}),t.length&&t[0].attachEvent&&t.each(function(){this.attachEvent("onpropertychange",n._sync)}),(e=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver)!==v&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new e(function(e){b.each(e,n._sync)}),this.propertyObserver.observe(t.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(e){e=b.Event("select2-selecting",{val:this.id(e),object:e,choice:e});return this.opts.element.trigger(e),!e.isDefaultPrevented()},triggerChange:function(e){e=e||{},e=b.extend({},e,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(e),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return!0===this.enabledInterface},enableInterface:function(){var e=this._enabled&&!this._readonly,t=!e;return e!==this.enabledInterface&&(this.container.toggleClass("select2-container-disabled",t),this.close(),this.enabledInterface=e,!0)},enable:function(e){e===v&&(e=!0),this._enabled!==e&&(this._enabled=e,this.opts.element.prop("disabled",!e),this.enableInterface())},disable:function(){this.enable(!1)},readonly:function(e){e===v&&(e=!1),this._readonly!==e&&(this._readonly=e,this.opts.element.prop("readonly",e),this.enableInterface())},opened:function(){return!!this.container&&this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var e,t,n,i=this.dropdown,o=this.container,a=o.offset(),r=o.outerHeight(!1),s=o.outerWidth(!1),l=i.outerHeight(!1),c=b(window),d=c.width(),u=c.height(),h=c.scrollLeft()+d,p=c.scrollTop()+u,f=a.top+r,m=a.left,g=f+l<=p,v=a.top-l>=c.scrollTop(),y=i.outerWidth(!1);i.hasClass("select2-drop-above")?(e=!0,!v&&g&&(e=!(t=!0))):(e=!1,!g&&v&&(e=t=!0)),t&&(i.hide(),a=this.container.offset(),r=this.container.outerHeight(!1),s=this.container.outerWidth(!1),l=i.outerHeight(!1),h=c.scrollLeft()+d,c.scrollTop(),f=a.top+r,m=a.left,y=i.outerWidth(!1),i.show(),this.focusSearch()),this.opts.dropdownAutoWidth?(n=b(".select2-results",i)[0],i.addClass("select2-drop-auto-width"),i.css("width",""),s<(y=i.outerWidth(!1)+(n.scrollHeight===n.clientHeight?0:w.width))?s=y:y=s,l=i.outerHeight(!1)):this.container.removeClass("select2-drop-auto-width"),"static"!==this.body.css("position")&&(f-=(n=this.body.offset()).top,m-=n.left),!(m+y<=h)&&a.left+h+o.outerWidth(!1)>y&&(m=a.left+this.container.outerWidth(!1)-y),s={left:m,width:s},e?(this.container.addClass("select2-drop-above"),i.addClass("select2-drop-above"),l=i.outerHeight(!1),s.top=a.top-l,s.bottom="auto"):(s.top=f,s.bottom="auto",this.container.removeClass("select2-drop-above"),i.removeClass("select2-drop-above")),s=b.extend(s,$(this.opts.dropdownCss,this.opts.element)),i.css(s)},shouldOpen:function(){var e;return!this.opened()&&(!1!==this._enabled&&!0!==this._readonly&&(e=b.Event("select2-opening"),this.opts.element.trigger(e),!e.isDefaultPrevented()))},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return!!this.shouldOpen()&&(this.opening(),r.on("mousemove.select2Event",function(e){s.x=e.pageX,s.y=e.pageY}),!0)},opening:function(){var n,e=this.containerEventName,t="scroll."+e,i="resize."+e,o="orientationchange."+e;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body.children().last()[0]&&this.dropdown.detach().appendTo(this.body),0===(n=b("#select2-drop-mask")).length&&((n=b(document.createElement("div"))).attr("id","select2-drop-mask").attr("class","select2-drop-mask"),n.hide(),n.appendTo(this.body),n.on("mousedown touchstart click",function(e){l(n);var t=b("#select2-drop");0<t.length&&((t=t.data("select2")).opts.selectOnBlur&&t.selectHighlighted({noFocus:!0}),t.close(),e.preventDefault(),e.stopPropagation())})),this.dropdown.prev()[0]!==n[0]&&this.dropdown.before(n),b("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),n.show(),this.positionDropdown(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var a=this;this.container.parents().add(window).each(function(){b(this).on(i+" "+t+" "+o,function(e){a.opened()&&a.positionDropdown()})})},close:function(){var e,t,n,i;this.opened()&&(e=this.containerEventName,t="scroll."+e,n="resize."+e,i="orientationchange."+e,this.container.parents().add(window).each(function(){b(this).off(t).off(n).off(i)}),this.clearDropdownAlignmentPreference(),b("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),r.off("mousemove.select2Event"),this.clearSearch(),this.search.removeClass("select2-active"),this.search.removeAttr("aria-activedescendant"),this.opts.element.trigger(b.Event("select2-close")))},externalSearch:function(e){this.open(),this.search.val(e),this.updateResults(!1)},clearSearch:function(){},prefillNextSearchTerm:function(){if(""!==this.search.val())return!1;var e=this.opts.nextSearchTerm(this.data(),this.lastSearchTerm);return e!==v&&(this.search.val(e),this.search.select(),!0)},getMaximumSelectionSize:function(){return $(this.opts.maximumSelectionSize,this.opts.element)},ensureHighlightVisible:function(){var e,t,n,i,o,a=this.results,r=this.highlight();r<0||(0!=r?(e=this.findHighlightableChoices().find(".select2-result-label"),n=(o=((t=b(e[r])).offset()||{}).top||0)+t.outerHeight(!0),r===e.length-1&&0<(i=a.find("li.select2-more-results")).length&&(n=i.offset().top+i.outerHeight(!0)),(i=a.offset().top+a.outerHeight(!1))<n&&a.scrollTop(a.scrollTop()+(n-i)),(o=o-a.offset().top)<0&&"none"!=t.css("display")&&a.scrollTop(a.scrollTop()+o)):a.scrollTop(0))},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled):not(.select2-selected)")},moveHighlight:function(e){for(var t=this.findHighlightableChoices(),n=this.highlight();-1<n&&n<t.length;){var i=b(t[n+=e]);if(i.hasClass("select2-result-selectable")&&!i.hasClass("select2-disabled")&&!i.hasClass("select2-selected")){this.highlight(n);break}}},highlight:function(e){var t=this.findHighlightableChoices();if(0===arguments.length)return u(t.filter(".select2-highlighted")[0],t.get());e>=t.length&&(e=t.length-1),e<0&&(e=0),this.removeHighlight(),(e=b(t[e])).addClass("select2-highlighted"),this.search.attr("aria-activedescendant",e.find(".select2-result-label").attr("id")),this.ensureHighlightVisible(),this.liveRegion.text(e.text()),(e=e.data("select2-data"))&&this.opts.element.trigger({type:"select2-highlight",val:this.id(e),choice:e})},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},touchMoved:function(){this._touchMoved=!0},clearTouchMoved:function(){this._touchMoved=!1},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(e){var t=b(e.target).closest(".select2-result-selectable");0<t.length&&!t.is(".select2-highlighted")?(e=this.findHighlightableChoices(),this.highlight(e.index(t))):0==t.length&&this.removeHighlight()},loadMoreIfNeeded:function(){var t=this.results,n=t.find("li.select2-more-results"),i=this.resultsPage+1,o=this,a=this.search.val(),r=this.context;0!==n.length&&n.offset().top-t.offset().top-t.height()<=this.opts.loadMorePadding&&(n.addClass("select2-active"),this.opts.query({element:this.opts.element,term:a,page:i,context:r,matcher:this.opts.matcher,callback:this.bind(function(e){o.opened()&&(o.opts.populateResults.call(this,t,e.results,{term:a,page:i,context:r}),o.postprocessResults(e,!1,!1),!0===e.more?(n.detach().appendTo(t).html(o.opts.escapeMarkup($(o.opts.formatLoadMore,o.opts.element,i+1))),window.setTimeout(function(){o.loadMoreIfNeeded()},10)):n.remove(),o.positionDropdown(),o.resultsPage=i,o.context=e.context,this.opts.element.trigger({type:"select2-loaded",items:e}))})}))},tokenize:function(){},updateResults:function(n){var e,i,o=this.search,a=this.results,r=this.opts,s=this,t=o.val(),l=b.data(this.container,"select2-last-term");if((!0===n||!l||!h(t,l))&&(b.data(this.container,"select2-last-term",t),!0===n||!1!==this.showSearchInput&&this.opened())){i=++this.queryCount;t=this.getMaximumSelectionSize();if(!(1<=t&&(e=this.data(),b.isArray(e)&&e.length>=t&&O(r.formatSelectionTooBig,"formatSelectionTooBig"))))return o.val().length<r.minimumInputLength?(O(r.formatInputTooShort,"formatInputTooShort")?d("<li class='select2-no-results'>"+$(r.formatInputTooShort,r.element,o.val(),r.minimumInputLength)+"</li>"):d(""),void(n&&this.showSearch&&this.showSearch(!0))):void(r.maximumInputLength&&o.val().length>r.maximumInputLength?O(r.formatInputTooLong,"formatInputTooLong")?d("<li class='select2-no-results'>"+$(r.formatInputTooLong,r.element,o.val(),r.maximumInputLength)+"</li>"):d(""):(r.formatSearching&&0===this.findHighlightableChoices().length&&d("<li class='select2-searching'>"+$(r.formatSearching,r.element)+"</li>"),o.addClass("select2-active"),this.removeHighlight(),(e=this.tokenize())!=v&&null!=e&&o.val(e),this.resultsPage=1,r.query({element:r.element,term:o.val(),page:this.resultsPage,context:null,matcher:r.matcher,callback:this.bind(function(e){var t;if(i==this.queryCount)if(this.opened())if(e.hasError!==v&&O(r.formatAjaxError,"formatAjaxError"))d("<li class='select2-ajax-error'>"+$(r.formatAjaxError,r.element,e.jqXHR,e.textStatus,e.errorThrown)+"</li>");else{if(this.context=e.context===v?null:e.context,this.opts.createSearchChoice&&""!==o.val()&&(t=this.opts.createSearchChoice.call(s,o.val(),e.results))!==v&&null!==t&&s.id(t)!==v&&null!==s.id(t)&&0===b(e.results).filter(function(){return h(s.id(this),s.id(t))}).length&&this.opts.createSearchChoicePosition(e.results,t),0===e.results.length&&O(r.formatNoMatches,"formatNoMatches"))return d("<li class='select2-no-results'>"+$(r.formatNoMatches,r.element,o.val())+"</li>"),void(this.showSearch&&this.showSearch(o.val()));a.empty(),s.opts.populateResults.call(this,a,e.results,{term:o.val(),page:this.resultsPage,context:null}),!0===e.more&&O(r.formatLoadMore,"formatLoadMore")&&(a.append("<li class='select2-more-results'>"+r.escapeMarkup($(r.formatLoadMore,r.element,this.resultsPage))+"</li>"),window.setTimeout(function(){s.loadMoreIfNeeded()},10)),this.postprocessResults(e,n),c(),this.opts.element.trigger({type:"select2-loaded",items:e})}else this.search.removeClass("select2-active")})})));d("<li class='select2-selection-limit'>"+$(r.formatSelectionTooBig,r.element,t)+"</li>")}function c(){o.removeClass("select2-active"),s.positionDropdown(),a.find(".select2-no-results,.select2-selection-limit,.select2-searching").length?s.liveRegion.text(a.text()):s.liveRegion.text(s.opts.formatMatches(a.find('.select2-result-selectable:not(".select2-selected")').length))}function d(e){a.html(e),c()}},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){var n;(n=this.search)[0]!==document.activeElement&&window.setTimeout(function(){var e=n[0],t=n.val().length;n.focus(),(0<e.offsetWidth||0<e.offsetHeight)&&e===document.activeElement&&(e.setSelectionRange?e.setSelectionRange(t,t):e.createTextRange&&((e=e.createTextRange()).collapse(!1),e.select()))},0)},selectHighlighted:function(e){var t,n;this._touchMoved?this.clearTouchMoved():(t=this.highlight(),(n=this.results.find(".select2-highlighted").closest(".select2-result").data("select2-data"))?(this.highlight(t),this.onSelect(n,e)):e&&e.noFocus&&this.close())},getPlaceholder:function(){var e;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((e=this.getPlaceholderOption())!==v?e.text():v)},getPlaceholderOption:function(){if(this.select){var e=this.select.children("option").first();return this.opts.placeholderOption!==v?"first"===this.opts.placeholderOption&&e||"function"==typeof this.opts.placeholderOption&&this.opts.placeholderOption(this.select):""===b.trim(e.text())&&""===e.val()?e:void 0}},initContainerWidth:function(){var e=function(){var e,t,n,i,o;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"!==this.opts.width&&"resolve"!==this.opts.width)return b.isFunction(this.opts.width)?this.opts.width():this.opts.width;if("string"==typeof(e=this.opts.element.attr("style")))for(i=0,o=(t=e.split(";")).length;i<o;i+=1)if(null!==(n=t[i].replace(/\s/g,"").match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i))&&1<=n.length)return n[1];return"resolve"===this.opts.width?0<(e=this.opts.element.css("width")).indexOf("%")?e:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px":null}.call(this);null!==e&&this.container.css("width",e)}}),t=I(e,{createContainer:function(){return b(document.createElement("div")).attr({class:"select2-container"}).html(["<a href='javascript:void(0)' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&#160;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow' role='presentation'><b role='presentation'></b></span>","</a>","<label for='' class='select2-offscreen'></label>","<input class='select2-focusser select2-offscreen' type='text' aria-haspopup='true' role='button' />","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <label for='' class='select2-offscreen'></label>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input' role='combobox' aria-expanded='true'","       aria-autocomplete='list' />","   </div>","   <ul class='select2-results' role='listbox'>","   </ul>","</div>"].join(""))},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var e,t;0<=this.opts.minimumResultsForSearch&&this.showSearch(!0),this.parent.opening.apply(this,arguments),!1!==this.showSearchInput&&this.search.val(this.focusser.val()),this.opts.shouldFocusInput(this)&&(this.search.focus(),(e=this.search.get(0)).createTextRange?((t=e.createTextRange()).collapse(!1),t.select()):e.setSelectionRange&&(t=this.search.val().length,e.setSelectionRange(t,t))),this.prefillNextSearchTerm(),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger(b.Event("select2-open"))},close:function(){this.opened()&&(this.parent.close.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},focus:function(){this.opened()?this.close():(this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus()},destroy:function(){b("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),A.call(this,"selection","focusser")},initContainer:function(){var t,e=this.container,n=this.dropdown,i=y();this.opts.minimumResultsForSearch<0?this.showSearch(!1):this.showSearch(!0),this.selection=t=e.find(".select2-choice"),this.focusser=e.find(".select2-focusser"),t.find(".select2-chosen").attr("id","select2-chosen-"+i),this.focusser.attr("aria-labelledby","select2-chosen-"+i),this.results.attr("id","select2-results-"+i),this.search.attr("aria-owns","select2-results-"+i),this.focusser.attr("id","s2id_autogen"+i),e=b("label[for='"+this.opts.element.attr("id")+"']"),this.opts.element.on("focus.select2",this.bind(function(){this.focus()})),this.focusser.prev().text(e.text()).attr("for",this.focusser.attr("id"));i=this.opts.element.attr("title");this.opts.element.attr("title",i||e.text()),this.focusser.attr("tabindex",this.elementTabIndex),this.search.attr("id",this.focusser.attr("id")+"_search"),this.search.prev().text(b("label[for='"+this.focusser.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()&&229!=e.keyCode)if(e.which!==c.PAGE_UP&&e.which!==c.PAGE_DOWN)switch(e.which){case c.UP:case c.DOWN:return this.moveHighlight(e.which===c.UP?-1:1),void k(e);case c.ENTER:return this.selectHighlighted(),void k(e);case c.TAB:return void this.selectHighlighted({noFocus:!0});case c.ESC:return this.cancel(e),void k(e)}else k(e)})),this.search.on("blur",this.bind(function(e){document.activeElement===this.body.get(0)&&window.setTimeout(this.bind(function(){this.opened()&&this.results&&1<this.results.length&&this.search.focus()}),0)})),this.focusser.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()&&e.which!==c.TAB&&!c.isControl(e)&&!c.isFunctionKey(e)&&e.which!==c.ESC){if(!1!==this.opts.openOnEnter||e.which!==c.ENTER)return e.which==c.DOWN||e.which==c.UP||e.which==c.ENTER&&this.opts.openOnEnter?e.altKey||e.ctrlKey||e.shiftKey||e.metaKey?void 0:(this.open(),void k(e)):void(e.which!=c.DELETE&&e.which!=c.BACKSPACE||(this.opts.allowClear&&this.clear(),k(e)));k(e)}})),m(this.focusser),this.focusser.on("keyup-change input",this.bind(function(e){0<=this.opts.minimumResultsForSearch&&(e.stopPropagation(),this.opened()||this.open())})),t.on("mousedown touchstart","abbr",this.bind(function(e){this.isInterfaceEnabled()&&(this.clear(),(e=e).preventDefault(),e.stopImmediatePropagation(),this.close(),this.selection&&this.selection.focus())})),t.on("mousedown touchstart",this.bind(function(e){l(t),this.container.hasClass("select2-container-active")||this.opts.element.trigger(b.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),k(e)})),n.on("mousedown touchstart",this.bind(function(){this.opts.shouldFocusInput(this)&&this.search.focus()})),t.on("focus",this.bind(function(e){k(e)})),this.focusser.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(b.Event("select2-focus")),this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger(b.Event("select2-blur")))})),this.search.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(b.Event("select2-focus")),this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.opts.element.hide(),this.setPlaceholder()},clear:function(e){var t,n=this.selection.data("select2-data");n&&(t=b.Event("select2-clearing"),this.opts.element.trigger(t),t.isDefaultPrevented()||(t=this.getPlaceholderOption(),this.opts.element.val(t?t.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),!1!==e&&(this.opts.element.trigger({type:"select2-removed",val:this.id(n),choice:n}),this.triggerChange({removed:n}))))},initSelection:function(){var t;this.isPlaceholderOptionSelected()?(this.updateSelection(null),this.close(),this.setPlaceholder()):(t=this).opts.initSelection.call(null,this.opts.element,function(e){e!==v&&null!==e&&(t.updateSelection(e),t.close(),t.setPlaceholder(),t.lastSearchTerm=t.search.val())})},isPlaceholderOptionSelected:function(){var e;return this.getPlaceholder()!==v&&((e=this.getPlaceholderOption())!==v&&e.prop("selected")||""===this.opts.element.val()||this.opts.element.val()===v||null===this.opts.element.val())},prepareOpts:function(){var r=this.parent.prepareOpts.apply(this,arguments),n=this;return"select"===r.element.get(0).tagName.toLowerCase()?r.initSelection=function(e,t){e=e.find("option").filter(function(){return this.selected&&!this.disabled});t(n.optionToData(e))}:"data"in r&&(r.initSelection=r.initSelection||function(e,t){var o=e.val(),a=null;r.query({matcher:function(e,t,n){var i=h(o,r.id(n));return i&&(a=n),i},callback:b.isFunction(t)?function(){t(a)}:b.noop})}),r},getPlaceholder:function(){return this.select&&this.getPlaceholderOption()===v?v:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var e=this.getPlaceholder();this.isPlaceholderOptionSelected()&&e!==v&&(this.select&&this.getPlaceholderOption()===v||(this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")))},postprocessResults:function(e,t,n){var i=0,o=this;this.findHighlightableChoices().each2(function(e,t){if(h(o.id(t.data("select2-data")),o.opts.element.val()))return i=e,!1}),!1!==n&&(!0===t&&0<=i?this.highlight(i):this.highlight(0)),!0!==t||0<=(t=this.opts.minimumResultsForSearch)&&this.showSearch(function n(e){var i=0;return b.each(e,function(e,t){t.children?i+=n(t.children):i++}),i}(e.results)>=t)},showSearch:function(e){this.showSearchInput!==e&&(this.showSearchInput=e,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!e),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!e),b(this.dropdown,this.container).toggleClass("select2-with-searchbox",e))},onSelect:function(e,t){var n,i;this.triggerSelect(e)&&(n=this.opts.element.val(),i=this.data(),this.opts.element.val(this.id(e)),this.updateSelection(e),this.opts.element.trigger({type:"select2-selected",val:this.id(e),choice:e}),this.lastSearchTerm=this.search.val(),this.close(),t&&t.noFocus||!this.opts.shouldFocusInput(this)||this.focusser.focus(),h(n,this.id(e))||this.triggerChange({added:e,removed:i}))},updateSelection:function(e){var t,n=this.selection.find(".select2-chosen");this.selection.data("select2-data",e),n.empty(),null!==e&&(t=this.opts.formatSelection(e,n,this.opts.escapeMarkup)),t!==v&&n.append(t),(e=this.opts.formatSelectionCssClass(e,n))!==v&&n.addClass(e),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==v&&this.container.addClass("select2-allowclear")},val:function(){var e,t=!1,n=null,i=this,o=this.data();if(0===arguments.length)return this.opts.element.val();if(e=arguments[0],1<arguments.length&&(t=arguments[1],this.opts.debug&&console&&console.warn&&console.warn('Select2: The second option to `select2("val")` is not supported in Select2 4.0.0. The `change` event will always be triggered in 4.0.0.')),this.select)this.opts.debug&&console&&console.warn&&console.warn('Select2: Setting the value on a <select> using `select2("val")` is no longer supported in 4.0.0. You can use the `.val(newValue).trigger("change")` method provided by jQuery instead.'),this.select.val(e).find("option").filter(function(){return this.selected}).each2(function(e,t){return n=i.optionToData(t),!1}),this.updateSelection(n),this.setPlaceholder(),t&&this.triggerChange({added:n,removed:o});else if(e||0===e){if(this.opts.initSelection===v)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){i.opts.element.val(e?i.id(e):""),i.updateSelection(e),i.setPlaceholder(),t&&i.triggerChange({added:e,removed:o})})}else this.clear(t)},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(e){var t,n=!1;if(0===arguments.length)return(t=this.selection.data("select2-data"))==v&&(t=null),t;this.opts.debug&&console&&console.warn&&console.warn('Select2: The `select2("data")` method can no longer set selected values in 4.0.0, consider using the `.val()` method instead.'),1<arguments.length&&(n=arguments[1]),e?(t=this.data(),this.opts.element.val(e?this.id(e):""),this.updateSelection(e),n&&this.triggerChange({added:e,removed:t})):this.clear(n)}}),n=I(e,{createContainer:function(){return b(document.createElement("div")).attr({class:"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <label for='' class='select2-offscreen'></label>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""))},prepareOpts:function(){var l=this.parent.prepareOpts.apply(this,arguments),i=this;return"select"===l.element.get(0).tagName.toLowerCase()?l.initSelection=function(e,t){var n=[];e.find("option").filter(function(){return this.selected&&!this.disabled}).each2(function(e,t){n.push(i.optionToData(t))}),t(n)}:"data"in l&&(l.initSelection=l.initSelection||function(e,a){var r=p(e.val(),l.separator,l.transformVal),s=[];l.query({matcher:function(e,t,n){var i=b.grep(r,function(e){return h(e,l.id(n))}).length;return i&&s.push(n),i},callback:b.isFunction(a)?function(){for(var e=[],t=0;t<r.length;t++)for(var n=r[t],i=0;i<s.length;i++){var o=s[i];if(h(n,l.id(o))){e.push(o),s.splice(i,1);break}}a(e)}:b.noop})}),l},selectChoice:function(e){var t=this.container.find(".select2-search-choice-focus");t.length&&e&&e[0]==t[0]||(t.length&&this.opts.element.trigger("choice-deselected",t),t.removeClass("select2-search-choice-focus"),e&&e.length&&(this.close(),e.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",e)))},destroy:function(){b("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),A.call(this,"searchContainer","selection")},initContainer:function(){var l,e=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=l=this.container.find(e);var t=this;this.selection.on("click",".select2-container:not(.select2-container-disabled) .select2-search-choice:not(.select2-locked)",function(e){t.search[0].focus(),t.selectChoice(b(this))}),this.search.attr("id","s2id_autogen"+y()),this.search.prev().text(b("label[for='"+this.opts.element.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.opts.element.on("focus.select2",this.bind(function(){this.focus()})),this.search.on("input paste",this.bind(function(){this.search.attr("placeholder")&&0==this.search.val().length||this.isInterfaceEnabled()&&(this.opened()||this.open())})),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()){++this.keydowns;var t,n,i,o=l.find(".select2-search-choice-focus"),a=o.prev(".select2-search-choice:not(.select2-locked)"),r=o.next(".select2-search-choice:not(.select2-locked)"),i=(t=this.search,s=i=0,"selectionStart"in(t=b(t)[0])?(i=t.selectionStart,s=t.selectionEnd-i):"selection"in document&&(t.focus(),n=document.selection.createRange(),s=document.selection.createRange().text.length,n.moveStart("character",-t.value.length),i=n.text.length-s),{offset:i,length:s});if(o.length&&(e.which==c.LEFT||e.which==c.RIGHT||e.which==c.BACKSPACE||e.which==c.DELETE||e.which==c.ENTER)){var s=o;return e.which==c.LEFT&&a.length?s=a:e.which==c.RIGHT?s=r.length?r:null:e.which===c.BACKSPACE?this.unselect(o.first())&&(this.search.width(10),s=a.length?a:r):e.which==c.DELETE?this.unselect(o.first())&&(this.search.width(10),s=r.length?r:null):e.which==c.ENTER&&(s=null),this.selectChoice(s),k(e),void(s&&s.length||this.open())}if((e.which===c.BACKSPACE&&1==this.keydowns||e.which==c.LEFT)&&0==i.offset&&!i.length)return this.selectChoice(l.find(".select2-search-choice:not(.select2-locked)").last()),void k(e);if(this.selectChoice(null),this.opened())switch(e.which){case c.UP:case c.DOWN:return this.moveHighlight(e.which===c.UP?-1:1),void k(e);case c.ENTER:return this.selectHighlighted(),void k(e);case c.TAB:return this.selectHighlighted({noFocus:!0}),void this.close();case c.ESC:return this.cancel(e),void k(e)}if(e.which!==c.TAB&&!c.isControl(e)&&!c.isFunctionKey(e)&&e.which!==c.BACKSPACE&&e.which!==c.ESC){if(e.which===c.ENTER){if(!1===this.opts.openOnEnter)return;if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return}this.open(),e.which!==c.PAGE_UP&&e.which!==c.PAGE_DOWN||k(e),e.which===c.ENTER&&k(e)}}})),this.search.on("keyup",this.bind(function(e){this.keydowns=0,this.resizeSearch()})),this.search.on("blur",this.bind(function(e){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),e.stopImmediatePropagation(),this.opts.element.trigger(b.Event("select2-blur"))})),this.container.on("click",e,this.bind(function(e){this.isInterfaceEnabled()&&(0<b(e.target).closest(".select2-search-choice").length||(this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger(b.Event("select2-focus")),this.open(),this.focusSearch(),e.preventDefault()))})),this.container.on("focus",e,this.bind(function(){this.isInterfaceEnabled()&&(this.container.hasClass("select2-container-active")||this.opts.element.trigger(b.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.initContainerWidth(),this.opts.element.hide(),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){var t;""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),!this.select&&""===this.opts.element.val()||(t=this).opts.initSelection.call(null,this.opts.element,function(e){e!==v&&null!==e&&(t.updateSelection(e),t.close(),t.clearSearch())})},clearSearch:function(){var e=this.getPlaceholder(),t=this.getMaxSearchWidth();e!==v&&0===this.getVal().length&&!1===this.search.hasClass("select2-focused")?(this.search.val(e).addClass("select2-default"),this.search.width(0<t?t:this.container.css("width"))):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),this.prefillNextSearchTerm(),this.updateResults(!0),this.opts.shouldFocusInput(this)&&this.search.focus(),this.opts.element.trigger(b.Event("select2-open"))},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(e){var t={},n=[],i=this;b(e).each(function(){i.id(this)in t||(t[i.id(this)]=0,n.push(this))}),this.selection.find(".select2-search-choice").remove(),this.addSelectedChoice(n),i.postprocessResults()},tokenize:function(){var e=this.search.val();null!=(e=this.opts.tokenizer.call(this,e,this.data(),this.bind(this.onSelect),this.opts))&&e!=v&&(this.search.val(e),0<e.length&&this.open())},onSelect:function(e,t){this.triggerSelect(e)&&""!==e.text&&(this.addSelectedChoice(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),this.lastSearchTerm=this.search.val(),this.clearSearch(),this.updateResults(),!this.select&&this.opts.closeOnSelect||this.postprocessResults(e,!1,!0===this.opts.closeOnSelect),!this.opts.closeOnSelect&&0<this.countSelectableResults()?(this.search.width(10),this.resizeSearch(),0<this.getMaximumSelectionSize()&&this.val().length>=this.getMaximumSelectionSize()?this.updateResults(!0):this.prefillNextSearchTerm()&&this.updateResults(),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:e}),t&&t.noFocus||this.focusSearch())},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(e){var t=this.getVal(),n=this;b(e).each(function(){t.push(n.createChoice(this))}),this.setVal(t)},createChoice:function(e){var t=!e.locked,n=b("<li class='select2-search-choice'>    <div></div>    <a href='#' class='select2-search-choice-close' tabindex='-1'></a></li>"),i=b("<li class='select2-search-choice select2-locked'><div></div></li>"),o=t?n:i,n=this.id(e),i=this.opts.formatSelection(e,o.find("div"),this.opts.escapeMarkup);return i!=v&&o.find("div").replaceWith(b("<div></div>").html(i)),(i=this.opts.formatSelectionCssClass(e,o.find("div")))!=v&&o.addClass(i),t&&o.find(".select2-search-choice-close").on("mousedown",k).on("click dblclick",this.bind(function(e){this.isInterfaceEnabled()&&(this.unselect(b(e.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),k(e),this.close(),this.focusSearch())})).on("focus",this.bind(function(){this.isInterfaceEnabled()&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),o.data("select2-data",e),o.insertBefore(this.searchContainer),n},unselect:function(e){var t,n,i=this.getVal();if(0===(e=e.closest(".select2-search-choice")).length)throw"Invalid argument: "+e+". Must be .select2-search-choice";if(t=e.data("select2-data")){var o=b.Event("select2-removing");if(o.val=this.id(t),o.choice=t,this.opts.element.trigger(o),o.isDefaultPrevented())return!1;for(;0<=(n=u(this.id(t),i));)i.splice(n,1),this.setVal(i),this.select&&this.postprocessResults();return e.remove(),this.opts.element.trigger({type:"select2-removed",val:this.id(t),choice:t}),this.triggerChange({removed:t}),!0}},postprocessResults:function(e,t,n){var i=this.getVal(),o=this.results.find(".select2-result"),a=this.results.find(".select2-result-with-children"),r=this;o.each2(function(e,t){0<=u(r.id(t.data("select2-data")),i)&&(t.addClass("select2-selected"),t.find(".select2-result-selectable").addClass("select2-selected"))}),a.each2(function(e,t){t.is(".select2-result-selectable")||0!==t.find(".select2-result-selectable:not(.select2-selected)").length||t.addClass("select2-selected")}),-1==this.highlight()&&!1!==n&&!0===this.opts.closeOnSelect&&r.highlight(0),!this.opts.createSearchChoice&&0<!o.filter(".select2-result:not(.select2-selected)").length&&(!e||e&&!e.more&&0===this.results.find(".select2-no-results").length)&&O(r.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+$(r.opts.formatNoMatches,r.opts.element,r.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-f(this.search)},resizeSearch:function(){var e,t,n,i=f(this.search);t=this.search,o||(n=t[0].currentStyle||window.getComputedStyle(t[0],null),(o=b(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:n.fontSize,fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontWeight:n.fontWeight,letterSpacing:n.letterSpacing,textTransform:n.textTransform,whiteSpace:"nowrap"})).attr("class","select2-sizer"),b(document.body).append(o)),o.text(t.val()),e=o.width()+10,n=this.search.offset().left,(n=(t=this.selection.width())-(n-this.selection.offset().left)-i)<e&&(n=t-i),n<40&&(n=t-i),n<=0&&(n=e),this.search.width(Math.floor(n))},getVal:function(){var e;return this.select?null===(e=this.select.val())?[]:e:p(e=this.opts.element.val(),this.opts.separator,this.opts.transformVal)},setVal:function(e){var t,n;this.select?this.select.val(e):(t=[],n={},b(e).each(function(){this in n||(t.push(this),n[this]=0)}),this.opts.element.val(0===t.length?"":t.join(this.opts.separator)))},buildChangeDetails:function(e,t){for(var t=t.slice(0),e=e.slice(0),n=0;n<t.length;n++)for(var i=0;i<e.length;i++)if(h(this.opts.id(t[n]),this.opts.id(e[i]))){t.splice(n,1),n--,e.splice(i,1);break}return{added:t,removed:e}},val:function(e,n){var i,o=this;if(0===arguments.length)return this.getVal();if((i=this.data()).length||(i=[]),!e&&0!==e)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),void(n&&this.triggerChange({added:this.data(),removed:i}));if(this.setVal(e),this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),n&&this.triggerChange(this.buildChangeDetails(i,this.data()));else{if(this.opts.initSelection===v)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(e){var t=b.map(e,o.id);o.setVal(t),o.updateSelection(e),o.clearSearch(),n&&o.triggerChange(o.buildChangeDetails(i,o.data()))})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var e=[],t=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){e.push(t.opts.id(b(this).data("select2-data")))}),this.setVal(e),this.triggerChange()},data:function(e,t){var n,i,o=this;if(0===arguments.length)return this.selection.children(".select2-search-choice").map(function(){return b(this).data("select2-data")}).get();i=this.data(),e=e||[],n=b.map(e,function(e){return o.opts.id(e)}),this.setVal(n),this.updateSelection(e),this.clearSearch(),t&&this.triggerChange(this.buildChangeDetails(i,this.data()))}}),b.fn.select2=function(){var e,t,n,i=Array.prototype.slice.call(arguments,0),o=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],a=["opened","isFocused","container","dropdown"],r=["val","data"],s={search:"externalSearch"};return this.each(function(){if(0===i.length||"object"==typeof i[0])(e=0===i.length?{}:b.extend({},i[0])).element=b(this),"select"===e.element.get(0).tagName.toLowerCase()?n=e.element.prop("multiple"):(n=e.multiple||!1,"tags"in e&&(e.multiple=n=!0)),(n=new(n?window.Select2.class.multi:window.Select2.class.single)).init(e);else{if("string"!=typeof i[0])throw"Invalid arguments to select2 plugin: "+i;if(u(i[0],o)<0)throw"Unknown method: "+i[0];if(t=v,(n=b(this).data("select2"))!==v)return e=i[0],t="container"===e?n.container:"dropdown"===e?n.dropdown:(s[e]&&(e=s[e]),n[e].apply(n,i.slice(1))),!(0<=u(i[0],a)||0<=u(i[0],r)&&1==i.length)&&void 0}}),t===v?this:t},b.fn.select2.defaults={debug:!1,width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,n,i){var o=[];return S(this.text(e),n.term,o,i),o.join("")},transformVal:function(e){return b.trim(e)},formatSelection:function(e,t,n){return e?n(this.text(e)):v},sortResults:function(e,t,n){return e},formatResultCssClass:function(e){return e.css},formatSelectionCssClass:function(e,t){return v},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e==v?null:e.id},text:function(e){return e&&this.data&&this.data.text?b.isFunction(this.data.text)?this.data.text(e):e[this.data.text]:e.text},matcher:function(e,t){return 0<=d(""+t).toUpperCase().indexOf(d(""+e).toUpperCase())},separator:",",tokenSeparators:[],tokenizer:function(e,t,n,i){var o,a,r,s,l,c=e,d=!1;if(!i.createSearchChoice||!i.tokenSeparators||i.tokenSeparators.length<1)return v;for(;;){for(a=-1,r=0,s=i.tokenSeparators.length;r<s&&(l=i.tokenSeparators[r],!(0<=(a=e.indexOf(l))));r++);if(a<0)break;if(o=e.substring(0,a),e=e.substring(a+l.length),0<o.length&&(o=i.createSearchChoice.call(this,o,t))!==v&&null!==o&&i.id(o)!==v&&null!==i.id(o)){for(d=!1,r=0,s=t.length;r<s;r++)if(h(i.id(o),i.id(t[r]))){d=!0;break}d||n(o)}}return c!==e?e:void 0},escapeMarkup:T,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(e){return null},nextSearchTerm:function(e,t){return v},searchInputPlaceholder:"",createSearchChoicePosition:"top",shouldFocusInput:function(e){return!("ontouchstart"in window||0<navigator.msMaxTouchPoints)||!(e.opts.minimumResultsForSearch<0)}},b.fn.select2.locales=[],b.fn.select2.locales.en={formatMatches:function(e){return 1===e?"One result is available, press enter to select it.":e+" results are available, use up and down arrow keys to navigate."},formatNoMatches:function(){return"No matches found"},formatAjaxError:function(e,t,n){return"Loading failed"},formatInputTooShort:function(e,t){e=t-e.length;return"Please enter "+e+" or more character"+(1==e?"":"s")},formatInputTooLong:function(e,t){t=e.length-t;return"Please delete "+t+" character"+(1==t?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(1==e?"":"s")},formatLoadMore:function(e){return"Loading more results…"},formatSearching:function(){return"Searching…"}},b.extend(b.fn.select2.defaults,b.fn.select2.locales.en),b.fn.select2.ajaxDefaults={transport:b.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:E,local:C,tags:D},util:{debounce:g,markMatch:S,escapeMarkup:T,stripDiacritics:d},class:{abstract:e,single:t,multi:n}})}(jQuery)}.apply(e,arguments)})}(this),define("mockup-patterns-select2",["jquery","pat-base","mockup-utils","sortable","select2"],function(s,e,l,i){"use strict";return e.extend({name:"select2",trigger:".pat-select2",parser:"mockup",defaults:{separator:","},initializeValues:function(){var o=this;o.options.initialValues&&(o.options.id=function(e){return e.id},o.options.initSelection=function(e,t){var n=[],e=e.val(),i=o.options.initialValues;"string"==typeof o.options.initialValues&&""!==o.options.initialValues&&("{"===o.options.initialValues[0]?i=JSON.parse(o.options.initialValues):(i={},s(o.options.initialValues.split(o.options.separator)).each(function(){var e=this.split(":"),t=s.trim(e[0]),e=s.trim(e[1]);i[t]=e}))),s(e.split(o.options.separator)).each(function(){var e=this;i[this]&&(e=i[this]),n.push({id:l.removeHTML(this),text:l.removeHTML(e)})}),t(n)})},initializeTags:function(){var e=this;e.options.tags&&"string"==typeof e.options.tags&&("["===e.options.tags.substr(0,1)?e.options.tags=JSON.parse(e.options.tags):e.options.tags=e.options.tags.split(e.options.separator)),e.options.tags&&!e.options.allowNewItems&&(e.options.data=s.map(e.options.tags,function(e,t){return{id:e,text:e}}),e.options.multiple=!0,delete e.options.tags)},initializeOrdering:function(){var n=this;n.options.orderable&&this.$el.on("change",function(e){var t=this.$select2[0].querySelector(".select2-choices");new i(t,{draggable:"li",dragClass:"select2-choice-dragging",chosenClass:"dragging",onStart:function(e){n.$el.select2("onSortStart")}.bind(this),onEnd:function(e){this.$el.select2("onSortEnd")}.bind(this)})}.bind(this))},initializeSelect2:function(){var n=this;function t(e,t){return e&&(n.options.debug&&console.debug("callback",e,t),"string"==typeof e&&(e=window[e]),e(t))}n.options.formatResultCssClass=function(e){if(e.id)return"select2-option-"+e.id.toLowerCase().replace(/[ \:\)\(\[\]\{\}\_\+\=\&\*\%\#]/g,"-")},n.$el.select2(n.options),n.$el.on("select2-selected",function(e){t(n.options.onSelected,e)}),n.$el.on("select2-selecting",function(e){t(n.options.onSelecting,e)}),n.$el.on("select2-deselecting",function(e){t(n.options.onDeselecting,e)}),n.$el.on("select2-deselected",function(e){t(n.options.onDeselected,e)}),n.$select2=n.$el.parent().find(".select2-container"),n.$el.parent().off("close.plone-modal.patterns"),n.options.orderable&&n.$select2.addClass("select2-orderable")},opened:function(){return 1===s(".select2-dropdown-open",this.$el.parent()).length},init:function(){var a,e,t,n,r=this;r.options.allowNewItems=!r.options.hasOwnProperty("allowNewItems")||JSON.parse(r.options.allowNewItems),r.options.ajax||r.options.vocabularyUrl?(r.options.vocabularyUrl&&(r.options.multiple=void 0===r.options.multiple||r.options.multiple,r.options.ajax=r.options.ajax||{},r.options.ajax.url=r.options.vocabularyUrl,r.options.initSelection=function(e,t){var n=[],e=e.val();s(e.split(r.options.separator)).each(function(){var e=l.removeHTML(this);n.push({id:e,text:e})}),t(n)}),a="",r.options.ajax=s.extend({quietMillis:300,data:function(e,t){return{query:a=e,page_limit:10,page:t}},results:function(e,t){var n,i,o=e.results;return r.options.vocabularyUrl&&(n=[],s.each(e.results,function(e,t){n.push(t.id)}),o=[],i=""===a||0<=s.inArray(a,n),r.options.allowNewItems&&!i&&(a=l.removeHTML(a),o.push({id:a,text:a})),s.each(e.results,function(e,t){o.push(t)})),{results:o}}},r.options.ajax)):r.options.multiple&&r.$el.is("select")&&(e=r.$el.val()||[],t=s.map(r.$el.find("option"),function(e){return{text:s(e).html(),id:e.value}}),(n=s('<input type="hidden" />')).val(e.join(r.options.separator)),n.attr("class",r.$el.attr("class")),n.attr("name",r.$el.attr("name")),n.attr("id",r.$el.attr("id")),r.$orig=r.$el,r.$el.replaceWith(n),r.$el=n,r.options.data=t),r.initializeValues(),r.initializeTags(),r.initializeOrdering(),r.initializeSelect2()}})}),define("mockup-ui-url/views/base",["jquery","underscore","backbone","translate"],function(n,i,o,a){"use strict";return o.View.extend({isUIView:!0,eventPrefix:"ui",template:null,idPrefix:"base-",appendInContainer:!0,initialize:function(e){for(var t in this.options=e,this.options)this[t]=this.options[t];this.options._t=a},render:function(){return this.applyTemplate(),this.trigger("render",this),this.afterRender(),this.options.id&&this.$el.attr("id",this.idPrefix+this.options.id),this},afterRender:function(){},serializedModel:function(){return this.options},applyTemplate:function(){var e,t;null!==this.template&&(e=n.extend({_t:a},this.options,this.serializedModel()),"string"==typeof(t=this.template)&&(t=i.template(t)),this.$el.html(t(e)))},propagateEvent:function(e){if(0<e.indexOf(":")){e=e.split(":")[0];if(""!==this.eventPrefix&&(e===this.eventPrefix||e===this.eventPrefix+"."+this.id))return!0}return!1},uiEventTrigger:function(e){var t=[].slice.call(arguments,0);""!==this.eventPrefix&&(t[0]=this.eventPrefix+":"+e,o.View.prototype.trigger.apply(this,t),this.id&&(t[0]=this.eventPrefix+"."+this.id+":"+e,o.View.prototype.trigger.apply(this,t)))}})}),define("mockup-patterns-tooltip",["jquery","pat-base"],function(c,e,t){"use strict";function n(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)}return n.VERSION="3.2.0",n.DEFAULTS={animation:!0,placement:"auto",selector:!1,template:'<div class="tooltip mockup-tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!0,container:!1,viewport:{selector:"body",padding:0}},n.prototype.init=function(e,t,n){this.enabled=!0,this.type=e,this.$element=c(t),this.options=this.getOptions(n),this.$viewport=this.options.viewport&&c(this.options.viewport.selector||this.options.viewport);for(var i=this.options.trigger.split(" "),o=i.length;o--;){var a,r=i[o];"click"==r?this.$element.on("click."+this.type,this.options.selector,c.proxy(this.toggle,this)):"manual"!=r&&(a="hover"==r?"mouseenter":"focusin",r="hover"==r?"mouseleave":"focusout",this.$element.on(a+"."+this.type,this.options.selector,c.proxy(this.enter,this)),this.$element.on(r+"."+this.type,this.options.selector,c.proxy(this.leave,this)))}this.options.selector?this._options=c.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.getOptions=function(e){return(e=c.extend({},this.getDefaults(),this.$element.data(),e)).delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},n.prototype.getDelegateOptions=function(){var n={},i=this.getDefaults();return this._options&&c.each(this._options,function(e,t){i[e]!=t&&(n[e]=t)}),n},n.prototype.enter=function(e){var t=e instanceof this.constructor?e:c(e.currentTarget).data("bs."+this.type);if(t||(t=new this.constructor(e.currentTarget,this.getDelegateOptions()),c(e.currentTarget).data("bs."+this.type,t)),t.leaving=!1,clearTimeout(t.timeout),t.hoverState="in",!t.options.delay||!t.options.delay.show)return t.show();t.timeout=setTimeout(function(){"in"==t.hoverState&&t.show()},t.options.delay.show)},n.prototype.leave=function(e){var t=e instanceof this.constructor?e:c(e.currentTarget).data("bs."+this.type);if(t.leaving=!0,t||(t=new this.constructor(e.currentTarget,this.getDelegateOptions()),c(e.currentTarget).data("bs."+this.type,t)),clearTimeout(t.timeout),t.hoverState="out",!t.options.delay||!t.options.delay.hide)return t.hide();t.timeout=setTimeout(function(){"out"==t.hoverState&&t.hide()},t.options.delay.hide)},n.prototype.show=function(){var e,r,s,l,t=c.Event("show.bs."+this.type);this.hasContent()&&this.enabled&&(this.$element.trigger(t),e=c.contains(document.documentElement,this.$element[0]),!t.isDefaultPrevented()&&e&&(r=this.tip(),s=this.getUID(this.type),(l=this).setContent().then(function(){r.attr("id",s),l.$element.attr("aria-describedby",s),l.options.animation&&r.addClass("fade");var e="function"==typeof l.options.placement?l.options.placement.call(l,r[0],l.$element[0]):l.options.placement,t=/\s?auto?\s?/i,n=t.test(e);n&&(e=e.replace(t,"")||"top"),r.detach().css({top:0,left:0,display:"block"}).addClass(e).data("bs."+l.type,l),l.options.container?r.appendTo(l.options.container):r.insertAfter(l.$element);var i=l.getPosition(),o=r[0].offsetWidth,a=r[0].offsetHeight;n&&(t=e,n=l.$element.parent(),n=l.getPosition(n),e="bottom"==e&&i.top+i.height+a-n.scroll>n.height?"top":"top"==e&&i.top-n.scroll-a<0?"bottom":"right"==e&&i.right+o>n.width?"left":"left"==e&&i.left-o<n.left?"right":e,r.removeClass(t).addClass(e));a=l.getCalculatedOffset(e,i,o,a);l.applyPlacement(a,e);e=function(){l.$element.trigger("shown.bs."+l.type),l.hoverState=null,l.leaving&&l.leave(l)};c.support.transition&&l.$tip.hasClass("fade")?r.one("bsTransitionEnd",e).emulateTransitionEnd(150):e()})))},n.prototype.applyPlacement=function(e,t){var n=this.tip(),i=n[0].offsetWidth,o=n[0].offsetHeight,a=parseInt(n.css("margin-top"),10),r=parseInt(n.css("margin-left"),10);isNaN(a)&&(a=0),isNaN(r)&&(r=0),e.top=e.top+a,e.left=e.left+r,c.offset.setOffset(n[0],c.extend({using:function(e){n.css({top:Math.round(e.top),left:Math.round(e.left)})}},e),0),n.addClass("in");a=n[0].offsetWidth,r=n[0].offsetHeight;"top"==t&&r!=o&&(e.top=e.top+o-r);t=this.getViewportAdjustedDelta(t,e,a,r);t.left?e.left+=t.left:e.top+=t.top;o=t.left?2*t.left-i+a:2*t.top-o+r,r=t.left?"left":"top",t=t.left?"offsetWidth":"offsetHeight";n.offset(e),this.replaceArrow(o,n[0][t],r)},n.prototype.replaceArrow=function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},n.prototype.setContent=function(){var t=this.tip(),n=this.options.html?"html":"text",i=this.options.patTooltip?this.options.patTooltip.contentSelector:null;function o(e){"html"===n&&i&&(e=c(e).find(i).html()),t.find(".tooltip-inner")[n](e)}function e(){t.removeClass("fade in top bottom left right")}var a=this.getTitle(),r=this.getUrl();return r?(e(),c.get(r).then(function(e){o(e)})):(e(),o(a),new Promise(function(e,t){e(a)}))},n.prototype.getUrl=function(){return this.options.patTooltip?this.options.patTooltip.ajaxUrl:null},n.prototype.hide=function(){var e=this,t=this.tip(),n=c.Event("hide.bs."+this.type);function i(){"in"!=e.hoverState&&t.detach(),e.$element.trigger("hidden.bs."+e.type)}if(this.$element.removeAttr("aria-describedby"),this.$element.trigger(n),!n.isDefaultPrevented())return t.removeClass("in"),c.support.transition&&this.$tip.hasClass("fade")?t.one("bsTransitionEnd",i).emulateTransitionEnd(150):i(),this.hoverState=null,this},n.prototype.fixTitle=function(){var e=this.$element;!e.attr("title")&&"string"==typeof e.attr("data-original-title")||e.attr("data-original-title",e.attr("title")||"").attr("title","")},n.prototype.hasContent=function(){return this.getTitle()||this.getUrl()},n.prototype.getPosition=function(e){var t=(e=e||this.$element)[0],n="BODY"==t.tagName;return c.extend({},"function"==typeof t.getBoundingClientRect?t.getBoundingClientRect():null,{scroll:n?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop(),width:n?c(window).width():e.outerWidth(),height:n?c(window).height():e.outerHeight()},n?{top:0,left:0}:e.offset())},n.prototype.getCalculatedOffset=function(e,t,n,i){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-n/2}:"top"==e?{top:t.top-i,left:t.left+t.width/2-n/2}:"left"==e?{top:t.top+t.height/2-i/2,left:t.left-n}:{top:t.top+t.height/2-i/2,left:t.left+t.width}},n.prototype.getViewportAdjustedDelta=function(e,t,n,i){var o={top:0,left:0};if(!this.$viewport)return o;var a,r=this.options.viewport&&this.options.viewport.padding||0,s=this.getPosition(this.$viewport);return/right|left/.test(e)?(e=t.top-r-s.scroll,a=t.top+r-s.scroll+i,e<s.top?o.top=s.top-e:a>s.top+s.height&&(o.top=s.top+s.height-a)):(a=t.left-r,n=t.left+r+n,a<s.left?o.left=s.left-a:n>s.width&&(o.left=s.left+s.width-n)),o},n.prototype.getTitle=function(){var e=this.$element,t=this.options;return e.attr("data-original-title")||("function"==typeof t.title?t.title.call(e[0]):t.title)},n.prototype.getUID=function(e){for(;e+=~~(1e6*Math.random()),document.getElementById(e););return e},n.prototype.tip=function(){if(this.$tip)return this.$tip;var e=this.$tip||c(this.options.template);return this.options.patTooltip&&(this.options.patTooltip.style&&e.css(this.options.patTooltip.style),this.options.patTooltip.class&&e.addClass(this.options.patTooltip.class),this.options.patTooltip.innerStyle&&e.find(".tooltip-inner").css(this.options.patTooltip.innerStyle)),this.$tip=e},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},n.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},n.prototype.enable=function(){this.enabled=!0},n.prototype.disable=function(){this.enabled=!1},n.prototype.toggleEnabled=function(){this.enabled=!this.enabled},n.prototype.toggle=function(e){var t=this;e&&((t=c(e.currentTarget).data("bs."+this.type))||(t=new this.constructor(e.currentTarget,this.getDelegateOptions()),c(e.currentTarget).data("bs."+this.type,t))),t.tip().hasClass("in")?t.leave(t):t.enter(t)},n.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)},e.extend({name:"tooltip",trigger:".pat-tooltip",parser:"mockup",defaults:{html:!1,placement:"top"},init:function(){"true"===this.options.html||!0===this.options.html?this.options.html=!0:this.options.html=!1,this.data=new n(this.$el[0],this.options)}})}),define("mockup-ui-url/views/button",["underscore","mockup-ui-url/views/base","mockup-patterns-tooltip"],function(n,i,o){"use strict";return i.extend({tagName:"a",className:"btn",eventPrefix:"button",context:"default",idPrefix:"btn-",attributes:{href:"#"},extraClasses:[],tooltip:null,template:'<% if (icon) { %><span class="glyphicon glyphicon-<%= icon %>"></span><% } %> <%= title %>',events:{click:"handleClick"},initialize:function(e){var t;e.id||(t=e.title||"",e.id=""!==t?t.toLowerCase().replace(" ","-"):this.cid),i.prototype.initialize.apply(this,[e]),this.on("render",function(){this.$el.attr("title",this.options.title||""),this.$el.attr("aria-label",this.options.title||this.options.tooltip||""),null!==this.context&&this.$el.addClass("btn-"+this.context),n.each(this.extraClasses,function(e){this.$el.addClass(e)}.bind(this)),null!==this.tooltip&&(this.$el.attr("title",this.tooltip),new o(this.$el),this.$el.on("hidden",function(e){"hidden"===e.type&&e.stopPropagation()}))},this)},handleClick:function(e){e.preventDefault(),this.$el.is(".disabled")||this.uiEventTrigger("click",this,e)},serializedModel:function(){return n.extend({icon:"",title:""},this.options)},disable:function(){this.$el.addClass("disabled")},enable:function(){this.$el.removeClass("disabled")}})}),define("text",["module"],function(e){"use strict";var l,o,r,s,c,i=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],n=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,d="undefined"!=typeof location&&location.href,u=d&&location.protocol&&location.protocol.replace(/\:/,""),h=d&&location.hostname,p=d&&(location.port||void 0),f={},m=e.config&&e.config()||{};function g(e,t){return void 0===e||""===e?t:e}return l={version:"2.0.16",strip:function(e){var t;return e?(t=(e=e.replace(n,"")).match(a))&&(e=t[1]):e="",e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:m.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;t<3;t+=1){n=i[t];try{e=new ActiveXObject(n)}catch(e){}if(e){i=[n];break}}return e},parseName:function(e){var t,n,i=!1,o=e.lastIndexOf("."),a=0===e.indexOf("./")||0===e.indexOf("../");return-1!==o&&(!a||1<o)?(t=e.substring(0,o),n=e.substring(o+1)):t=e,-1!==(o=(e=n||t).indexOf("!"))&&(i="strip"===e.substring(o+1),e=e.substring(0,o),n?n=e:t=e),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,n,i){var o,a=l.xdRegExp.exec(e);return!a||(o=a[2],a=(e=(e=a[3]).split(":"))[1],e=e[0],(!o||o===t)&&(!e||e.toLowerCase()===n.toLowerCase())&&(!a&&!e||function(e,t,n,i){if(t===i)return!0;if(e===n){if("http"===e)return g(t,"80")===g(i,"80");if("https"===e)return g(t,"443")===g(i,"443")}return!1}(o,a,t,i)))},finishLoad:function(e,t,n,i){n=t?l.strip(n):n,m.isBuild&&(f[e]=n),i(n)},load:function(t,e,n,i){var o,a,r;i&&i.isBuild&&!i.inlineText?n():(m.isBuild=i&&i.isBuild,a=(o=l.parseName(t)).moduleName+(o.ext?"."+o.ext:""),r=e.toUrl(a),i=m.useXhr||l.useXhr,0!==r.indexOf("empty:")?!d||i(r,u,h,p)?l.get(r,function(e){l.finishLoad(t,o.strip,e,n)},function(e){n.error&&n.error(e)}):e([a],function(e){l.finishLoad(o.moduleName+"."+o.ext,o.strip,e,n)},function(e){n.error&&n.error(e)}):n())},write:function(e,t,n,i){var o;f.hasOwnProperty(t)&&(o=l.jsEscape(f[t]),n.asModule(e+"!"+t,"define(function () { return '"+o+"';});\n"))},writeFile:function(n,e,t,i,o){var a=l.parseName(e),e=a.ext?"."+a.ext:"",r=a.moduleName+e,s=t.toUrl(a.moduleName+e)+".js";l.load(r,t,function(e){function t(e){return i(s,e)}t.asModule=function(e,t){return i.asModule(e,s,t)},l.write(n,r,t,o)},o)}},"node"===m.env||!m.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(o=require.nodeRequire("fs"),l.get=function(e,t,n){try{var i=o.readFileSync(e,"utf8");"\ufeff"===i[0]&&(i=i.substring(1)),t(i)}catch(e){n&&n(e)}}):"xhr"===m.env||!m.env&&l.createXhr()?l.get=function(n,i,o,e){var t,a=l.createXhr();if(a.open("GET",n,!0),e)for(t in e)e.hasOwnProperty(t)&&a.setRequestHeader(t.toLowerCase(),e[t]);m.onXhr&&m.onXhr(a,n),a.onreadystatechange=function(e){var t;4===a.readyState&&(399<(t=a.status||0)&&t<600?((t=new Error(n+" HTTP status: "+t)).xhr=a,o&&o(t)):i(a.responseText),m.onXhrComplete&&m.onXhrComplete(a,n))},a.send(null)}:"rhino"===m.env||!m.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?l.get=function(e,t){var n,i,e=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(e),"utf-8")),r="";try{for(n=new java.lang.StringBuffer,(i=a.readLine())&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&n.append(i);null!==(i=a.readLine());)n.append(o),n.append(i);r=String(n.toString())}finally{a.close()}t(r)}:("xpconnect"===m.env||!m.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(r=Components.classes,s=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),c="@mozilla.org/windows-registry-key;1"in r,l.get=function(e,t){var n,i,o,a={};c&&(e=e.replace(/\//g,"\\")),o=new FileUtils.File(e);try{(n=r["@mozilla.org/network/file-input-stream;1"].createInstance(s.nsIFileInputStream)).init(o,1,0,!1),(i=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(s.nsIConverterInputStream)).init(n,"utf-8",n.available(),s.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),i.readString(n.available(),a),i.close(),n.close(),t(a.value)}catch(e){throw new Error((o&&o.path||"")+": "+e)}}),l}),define("text!mockup-patterns-relateditems-url/templates/breadcrumb.xml",[],function(){return'<span class="separator">/<span>\n<a href="<%- path %>" class="crumb"><%- text %></a>\n'}),define("text!mockup-patterns-relateditems-url/templates/favorite.xml",[],function(){return'<li><a href="<%- path %>" class="fav" aria-labelledby="blip"><%- title %></a></li>\n'}),define("text!mockup-patterns-relateditems-url/templates/recentlyused.xml",[],function(){return'<li class="pattern-relateditems-recentlyused">\n  <a class="pattern-relateditems-recentlyused-select" data-uid="<%- UID %>">\n    <div class="pattern-relateditems-recentlyused-info">\n      <span\n        class="pattern-relateditems-recentlyused-title <%- portal_type ? \'contenttype-\' + portal_type.toLowerCase() : \'\' %> <%- review_state ? \'state-\' + review_state : \'\' %>"\n        title="<%- portal_type %>">\n        <%- Title %>\n      </span>\n      <span class="pattern-relateditems-recentlyused-path"><%- path %></span>\n    </div>\n    <% if (getURL && (getIcon || portal_type === "Image")) { %>\n      <div class="pattern-relateditems-recentlyused-image">\n        <img src="<%- getURL %>/@@images/image/tile" />\n      </div>\n    <% } %>\n  </a>\n</li>\n'}),define("text!mockup-patterns-relateditems-url/templates/result.xml",[],function(){return'<div class="pattern-relateditems-result <%- oneLevelUp ? \'one-level-up\' : \'\' %>">\n  <div class="pattern-relateditems-result-browse-wrapper">\n  <% if (!oneLevelUp) { %>\n    <a\n      class="pattern-relateditems-result-select<%- selectable ? \' selectable\' : \'\' %><%- oneLevelUp ? \' one-level-up\' : \'\' %>"\n      data-path="<%- path %>">\n  <% } %>\n      <div class="pattern-relateditems-result-info">\n        <span\n          class="pattern-relateditems-result-title <%- portal_type ? \'contenttype-\' + portal_type.toLowerCase() : \'\' %> <%- review_state ? \'state-\' + review_state : \'\' %>"\n          title="<%- portal_type %>">\n          <%- Title %>\n        </span>\n        <span class="pattern-relateditems-result-path"><%- oneLevelUp ? currentPath : path %></span>\n      </div>\n      <% if (is_folderish) { %>\n        <a\n          class="pattern-relateditems-result-browse"\n          data-path="<%- path %>"\n          title="<%- oneLevelUp ? one_level_up : open_folder %>">\n          <span class="<%- oneLevelUp ? \'icon-left-circle\' : \'icon-right-circle\' %>"></span>\n        </a>\n      <% } %>\n  <% if (!oneLevelUp) { %>\n    </a>\n  <% } %>\n  </div>\n  <% if (getURL && (getIcon || portal_type === "Image")) { %>\n    <% if (!oneLevelUp) { %>\n    <a\n      class="pattern-relateditems-result-select<%- selectable ? \' selectable\' : \'\' %><%- oneLevelUp ? \' one-level-up\' : \'\' %>"\n      data-path="<%- path %>">\n    <% } %>\n    <div class="pattern-relateditems-result-image">\n      <img src="<%- getURL %>/@@images/image/thumb" />\n    </div>\n    <% if (!oneLevelUp) { %>\n    </a>\n    <% } %>\n  <% } %>\n</div>\n'}),define("text!mockup-patterns-relateditems-url/templates/selection.xml",[],function(){return'<div class="pattern-relateditems-item">\n  <div class="pattern-relateditems-result-info">\n    <span\n      class="pattern-relateditems-item-title <%- portal_type ? \'contenttype-\' + portal_type.toLowerCase() : \'\' %> <%- review_state ? \'state-\' + review_state : \'\' %>"\n      title="<%- portal_type %>">\n      <%- Title %>\n    </span>\n    <span class="pattern-relateditems-item-path"><%- path %></span>\n  </div>\n  <% if (getURL && (getIcon || portal_type === "Image")) { %>\n    <div class="pattern-relateditems-item-image">\n      <img src="<%- getURL %>/@@images/image/thumb" />\n    </div>\n  <% } %>\n</div>\n'}),define("text!mockup-patterns-relateditems-url/templates/toolbar.xml",[],function(){return'<% if (mode!==\'auto\') { %>\n<div class="btn-group mode-selector" role="group">\n  <button type="button" class="mode search btn <% if (mode==\'search\') { %>btn-primary<% } else {%>btn-default<% } %>"><%- searchModeText %></button>\n  <button type="button" class="mode browse btn <% if (mode==\'browse\') { %>btn-primary<% } else {%>btn-default<% } %>"><%- browseModeText %></button>\n</div>\n<% } %>\n<div class="path-wrapper">\n  <span class="pattern-relateditems-path-label"><%- searchText %></span>\n  <a class="crumb" href="/"><span class="glyphicon glyphicon-home"/></a>\n  <%= items %>\n</div>\n<div class="controls pull-right">\n\n  <% if (recentlyUsedItems) { %>\n  <div class="recentlyUsed dropdown pull-right">\n    <button type="button" class="recentlyUsed dropdown-toggle btn btn-primary" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n      <span class="glyphicon glyphicon-time"/>\n      <%- recentlyUsedText %>\n      <span class="caret"/>\n    </button>\n    <ul class="dropdown-menu">\n      <%= recentlyUsedItems %>\n    </ul>\n  </div>\n  <% } %>\n\n  <% if (favorites.length > 0) { %>\n  <div class="favorites dropdown pull-right">\n    <button type="button" class="favorites dropdown-toggle btn btn-primary" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n      <span class="glyphicon glyphicon-star"/>\n      <%- favText %>\n      <span class="caret"/>\n    </button>\n    <ul class="dropdown-menu">\n      <%= favItems %>\n    </ul>\n  </div>\n  <% } %>\n</div>\n'}),define("mockup-patterns-relateditems",["jquery","underscore","pat-base","mockup-patterns-select2","mockup-ui-url/views/button","mockup-utils","pat-registry","translate","text!mockup-patterns-relateditems-url/templates/breadcrumb.xml","text!mockup-patterns-relateditems-url/templates/favorite.xml","text!mockup-patterns-relateditems-url/templates/recentlyused.xml","text!mockup-patterns-relateditems-url/templates/result.xml","text!mockup-patterns-relateditems-url/templates/selection.xml","text!mockup-patterns-relateditems-url/templates/toolbar.xml","bootstrap-dropdown"],function(l,c,e,t,d,u,n,h,i,o,a,r,s,p){"use strict";var f=37,m=39;return e.extend({name:"relateditems",trigger:".pat-relateditems",parser:"mockup",currentPath:void 0,selectedUIDs:[],openAfterInit:void 0,defaults:{vocabularyUrl:null,attributes:["UID","Title","portal_type","path","getURL","getIcon","is_folderish","review_state"],basePath:"",pageSize:10,browsing:void 0,closeOnSelect:!0,contextPath:void 0,dropdownCssClass:"pattern-relateditems-dropdown",favorites:[],recentlyUsed:!1,recentlyUsedMaxItems:20,recentlyUsedKey:"relateditems_recentlyused",maximumSelectionSize:-1,minimumInputLength:0,mode:"auto",orderable:!0,pathOperator:"plone.app.querystring.operation.string.path",rootPath:"/",rootUrl:"",scanSelection:!1,selectableTypes:null,separator:",",sortOn:null,sortOrder:"ascending",tokenSeparators:[","," "],upload:!1,uploadAllowView:void 0,width:"100%",breadcrumbTemplate:i,breadcrumbTemplateSelector:null,favoriteTemplate:o,favoriteTemplateSelector:null,recentlyusedTemplate:a,recentlyusedTemplateSelector:null,resultTemplate:r,resultTemplateSelector:null,selectionTemplate:s,selectionTemplateSelector:null,toolbarTemplate:p,toolbarTemplateSelector:null,multiple:!0},recentlyUsed:function(e){var t=(t=u.storage.get(this.options.recentlyUsedKey)||[]).slice(t.length-1e3,t.length);e&&t.filter(this.isSelectable.bind(this));e=parseInt(this.options.recentlyUsedMaxItems,10);return e&&(t=t.slice(t.length-e,t.length)),t},applyTemplate:function(e,t){var n=this,i=n.options[e+"TemplateSelector"]&&(i=l(n.options[e+"TemplateSelector"]).html())||n.options[e+"Template"],n=l.extend(!0,{},n.options,t,{browsing:n.browsing,open_folder:h("Open folder"),current_directory:h("current directory:"),one_level_up:h("Go one level up")});return n._item=t,c.template(i)(n)},setAjax:function(){var e={url:this.options.vocabularyUrl,dataType:"JSON",quietMillis:500,data:function(e,t){var n=[];e&&(e="*"+e+"*",n.push({i:"SearchableText",o:"plone.app.querystring.operation.string.contains",v:e})),!this.browsing&&this.options.selectableTypes&&n.push({i:"portal_type",o:"plone.app.querystring.operation.selection.any",v:this.options.selectableTypes}),n.push({i:"path",o:this.options.pathOperator,v:this.options.rootPath+this.currentPath+(this.browsing?"::1":"")});var i=this.options.sortOn,e=i?this.options.sortOrder:null;return this.browsing&&null===i&&(i="getObjPositionInParent",e="ascending"),{query:JSON.stringify({criteria:n,sort_on:i,sort_order:e}),attributes:JSON.stringify(this.options.attributes),batch:JSON.stringify({page:t||1,size:this.options.pageSize})}}.bind(this),results:function(e,t){var n=t*this.options.pageSize<e.total,i=e.results;this.selectedUIDs=(this.$el.select2("data")||[]).map(function(e){return e.UID}),i=i.filter(function(e){return!!(this.browsing&&e.is_folderish||this.isSelectable(e)&&-1===this.selectedUIDs.indexOf(e.UID))}.bind(this));e=this.currentPath.split("/");return 1===t&&this.browsing&&1<e.length&&"/"!==this.currentPath&&(i=[{oneLevelUp:!0,Title:h("One level up"),path:e.slice(0,e.length-1).join("/")||"/",currentPath:this.currentPath,is_folderish:!0,selectable:!1}].concat(i)),{results:i,more:n}}.bind(this)};this.options.ajax=e},renderToolbar:function(){var o=this,e=o.currentPath.split("/"),n="",i="";c.each(e,function(e){var t;""!==e&&((t={}).path=n=n+"/"+e,t.text=e,i+=o.applyTemplate("breadcrumb",t))});var t="";c.each(o.options.favorites,function(e){e=c.clone(e);e.path=e.path.substr(o.options.rootPath.length)||"/",t+=o.applyTemplate("favorite",e)});var a,r="";function s(e,t){var n="upload-"+u.generateId(),i=new d({id:n,title:h("Upload"),tooltip:h("Upload files"),icon:"upload"});t&&i.disable(),l(".controls",o.$toolbar).prepend(i.render().el),o.uploadView=new e({triggerView:i,app:o}),l("#btn-"+n,o.$toolbar).append(o.uploadView.render().el)}o.options.recentlyUsed&&(a=o.recentlyUsed(!0),c.each(a.reverse(),function(e){r+=o.applyTemplate("recentlyused",e)})),a=o.applyTemplate("toolbar",{items:i,favItems:t,favText:h("Favorites"),searchText:h("Current path:"),searchModeText:h("Search"),browseModeText:h("Browse"),recentlyUsedItems:r,recentlyUsedText:h("Recently Used")}),o.$toolbar.html(a),l(".dropdown-toggle",o.$toolbar).dropdown(),l(".pattern-relateditems-dropdown").unbind("mouseup"),l(".pattern-relateditems-dropdown").bind("mouseup",function(e){e.stopPropagation()}),l("button.mode.search",o.$toolbar).on("click",function(e){e.preventDefault(),o.browsing?(l("button.mode.search",o.$toolbar).toggleClass("btn-primary btn-default"),l("button.mode.browse",o.$toolbar).toggleClass("btn-primary btn-default"),o.browsing=!1,0<o.$el.select2("data").length&&(o.openAfterInit=!0),o.openAfterInit||(o.$el.select2("close"),o.$el.select2("open"))):(o.$el.select2("close"),o.$el.select2("open"))}),l("button.mode.browse",o.$toolbar).on("click",function(e){e.preventDefault(),o.browsing?(o.$el.select2("close"),o.$el.select2("open")):(l("button.mode.search",o.$toolbar).toggleClass("btn-primary btn-default"),l("button.mode.browse",o.$toolbar).toggleClass("btn-primary btn-default"),o.browsing=!0,0<o.$el.select2("data").length&&(o.openAfterInit=!0),o.openAfterInit||(o.$el.select2("close"),o.$el.select2("open")))}),l("a.crumb",o.$toolbar).on("click",function(e){e.preventDefault(),o.browseTo(l(this).attr("href"))}),l("a.fav",o.$toolbar).on("click",function(e){e.preventDefault(),o.browseTo(l(this).attr("href"))}),o.options.recentlyUsed&&l(".pattern-relateditems-recentlyused-select",o.$toolbar).on("click",function(e){e.preventDefault();var t=l(this).data("uid"),e=o.recentlyUsed().filter(function(e){return e.UID===t});0<e.length&&(e=e[0],o.selectItem(e),0<o.options.maximumSelectionSize&&(o.$el.select2("data").length,o.options.maximumSelectionSize))}),o.options.upload&&u.featureSupport.dragAndDrop()&&u.featureSupport.fileApi()&&require(["mockup-patterns-relateditems-upload"],function(t){o.options.uploadAllowView?l.ajax({url:o.options.uploadAllowView,dataType:"JSON",data:{path:o.options.rootPath+o.currentPath},type:"GET",success:function(e){s(t,!e.allowUpload)}}):s(t)})},browseTo:function(e){var t=this;t.emit("before-browse"),t.currentPath=e,t.$el.select2("close"),t.renderToolbar(),t.$el.select2("open"),t.emit("after-browse")},selectItem:function(t){var e=this;e.emit("selecting");var n,i=e.$el.select2("data");i.push(t),e.$el.select2("data",i,!0),e.options.recentlyUsed&&(0<(i=(n=e.recentlyUsed()).filter(function(e){return e.UID===t.UID})).length&&n.splice(n.indexOf(i[0]),1),n.push(t),u.storage.set(e.options.recentlyUsedKey,n)),e.emit("selected")},deselectItem:function(n){this.emit("deselecting");var i=this.$el.select2("data");c.each(i,function(e,t){e.UID===n.UID&&i.splice(t,1)}),this.$el.select2("data",i,!0),this.emit("deselected")},isSelectable:function(e){return!1!==e.selectable&&(null===this.options.selectableTypes||-1!==this.options.selectableTypes.indexOf(e.portal_type))},init:function(){var o=this;o.browsing="search"!==o.options.mode,o.options.rootPath=o.options.rootPath.replace(/\/$/,""),o.currentPath=o.options.basePath.substr(o.options.rootPath.length)||"/",o.setAjax(),o.$el.wrap('<div class="pattern-relateditems-container" />'),o.$container=o.$el.parents(".pattern-relateditems-container"),o.$container.width(o.options.width),t.prototype.initializeValues.call(o),t.prototype.initializeTags.call(o),o.options.formatSelection=function(e){e=l.extend(!0,{Title:"",getIcon:"",getURL:"",path:"",portal_type:"",review_state:""},e);var t=l(o.applyTemplate("selection",e));return o.options.scanSelection&&n.scan(t),1==o.options.maximumSelectionSize&&(e=(e=e.path).split("/").slice(0,-1).join("/"),o.currentPath=e,o.renderToolbar()),t},t.prototype.initializeOrdering.call(o),o.options.formatResult=function(t){t.selectable=o.isSelectable(t),t=l.extend(!0,{Title:"",getIcon:"",getURL:"",is_folderish:!1,oneLevelUp:!1,path:"",portal_type:"",review_state:"",selectable:!1},t),-1!==o.selectedUIDs.indexOf(t.UID)&&(t.selectable=!1);var e=l(o.applyTemplate("result",t));return l(".pattern-relateditems-result-select",e).on("click",function(e){e.preventDefault(),l(this).is(".selectable")&&((e=l(this).parents(".pattern-relateditems-result")).is(".pattern-relateditems-active")?(e.removeClass("pattern-relateditems-active"),o.deselectItem(t)):(0<o.options.maximumSelectionSize&&o.$el.select2("data").length>=o.options.maximumSelectionSize&&o.$el.select2("close"),o.selectItem(t),e.addClass("pattern-relateditems-active"),o.options.closeOnSelect&&o.$el.select2("close")))}),l(".pattern-relateditems-result-browse",e).on("click",function(e){e.preventDefault(),e.stopPropagation();e=l(this).data("path");o.browseTo(e)}),l(e)},o.options.initSelection=function(e,n){var i,e=l(e).val();""!==e&&(i=e.split(o.options.separator),new u.QueryHelper(l.extend(!0,{},o.options,{pattern:o})).search("UID","plone.app.querystring.operation.list.contains",i,function(e){var t=e.results.reduce(function(e,t){return e[t.UID]=t,e},{});try{n(i.map(function(e){return t[e]}).filter(function(e){return void 0!==e}))}catch(e){}o.openAfterInit&&(o.$el.select2("open"),o.openAfterInit=void 0)},!1))},o.options.tokenizer=function(e){"auto"===this.options.mode&&(this.browsing=!e)}.bind(this),o.options.id=function(e){return e.UID},t.prototype.initializeSelect2.call(o),o.$toolbar=l('<div class="toolbar ui-offset-parent" />'),o.$container.prepend(o.$toolbar),o.$el.on("select2-selecting",function(e){o.isSelectable(e.choice)||e.preventDefault()}),o.renderToolbar(),l(document).on("keyup",o.$el,function(e){t.prototype.opened.call(o)&&(e.which!==f&&e.which!==m||(e.stopPropagation(),e=e.which===f?".pattern-relateditems-result.one-level-up":".select2-highlighted",1===(e=l(".pattern-relateditems-result-browse",e)).length&&(e=e.data("path"),o.browseTo(e))))})}})}),function(e){"function"==typeof define&&define.amd?define("picker",["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):"object"==typeof window?window.Picker=e(jQuery):this.Picker=e(jQuery)}(function(f){var i=f(window),m=f(document),o=f(document.documentElement),g=null!=document.documentElement.style.transition;function v(o,t,n,e){if(!o)return v;var i=!1,s={id:o.id||"P"+Math.abs(~~(Math.random()*new Date)),handlingOpen:!1},l=n?f.extend(!0,{},n.defaults,e):e||{},a=f.extend({},v.klasses(),l.klass),c=f(o),e=function(){return this.start()},d=e.prototype={constructor:e,$node:c,start:function(){return s&&s.start?d:(s.methods={},s.start=!0,s.open=!1,s.type=o.type,o.autofocus=o==k(),o.readOnly=!l.editable,o.id=o.id||s.id,"text"!=o.type&&(o.type="text"),d.component=new n(d,l),d.$root=f('<div class="'+a.picker+'" id="'+o.id+'_root" />'),w(d.$root[0],"hidden",!0),d.$holder=f(r()).appendTo(d.$root),u(),l.formatSubmit&&(!0===l.hiddenName?(e=o.name,o.name=""):e=(e=["string"==typeof l.hiddenPrefix?l.hiddenPrefix:"","string"==typeof l.hiddenSuffix?l.hiddenSuffix:"_submit"])[0]+o.name+e[1],d._hidden=f('<input type=hidden name="'+e+'"'+(c.data("value")||o.value?' value="'+d.get("select",l.formatSubmit)+'"':"")+">")[0],c.on("change."+s.id,function(){d._hidden.value=o.value?d.get("select",l.formatSubmit):""})),c.data(t,d).addClass(a.input).val(c.data("value")?d.get("select",l.format):o.value).on("focus."+s.id+" click."+s.id,function(e){e.preventDefault(),d.open()}).on("mousedown",function(){s.handlingOpen=!0;var e=function(){setTimeout(function(){f(document).off("mouseup",e),s.handlingOpen=!1},0)};f(document).on("mouseup",e)}),l.editable||c.on("keydown."+s.id,p),w(o,{haspopup:!0,expanded:!1,readonly:!1,owns:o.id+"_root"}),l.containerHidden?f(l.containerHidden).append(d._hidden):c.after(d._hidden),l.container?f(l.container).append(d.$root):c.after(d.$root),d.on({start:d.component.onStart,render:d.component.onRender,stop:d.component.onStop,open:d.component.onOpen,close:d.component.onClose,set:d.component.onSet}).on({start:l.onStart,render:l.onRender,stop:l.onStop,open:l.onOpen,close:l.onClose,set:l.onSet}),i=function(e){var t,n="position";e.currentStyle?t=e.currentStyle[n]:window.getComputedStyle&&(t=getComputedStyle(e)[n]);return"fixed"==t}(d.$holder[0]),o.autofocus&&d.open(),d.trigger("start").trigger("render"));var e},render:function(e){return e?(d.$holder=f(r()),u(),d.$root.html(d.$holder)):d.$root.find("."+a.box).html(d.component.nodes(s.open)),d.trigger("render")},stop:function(){return s.start&&(d.close(),d._hidden&&d._hidden.parentNode.removeChild(d._hidden),d.$root.remove(),c.removeClass(a.input).removeData(t),setTimeout(function(){c.off("."+s.id)},0),o.type=s.type,o.readOnly=!1,d.trigger("stop"),s.methods={},s.start=!1),d},open:function(e){return s.open?d:(c.addClass(a.active),w(o,"expanded",!0),setTimeout(function(){d.$root.addClass(a.opened),w(d.$root[0],"hidden",!1)},0),!1!==e&&(s.open=!0,i&&f("body").css("overflow","hidden").css("padding-right","+="+y()),i&&g?d.$holder.find("."+a.frame).one("transitionend",function(){d.$holder.eq(0).focus()}):setTimeout(function(){d.$holder.eq(0).focus()},0),m.on("click."+s.id+" focusin."+s.id,function(e){var t;s.handlingOpen||(t=b(e,o),e.isSimulated||t==o||t==document||3==e.which||d.close(t===d.$holder[0]))}).on("keydown."+s.id,function(e){var t=e.keyCode,n=d.component.key[t],i=b(e,o);27==t?d.close(!0):i!=d.$holder[0]||!n&&13!=t?f.contains(d.$root[0],i)&&13==t&&(e.preventDefault(),i.click()):(e.preventDefault(),n?v._.trigger(d.component.key.go,d,[v._.trigger(n)]):d.$root.find("."+a.highlighted).hasClass(a.disabled)||(d.set("select",d.component.item.highlight),l.closeOnSelect&&d.close(!0)))})),d.trigger("open"))},close:function(e){return e&&(l.editable?o.focus():(d.$holder.off("focus.toOpen").focus(),setTimeout(function(){d.$holder.on("focus.toOpen",h)},0))),c.removeClass(a.active),w(o,"expanded",!1),setTimeout(function(){d.$root.removeClass(a.opened+" "+a.focused),w(d.$root[0],"hidden",!0)},0),s.open?(s.open=!1,i&&f("body").css("overflow","").css("padding-right","-="+y()),m.off("."+s.id),d.trigger("close")):d},clear:function(e){return d.set("clear",null,e)},set:function(e,t,n){var i,o,a=f.isPlainObject(e),r=a?e:{};if(n=a&&f.isPlainObject(t)?t:n||{},e){for(i in a||(r[e]=t),r)o=r[i],i in d.component.item&&(void 0===o&&(o=null),d.component.set(i,o,n)),"select"!=i&&"clear"!=i||!l.updateInput||c.val("clear"==i?"":d.get(i,l.format)).trigger("change");d.render()}return n.muted?d:d.trigger("set",r)},get:function(e,t){if(null!=s[e=e||"value"])return s[e];if("valueSubmit"==e){if(d._hidden)return d._hidden.value;e="value"}if("value"==e)return o.value;if(e in d.component.item){if("string"!=typeof t)return d.component.get(e);e=d.component.get(e);return e?v._.trigger(d.component.formats.toString,d.component,[t,e]):""}},on:function(e,t,n){var i,o,a=f.isPlainObject(e),r=a?e:{};if(e)for(i in a||(r[e]=t),r)o=r[i],n&&(i="_"+i),s.methods[i]=s.methods[i]||[],s.methods[i].push(o);return d},off:function(){var e,t=arguments,n=0;for(namesCount=t.length;n<namesCount;n+=1)(e=t[n])in s.methods&&delete s.methods[e];return d},trigger:function(e,t){function n(e){(e=s.methods[e])&&e.map(function(e){v._.trigger(e,d,[t])})}return n("_"+e),n(e),d}};function r(){return v._.node("div",v._.node("div",v._.node("div",v._.node("div",d.component.nodes(s.open),a.box),a.wrap),a.frame),a.holder,'tabindex="-1"')}function u(){d.$holder.on({keydown:p,"focus.toOpen":h,blur:function(){c.removeClass(a.target)},focusin:function(e){d.$root.removeClass(a.focused),e.stopPropagation()},"mousedown click":function(e){var t=b(e,o);t!=d.$holder[0]&&(e.stopPropagation(),"mousedown"!=e.type||f(t).is("input, select, textarea, button, option")||(e.preventDefault(),d.$holder.eq(0).focus()))}}).on("click","[data-pick], [data-nav], [data-clear], [data-close]",function(){var e=f(this),t=e.data(),n=e.hasClass(a.navDisabled)||e.hasClass(a.disabled),e=(e=k())&&(e.type||e.href?e:null);(n||e&&!f.contains(d.$root[0],e))&&d.$holder.eq(0).focus(),!n&&t.nav?d.set("highlight",d.component.item.highlight,{nav:t.nav}):!n&&"pick"in t?(d.set("select",t.pick),l.closeOnSelect&&d.close(!0)):t.clear?(d.clear(),l.closeOnClear&&d.close(!0)):t.close&&d.close(!0)})}function h(e){e.stopPropagation(),c.addClass(a.target),d.$root.addClass(a.focused),d.open()}function p(e){var t=e.keyCode,n=/^(8|46)$/.test(t);if(27==t)return d.close(!0),!1;(32==t||n||!s.open&&d.component.key[t])&&(e.preventDefault(),e.stopPropagation(),n?d.clear().close():d.open())}return new e}function y(){if(o.height()<=i.height())return 0;var e=f('<div style="visibility:hidden;width:100px" />').appendTo("body"),t=e[0].offsetWidth;e.css("overflow","scroll");var n=f('<div style="width:100%" />').appendTo(e)[0].offsetWidth;return e.remove(),t-n}function b(e,t){var n=[];return e.path&&(n=e.path),e.originalEvent&&e.originalEvent.path&&(n=e.originalEvent.path),n&&0<n.length?t&&0<=n.indexOf(t)?t:n[0]:e.target}function w(e,t,n){if(f.isPlainObject(t))for(var i in t)a(e,i,t[i]);else a(e,t,n)}function a(e,t,n){e.setAttribute(("role"==t?"":"aria-")+t,n)}function k(){try{return document.activeElement}catch(e){}}return v.klasses=function(e){return{picker:e=e||"picker",opened:e+"--opened",focused:e+"--focused",input:e+"__input",active:e+"__input--active",target:e+"__input--target",holder:e+"__holder",frame:e+"__frame",wrap:e+"__wrap",box:e+"__box"}},v._={group:function(e){for(var t,n="",i=v._.trigger(e.min,e);i<=v._.trigger(e.max,e,[i]);i+=e.i)t=v._.trigger(e.item,e,[i]),n+=v._.node(e.node,t[0],t[1],t[2]);return n},node:function(e,t,n,i){return t?"<"+e+(n=n?' class="'+n+'"':"")+(i=i?" "+i:"")+">"+(t=f.isArray(t)?t.join(""):t)+"</"+e+">":""},lead:function(e){return(e<10?"0":"")+e},trigger:function(e,t,n){return"function"==typeof e?e.apply(t,n||[]):e},digits:function(e){return/\d/.test(e[1])?2:1},isDate:function(e){return-1<{}.toString.call(e).indexOf("Date")&&this.isInteger(e.getDate())},isInteger:function(e){return-1<{}.toString.call(e).indexOf("Number")&&e%1==0},ariaAttr:function(e,t){f.isPlainObject(e)||(e={attribute:t});for(var n in t="",e){var i=("role"==n?"":"aria-")+n,o=e[n];t+=null==o?"":i+'="'+e[n]+'"'}return t}},v.extend=function(i,o){f.fn[i]=function(e,t){var n=this.data(i);return"picker"==e?n:n&&"string"==typeof e?v._.trigger(n[e],n,[t]):this.each(function(){f(this).data(i)||new v(this,i,o,e)})},f.fn[i].defaults=o.defaults},v}),function(e){"function"==typeof define&&define.amd?define("picker.date",["./picker","jquery"],e):"object"==typeof exports?module.exports=e(require("./picker.js"),require("jquery")):e(Picker,jQuery)}(function(e,f){var t,g=e._;function n(t,n){function e(){return o.currentStyle?"rtl"==o.currentStyle.direction:"rtl"==getComputedStyle(t.$root[0]).direction}var i=this,o=t.$node[0],a=o.value,r=t.$node.data("value"),s=r||a,a=r?n.formatSubmit:n.format;i.settings=n,i.$node=t.$node,i.queue={min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse navigate create validate",view:"parse create validate viewset",disable:"deactivate",enable:"activate"},i.item={},i.item.clear=null,i.item.disable=(n.disable||[]).slice(0),i.item.enable=-(!0===(r=i.item.disable)[0]?r.shift():-1),i.set("min",n.min).set("max",n.max).set("now"),s?i.set("select",s,{format:a,defaultValue:!0}):i.set("select",null).set("highlight",i.item.now),i.key={40:7,38:-7,39:function(){return e()?-1:1},37:function(){return e()?1:-1},go:function(e){var t=i.item.highlight,t=new Date(t.year,t.month,t.date+e);i.set("highlight",t,{interval:e}),this.render()}},t.on("render",function(){t.$root.find("."+n.klass.selectMonth).on("change",function(){var e=this.value;e&&(t.set("highlight",[t.get("view").year,e,t.get("highlight").date]),t.$root.find("."+n.klass.selectMonth).trigger("focus"))}),t.$root.find("."+n.klass.selectYear).on("change",function(){var e=this.value;e&&(t.set("highlight",[e,t.get("view").month,t.get("highlight").date]),t.$root.find("."+n.klass.selectYear).trigger("focus"))})},1).on("open",function(){var e="";i.disabled(i.get("now"))&&(e=":not(."+n.klass.buttonToday+")"),t.$root.find("button"+e+", select").attr("disabled",!1)},1).on("close",function(){t.$root.find("button, select").attr("disabled",!0)},1)}function i(e,t,n){e=e.match(/[^\x00-\x7F]+|\w+/)[0];return n.mm||n.m||(n.m=t.indexOf(e)+1),e.length}function o(e){return e.match(/\w+/)[0].length}n.prototype.set=function(t,n,i){var o=this,e=o.item;return null===n?("clear"==t&&(t="select"),e[t]=n):(e["enable"==t?"disable":"flip"==t?"enable":t]=o.queue[t].split(" ").map(function(e){return n=o[e](t,n,i)}).pop(),"select"==t?o.set("highlight",e.select,i):"highlight"==t?o.set("view",e.highlight,i):t.match(/^(flip|min|max|disable|enable)$/)&&(e.select&&o.disabled(e.select)&&o.set("select",e.select,i),e.highlight&&o.disabled(e.highlight)&&o.set("highlight",e.highlight,i))),o},n.prototype.get=function(e){return this.item[e]},n.prototype.create=function(e,t,n){var i;return(t=void 0===t?e:t)==-1/0||t==1/0?i=t:t=f.isPlainObject(t)&&g.isInteger(t.pick)?t.obj:f.isArray(t)?(t=new Date(t[0],t[1],t[2]),g.isDate(t)?t:this.create().obj):g.isInteger(t)||g.isDate(t)?this.normalize(new Date(t),n):this.now(e,t,n),{year:i||t.getFullYear(),month:i||t.getMonth(),date:i||t.getDate(),day:i||t.getDay(),obj:i||t,pick:i||t.getTime()}},n.prototype.createRange=function(e,t){function n(e){return!0===e||f.isArray(e)||g.isDate(e)?i.create(e):e}var i=this;return g.isInteger(e)||(e=n(e)),g.isInteger(t)||(t=n(t)),g.isInteger(e)&&f.isPlainObject(t)?e=[t.year,t.month,t.date+e]:g.isInteger(t)&&f.isPlainObject(e)&&(t=[e.year,e.month,e.date+t]),{from:n(e),to:n(t)}},n.prototype.withinRange=function(e,t){return e=this.createRange(e.from,e.to),t.pick>=e.from.pick&&t.pick<=e.to.pick},n.prototype.overlapRanges=function(e,t){var n=this;return e=n.createRange(e.from,e.to),t=n.createRange(t.from,t.to),n.withinRange(e,t.from)||n.withinRange(e,t.to)||n.withinRange(t,e.from)||n.withinRange(t,e.to)},n.prototype.now=function(e,t,n){return t=new Date,n&&n.rel&&t.setDate(t.getDate()+n.rel),this.normalize(t,n)},n.prototype.navigate=function(e,t,n){var i,o,a,r=f.isArray(t),s=f.isPlainObject(t),l=this.item.view;if(r||s){for(a=s?(i=t.year,o=t.month,t.date):(i=+t[0],o=+t[1],+t[2]),n&&n.nav&&l&&l.month!==o&&(i=l.year,o=l.month),i=(n=new Date(i,o+(n&&n.nav?n.nav:0),1)).getFullYear(),o=n.getMonth();new Date(i,o,a).getMonth()!==o;)--a;t=[i,o,a]}return t},n.prototype.normalize=function(e){return e.setHours(0,0,0,0),e},n.prototype.measure=function(e,t){return g.isInteger(t)?t=this.now(e,t,{rel:t}):t?"string"==typeof t&&(t=this.parse(e,t)):t="min"==e?-1/0:1/0,t},n.prototype.viewset=function(e,t){return this.create([t.year,t.month,1])},n.prototype.validate=function(e,n,t){var i,o,a,r,s=this,l=n,c=t&&t.interval?t.interval:1,d=-1===s.item.enable,u=s.item.min,h=s.item.max,p=d&&s.item.disable.filter(function(e){var t;return f.isArray(e)&&((t=s.create(e).pick)<n.pick?i=!0:t>n.pick&&(o=!0)),g.isInteger(e)}).length;if((!t||!t.nav&&!t.defaultValue)&&(!d&&s.disabled(n)||d&&s.disabled(n)&&(p||i||o)||!d&&(n.pick<=u.pick||n.pick>=h.pick)))for(d&&!p&&(!o&&0<c||!i&&c<0)&&(c*=-1);s.disabled(n)&&(1<Math.abs(c)&&(n.month<l.month||n.month>l.month)&&(n=l,c=0<c?1:-1),n.pick<=u.pick?(a=!0,c=1,n=s.create([u.year,u.month,u.date+(n.pick===u.pick?0:-1)])):n.pick>=h.pick&&(r=!0,c=-1,n=s.create([h.year,h.month,h.date+(n.pick===h.pick?0:1)])),!a||!r);)n=s.create([n.year,n.month,n.date+c]);return n},n.prototype.disabled=function(t){var n=this,e=(e=n.item.disable.filter(function(e){return g.isInteger(e)?t.day===(n.settings.firstDay?e:e-1)%7:f.isArray(e)||g.isDate(e)?t.pick===n.create(e).pick:f.isPlainObject(e)?n.withinRange(e,t):void 0})).length&&!e.filter(function(e){return f.isArray(e)&&"inverted"==e[3]||f.isPlainObject(e)&&e.inverted}).length;return-1===n.item.enable?!e:e||t.pick<n.item.min.pick||t.pick>n.item.max.pick},n.prototype.parse=function(e,i,t){var o=this,a={};return i&&"string"==typeof i?(t&&t.format||((t=t||{}).format=o.settings.format),o.formats.toArray(t.format).map(function(e){var t=o.formats[e],n=t?g.trigger(t,o,[i,a]):e.replace(/^!/,"").length;t&&(a[e]=i.substr(0,n)),i=i.substr(n)}),[a.yyyy||a.yy,+(a.mm||a.m)-1,a.dd||a.d]):i},n.prototype.formats={d:function(e,t){return e?g.digits(e):t.date},dd:function(e,t){return e?2:g.lead(t.date)},ddd:function(e,t){return e?o(e):this.settings.weekdaysShort[t.day]},dddd:function(e,t){return e?o(e):this.settings.weekdaysFull[t.day]},m:function(e,t){return e?g.digits(e):t.month+1},mm:function(e,t){return e?2:g.lead(t.month+1)},mmm:function(e,t){var n=this.settings.monthsShort;return e?i(e,n,t):n[t.month]},mmmm:function(e,t){var n=this.settings.monthsFull;return e?i(e,n,t):n[t.month]},yy:function(e,t){return e?2:(""+t.year).slice(2)},yyyy:function(e,t){return e?4:t.year},toArray:function(e){return e.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},toString:function(e,t){var n=this;return n.formats.toArray(e).map(function(e){return g.trigger(n.formats[e],n,[0,t])||e.replace(/^!/,"")}).join("")}},n.prototype.isDateExact=function(e,t){return g.isInteger(e)&&g.isInteger(t)||"boolean"==typeof e&&"boolean"==typeof t?e===t:(g.isDate(e)||f.isArray(e))&&(g.isDate(t)||f.isArray(t))?this.create(e).pick===this.create(t).pick:!(!f.isPlainObject(e)||!f.isPlainObject(t))&&(this.isDateExact(e.from,t.from)&&this.isDateExact(e.to,t.to))},n.prototype.isDateOverlap=function(e,t){var n=this.settings.firstDay?1:0;return g.isInteger(e)&&(g.isDate(t)||f.isArray(t))?(e=e%7+n)===this.create(t).day+1:g.isInteger(t)&&(g.isDate(e)||f.isArray(e))?(t=t%7+n)===this.create(e).day+1:!(!f.isPlainObject(e)||!f.isPlainObject(t))&&this.overlapRanges(e,t)},n.prototype.flipEnable=function(e){var t=this.item;t.enable=e||(-1==t.enable?1:-1)},n.prototype.deactivate=function(e,t){var i=this,o=i.item.disable.slice(0);return"flip"==t?i.flipEnable():!1===t?(i.flipEnable(1),o=[]):!0===t?(i.flipEnable(-1),o=[]):t.map(function(e){for(var t,n=0;n<o.length;n+=1)if(i.isDateExact(e,o[n])){t=!0;break}t||(g.isInteger(e)||g.isDate(e)||f.isArray(e)||f.isPlainObject(e)&&e.from&&e.to)&&o.push(e)}),o},n.prototype.activate=function(e,t){var a=this,r=a.item.disable,s=r.length;return"flip"==t?a.flipEnable():!0===t?(a.flipEnable(1),r=[]):!1===t?(a.flipEnable(-1),r=[]):t.map(function(e){for(var t,n,i,o=0;o<s;o+=1){if(n=r[o],a.isDateExact(n,e)){i=!(t=r[o]=null);break}if(a.isDateOverlap(n,e)){f.isPlainObject(e)?(e.inverted=!0,t=e):f.isArray(e)?(t=e)[3]||t.push("inverted"):g.isDate(e)&&(t=[e.getFullYear(),e.getMonth(),e.getDate(),"inverted"]);break}}if(t)for(o=0;o<s;o+=1)if(a.isDateExact(r[o],e)){r[o]=null;break}if(i)for(o=0;o<s;o+=1)if(a.isDateOverlap(r[o],e)){r[o]=null;break}t&&r.push(t)}),r.filter(function(e){return null!=e})},n.prototype.nodes=function(r){function e(e){return g.node("div"," ",l.klass["nav"+(e?"Next":"Prev")]+(e&&h.year>=m.year&&h.month>=m.month||!e&&h.year<=f.year&&h.month<=f.month?" "+l.klass.navDisabled:""),"data-nav="+(e||-1)+" "+g.ariaAttr({role:"button",controls:s.$node[0].id+"_table"})+' title="'+(e?l.labelMonthNext:l.labelMonthPrev)+'"')}function t(){var t=l.showMonthsShort?l.monthsShort:l.monthsFull;return l.selectMonths?g.node("select",g.group({min:0,max:11,i:1,node:"option",item:function(e){return[t[e],0,"value="+e+(h.month==e?" selected":"")+(h.year==f.year&&e<f.month||h.year==m.year&&e>m.month?" disabled":"")]}}),l.klass.selectMonth,(r?"":"disabled")+" "+g.ariaAttr({controls:s.$node[0].id+"_table"})+' title="'+l.labelMonthSelect+'"'):g.node("div",t[h.month],l.klass.month)}var n,i,s=this,l=s.settings,o=s.item,c=o.now,d=o.select,u=o.highlight,h=o.view,p=o.disable,f=o.min,m=o.max,a=(n=(l.showWeekdaysFull?l.weekdaysFull:l.weekdaysShort).slice(0),i=l.weekdaysFull.slice(0),l.firstDay&&(n.push(n.shift()),i.push(i.shift())),g.node("thead",g.node("tr",g.group({min:0,max:6,i:1,node:"th",item:function(e){return[n[e],l.klass.weekdays,'scope=col title="'+i[e]+'"']}})))),o=function(){var t=h.year,e=!0===l.selectYears?5:~~(l.selectYears/2);if(e){var n=f.year,i=m.year,o=t-e,a=t+e;return o<n&&(a+=n-o,o=n),i<a&&(o-=(e=a-i)<(n=o-n)?e:n,a=i),g.node("select",g.group({min:o,max:a,i:1,node:"option",item:function(e){return[e,0,"value="+e+(t==e?" selected":"")]}}),l.klass.selectYear,(r?"":"disabled")+" "+g.ariaAttr({controls:s.$node[0].id+"_table"})+' title="'+l.labelYearSelect+'"')}return g.node("div",t,l.klass.year)};return g.node("div",(l.selectYears?o()+t():t()+o())+e()+e(1),l.klass.header)+g.node("table",a+g.node("tbody",g.group({min:0,max:5,i:1,node:"tr",item:function(e){var t=l.firstDay&&0===s.create([h.year,h.month,1]).day?-7:0;return[g.group({min:7*e-h.day+t+1,max:function(){return this.min+7-1},i:1,node:"td",item:function(e){e=s.create([h.year,h.month,e+(l.firstDay?1:0)]);var t,n=d&&d.pick==e.pick,i=u&&u.pick==e.pick,o=p&&s.disabled(e)||e.pick<f.pick||e.pick>m.pick,a=g.trigger(s.formats.toString,s,[l.format,e]);return[g.node("div",e.date,((t=[l.klass.day]).push(h.month==e.month?l.klass.infocus:l.klass.outfocus),c.pick==e.pick&&t.push(l.klass.now),n&&t.push(l.klass.selected),i&&t.push(l.klass.highlighted),o&&t.push(l.klass.disabled),t.join(" ")),"data-pick="+e.pick+" "+g.ariaAttr({role:"gridcell",label:a,selected:!(!n||s.$node.val()!==a)||null,activedescendant:!!i||null,disabled:!!o||null})),"",g.ariaAttr({role:"presentation"})]}})]}})),l.klass.table,'id="'+s.$node[0].id+'_table" '+g.ariaAttr({role:"grid",controls:s.$node[0].id,readonly:!0}))+g.node("div",g.node("button",l.today,l.klass.buttonToday,"type=button data-pick="+c.pick+(r&&!s.disabled(c)?"":" disabled")+" "+g.ariaAttr({controls:s.$node[0].id}))+g.node("button",l.clear,l.klass.buttonClear,"type=button data-clear=1"+(r?"":" disabled")+" "+g.ariaAttr({controls:s.$node[0].id}))+g.node("button",l.close,l.klass.buttonClose,"type=button data-close=true "+(r?"":" disabled")+" "+g.ariaAttr({controls:s.$node[0].id})),l.klass.footer)},n.defaults={labelMonthNext:"Next month",labelMonthPrev:"Previous month",labelMonthSelect:"Select a month",labelYearSelect:"Select a year",monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],today:"Today",clear:"Clear",close:"Close",closeOnSelect:!0,closeOnClear:!0,updateInput:!0,format:"d mmmm, yyyy",klass:{table:(t=e.klasses().picker+"__")+"table",header:t+"header",navPrev:t+"nav--prev",navNext:t+"nav--next",navDisabled:t+"nav--disabled",month:t+"month",year:t+"year",selectMonth:t+"select--month",selectYear:t+"select--year",weekdays:t+"weekday",day:t+"day",disabled:t+"day--disabled",selected:t+"day--selected",highlighted:t+"day--highlighted",now:t+"day--today",infocus:t+"day--infocus",outfocus:t+"day--outfocus",footer:t+"footer",buttonClear:t+"button--clear",buttonToday:t+"button--today",buttonClose:t+"button--close"}},e.extend("pickadate",n)}),function(e){"function"==typeof define&&define.amd?define("picker.time",["./picker","jquery"],e):"object"==typeof exports?module.exports=e(require("./picker.js"),require("jquery")):e(Picker,jQuery)}(function(e,l){var t,o=1440,p=e._;function n(o,a){var t=this,e=o.$node[0].value,n=o.$node.data("value"),i=n||e,e=n?a.formatSubmit:a.format;t.settings=a,t.$node=o.$node,t.queue={interval:"i",min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse create validate",view:"parse create validate",disable:"deactivate",enable:"activate"},t.item={},t.item.clear=null,t.item.interval=a.interval||30,t.item.disable=(a.disable||[]).slice(0),t.item.enable=-(!0===(n=t.item.disable)[0]?n.shift():-1),t.set("min",a.min).set("max",a.max).set("now"),i?t.set("select",i,{format:e}):t.set("select",null).set("highlight",t.item.now),t.key={40:1,38:-1,39:1,37:-1,go:function(e){t.set("highlight",t.item.highlight.pick+e*t.item.interval,{interval:e*t.item.interval}),this.render()}},o.on("render",function(){function e(t){return["webkit","moz","ms","o",""].map(function(e){return(e?"-"+e+"-":"")+t})}function t(t,n){e("transform").map(function(e){t.css(e,n)}),e("transition").map(function(e){t.css(e,n)})}var n=o.$root.children(),i=n.find("."+a.klass.viewset);i.length&&(t(n,"none"),n[0].scrollTop=~~i.position().top-2*i[0].clientHeight,t(n,""))},1).on("open",function(){o.$root.find("button").attr("disabled",!1)},1).on("close",function(){o.$root.find("button").attr("disabled",!0)},1)}n.prototype.set=function(t,n,i){var o=this,e=o.item;return null===n?("clear"==t&&(t="select"),e[t]=n):(e["enable"==t?"disable":"flip"==t?"enable":t]=o.queue[t].split(" ").map(function(e){return n=o[e](t,n,i)}).pop(),"select"==t?o.set("highlight",e.select,i):"highlight"==t?o.set("view",e.highlight,i):"interval"==t?o.set("min",e.min,i).set("max",e.max,i):t.match(/^(flip|min|max|disable|enable)$/)&&(e.select&&o.disabled(e.select)&&o.set("select",n,i),e.highlight&&o.disabled(e.highlight)&&o.set("highlight",n,i),"min"==t&&o.set("max",e.max,i))),o},n.prototype.get=function(e){return this.item[e]},n.prototype.create=function(e,t,n){var i=this;return t=void 0===t?e:t,p.isDate(t)&&(t=[t.getHours(),t.getMinutes()]),l.isPlainObject(t)&&p.isInteger(t.pick)?t=t.pick:l.isArray(t)?t=60*+t[0]+ +t[1]:p.isInteger(t)||(t=i.now(e,t,n)),"max"==e&&t<i.item.min.pick&&(t+=o),"min"!=e&&"max"!=e&&(t-i.item.min.pick)%i.item.interval!=0&&(t+=i.item.interval),{hour:~~(24+(t=i.normalize(e,t,n))/60)%24,mins:(60+t%60)%60,time:(o+t)%o,pick:t%o}},n.prototype.createRange=function(e,t){function n(e){return!0===e||l.isArray(e)||p.isDate(e)?i.create(e):e}var i=this;return p.isInteger(e)||(e=n(e)),p.isInteger(t)||(t=n(t)),p.isInteger(e)&&l.isPlainObject(t)?e=[t.hour,t.mins+e*i.settings.interval]:p.isInteger(t)&&l.isPlainObject(e)&&(t=[e.hour,e.mins+t*i.settings.interval]),{from:n(e),to:n(t)}},n.prototype.withinRange=function(e,t){return e=this.createRange(e.from,e.to),t.pick>=e.from.pick&&t.pick<=e.to.pick},n.prototype.overlapRanges=function(e,t){var n=this;return e=n.createRange(e.from,e.to),t=n.createRange(t.from,t.to),n.withinRange(e,t.from)||n.withinRange(e,t.to)||n.withinRange(t,e.from)||n.withinRange(t,e.to)},n.prototype.now=function(e,t){var n=this.item.interval,i=new Date,o=60*i.getHours()+i.getMinutes();return o-=o%n,i=t<0&&n*t+o<=-n,o+="min"==e&&i?0:n,p.isInteger(t)&&(o+=n*(i&&"max"!=e?t+1:t)),o},n.prototype.normalize=function(e,t){var n=this.item.interval,i=this.item.min&&this.item.min.pick||0;return t-="min"==e?0:(t-i)%n},n.prototype.measure=function(e,t,n){return"string"==typeof(t=t||("min"==e?[0,0]:[23,59]))?t=this.parse(e,t):!0===t||p.isInteger(t)?t=this.now(e,t,n):l.isPlainObject(t)&&p.isInteger(t.pick)&&(t=this.normalize(e,t.pick,n)),t},n.prototype.validate=function(e,t,n){var i=this,n=(n&&n.interval?n:i.item).interval;return i.disabled(t)&&(t=i.shift(t,n)),t=i.scope(t),i.disabled(t)&&(t=i.shift(t,-1*n)),t},n.prototype.disabled=function(t){var n=this,e=(e=n.item.disable.filter(function(e){return p.isInteger(e)?t.hour==e:l.isArray(e)||p.isDate(e)?t.pick==n.create(e).pick:l.isPlainObject(e)?n.withinRange(e,t):void 0})).length&&!e.filter(function(e){return l.isArray(e)&&"inverted"==e[2]||l.isPlainObject(e)&&e.inverted}).length;return-1===n.item.enable?!e:e||t.pick<n.item.min.pick||t.pick>n.item.max.pick},n.prototype.shift=function(e,t){var n=this,i=n.item.min.pick,o=n.item.max.pick;for(t=t||n.item.interval;n.disabled(e)&&!((e=n.create(e.pick+=t)).pick<=i||e.pick>=o););return e},n.prototype.scope=function(e){var t=this.item.min.pick,n=this.item.max.pick;return this.create(e.pick>n?n:e.pick<t?t:e)},n.prototype.parse=function(e,i,t){var n,o,a,r,s,l=this,c={};if(!i||"string"!=typeof i)return i;for(r in t&&t.format||((t=t||{}).format=l.settings.format),l.formats.toArray(t.format).map(function(e){var t=l.formats[e],n=t?p.trigger(t,l,[i,c]):e.replace(/^!/,"").length;t&&(t=i.substr(0,n),c[e]=t.match(/^\d+$/)?+t:t),i=i.substr(n)}),c)s=c[r],p.isInteger(s)?r.match(/^(h|hh)$/i)?(n=s,"h"!=r&&"hh"!=r||(n%=12)):"i"==r&&(o=s):r.match(/^a$/i)&&s.match(/^p/i)&&("h"in c||"hh"in c)&&(a=!0);return 60*(a?n+12:n)+o},n.prototype.formats={h:function(e,t){return e?p.digits(e):t.hour%12||12},hh:function(e,t){return e?2:p.lead(t.hour%12||12)},H:function(e,t){return e?p.digits(e):""+t.hour%24},HH:function(e,t){return e?p.digits(e):p.lead(t.hour%24)},i:function(e,t){return e?2:p.lead(t.mins)},a:function(e,t){return e?4:t.time%o<720?"a.m.":"p.m."},A:function(e,t){return e?2:t.time%o<720?"AM":"PM"},toArray:function(e){return e.split(/(h{1,2}|H{1,2}|i|a|A|!.)/g)},toString:function(e,t){var n=this;return n.formats.toArray(e).map(function(e){return p.trigger(n.formats[e],n,[0,t])||e.replace(/^!/,"")}).join("")}},n.prototype.isTimeExact=function(e,t){return p.isInteger(e)&&p.isInteger(t)||"boolean"==typeof e&&"boolean"==typeof t?e===t:(p.isDate(e)||l.isArray(e))&&(p.isDate(t)||l.isArray(t))?this.create(e).pick===this.create(t).pick:!(!l.isPlainObject(e)||!l.isPlainObject(t))&&(this.isTimeExact(e.from,t.from)&&this.isTimeExact(e.to,t.to))},n.prototype.isTimeOverlap=function(e,t){return p.isInteger(e)&&(p.isDate(t)||l.isArray(t))?e===this.create(t).hour:p.isInteger(t)&&(p.isDate(e)||l.isArray(e))?t===this.create(e).hour:!(!l.isPlainObject(e)||!l.isPlainObject(t))&&this.overlapRanges(e,t)},n.prototype.flipEnable=function(e){var t=this.item;t.enable=e||(-1==t.enable?1:-1)},n.prototype.deactivate=function(e,t){var i=this,o=i.item.disable.slice(0);return"flip"==t?i.flipEnable():!1===t?(i.flipEnable(1),o=[]):!0===t?(i.flipEnable(-1),o=[]):t.map(function(e){for(var t,n=0;n<o.length;n+=1)if(i.isTimeExact(e,o[n])){t=!0;break}t||(p.isInteger(e)||p.isDate(e)||l.isArray(e)||l.isPlainObject(e)&&e.from&&e.to)&&o.push(e)}),o},n.prototype.activate=function(e,t){var a=this,r=a.item.disable,s=r.length;return"flip"==t?a.flipEnable():!0===t?(a.flipEnable(1),r=[]):!1===t?(a.flipEnable(-1),r=[]):t.map(function(e){for(var t,n,i,o=0;o<s;o+=1){if(n=r[o],a.isTimeExact(n,e)){i=!(t=r[o]=null);break}if(a.isTimeOverlap(n,e)){l.isPlainObject(e)?(e.inverted=!0,t=e):l.isArray(e)?(t=e)[2]||t.push("inverted"):p.isDate(e)&&(t=[e.getFullYear(),e.getMonth(),e.getDate(),"inverted"]);break}}if(t)for(o=0;o<s;o+=1)if(a.isTimeExact(r[o],e)){r[o]=null;break}if(i)for(o=0;o<s;o+=1)if(a.isTimeOverlap(r[o],e)){r[o]=null;break}t&&r.push(t)}),r.filter(function(e){return null!=e})},n.prototype.i=function(e,t){return p.isInteger(t)&&0<t?t:this.item.interval},n.prototype.nodes=function(e){var s=this,l=s.settings,c=s.item.select,d=s.item.highlight,u=s.item.view,h=s.item.disable;return p.node("ul",p.group({min:s.item.min.pick,max:s.item.max.pick,i:s.item.interval,node:"li",item:function(e){var t,n=(e=s.create(e)).pick,i=c&&c.pick==n,o=d&&d.pick==n,a=h&&s.disabled(e),r=p.trigger(s.formats.toString,s,[l.format,e]);return[p.trigger(s.formats.toString,s,[p.trigger(l.formatLabel,s,[e])||l.format,e]),(t=[l.klass.listItem],i&&t.push(l.klass.selected),o&&t.push(l.klass.highlighted),u&&u.pick==n&&t.push(l.klass.viewset),a&&t.push(l.klass.disabled),t.join(" ")),"data-pick="+e.pick+" "+p.ariaAttr({role:"option",label:r,selected:!(!i||s.$node.val()!==r)||null,activedescendant:!!o||null,disabled:!!a||null})]}})+p.node("li",p.node("button",l.clear,l.klass.buttonClear,"type=button data-clear=1"+(e?"":" disabled")+" "+p.ariaAttr({controls:s.$node[0].id})),"",p.ariaAttr({role:"presentation"})),l.klass.list,p.ariaAttr({role:"listbox",controls:s.$node[0].id}))},n.defaults={clear:"Clear",format:"h:i A",interval:30,closeOnSelect:!0,closeOnClear:!0,updateInput:!0,klass:{picker:(t=e.klasses().picker)+" "+t+"--time",holder:t+"__holder",list:t+"__list",listItem:t+"__list-item",disabled:t+"__list-item--disabled",selected:t+"__list-item--selected",highlighted:t+"__list-item--highlighted",viewset:t+"__list-item--viewset",now:t+"__list-item--now",buttonClear:t+"__button--clear"}},e.extend("pickatime",n)}),define("mockup-patterns-pickadate",["jquery","pat-base","mockup-utils","translate","picker","picker.date","picker.time","mockup-patterns-select2"],function(a,e,r,t){"use strict";return e.extend({name:"pickadate",trigger:".pat-pickadate",parser:"mockup",defaults:{separator:" ",date:{selectYears:!0,selectMonths:!0,formatSubmit:"yyyy-mm-dd",format:"yyyy-mm-dd",labelMonthNext:t("Next month"),labelMonthPrev:t("Previous month"),labelMonthSelect:t("Select a month"),labelYearSelect:t("Select a year"),clear:!1,close:!1,today:!1},time:{clear:!1},today:t("Today"),clear:t("Clear"),timezone:null,autoSetTimeOnDateChange:"+[0,0]",classWrapperName:"pattern-pickadate-wrapper",classSeparatorName:"pattern-pickadate-separator",classDateName:"pattern-pickadate-date",classDateWrapperName:"pattern-pickadate-date-wrapper",classTimeName:"pattern-pickadate-time",classTimeWrapperName:"pattern-pickadate-time-wrapper",classTimezoneName:"pattern-pickadate-timezone",classTimezoneWrapperName:"pattern-pickadate-timezone-wrapper",classClearName:"pattern-pickadate-clear",classNowName:"pattern-pickadate-now",placeholderDate:t("Enter date..."),placeholderTime:t("Enter time..."),placeholderTimezone:t("Enter timezone...")},parseTimeOffset:function(t){var e=void 0;0===t.indexOf("+")?(e="+",t=t.split("+")[1]):0===t.indexOf("-")&&(e="-",t=t.split("-")[1]);try{t=JSON.parse(t)}catch(e){t=void 0}if(!1===t)return!1;if(!0===t||!0!==Array.isArray(t))return[0,0];var n,i,o=parseInt(t[0],10)||0,a=parseInt(t[1],10)||0;return"+"!==e&&"-"!==e||(n=(i=new Date).getHours(),i=i.getMinutes(),"+"===e?(23<(o=n+o)&&(o=23),59<(a=i+a)&&(a=59)):"-"===e&&((o=n-o)<0&&(o=0),(a=i-a)<0&&(a=0))),[o,a]},init:function(){var t,n=this,e=n.$el.val().split(" "),i=e[0]||"",o=e[1]||"";!1===r.bool(n.options.date)&&(n.options.date=!1),!1===r.bool(n.options.time)&&(n.options.time=!1),n.options.autoSetTimeOnDateChange=n.parseTimeOffset(n.options.autoSetTimeOnDateChange),!1===n.options.date&&(o=e[0]),n.$el.hide(),n.$wrapper=a("<div/>").addClass(n.options.classWrapperName).insertAfter(n.$el),!1!==n.options.date&&(n.$date=a('<input type="text"/>').attr("placeholder",n.options.placeholderDate).attr("data-value",i).addClass(n.options.classDateName).appendTo(a("<div/>").addClass(n.options.classDateWrapperName).appendTo(n.$wrapper)).pickadate(a.extend(!0,{},n.options.date,{onSet:function(e){void 0!==e.select&&(n.$date.attr("data-value",e.select),!1!==n.options.autoSetTimeOnDateChange&&n.$time&&(n.$time.pickatime("picker").get("select")||n.$time.pickatime("picker").set("select",n.options.autoSetTimeOnDateChange)),!1!==n.options.time&&""===n.$time.attr("data-value")||n.updateValue.call(n)),e.hasOwnProperty("clear")&&(n.$el.val(""),n.$date.attr("data-value",""))}}))),!1!==n.options.time&&(n.options.time.formatSubmit="HH:i",n.$time=a('<input type="text"/>').attr("placeholder",n.options.placeholderTime).attr("data-value",o).addClass(n.options.classTimeName).appendTo(a("<div/>").addClass(n.options.classTimeWrapperName).appendTo(n.$wrapper)).pickatime(a.extend(!0,{},n.options.time,{onSet:function(e){void 0!==e.select&&(n.$time.attr("data-value",e.select),!1!==n.options.date&&""===n.$date.attr("data-value")||n.updateValue.call(n)),e.hasOwnProperty("clear")&&(n.$el.val(""),n.$time.attr("data-value",""))}})),"string"==typeof o&&"00"===o.substring(0,2)&&(n.$time.pickatime("picker").set("select",o.split(":")),n.$time.attr("data-value",o))),!1!==n.options.date&&!1!==n.options.time&&n.options.timezone&&(n.$separator=a("<span/>").addClass(n.options.classSeparatorName).html(" "===n.options.separator?"&nbsp;":n.options.separator).appendTo(n.$wrapper)),null!==n.options.timezone&&(n.$timezone=a('<input type="text"/>').addClass(n.options.classTimezoneName).appendTo(a("<div/>").addClass(n.options.classTimezoneWrapperName).appendTo(n.$wrapper)).patternSelect2(a.extend(!0,{placeholder:n.options.placeholderTimezone,width:"10em"},n.options.timezone,{multiple:!1})).on("change",function(e){void 0!==e.val&&(n.$timezone.attr("data-value",e.val),!1!==n.options.date&&""===n.$date.attr("data-value")||!1!==n.options.time&&""===n.$time.attr("data-value")||n.updateValue.call(n))}),(o=n.options.timezone.default)&&(n.options.timezone.data.some(function(e){return t=e.text===n.options.timezone.default}),t&&(n.$timezone.attr("data-value",o),n.$timezone.parent().find(".select2-chosen").text(o))),1===n.options.timezone.data.length&&(n.$timezone.attr("data-value",n.options.timezone.data[0].text),n.$timezone.parent().find(".select2-chosen").text(n.options.timezone.data[0].text),n.$timezone.select2("enable",!1))),r.bool(n.options.today)&&(n.$now=a('<button type="button" class="btn btn-xs btn-info" title="'+n.options.today+'"><span class="glyphicon glyphicon-time"></span></button>').addClass(n.options.classNowName).on("click",function(e){e.preventDefault();e=new Date;n.$date&&n.$date.data("pickadate").set("select",e),n.$time&&n.$time.data("pickatime").set("select",e),n.emit("updated")}).appendTo(n.$wrapper)),r.bool(n.options.clear)&&(n.$clear=a('<button type="button" class="btn btn-xs btn-danger" title="'+n.options.clear+'"><span class="glyphicon glyphicon-trash"></span></button>').addClass(n.options.classClearName).on("click",function(e){e.preventDefault(),n.$date&&n.$date.data("pickadate").clear(),n.$time&&n.$time.data("pickatime").clear(),n.emit("updated")}).appendTo(n.$wrapper))},updateValue:function(){var e,t,n,i,o=this,a="";!1!==o.options.date&&(t=o.$date.data("pickadate").component,n=o.$date.data("pickadate").get("select"),e=t.formats.toString,n&&(a+=e.apply(t,[o.options.date.formatSubmit,n]))),!1!==o.options.date&&!1!==o.options.time&&(a+=" "),!1!==o.options.time&&(t=o.$time.data("pickatime").component,i=o.$time.data("pickatime").get("select"),n=t.formats.toString,i&&(a+=n.apply(t,["HH:i",i]))),null===o.options.timezone||(i=" "+o.$timezone.attr("data-value"))&&(a+=i),o.$el.val(a),o.emit("updated")}})}),require(["mockup-patterns-inlinevalidation","mockup-patterns-recurrence","mockup-patterns-relateditems","mockup-patterns-pickadate","mockup-patterns-select2"],function(){}),define("/home/_thet/data/dev/plone/buildout.coredev-60/src/plone.staticresources/src/plone/staticresources/static/plone-logged-in.js",function(){});
//# sourceMappingURL=plone-logged-in-compiled.min.js.map