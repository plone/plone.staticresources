define("mockup-patterns-inlinevalidation",["jquery","pat-base"],function(s,e){"use strict";return e.extend({name:"inlinevalidation",trigger:".pat-inlinevalidation",parser:"mockup",render_error:function(e,t){var n=s("div.fieldErrorBox",e);""!==t?(e.addClass("error"),n.html(t)):(e.removeClass("error"),n.html(""))},render_error_bootstrap:function(e,t){var n=s("input",e),i=s(".invalid-feedback",e);""!==t?(n.addClass("is-invalid"),i.length?i.html(t):s('<div class="invalid-feedback">'+t+"</div>").appendTo(e)):(n.removeClass("is-invalid"),i.length&&i.remove())},append_url_path:function(e,t){var n,i,o=e.split(/\?/);for("/"!==(i=o[0])[i.length-1]&&(i+="/"),i+=t,n=1;n<o.length;n+=1)i+="?"+o[n];return i},queue:function(e,t){void 0===t&&(t=e,e="fx"),s(window).queue(e,t)},validate_archetypes_field:function(e){var t=s(e),n=t.closest(".field"),i=n.attr("data-uid"),o=n.attr("data-fieldname"),a=t.val();t.prop("multiple")&&null===a&&(a=s([]).serialize());var r=s.param({uid:i,fname:o,value:a},!0);n&&i&&o&&this.queue(s.proxy(function(t){s.ajax({type:"POST",url:s("base").attr("href")+"/at_validate_field?"+r,iframe:!1,success:s.proxy(function(e){this.render_error(n,e.errmsg),t()},this),error:function(){t()},dataType:"json"})},this))},validate_formlib_field:function(e){var n=s(e).closest(".field"),i=n.closest("form").clone(),o=n.attr("data-fieldname");i.find("input[type=file]").remove(),this.queue(s.proxy(function(t){i.ajaxSubmit({url:this.append_url_path(i.attr("action"),"@@formlib_validate_field"),data:{fname:o},iframe:!1,success:s.proxy(function(e){this.render_error(n,e.errmsg),t()},this),error:function(){t()},dataType:"json"})},this))},validate_z3cform_field:function(e){var t=s(e),n=t.closest(".field"),i=n.closest("form"),o=i.clone(),a=t.closest("fieldset").data("fieldset"),r=n.data("fieldname");s.each(s("select",i),function(e,t){s('select[name="'+t.name+'"]',o).val(s(t).val())}),o.find("input[type=file]").remove(),r&&this.queue(s.proxy(function(t){o.ajaxSubmit({url:this.append_url_path(o.attr("action"),"@@z3cform_validate_field"),data:{fname:r,fset:a},iframe:!1,success:s.proxy(function(e){this.render_error_bootstrap(n,e.errmsg),t()},this),error:function(){t()},dataType:"json"})},this))},init:function(){this.$el.find('input[type="text"], input[type="password"], input[type="checkbox"], select, textarea').on("blur",s.proxy(function(e){"archetypes"===this.options.type?this.validate_archetypes_field(e.target):"z3c.form"===this.options.type?this.validate_z3cform_field(e.target):"formlib"===this.options.type&&this.validate_formlib_field(e.target)},this))}})}),function(e){define("resource-plone-app-jquerytools-js",["jquery"],function(){return function(){function p(e,t){var n=f(t);return n.length<2?n:e.parent().find(t)}function n(e,r){var s=this,l=e.add(s),c=e.children(),d=0,u=r.vertical;if(m=m||s,1<c.length&&(c=f(r.items,e)),1<r.size&&(r.circular=!1),f.extend(s,{getConf:function(){return r},getIndex:function(){return d},getSize:function(){return s.getItems().size()},getNaviButtons:function(){return n.add(a)},getRoot:function(){return e},getItemWrap:function(){return c},getItems:function(){return c.find(r.item).not("."+r.clonedClass)},move:function(e,t){return s.seekTo(d+e,t)},next:function(e){return s.move(r.size,e)},prev:function(e){return s.move(-r.size,e)},begin:function(e){return s.seekTo(0,e)},end:function(e){return s.seekTo(s.getSize()-1,e)},focus:function(){return m=s},addItem:function(e){return e=f(e),r.circular?(c.children().last().before(e),c.children().first().replaceWith(e.clone().addClass(r.clonedClass))):(c.append(e),a.removeClass("disabled")),l.trigger("onAddItem",[e]),s},seekTo:function(e,t,n){if(e.jquery||(e*=1),r.circular&&0===e&&-1==d&&0!==t)return s;if(!r.circular&&e<0||e>s.getSize()||e<-1)return s;var i=e;e.jquery?e=s.getItems().index(e):i=s.getItems().eq(e);var o=f.Event("onBeforeSeek");if(!n&&(l.trigger(o,[e,t]),o.isDefaultPrevented()||!i.length))return s;var a=u?{top:-i.position().top}:{left:-i.position().left};return d=e,m=s,void 0===t&&(t=r.speed),c.animate(a,t,r.easing,n||function(){l.trigger("onSeek",[e])}),s}}),f.each(["onBeforeSeek","onSeek","onAddItem"],function(e,t){f.isFunction(r[t])&&f(s).on(t,r[t]),s[t]=function(e){return e&&f(s).on(t,e),s}}),r.circular){var i=s.getItems().slice(-1).clone().prependTo(c),o=s.getItems().eq(1).clone().appendTo(c);i.add(o).addClass(r.clonedClass),s.onBeforeSeek(function(e,t,n){if(!e.isDefaultPrevented())return-1==t?(s.seekTo(i,n,function(){s.end(0)}),e.preventDefault()):void(t==s.getSize()&&s.seekTo(o,n,function(){s.begin(0)}))});var t=e.parents().add(e).filter(function(){if("none"===f(this).css("display"))return!0});t.length?(t.show(),s.seekTo(0,0,function(){}),t.hide()):s.seekTo(0,0,function(){})}var n=p(e,r.prev).click(function(e){e.stopPropagation(),s.prev()}),a=p(e,r.next).click(function(e){e.stopPropagation(),s.next()});if(r.circular||(s.onBeforeSeek(function(e,t){setTimeout(function(){e.isDefaultPrevented()||(n.toggleClass(r.disabledClass,t<=0),a.toggleClass(r.disabledClass,t>=s.getSize()-1))},1)}),r.initialIndex||n.addClass(r.disabledClass)),s.getSize()<2&&n.add(a).addClass(r.disabledClass),r.mousewheel&&f.fn.mousewheel&&e.mousewheel(function(e,t){if(r.mousewheel)return s.move(t<0?1:-1,r.wheelSpeed||50),!1}),r.touch){var h={};c[0].ontouchstart=function(e){var t=e.touches[0];h.x=t.clientX,h.y=t.clientY},c[0].ontouchmove=function(e){if(1==e.touches.length&&!c.is(":animated")){var t=e.touches[0],n=h.x-t.clientX,i=h.y-t.clientY;s[u&&0<i||!u&&0<n?"next":"prev"](),e.preventDefault()}}}r.keyboard&&f(document).on("keydown.scrollable",function(e){if(!(!r.keyboard||e.altKey||e.ctrlKey||e.metaKey||f(e.target).is(":input")||"static"!=r.keyboard&&m!=s)){var t=e.keyCode;return!u||38!=t&&40!=t?u||37!=t&&39!=t?void 0:(s.move(37==t?-1:1),e.preventDefault()):(s.move(38==t?-1:1),e.preventDefault())}}),r.initialIndex&&s.seekTo(r.initialIndex,0,function(){})}var f,m,i,o,a,r,t,s,l,c,d,u,h,g;function v(e){if(e){var t=a.contentWindow.document;t.open().close(),t.location.hash=e}}function y(){if(/msie/.test(navigator.userAgent.toLowerCase())){var e=s(document).height(),t=s(window).height();return[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,e-t<20?t:e]}return[s(document).width(),s(document).height()]}function b(e){if(e)return e.call(s.mask)}!function(f){f.tools=f.tools||{version:"@VERSION"},f.tools.overlay={addEffect:function(e,t,n){g[e]=[t,n]},conf:{close:null,closeOnClick:!0,closeOnEsc:!0,closeSpeed:"fast",effect:"default",fixed:!/msie/.test(navigator.userAgent.toLowerCase())||6<navigator.appVersion,left:"center",load:!1,mask:null,oneInstance:!0,speed:"normal",target:null,top:"10%"}};var m=[],g={};function n(e,r){var t,s,l,c=this,d=e.add(c),u=f(window),h=f.tools.expose&&(r.mask||r.expose),p=Math.random().toString().slice(10);h&&("string"==typeof h&&(h={color:h}),h.closeOnClick=h.closeOnEsc=!1);var n=r.target||e.attr("rel");if(!(s=n?f(n):e).length)throw"Could not find Overlay: "+n;e&&-1==e.index(s)&&e.click(function(e){return c.load(e),e.preventDefault()}),f.extend(c,{load:function(e){if(c.isOpened())return c;var t=g[r.effect];if(!t)throw'Overlay: cannot find effect : "'+r.effect+'"';if(r.oneInstance&&f.each(m,function(){this.close(e)}),(e=e||f.Event()).type="onBeforeLoad",d.trigger(e),e.isDefaultPrevented())return c;l=!0,h&&f(s).expose(h);var n=r.top,i=r.left,o=s.outerWidth(!0),a=s.outerHeight(!0);return"string"==typeof n&&(n="center"==n?Math.max((u.height()-a)/2,0):parseInt(n,10)/100*u.height()),"center"==i&&(i=Math.max((u.width()-o)/2,0)),t[0].call(c,{top:n,left:i},function(){l&&(e.type="onLoad",d.trigger(e))}),h&&r.closeOnClick&&f.mask.getMask().one("click",c.close),r.closeOnClick&&f(document).on("click."+p,function(e){f(e.target).parents(s).length||c.close(e)}),r.closeOnEsc&&f(document).on("keydown."+p,function(e){27==e.keyCode&&c.close(e)}),c},close:function(e){return c.isOpened()?((e=e||f.Event()).type="onBeforeClose",d.trigger(e),e.isDefaultPrevented()?void 0:(l=!1,g[r.effect][1].call(c,function(){e.type="onClose",d.trigger(e)}),f(document).off("click."+p+" keydown."+p),h&&f.mask.close(),c)):c},getOverlay:function(){return s},getTrigger:function(){return e},getClosers:function(){return t},isOpened:function(){return l},getConf:function(){return r}}),f.each("onBeforeLoad,onStart,onLoad,onBeforeClose,onClose".split(","),function(e,t){f.isFunction(r[t])&&f(c).on(t,r[t]),c[t]=function(e){return e&&f(c).on(t,e),c}}),(t=s.find(r.close||".close")).length||r.close||(t=f('<a class="close"></a>'),s.prepend(t)),t.click(function(e){c.close(e)}),r.load&&c.load()}f.tools.overlay.addEffect("default",function(e,t){var n=this.getConf(),i=f(window);n.fixed||(e.top+=i.scrollTop(),e.left+=i.scrollLeft()),e.position=n.fixed?"fixed":"absolute",this.getOverlay().css(e).fadeIn(n.speed,t)},function(e){this.getOverlay().fadeOut(this.getConf().closeSpeed,e)}),f.fn.overlay=function(e){var t=this.data("overlay");return t||(f.isFunction(e)&&(e={onBeforeLoad:e}),e=f.extend(!0,{},f.tools.overlay.conf,e),this.each(function(){t=new n(f(this),e),m.push(t),f(this).data("overlay",t)}),e.api?t:this)}}(jQuery),(f=jQuery).tools=f.tools||{version:"@VERSION"},f.tools.scrollable={conf:{activeClass:"active",circular:!1,clonedClass:"cloned",disabledClass:"disabled",easing:"swing",initialIndex:0,item:"> *",items:".items",keyboard:!0,mousewheel:!1,next:".next",prev:".prev",size:1,speed:400,vertical:!1,touch:!0,wheelSpeed:0}},f.fn.scrollable=function(e){var t=this.data("scrollable");return t||(e=f.extend({},f.tools.scrollable.conf,e),this.each(function(){t=new n(f(this),e),f(this).data("scrollable",t)}),e.api?t:this)},function(h){h.tools=h.tools||{version:"@VERSION"},h.tools.tabs={conf:{tabs:"a",current:"current",onBeforeClick:null,onClick:null,effect:"default",initialEffect:!1,initialIndex:0,event:"click",rotate:!1,slideUpSpeed:400,slideDownSpeed:400,history:!1},addEffect:function(e,t){p[e]=t}};var o,a,p={default:function(e,t){this.getPanes().hide().eq(e).show(),t.call()},fade:function(e,t){var n=this.getConf(),i=n.fadeOutSpeed,o=this.getPanes();i?o.fadeOut(i):o.hide(),o.eq(e).fadeIn(n.fadeInSpeed,t)},slide:function(e,t){var n=this.getConf();this.getPanes().slideUp(n.slideUpSpeed),this.getPanes().eq(e).slideDown(n.slideDownSpeed,t)},ajax:function(e,t){this.getPanes().eq(0).load(this.getTabs().eq(e).attr("href"),t)}};function i(r,e,s){var l,c=this,d=r.add(this),u=r.find(s.tabs),t=e.jquery?e:r.children(e);u.length||(u=r.children()),t.length||(t=r.parent().find(e)),t.length||(t=h(e)),h.extend(this,{click:function(e,t){var n=u.eq(e),i=!r.data("tabs");if("string"==typeof e&&e.replace("#","")&&(n=u.filter('[href*="'+e.replace("#","")+'"]'),e=Math.max(u.index(n),0)),s.rotate){var o=u.length-1;if(e<0)return c.click(o,t);if(o<e)return c.click(0,t)}if(!n.length){if(0<=l)return c;e=s.initialIndex,n=u.eq(e)}if(e===l)return c;if((t=t||h.Event()).type="onBeforeClick",d.trigger(t,[e]),!t.isDefaultPrevented()){var a=i?s.initialEffect&&s.effect||"default":s.effect;return p[a].call(c,e,function(){l=e,t.type="onClick",d.trigger(t,[e])}),u.removeClass(s.current),n.addClass(s.current),c}},getConf:function(){return s},getTabs:function(){return u},getPanes:function(){return t},getCurrentPane:function(){return t.eq(l)},getCurrentTab:function(){return u.eq(l)},getIndex:function(){return l},next:function(){return c.click(l+1)},prev:function(){return c.click(l-1)},destroy:function(){return u.off(s.event).removeClass(s.current),t.find('a[href^="#"]').off("click.T"),c}}),h.each("onBeforeClick,onClick".split(","),function(e,t){h.isFunction(s[t])&&h(c).on(t,s[t]),c[t]=function(e){return e&&h(c).on(t,e),c}}),s.history&&h.fn.history&&(h.tools.history.init(u),s.event="history"),u.each(function(t){h(this).on(s.event,function(e){return c.click(t,e),e.preventDefault()})}),t.find('a[href^="#"]').on("click.T",function(e){c.click(h(this).attr("href"),e)}),location.hash&&"a"==s.tabs&&r.find('[href="'+location.hash+'"]').length?c.click(location.hash):(0===s.initialIndex||0<s.initialIndex)&&c.click(s.initialIndex)}h.tools.tabs.addEffect("horizontal",function(e,t){if(!o){var n=this.getPanes().eq(e),i=this.getCurrentPane();a=a||this.getPanes().eq(0).width(),o=!0,n.show(),i.animate({width:0},{step:function(e){n.css("width",a-e)},complete:function(){h(this).hide(),t.call(),o=!1}}),i.length||(t.call(),o=!1)}}),h.fn.tabs=function(e,t){var n=this.data("tabs");return n&&(n.destroy(),this.removeData("tabs")),h.isFunction(t)&&(t={onBeforeClick:t}),t=h.extend({},h.tools.tabs.conf,t),this.each(function(){n=new i(h(this),e,t),h(this).data("tabs",n)}),t.api?n:this}}(jQuery),(i=jQuery).tools=i.tools||{version:"@VERSION"},i.tools.history={init:function(e){t||(i.browser.msie&&i.browser.version<"8"?a||(a=i("<iframe/>").attr("src","javascript:false;").hide().get(0),i("body").append(a),setInterval(function(){var e=a.contentWindow.document.location.hash;o!==e&&i(window).trigger("hash",e)},100),v(location.hash||"#")):setInterval(function(){var e=location.hash;e!==o&&i(window).trigger("hash",e)},100),r=r?r.add(e):e,e.click(function(e){var t=i(this).attr("href");if(a&&v(t),"#"!=t.slice(0,1))return location.href="#"+t,e.preventDefault()}),t=!0)}},i(window).on("hash",function(e,t){t?r.filter(function(){var e=i(this).attr("href");return e==t||e==t.replace("#","")}).trigger("history",[t]):r.eq(0).trigger("history",[t]),o=t}),i.fn.history=function(e){return i.tools.history.init(this),this.on("history",e)},(s=jQuery).tools=s.tools||{version:"@VERSION"},l=s.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",closeSpeed:"fast",closeOnClick:!0,closeOnEsc:!0,zIndex:9998,opacity:.8,startOpacity:0,color:"#fff",onLoad:null,onClose:null}},s.mask={load:function(e,t){if(u)return this;"string"==typeof e&&(e={color:e}),e=e||h,h=e=s.extend(s.extend({},l.conf),e),(c=s("#"+e.maskId)).length||(c=s("<div/>").attr("id",e.maskId),s("body").append(c));var n=y();return c.css({position:"absolute",top:0,left:0,width:n[0],height:n[1],display:"none",opacity:e.startOpacity,zIndex:e.zIndex}),e.color&&c.css("backgroundColor",e.color),!1===b(e.onBeforeLoad)||(e.closeOnEsc&&s(document).on("keydown.mask",function(e){27==e.keyCode&&s.mask.close(e)}),e.closeOnClick&&c.on("click.mask",function(e){s.mask.close(e)}),s(window).on("resize.mask",function(){s.mask.fit()}),t&&t.length&&(g=t.eq(0).css("zIndex"),s.each(t,function(){var e=s(this);/relative|absolute|fixed/i.test(e.css("position"))||e.css("position","relative")}),d=t.css({zIndex:Math.max(e.zIndex+1,"auto"==g?0:g)})),c.css({display:"block"}).fadeTo(e.loadSpeed,e.opacity,function(){s.mask.fit(),b(e.onLoad),u="full"}),u=!0),this},close:function(){if(u){if(!1===b(h.onBeforeClose))return this;c.fadeOut(h.closeSpeed,function(){d&&d.css({zIndex:g}),u=!1,b(h.onClose)}),s(document).off("keydown.mask"),c.off("click.mask"),s(window).off("resize.mask")}return this},fit:function(){if(u){var e=y();c.css({width:e[0],height:e[1]})}},getMask:function(){return c},isLoaded:function(e){return e?"full"==u:u},getConf:function(){return h},getExposed:function(){return d}},s.fn.mask=function(e){return s.mask.load(e),this},s.fn.expose=function(e){return s.mask.load(e,this),this},function(m){m.tools=m.tools||{version:"@VERSION"},m.tools.tooltip={conf:{effect:"toggle",fadeOutSpeed:"fast",predelay:0,delay:30,opacity:1,tip:0,fadeIE:!1,position:["top","center"],offset:[0,0],relative:!1,cancelDefault:!0,events:{def:"mouseenter,mouseleave",input:"focus,blur",widget:"focus mouseenter,blur mouseleave",tooltip:"mouseenter,mouseleave"},layout:"<div/>",tipClass:"tooltip"},addEffect:function(e,t,n){g[e]=[t,n]}};var g={toggle:[function(e){var t=this.getConf(),n=this.getTip(),i=t.opacity;i<1&&n.css({opacity:i}),n.show(),e.call()},function(e){this.getTip().hide(),e.call()}],fade:[function(e){var t=this.getConf();!/msie/.test(navigator.userAgent.toLowerCase())||t.fadeIE?this.getTip().fadeTo(t.fadeInSpeed,t.opacity,e):(this.getTip().show(),e())},function(e){var t=this.getConf();!/msie/.test(navigator.userAgent.toLowerCase())||t.fadeIE?this.getTip().fadeOut(t.fadeOutSpeed,e):(this.getTip().hide(),e())}]};function v(e,t,n){var i=n.relative?e.position().top:e.offset().top,o=n.relative?e.position().left:e.offset().left,a=n.position[0];i-=t.outerHeight()-n.offset[0],o+=e.outerWidth()+n.offset[1],/iPad/i.test(navigator.userAgent)&&(i-=m(window).scrollTop());var r=t.outerHeight()+e.outerHeight();"center"==a&&(i+=r/2),"bottom"==a&&(i+=r),a=n.position[1];var s=t.outerWidth()+e.outerWidth();return"center"==a&&(o-=s/2),"left"==a&&(o-=s),{top:i,left:o}}function n(i,o){var a,r,s=this,l=i.add(s),c=0,d=0,u=i.attr("title"),h=i.attr("data-tooltip"),p=g[o.effect],e=i.is(":input"),t=e&&i.is(":checkbox, :radio, select, :button, :submit"),n=i.attr("type"),f=o.events[n]||o.events[e?t?"widget":"input":"def"];if(!p)throw'Nonexistent effect "'+o.effect+'"';if(2!=(f=f.split(/,\s*/)).length)throw"Tooltip: bad events configuration for "+n;i.on(f[0],function(e){clearTimeout(c),o.predelay?d=setTimeout(function(){s.show(e)},o.predelay):s.show(e)}).on(f[1],function(e){clearTimeout(d),o.delay?c=setTimeout(function(){s.hide(e)},o.delay):s.hide(e)}),u&&o.cancelDefault&&(i.removeAttr("title"),i.data("title",u)),m.extend(s,{show:function(e){if(!a&&(h?a=m(h):o.tip?a=m(o.tip).eq(0):u?a=m(o.layout).addClass(o.tipClass).appendTo(document.body).hide().append(u):((a=i.find("."+o.tipClass)).length||(a=i.next()),a.length||(a=i.parent().next())),!a.length))throw"Cannot find tooltip for "+i;if(s.isShown())return s;a.stop(!0,!0);var t=v(i,a,o);if(o.tip&&a.html(i.data("title")),(e=m.Event()).type="onBeforeShow",l.trigger(e,[t]),e.isDefaultPrevented())return s;t=v(i,a,o),a.css({position:"absolute",top:t.top,left:t.left}),r=!0,p[0].call(s,function(){e.type="onShow",r="full",l.trigger(e)});var n=o.events.tooltip.split(/,\s*/);return a.data("__set")||(a.off(n[0]).on(n[0],function(){clearTimeout(c),clearTimeout(d)}),n[1]&&!i.is("input:not(:checkbox, :radio), textarea")&&a.off(n[1]).on(n[1],function(e){e.relatedTarget!=i[0]&&i.trigger(f[1].split(" ")[0])}),o.tip||a.data("__set",!0)),s},hide:function(e){return a&&s.isShown()?((e=m.Event()).type="onBeforeHide",l.trigger(e),e.isDefaultPrevented()?void 0:(r=!1,g[o.effect][1].call(s,function(){e.type="onHide",l.trigger(e)}),s)):s},isShown:function(e){return e?"full"==r:r},getConf:function(){return o},getTip:function(){return a},getTrigger:function(){return i}}),m.each("onHide,onBeforeShow,onShow,onBeforeHide".split(","),function(e,t){m.isFunction(o[t])&&m(s).on(t,o[t]),s[t]=function(e){return e&&m(s).on(t,e),s}})}m.fn.tooltip=function(e){var t=this.data("tooltip");return t||("string"==typeof(e=m.extend(!0,{},m.tools.tooltip.conf,e)).position&&(e.position=e.position.split(/,?\s/)),this.each(function(){t=new n(m(this),e),m(this).data("tooltip",t)}),e.api?t:this)}}(jQuery)}.apply(e,arguments)})}(this),function(e){define("resource-plone-app-jquerytools-dateinput-js",["jquery"],function(){return function(){!function(_,M){function R(e,t){return new Date(e,t+1,0).getDate()}function d(e,t){for(e=""+e,t=t||2;e.length<t;)e="0"+e;return e}function u(e,t,n,i){var o=t.getDate(),a=t.getDay(),r=t.getMonth(),s=t.getFullYear(),l={d:o,dd:d(o),ddd:L[i].shortDays[a],dddd:L[i].days[a],m:r+1,mm:d(r+1),mmm:L[i].shortMonths[r],mmmm:L[i].months[r],yy:String(s).slice(2),yyyy:s},c=p[e](n,t,l,i);return f.html(c).html()}function N(e){return parseInt(e,10)}function P(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()==t.getMonth()&&e.getDate()==t.getDate()}function j(e){if(e!==M){if(e.constructor==Date)return e;if("string"==typeof e){var t=e.split("-");if(3==t.length)return new Date(N(t[0]),N(t[1])-1,N(t[2]));if(!/^-?\d+$/.test(e))return;e=N(e)}var n=new Date;return n.setDate(n.getDate()+e),n}}function o(a,p){function f(e,t,n){return a.attr("readonly")?void k.hide(n):(v=(C=e).getFullYear(),y=e.getMonth(),b=e.getDate(),"click"!=(n=n||_.Event("api")).type||/msie/.test(navigator.userAgent.toLowerCase())||a.focus(),n.type="beforeChange",l.trigger(n,[e]),void(n.isDefaultPrevented()||(a.val(u(t.formatter,e,t.format,t.lang)),n.type="change",n.target=a[0],l.trigger(n),a.data("date",e),k.hide(n))))}function n(e){e.type="onShow",l.trigger(e),_(document).on("keydown.d",function(e){if(e.ctrlKey)return!0;var t=e.keyCode;if(8==t||46==t)return a.val(""),k.hide(e);if(27==t||9==t)return k.hide(e);if(0<=_(F).index(t)){if(!w)return k.show(e),e.preventDefault();var n=_("#"+S.weeks+" a"),i=_("."+S.focus),o=n.index(i);return i.removeClass(S.focus),74==t||40==t?o+=7:75==t||38==t?o-=7:76==t||39==t?o+=1:72!=t&&37!=t||--o,(i=41<o?(k.addMonth(),_("#"+S.weeks+" a:eq("+(o-42)+")")):o<0?(k.addMonth(-1),_("#"+S.weeks+" a:eq("+(o+42)+")")):n.eq(o)).addClass(S.focus),e.preventDefault()}return 34==t?k.addMonth():33==t?k.addMonth(-1):36==t?k.today():(13==t&&(_(e.target).is("select")||_("."+S.focus).click()),0<=_([16,17,18,9]).index(t))}),_(document).on("click.d",function(e){var t=e.target;t.id==S.root||_(t).parents("#"+S.root).length||t==a[0]||i&&t==i[0]||k.hide(e)})}var i,m,g,v,y,b,w,k=this,x=new Date,e=x.getFullYear(),S=p.css,T=L[p.lang],o=_("#"+S.root),E=o.find("#"+S.title),C=a.attr("data-value")||p.value||a.val(),D=a.attr("min")||p.min,O=a.attr("max")||p.max;if(0===D&&(D="0"),C=j(C)||x,D=j(D||new Date(e+p.yearRange[0],1,1)),O=j(O||new Date(e+p.yearRange[1]+1,1,-1)),!T)throw"Dateinput: invalid language: "+p.lang;if("date"==a.attr("type")){var t,r=(t=a.clone()).wrap("<div/>").parent().html(),s=_(r.replace(/type/i,"type=text data-orig-type"));p.value&&s.val(p.value),a.replaceWith(s),a=s}a.addClass(S.input);var l=a.add(k);if(!o.length){if((o=_("<div><div><a/><div/><a/></div><div><div/><div/></div></div>").hide().css({position:"absolute"}).attr("id",S.root)).children().eq(0).attr("id",S.head).end().eq(1).attr("id",S.body).children().eq(0).attr("id",S.days).end().eq(1).attr("id",S.weeks).end().end().end().find("a").eq(0).attr("id",S.prev).end().eq(1).attr("id",S.next),E=o.find("#"+S.head).find("div").attr("id",S.title),p.selectors){var $=_("<select/>").attr("id",S.month),A=_("<select/>").attr("id",S.year);E.html($.add(A))}for(var c=o.find("#"+S.days),d=0;d<7;d++)c.append(_("<span/>").text(T.shortDays[(d+p.firstDay)%7]));_("body").append(o)}p.trigger&&(i=_("<a/>").attr("href","#").addClass(S.trigger).click(function(e){return p.toggle?k.toggle():k.show(),e.preventDefault()}).insertAfter(a));var I=o.find("#"+S.weeks);A=o.find("#"+S.year),$=o.find("#"+S.month),_.extend(k,{show:function(e){if(!a.attr("disabled")&&!w&&((e=e||_.Event()).type="onBeforeShow",l.trigger(e),!e.isDefaultPrevented())){_.each(h,function(){this.hide()}),w=!0,$.off("change").change(function(){k.setValue(N(A.val()),N(_(this).val()))}),A.off("change").change(function(){k.setValue(N(_(this).val()),N($.val()))}),m=o.find("#"+S.prev).off("click").click(function(){return m.hasClass(S.disabled)||k.addMonth(-1),!1}),g=o.find("#"+S.next).off("click").click(function(){return g.hasClass(S.disabled)||k.addMonth(),!1}),k.setValue(C);var t=a.offset();return/iPad/i.test(navigator.userAgent)&&(t.top-=_(window).scrollTop()),o.css({top:t.top+a.outerHeight(!0)+p.offset[0],left:t.left+p.offset[1]}),p.speed?o.show(p.speed,function(){n(e)}):(o.show(),n(e)),k}},setValue:function(n,e,t){var i=-1<=N(e)?new Date(N(n),N(e),N(t==M||isNaN(t)?1:t)):n||C;if(i<D?i=D:O<i&&(i=O),"string"==typeof n&&(i=j(n)),n=i.getFullYear(),e=i.getMonth(),t=i.getDate(),-1==e?(e=11,n--):12==e&&(e=0,n++),!w)return f(i,p),k;y=e,v=n,b=t;var o,a=new Date(n,e,1-p.firstDay).getDay(),r=R(n,e),s=R(n,e-1);if(p.selectors){$.empty(),_.each(T.months,function(e,t){D<new Date(n,e+1,1)&&O>new Date(n,e,0)&&$.append(_("<option/>").html(t).attr("value",e))}),A.empty();for(var l=x.getFullYear(),c=l+p.yearRange[0];c<l+p.yearRange[1];c++)D<new Date(c+1,0,1)&&O>new Date(c,0,0)&&A.append(_("<option/>").text(c));$.val(e),A.val(n)}else E.html(T.months[e]+" "+n);I.empty(),m.add(g).removeClass(S.disabled);for(var d,u,h=a?0:-7;h<(a?42:35);h++)d=_("<a/>"),h%7==0&&(o=_("<div/>").addClass(S.week),I.append(o)),h<a?(d.addClass(S.off),u=s-a+h+1,i=new Date(n,e-1,u)):a+r<=h?(d.addClass(S.off),u=h-r-a+1,i=new Date(n,e+1,u)):(u=h-a+1,i=new Date(n,e,u),P(C,i)?d.attr("id",S.current).addClass(S.focus):P(x,i)&&d.attr("id",S.today)),D&&i<D&&d.add(m).addClass(S.disabled),O&&O<i&&d.add(g).addClass(S.disabled),d.attr("href","#"+u).text(u).data("date",i),o.append(d);return I.find("a").click(function(e){var t=_(this);return t.hasClass(S.disabled)||(_("#"+S.current).removeAttr("id"),t.attr("id",S.current),f(t.data("date"),p,e)),!1}),S.sunday&&I.find("."+S.week).each(function(){var e=p.firstDay?7-p.firstDay:0;_(this).children().slice(e,1+e).addClass(S.sunday)}),k},setMin:function(e,t){return D=j(e),t&&C<D&&k.setValue(D),k},setMax:function(e,t){return O=j(e),t&&O<C&&k.setValue(O),k},today:function(){return k.setValue(x)},addDay:function(e){return this.setValue(v,y,b+(e||1))},addMonth:function(e){var t=y+(e||1),n=R(v,t),i=b<=n?b:n;return this.setValue(v,t,i)},addYear:function(e){return this.setValue(v+(e||1),y,b)},destroy:function(){a.add(document).off("click.d keydown.d"),o.add(i).remove(),a.removeData("dateinput").removeClass(S.input),t&&a.replaceWith(t)},hide:function(e){if(w){if((e=_.Event()).type="onHide",l.trigger(e),e.isDefaultPrevented())return;_(document).off("click.d keydown.d"),o.hide(),w=!1}return k},toggle:function(){return k.isOpen()?k.hide():k.show()},getConf:function(){return p},getInput:function(){return a},getCalendar:function(){return o},getValue:function(e){return e?u(p.formatter,C,e,p.lang):C},isOpen:function(){return w}}),_.each(["onBeforeShow","onShow","change","onHide"],function(e,t){_.isFunction(p[t])&&_(k).on(t,p[t]),k[t]=function(e){return e&&_(k).on(t,e),k}}),p.editable||a.on("focus.d click.d",k.show).keydown(function(e){var t=e.keyCode;return!w&&0<=_(F).index(t)?(k.show(e),e.preventDefault()):(8!=t&&46!=t||a.val(""),!!(e.shiftKey||e.ctrlKey||e.altKey||9==t)||e.preventDefault())}),j(a.val())&&f(C,p)}_.tools=_.tools||{version:"@VERSION"};var e,h=[],p={},F=[75,76,38,39,74,72,40,37],L={};(e=_.tools.dateinput={conf:{format:"mm/dd/yy",formatter:"default",selectors:!1,yearRange:[-5,5],lang:"en",offset:[0,0],speed:0,firstDay:0,min:M,max:M,trigger:0,toggle:0,editable:0,css:{prefix:"cal",input:"date",root:0,head:0,title:0,prev:0,next:0,month:0,year:0,days:0,body:0,weeks:0,today:0,current:0,week:0,off:0,sunday:0,focus:0,disabled:0,trigger:0}},addFormatter:function(e,t){p[e]=t},localize:function(e,n){_.each(n,function(e,t){n[e]=t.split(",")}),L[e]=n}}).localize("en",{months:"January,February,March,April,May,June,July,August,September,October,November,December",shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec",days:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday",shortDays:"Sun,Mon,Tue,Wed,Thu,Fri,Sat"});var f=_("<a/>");e.addFormatter("default",function(e,t,n){return e.replace(/d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*'/g,function(e){return e in n?n[e]:e})}),e.addFormatter("prefixed",function(e,t,n){return e.replace(/%(d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*')/g,function(e,t){return t in n?n[t]:e})}),_.expr[":"].date=function(e){var t=e.getAttribute("type");return t&&"date"==t||!!_(e).data("dateinput")},_.fn.dateinput=function(n){return this.data("dateinput")?this:(n=_.extend(!0,{},e.conf,n),_.each(n.css,function(e,t){t||"prefix"==e||(n.css[e]=(n.css.prefix||"")+(t||e))}),this.each(function(){var e=new o(_(this),n);h.push(e);var t=e.getInput().data("dateinput",e);i=i?i.add(t):t}),i||this);var i}}(jQuery)}.apply(e,arguments)})}(this),function(e){define("jquery.tmpl",["jquery"],function(){return function(){function c(e,t,n,i){var o={data:i||(t?t.data:{}),_wrap:t?t._wrap:null,tmpl:null,parent:t||null,nodes:[],calls:d,nest:h,wrap:p,html:f,update:m};return e&&g.extend(o,e,{nodes:[],parent:t}),n&&(o.tmpl=n,o._ctnt=o._ctnt||o.tmpl(g,o),o.key=++S,(E.length?k:w)[S]=o),o}function r(t,e,n){var o,i=n?g.map(n,function(e){return"string"==typeof e?t.key?e.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+b+'="'+t.key+'" $2'):e:r(e,t,e._ctnt)}):t;return e?i:((i=i.join("")).replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(e,t,n,i){l(o=g(n).get()),t&&(o=a(t).concat(o)),i&&(o=o.concat(a(i)))}),o||a(i))}function a(e){var t=document.createElement("div");return t.innerHTML=e,g.makeArray(t.childNodes)}function n(e){return new Function("jQuery","$item","var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('"+g.trim(e).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(e,t,n,i,o,a,r){var s,l,c,d=g.tmpl.tag[n];if(!d)throw"Template command not found: "+n;return s=d._default||[],a&&!/\w$/.test(o)&&(o+=a,a=""),c=o?(o=u(o),r=r?","+u(r)+")":a?")":"",l=a?-1<o.indexOf(".")?o+a:"("+o+").call($item"+r:o,a?l:"(typeof("+o+")==='function'?("+o+").call($item):("+o+"))"):l=s.$1||"null",i=u(i),"');"+d[t?"close":"open"].split("$notnull_1").join(o?"typeof("+o+")!=='undefined' && ("+o+")!=null":"true").split("$1a").join(c).split("$1").join(l).split("$2").join(i?i.replace(/\s*([^\(]+)\s*(\((.*?)\))?/g,function(e,t,n,i){return(i=i?","+i+")":n?")":"")?"("+t+").call($item"+i:e}):s.$2||"")+"_.push('"})+"');}return _;")}function s(e,t){e._wrap=r(e,!0,g.isArray(t)?t:[i.test(t)?t:g(t).html()]).join("")}function u(e){return e?e.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function l(e){var t,n,i,o,a,s="_"+T,l={};for(i=0,o=e.length;i<o;i++)if(1===(t=e[i]).nodeType){for(a=(n=t.getElementsByTagName("*")).length-1;0<=a;a--)r(n[a]);r(t)}function r(e){var t,n,i,o,a=e;if(o=e.getAttribute(b)){for(;a.parentNode&&1===(a=a.parentNode).nodeType&&!(t=a.getAttribute(b)););t!==o&&(a=a.parentNode&&11!==a.nodeType&&a.getAttribute(b)||0,(i=w[o])||((i=c(i=k[o],w[a]||k[a],null,!0)).key=++S,w[S]=i),T&&r(o)),e.removeAttribute(b)}else T&&(i=g.data(e,"tmplItem"))&&(r(i.key),w[i.key]=i,a=(a=g.data(e.parentNode,"tmplItem"))?a.key:0);if(i){for(n=i;n&&n.key!=a;)n.nodes.push(e),n=n.parent;delete i._ctnt,delete i._wrap,g.data(e,"tmplItem",i)}function r(e){i=l[e+=s]=l[e]||c(i,w[i.parent.key+s]||i.parent,null,!0)}}}function d(e,t,n,i){if(!e)return E.pop();E.push({_:e,tmpl:t,item:this,data:n,options:i})}function h(e,t,n){return g.tmpl(g.template(e),t,n,this)}function p(e,t){var n=e.options||{};return n.wrapped=t,g.tmpl(g.template(e.tmpl),e.data,n,e.item)}function f(e,i){var t=this._wrap;return g.map(g(g.isArray(t)?t.join(""):t).filter(e||"*"),function(e){return i?e.innerText||e.textContent:e.outerHTML||(t=e,(n=document.createElement("div")).appendChild(t.cloneNode(!0)),n.innerHTML);var t,n})}function m(){var e=this.nodes;g.tmpl(null,null,null,this).insertBefore(e[0]),g(e).remove()}var g,v,y,b,i,w,k,x,S,T,E;g=jQuery,y=g.fn.domManip,b="_tmplitem",i=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,w={},k={},x={key:0,data:{}},T=S=0,E=[],g.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(l,c){g.fn[l]=function(e){var t,n,i,o,a=[],r=g(e),s=1===this.length&&this[0].parentNode;if(v=w||{},s&&11===s.nodeType&&1===s.childNodes.length&&1===r.length)r[c](this[0]),a=this;else{for(n=0,i=r.length;n<i;n++)t=(0<(T=n)?this.clone(!0):this).get(),g.fn[c].apply(g(r[n]),t),a=a.concat(t);T=0,a=this.pushStack(a,l,r.selector)}return o=v,v=null,g.tmpl.complete(o),a}}),g.fn.extend({tmpl:function(e,t,n){return g.tmpl(this[0],e,t,n)},tmplItem:function(){return g.tmplItem(this[0])},template:function(e){return g.template(e,this[0])},domManip:function(e,t,n,i){if(e[0]&&e[0].nodeType){for(var o,a=g.makeArray(arguments),r=e.length,s=0;s<r&&!(o=g.data(e[s++],"tmplItem")););1<r&&(a[0]=[g.makeArray(e)]),o&&T&&(a[2]=function(e){g.tmpl.afterManip(this,e,n)}),y.apply(this,a)}else y.apply(this,arguments);return T=0,v||g.tmpl.complete(w),this}}),g.extend({tmpl:function(t,e,n,i){var o,a=!i;if(a)i=x,t=g.template[t]||g.template(null,t),k={};else if(!t)return t=i.tmpl,(w[i.key]=i).nodes=[],i.wrapped&&s(i,i.wrapped),g(r(i,null,i.tmpl(g,i)));return t?("function"==typeof e&&(e=e.call(i||{})),n&&n.wrapped&&s(n,n.wrapped),o=g.isArray(e)?g.map(e,function(e){return e?c(n,i,t,e):null}):[c(n,i,t,e)],a?g(r(i,null,o)):o):[]},tmplItem:function(e){var t;for(e instanceof g&&(e=e[0]);e&&1===e.nodeType&&!(t=g.data(e,"tmplItem"))&&(e=e.parentNode););return t||x},template:function(e,t){return t?("string"==typeof t?t=n(t):t instanceof g&&(t=t[0]||{}),t.nodeType&&(t=g.data(t,"tmpl")||g.data(t,"tmpl",n(t.innerHTML))),"string"==typeof e?g.template[e]=t:t):e?"string"!=typeof e?g.template(null,e):g.template[e]||g.template(null,i.test(e)?e:g(e)):null},encode:function(e){return(""+e).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}}),g.extend(g.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},if:{open:"if(($notnull_1) && $1a){",close:"}"},else:{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode($1a));}"},"!":{open:""}},complete:function(e){w={}},afterManip:function(e,t,n){var i=11===t.nodeType?g.makeArray(t.childNodes):1===t.nodeType?[t]:[];n.call(e,t),l(i),T++}})}.apply(e,arguments)})}(this),function(e){define("jquery.recurrenceinput",["jquery","resource-plone-app-jquerytools-js","resource-plone-app-jquerytools-dateinput-js","jquery.tmpl"],function(){return function(){!function(A){var o;A.tools=A.tools||{version:"@VERSION"};var p={};(o=A.tools.recurrenceinput={conf:{lang:"en",readOnly:!1,firstDay:0,startField:null,startFieldYear:null,startFieldMonth:null,startFieldDay:null,ajaxURL:null,ajaxContentType:"application/json; charset=utf8",ributtonExtraClass:"",hasRepeatForeverButton:!0,formOverlay:{speed:"fast",fixed:!1},template:{form:"#jquery-recurrenceinput-form-tmpl",display:"#jquery-recurrenceinput-display-tmpl"},rtemplate:{daily:{rrule:"FREQ=DAILY",fields:["ridailyinterval","rirangeoptions"]},mondayfriday:{rrule:"FREQ=WEEKLY;BYDAY=MO,FR",fields:["rirangeoptions"]},weekdays:{rrule:"FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR",fields:["rirangeoptions"]},weekly:{rrule:"FREQ=WEEKLY",fields:["riweeklyinterval","riweeklyweekdays","rirangeoptions"]},monthly:{rrule:"FREQ=MONTHLY",fields:["rimonthlyinterval","rimonthlyoptions","rirangeoptions"]},yearly:{rrule:"FREQ=YEARLY",fields:["riyearlyinterval","riyearlyoptions","rirangeoptions"]}}},localize:function(e,t){p[e]=t},setTemplates:function(e,t){var n,i;for(n in o.conf.rtemplate=e,t)if(t.hasOwnProperty(n))for(i in t[n])t[n].hasOwnProperty(i)&&(p[n].rtemplate[i]=t[n][i])}}).localize("en",{displayUnactivate:"Does not repeat",displayActivate:"Repeats every",add_rules:"Add",edit_rules:"Edit",delete_rules:"Delete",add:"Add",refresh:"Refresh",title:"Repeat",preview:"Selected dates",addDate:"Add date",recurrenceType:"Repeats:",dailyInterval1:"Repeat every:",dailyInterval2:"days",weeklyInterval1:"Repeat every:",weeklyInterval2:"week(s)",weeklyWeekdays:"Repeat on:",weeklyWeekdaysHuman:"on:",monthlyInterval1:"Repeat every:",monthlyInterval2:"month(s)",monthlyDayOfMonth1:"Day",monthlyDayOfMonth1Human:"on day",monthlyDayOfMonth2:"of the month",monthlyDayOfMonth3:"month(s)",monthlyWeekdayOfMonth1:"The",monthlyWeekdayOfMonth1Human:"on the",monthlyWeekdayOfMonth2:"",monthlyWeekdayOfMonth3:"of the month",monthlyRepeatOn:"Repeat on:",yearlyInterval1:"Repeat every:",yearlyInterval2:"year(s)",yearlyDayOfMonth1:"Every",yearlyDayOfMonth1Human:"on",yearlyDayOfMonth2:"",yearlyDayOfMonth3:"",yearlyWeekdayOfMonth1:"The",yearlyWeekdayOfMonth1Human:"on the",yearlyWeekdayOfMonth2:"",yearlyWeekdayOfMonth3:"of",yearlyWeekdayOfMonth4:"",yearlyRepeatOn:"Repeat on:",range:"End recurrence:",rangeNoEnd:"Never",rangeByOccurrences1:"After",rangeByOccurrences1Human:"ends after",rangeByOccurrences2:"occurrence(s)",rangeByEndDate:"On",rangeByEndDateHuman:"ends on",including:", and also",except:", except for",cancel:"Cancel",save:"Save",recurrenceStart:"Start of the recurrence",additionalDate:"Additional date",include:"Include",exclude:"Exclude",remove:"Remove",orderIndexes:["first","second","third","fourth","last"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortWeekdays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longDateFormat:"mmmm dd, yyyy",shortDateFormat:"mm/dd/yyyy",unsupportedFeatures:"Warning: This event uses recurrence features not supported by this widget. Saving the recurrence may change the recurrence in unintended ways:",noTemplateMatch:"No matching recurrence template",multipleDayOfMonth:"This widget does not support multiple days in monthly or yearly recurrence",bysetpos:"BYSETPOS is not supported",noRule:"No RRULE in RRULE data",noRepeatEvery:'Error: The "Repeat every"-field must be between 1 and 1000',noEndDate:"Error: End date is not set. Please set a correct value",noRepeatOn:'Error: "Repeat on"-value must be selected',pastEndDate:"Error: End date cannot be before start date",noEndAfterNOccurrences:'Error: The "After N occurrences"-field must be between 1 and 1000',alreadyAdded:"This date was already added",rtemplate:{daily:"Daily",mondayfriday:"Monday and Friday",weekdays:"Weekday",weekly:"Weekly",monthly:"Monthly",yearly:"Yearly"}});var e=['<div class="rioccurrences">',"{{each occurrences}}",'<div class="occurrence ${occurrences[$index].type}">',"<span>","${occurrences[$index].formattedDate}",'{{if occurrences[$index].type === "start"}}','<span class="rlabel">${i18n.recurrenceStart}</span>',"{{/if}}",'{{if occurrences[$index].type === "rdate"}}','<span class="rlabel">${i18n.additionalDate}</span>',"{{/if}}","</span>","{{if !readOnly}}",'<span class="action">','{{if occurrences[$index].type === "rrule"}}','<a date="${occurrences[$index].date}" href="#"','class="${occurrences[$index].type}" title="${i18n.exclude}">',"${i18n.exclude}","</a>","{{/if}}",'{{if occurrences[$index].type === "rdate"}}','<a date="${occurrences[$index].date}" href="#"','class="${occurrences[$index].type}" title="${i18n.remove}" >',"${i18n.remove}","</a>","{{/if}}",'{{if occurrences[$index].type === "exdate"}}','<a date="${occurrences[$index].date}" href="#"','class="${occurrences[$index].type}" title="${i18n.include}">',"${i18n.include}","</a>","{{/if}}","</span>","{{/if}}","</div>","{{/each}}",'<div class="batching">',"{{each batch.batches}}",'{{if $index === batch.currentBatch}}<span class="current">{{/if}}','<a href="#" start="${batch.batches[$index][0]}">[${batch.batches[$index][0]} - ${batch.batches[$index][1]}]</a>',"{{if $index === batch.currentBatch}}</span>{{/if}}","{{/each}}","</div></div>"].join("\n");A.template("occurrenceTmpl",e);var t=['<div class="ridisplay">','<div class="rimain">',"{{if !readOnly}}",'<button name="riedit">${i18n.add_rules}</button>','<button name="ridelete" style="display:none">${i18n.delete_rules}</button>',"{{/if}}",'<label class="ridisplay">${i18n.displayUnactivate}</label>',"</div>",'<div class="rioccurrences" style="display:none" /></div>'].join("\n");A.template("displayTmpl",t);var n=['<div class="riform">',"<form>","<h1>${i18n.title}</h1>",'<div id="messagearea" style="display: none;">',"</div>",'<div id="rirtemplate">','<label for="${name}rtemplate" class="label">',"${i18n.recurrenceType}","</label>",'<select id="rirtemplate" name="rirtemplate" class="field">',"{{each rtemplate}}",'<option value="${$index}">${i18n.rtemplate[$index]}</value>',"{{/each}}","</select>","<div>",'<div id="riformfields">','<div id="ridailyinterval" class="rifield">','<label for="${name}dailyinterval" class="label">',"${i18n.dailyInterval1}","</label>",'<div class="field">','<input type="text" size="2"','value="1"','name="ridailyinterval"','id="${name}dailyinterval" />',"${i18n.dailyInterval2}","</div>","</div>",'<div id="riweeklyinterval" class="rifield">','<label for="${name}weeklyinterval" class="label">',"${i18n.weeklyInterval1}","</label>",'<div class="field">','<input type="text" size="2"','value="1"','name="riweeklyinterval"','id="${name}weeklyinterval"/>',"${i18n.weeklyInterval2}","</div>","</div>",'<div id="riweeklyweekdays" class="rifield">','<label for="${name}weeklyinterval" class="label">${i18n.weeklyWeekdays}</label>','<div class="field">',"{{each orderedWeekdays}}",'<div class="riweeklyweekday">','<input type="checkbox"','name="riweeklyweekdays${weekdays[$value]}"','id="${name}weeklyWeekdays${weekdays[$value]}"','value="${weekdays[$value]}" />','<label for="${name}weeklyWeekdays${weekdays[$value]}">${i18n.shortWeekdays[$value]}</label>',"</div>","{{/each}}","</div>","</div>",'<div id="rimonthlyinterval" class="rifield">','<label for="rimonthlyinterval" class="label">${i18n.monthlyInterval1}</label>','<div class="field">','<input type="text" size="2"','value="1" ','name="rimonthlyinterval"/>',"${i18n.monthlyInterval2}","</div>","</div>",'<div id="rimonthlyoptions" class="rifield">','<label for="rimonthlytype" class="label">${i18n.monthlyRepeatOn}</label>','<div class="field">',"<div>","<input",'type="radio"','value="DAYOFMONTH"','name="rimonthlytype"','id="${name}monthlytype:DAYOFMONTH" />','<label for="${name}monthlytype:DAYOFMONTH">',"${i18n.monthlyDayOfMonth1}","</label>",'<select name="rimonthlydayofmonthday"','id="${name}monthlydayofmonthday">',"{{each [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,","18,19,20,21,22,23,24,25,26,27,28,29,30,31]}}",'<option value="${$value}">${$value}</option>',"{{/each}}","</select>","${i18n.monthlyDayOfMonth2}","</div>","<div>","<input",'type="radio"','value="WEEKDAYOFMONTH"','name="rimonthlytype"','id="${name}monthlytype:WEEKDAYOFMONTH" />','<label for="${name}monthlytype:WEEKDAYOFMONTH">',"${i18n.monthlyWeekdayOfMonth1}","</label>",'<select name="rimonthlyweekdayofmonthindex">',"{{each i18n.orderIndexes}}",'<option value="${orderIndexes[$index]}">${$value}</option>',"{{/each}}","</select>","${i18n.monthlyWeekdayOfMonth2}",'<select name="rimonthlyweekdayofmonth">',"{{each orderedWeekdays}}",'<option value="${weekdays[$value]}">${i18n.weekdays[$value]}</option>',"{{/each}}","</select>","${i18n.monthlyWeekdayOfMonth3}","</div>","</div>","</div>",'<div id="riyearlyinterval" class="rifield">','<label for="riyearlyinterval" class="label">${i18n.yearlyInterval1}</label>','<div class="field">','<input type="text" size="2"','value="1" ','name="riyearlyinterval"/>',"${i18n.yearlyInterval2}","</div>","</div>",'<div id="riyearlyoptions" class="rifield">','<label for="riyearlyType" class="label">${i18n.yearlyRepeatOn}</label>','<div class="field">',"<div>","<input",'type="radio"','value="DAYOFMONTH"','name="riyearlyType"','id="${name}yearlytype:DAYOFMONTH" />','<label for="${name}yearlytype:DAYOFMONTH">',"${i18n.yearlyDayOfMonth1}","</label>",'<select name="riyearlydayofmonthmonth">',"{{each i18n.months}}",'<option value="${$index+1}">${$value}</option>',"{{/each}}","</select>","${i18n.yearlyDayOfMonth2}",'<select name="riyearlydayofmonthday">',"{{each [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,","18,19,20,21,22,23,24,25,26,27,28,29,30,31]}}",'<option value="${$value}">${$value}</option>',"{{/each}}","</select>","${i18n.yearlyDayOfMonth3}","</div>","<div>","<input",'type="radio"','value="WEEKDAYOFMONTH"','name="riyearlyType"','id="${name}yearlytype:WEEKDAYOFMONTH"/>','<label for="${name}yearlytype:WEEKDAYOFMONTH">',"${i18n.yearlyWeekdayOfMonth1}","</label>",'<select name="riyearlyweekdayofmonthindex">',"{{each i18n.orderIndexes}}",'<option value="${orderIndexes[$index]}">${$value}</option>',"{{/each}}","</select>",'<label for="${name}yearlytype:WEEKDAYOFMONTH">',"${i18n.yearlyWeekdayOfMonth2}","</label>",'<select name="riyearlyweekdayofmonthday">',"{{each orderedWeekdays}}",'<option value="${weekdays[$value]}">${i18n.weekdays[$value]}</option>',"{{/each}}","</select>","${i18n.yearlyWeekdayOfMonth3}",'<select name="riyearlyweekdayofmonthmonth">',"{{each i18n.months}}",'<option value="${$index+1}">${$value}</option>',"{{/each}}","</select>","${i18n.yearlyWeekdayOfMonth4}","</div>","</div>","</div>",'<div id="rirangeoptions" class="rifield">','<label class="label">${i18n.range}</label>','<div class="field">',"{{if hasRepeatForeverButton}}","<div>","<input",'type="radio"','value="NOENDDATE"','name="rirangetype"','id="${name}rangetype:NOENDDATE"/>','<label for="${name}rangetype:NOENDDATE">',"${i18n.rangeNoEnd}","</label>","</div>","{{/if}}","<div>","<input",'type="radio"','checked="checked"','value="BYOCCURRENCES"','name="rirangetype"','id="${name}rangetype:BYOCCURRENCES"/>','<label for="${name}rangetype:BYOCCURRENCES">',"${i18n.rangeByOccurrences1}","</label>","<input",'type="text" size="3"','value="7"','name="rirangebyoccurrencesvalue" />',"${i18n.rangeByOccurrences2}","</div>","<div>","<input",'type="radio"','value="BYENDDATE"','name="rirangetype"','id="${name}rangetype:BYENDDATE"/>','<label for="${name}rangetype:BYENDDATE">',"${i18n.rangeByEndDate}","</label>","<input",'type="date"','name="rirangebyenddatecalendar" />',"</div>","</div>","</div>","</div>",'<div class="rioccurrencesactions">','<div class="rioccurancesheader">',"<h2>${i18n.preview}</h2>",'<span class="refreshbutton action">','<a class="rirefreshbutton" href="#" title="${i18n.refresh}">',"${i18n.refresh}","</a>","</span>","</div>","</div>",'<div class="rioccurrences">',"</div>",'<div class="rioccurrencesactions">','<div class="rioccurancesheader">',"<h2>${i18n.addDate}</h2>","</div>",'<div class="riaddoccurrence">','<div class="errorarea"></div>','<input type="date" name="adddate" id="adddate" />','<input type="button" name="addaction" id="addaction" value="${i18n.add}">',"</div>","</div>",'<div class="ributtons">',"<input",'type="submit"','class="ricancelbutton ${ributtonExtraClass}"','value="${i18n.cancel}" />',"<input",'type="submit"','class="risavebutton ${ributtonExtraClass}"','value="${i18n.save}" />',"</div>","</form></div>"].join("\n");A.template("formTmpl",n);var l=/d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*'/g;function c(e,t){for(e=e.toString(),t=t||2;e.length<t;)e="0"+e;return e}function k(e,t,n){var i=e.getDate(),o=e.getDay(),a=e.getMonth(),r=e.getFullYear(),s={d:i,dd:c(i),ddd:n.i18n.shortWeekdays[o],dddd:n.i18n.weekdays[o],m:a+1,mm:c(a+1),mmm:n.i18n.shortMonths[a],mmmm:n.i18n.months[a],yy:String(r).slice(2),yyyy:r};return t.replace(l,function(e){return s.hasOwnProperty(e)?s[e]:e.slice(1,e.length-1)})}function x(e,t,n){var i,o,a,r,s,l,c,d,u,h,p,f,m=e.find("select[name=rirtemplate]").val(),g=t.rtemplate[m],v=g.rrule,y=t.i18n.rtemplate[m];for(r=0;r<g.fields.length;r++)switch((i=e.find("#"+g.fields[r])).attr("id")){case"ridailyinterval":"1"!==(p=i.find("input[name=ridailyinterval]").val())&&(v+=";INTERVAL="+p),y=p+" "+t.i18n.dailyInterval2;break;case"riweeklyinterval":"1"!==(p=i.find("input[name=riweeklyinterval]").val())&&(v+=";INTERVAL="+p),y=p+" "+t.i18n.weeklyInterval2;break;case"riweeklyweekdays":for(a=o="",s=0;s<t.weekdays.length;s++)i.find("input[name=riweeklyweekdays"+t.weekdays[s]+"]").is(":checked")&&(o&&(o+=",",a+=", "),o+=t.weekdays[s],a+=t.i18n.weekdays[s]);o&&(v+=";BYDAY="+o,y+=" "+t.i18n.weeklyWeekdaysHuman+" "+a);break;case"rimonthlyinterval":"1"!==(p=i.find("input[name=rimonthlyinterval]").val())&&(v+=";INTERVAL="+p),y=p+" "+t.i18n.monthlyInterval2;break;case"rimonthlyoptions":switch(A("input[name=rimonthlytype]:checked",e).val()){case"DAYOFMONTH":v+=";BYMONTHDAY="+(d=A("select[name=rimonthlydayofmonthday]",e).val()),y+=", "+t.i18n.monthlyDayOfMonth1Human+" "+d+" "+t.i18n.monthlyDayOfMonth2;break;case"WEEKDAYOFMONTH":l=A("select[name=rimonthlyweekdayofmonthindex]",e).val(),d=A("select[name=rimonthlyweekdayofmonth]",e).val(),-1<A.inArray(d,["MO","TU","WE","TH","FR","SA","SU"])&&(v+=";BYDAY="+l+d,y+=", "+t.i18n.monthlyWeekdayOfMonth1Human+" ",y+=" "+t.i18n.orderIndexes[A.inArray(l,t.orderIndexes)],y+=" "+t.i18n.monthlyWeekdayOfMonth2,y+=" "+t.i18n.weekdays[A.inArray(d,t.weekdays)],y+=" "+t.i18n.monthlyDayOfMonth2)}break;case"riyearlyinterval":"1"!==(p=i.find("input[name=riyearlyinterval]").val())&&(v+=";INTERVAL="+p),y=p+" "+t.i18n.yearlyInterval2;break;case"riyearlyoptions":switch(A("input[name=riyearlyType]:checked",e).val()){case"DAYOFMONTH":v+=";BYMONTH="+(u=A("select[name=riyearlydayofmonthmonth]",e).val()),v+=";BYMONTHDAY="+(d=A("select[name=riyearlydayofmonthday]",e).val()),y+=", "+t.i18n.yearlyDayOfMonth1Human+" "+t.i18n.months[u-1]+" "+d;break;case"WEEKDAYOFMONTH":l=A("select[name=riyearlyweekdayofmonthindex]",e).val(),d=A("select[name=riyearlyweekdayofmonthday]",e).val(),v+=";BYMONTH="+(u=A("select[name=riyearlyweekdayofmonthmonth]",e).val()),-1<A.inArray(d,["MO","TU","WE","TH","FR","SA","SU"])&&(v+=";BYDAY="+l+d,y+=", "+t.i18n.yearlyWeekdayOfMonth1Human,y+=" "+t.i18n.orderIndexes[A.inArray(l,t.orderIndexes)],y+=" "+t.i18n.yearlyWeekdayOfMonth2,y+=" "+t.i18n.weekdays[A.inArray(d,t.weekdays)],y+=" "+t.i18n.yearlyWeekdayOfMonth3,y+=" "+t.i18n.months[u-1],y+=" "+t.i18n.yearlyWeekdayOfMonth4)}break;case"rirangeoptions":switch(e.find("input[name=rirangetype]:checked").val()){case"BYOCCURRENCES":v+=";COUNT="+(f=e.find("input[name=rirangebyoccurrencesvalue]").val()),y+=", "+t.i18n.rangeByOccurrences1Human,y+=" "+f,y+=" "+t.i18n.rangeByOccurrences2;break;case"BYENDDATE":v+=";UNTIL="+(i=e.find("input[name=rirangebyenddatecalendar]")).data("dateinput").getValue("yyyymmdd")+"T000000",!0===n&&(v+="Z"),y+=", "+t.i18n.rangeByEndDateHuman,y+=" "+i.data("dateinput").getValue(t.i18n.longDateFormat)}}if(void 0!==e.ical.RDATE&&0<e.ical.RDATE.length){for(e.ical.RDATE.sort(),c=[],r=0;r<e.ical.RDATE.length;r++)""!==e.ical.RDATE[r]&&(h=parseInt(e.ical.RDATE[r].substring(0,4),10),u=parseInt(e.ical.RDATE[r].substring(4,6),10)-1,d=parseInt(e.ical.RDATE[r].substring(6,8),10),c.push(k(new Date(h,u,d),t.i18n.longDateFormat,t)));0!==c.length&&(y=y+t.i18n.including+" "+c.join("; "))}if(void 0!==e.ical.EXDATE&&0<e.ical.EXDATE.length){for(e.ical.EXDATE.sort(),c=[],r=0;r<e.ical.EXDATE.length;r++)""!==e.ical.EXDATE[r]&&(h=parseInt(e.ical.EXDATE[r].substring(0,4),10),u=parseInt(e.ical.EXDATE[r].substring(4,6),10)-1,d=parseInt(e.ical.EXDATE[r].substring(6,8),10),c.push(k(new Date(h,u,d),t.i18n.longDateFormat,t)));0!==c.length&&(y=y+t.i18n.except+" "+c.join("; "))}return v="RRULE:"+v,void 0!==e.ical.EXDATE&&""!==e.ical.EXDATE.join()&&(v=v+"\nEXDATE:"+(c=A.map(e.ical.EXDATE,function(e){return 8===e.length&&(e+="T000000"),!0===n&&(e+="Z"),e}))),void 0!==e.ical.RDATE&&""!==e.ical.RDATE.join()&&(v=v+"\nRDATE:"+(c=A.map(e.ical.RDATE,function(e){return 8===e.length&&(e+="T000000"),!0===n&&(e+="Z"),e}))),{result:v,description:y}}function I(e){var t,n=[],i=e.split(",");for(t in i)i.hasOwnProperty(t)&&(-1!==i[t].indexOf("Z")?n.push(i[t].substring(0,15)):n.push(i[t]));return n}function S(e,t,n,i){var o,a,r,s,l,c,d,u,h,p,f,m,g,v,y,b,w,k,x,S,T,E=[];if(e.ical=function(e){var t,n,i,o,a,r=[],s={},l=null;for((r=e.split("\n")).reverse();;){if(0<r.length){if(" "===(t=r.pop()).charAt(0)||"\t"===t.charAt(0)){l+=t;continue}}else t="";if(null!==l&&(a=o=i=void 0,i={},o=(n=l).indexOf(":"),a=n.substring(0,o),i.value=n.substring(o+1),-1!==a.indexOf(";")?(o=a.indexOf(";"),i.parameters=a.substring(o+1),i.property=a.substring(0,o)):(i.parameters=null,i.property=a),"RDATE"===(l=i).property||"EXDATE"===l.property?s[l.property]=I(l.value):s[l.property]=l.value),""===(l=t))break}return s}(n),void 0===e.ical.RRULE){if(E.push(t.i18n.noRule),!i)return-1}else{for(o in m=(a=/INTERVAL=([0-9]+);?/.exec(e.ical.RRULE))?a[1]:"1",g=(a=/BYDAY=([^;]+);?/.exec(e.ical.RRULE))?a[1]:"",y=(a=/BYMONTHDAY=([^;]+);?/.exec(e.ical.RRULE))?a[1].split(","):null,v=(a=/BYMONTH=([^;]+);?/.exec(e.ical.RRULE))?a[1].split(","):null,b=(a=/COUNT=([0-9]+);?/.exec(e.ical.RRULE))?a[1]:null,w=(a=/UNTIL=([0-9T]+);?/.exec(e.ical.RRULE))?a[1]:null,(a=/BYSETPOS=([^;]+);?/.exec(e.ical.RRULE))&&E.push(t.i18n.bysetpos),r="",s=null,t.rtemplate)t.rtemplate.hasOwnProperty(o)&&(l=t.rtemplate[o],0===e.ical.RRULE.indexOf(l.rrule)&&e.ical.RRULE.length>r.length&&(r=e.ical.RRULE,s=o));if(r)l=t.rtemplate[s],e.find("select[name=rirtemplate]").val(s);else{for(l in t.rtemplate)if(t.rtemplate.hasOwnProperty(l)){l=t.rtemplate[l];break}E.push(t.i18n.noTemplateMatch)}for(o=0;o<l.fields.length;o++)switch((p=e.find("#"+l.fields[o])).attr("id")){case"ridailyinterval":p.find("input[name=ridailyinterval]").val(m);break;case"riweeklyinterval":p.find("input[name=riweeklyinterval]").val(m);break;case"riweeklyweekdays":for(g=g.split(","),c=0;c<t.weekdays.length;c++)k=t.weekdays[c],(d=p.find("input[name=riweeklyweekdays"+k+"]")).attr("checked",-1!==A.inArray(k,g));break;case"rimonthlyinterval":p.find("input[name=rimonthlyinterval]").val(m);break;case"rimonthlyoptions":var C="DAYOFMONTH";for(y&&(C="DAYOFMONTH",1<y.length&&(E.push(t.i18n.multipleDayOfMonth),y=y[0]),p.find("select[name=rimonthlydayofmonthday]").val(y)),g&&(C="WEEKDAYOFMONTH",-1!==g.indexOf(",")&&(E.push(t.i18n.multipleDayOfMonth),g=g.split(",")[0]),"+"!==(u=g.slice(0,-2)).charAt(0)&&"-"!==u.charAt(0)&&(u="+"+u),T=g.slice(-2),p.find("select[name=rimonthlyweekdayofmonthindex]").val(u),p.find("select[name=rimonthlyweekdayofmonth]").val(T)),h=p.find("input[name=rimonthlytype]"),u=0;u<h.length;u++)f=h[u],A(f).attr("checked",f.value===C);break;case"riyearlyinterval":p.find("input[name=riyearlyinterval]").val(m);break;case"riyearlyoptions":var D="DAYOFMONTH";for(y&&(D="DAYOFMONTH",1<y.length&&(E.push(t.i18n.multipleDayOfMonth),y=y[0]),p.find("select[name=riyearlydayofmonthmonth]").val(v),p.find("select[name=riyearlydayofmonthday]").val(y)),g&&(D="WEEKDAYOFMONTH",-1!==g.indexOf(",")&&(E.push(t.i18n.multipleDayOfMonth),g=g.split(",")[0]),"+"!==(u=g.slice(0,-2)).charAt(0)&&"-"!==u.charAt(0)&&(u="+"+u),T=g.slice(-2),p.find("select[name=riyearlyweekdayofmonthindex]").val(u),p.find("select[name=riyearlyweekdayofmonthday]").val(T),p.find("select[name=riyearlyweekdayofmonthmonth]").val(v)),h=p.find("input[name=riyearlyType]"),u=0;u<h.length;u++)f=h[u],A(f).attr("checked",f.value===D);break;case"rirangeoptions":var O="NOENDDATE";for(b&&(O="BYOCCURRENCES",p.find("input[name=rirangebyoccurrencesvalue]").val(b)),w&&(O="BYENDDATE",d=p.find("input[name=rirangebyenddatecalendar]"),S=w.slice(0,4),x=w.slice(4,6),x=parseInt(x,10)-1,k=w.slice(6,8),d.data("dateinput").setValue(new Date(S,x,k))),h=p.find("input[name=rirangetype]"),u=0;u<h.length;u++)f=h[u],A(f).attr("checked",f.value===O)}}var $=e.find("#messagearea");return 0!==E.length?($.text(t.i18n.unsupportedFeatures+" "+E.join("; ")),$.show(),1):($.text(""),$.hide(),0)}function i(f,n){var m,g,e,t,i=[];for(t=0;t<7;t++)6<(e=t+f.firstDay)&&(e-=7),i.push(e);function o(e){var t;m.find(".rifield").hide();var n=e.val();if(n){var i=f.rtemplate[n];for(t=0;t<i.fields.length;t++)m.find("#"+i.fields[t]).show()}}function v(e){e.preventDefault(),void 0===m.ical.EXDATE&&(m.ical.EXDATE=[]),m.ical.EXDATE.push(this.attributes.date.value);var t=A(this);t.attr("class","exdate"),t.parent().parent().addClass("exdate"),t.unbind(e),t.click(y)}function y(e){e.preventDefault(),m.ical.EXDATE.splice(A.inArray(this.attributes.date.value,m.ical.EXDATE),1);var t=A(this);t.attr("class","rrule"),t.parent().parent().removeClass("exdate"),t.unbind(e),t.click(v)}function b(e){e.preventDefault(),m.ical.RDATE.splice(A.inArray(this.attributes.date.value,m.ical.RDATE),1),A(this).parent().parent().hide("slow",function(){A(this).remove()})}function w(u,h,e,p){(p?g:m).find(".rioccurrences").hide();var t={year:u.getFullYear(),month:u.getMonth()+1,day:u.getDate(),rrule:h,format:f.i18n.longDateFormat,start:e},n={url:f.ajaxURL,async:!1,type:"post",dataType:"json",contentType:f.ajaxContentType,cache:!1,data:t,success:function(e,t,n){var i,o,a,r,s,l,c,d;for(d in o=p?g:m,e.readOnly=p,e.i18n=f.i18n,e.occurrences)e.occurrences.hasOwnProperty(d)&&(r=(a=e.occurrences[d]).date,s=parseInt(r.substring(0,4),10),l=parseInt(r.substring(4,6),10)-1,c=parseInt(r.substring(6,8),10),a.formattedDate=k(new Date(s,l,c),f.i18n.longDateFormat,f));i=A.tmpl("occurrenceTmpl",e),o.find(".rioccurrences").replaceWith(i),o.find(".rioccurrences .batching a").click(function(e){e.preventDefault(),w(u,h,this.attributes.start.value,p)}),p||(o.find(".rioccurrences .action a.rrule").click(v),o.find(".rioccurrences .action a.exdate").click(y),o.find(".rioccurrences .action a.rdate").click(b)),o.find(".rioccurrences").show()},error:function(e,t,n){alert(t)}};A.ajax(n)}function a(e){var t=A(e);return t.length||(t=A("#"+e)),t.length||(t=A("input[name='"+e+"']")),t}function s(){var e,t,n,i,o=null;if(f.startField){if(!(e=a(f.startField)).length)return null;(o=e.data("dateinput"))?o=o.getValue():""===(o=e.val())&&(o=e.text()),"string"==typeof o&&(o=o.replace(" ","T")),o=new Date(o)}else if(f.startFieldYear&&f.startFieldMonth&&f.startFieldDay){if(t=a(f.startFieldYear),n=a(f.startFieldMonth),i=a(f.startFieldDay),!t.length&&!n.length&&!i.length)return null;o=new Date(t.val(),n.val()-1,i.val())}return null===o||isNaN(o)?null:o}function l(e,t){var n,i;return i=(n=t.find("input[name="+e+"]")).val(),isNaN(i)||-1!==i.toString().indexOf(".")||""===n.val()?null:i}function r(e){var t,n,i;e&&S(m,f,e,!0),null!==(t=s())?(m.find("select[name=rimonthlydayofmonthday]").val(t.getDate()),n=f.orderIndexes[Math.floor((t.getDate()-1)/7)],i=f.weekdays[t.getDay()],m.find("select[name=rimonthlyweekdayofmonthindex]").val(n),m.find("select[name=rimonthlyweekdayofmonth]").val(i),m.find("select[name=riyearlydayofmonthmonth]").val(t.getMonth()+1),m.find("select[name=riyearlydayofmonthday]").val(t.getDate()),m.find("select[name=riyearlyweekdayofmonthindex]").val(n),m.find("select[name=riyearlyweekdayofmonthday]").val(i),m.find("select[name=riyearlyweekdayofmonthmonth]").val(t.getMonth()+1),w(t,x(m,f,!1).result,0,!1),m.find("div.rioccurrencesactions").show()):m.find("div.rioccurrencesactions").hide(),o(m.find("select[name=rirtemplate]"))}function c(){var e=x(m,f,!1);g.find("label[class=ridisplay]").text(f.i18n.displayActivate+" "+e.description),n.val(e.result).change();var t=s();null!==t&&w(t,x(m,f,!1).result,0,!0),g.find('button[name="riedit"]').text(f.i18n.edit_rules),g.find('button[name="ridelete"]').show()}function d(e){var t,n,i,o;if(t=s(),(o=e.find("#messagearea")).text(""),o.hide(),e.find(".riaddoccurrence div.errorarea").text("").hide(),"block"===e.find("#ridailyinterval").css("display")&&(!(i=l("ridailyinterval",e))||i<1||1e3<i))o.text(f.i18n.noRepeatEvery).show();else if("block"===e.find("#riweeklyinterval").css("display")&&(!(i=l("riweeklyinterval",e))||i<1||1e3<i))o.text(f.i18n.noRepeatEvery).show();else{if("block"===e.find("#rimonthlyinterval").css("display")){if(!(i=l("rimonthlyinterval",e))||i<1||1e3<i)return void o.text(f.i18n.noRepeatEvery).show();if(0===e.find("#rimonthlyoptions input:checked").length)return void o.text(f.i18n.noRepeatOn).show()}if("block"===e.find("#riyearlyinterval").css("display")){if(!(i=l("riyearlyinterval",e))||i<1||1e3<i)return void o.text(f.i18n.noRepeatEvery).show();if(0===e.find("#riyearlyoptions input:checked").length)return void o.text(f.i18n.noRepeatOn).show()}if(!(0<e.find('input[value="BYOCCURRENCES"]:visible:checked').length&&(!(i=l("rirangebyoccurrencesvalue",e))||i<1||1e3<i))){if(0<e.find('input[value="BYENDDATE"]:visible:checked').length){if(r=(r=(a=e.find("input[name=rirangebyenddatecalendar]")).data("dateinput"))?r.getValue():a.val(),r=new Date(r),!(n=isNaN(r)||""===a.val()?null:r))return void o.text(f.i18n.noEndDate).show();if(n<t)return void o.text(f.i18n.pastEndDate).show()}var a,r;return 1}o.text(f.i18n.noEndAfterNOccurrences).show()}}function u(e){e.preventDefault(),d(m)&&(m.overlay().close(),c())}function h(){var e;e=s(),d(m)&&w(e,x(m,f,!1).result,0,!1)}A.extend(f,{orderIndexes:["+1","+2","+3","+4","-1"],weekdays:["SU","MO","TU","WE","TH","FR","SA"],orderedWeekdays:i}),g=A.tmpl("displayTmpl",f),(m=A.tmpl("formTmpl",f)).overlay(f.formOverlay).hide(),m.ical={RDATE:[],EXDATE:[]},A.tools.dateinput.localize(f.lang,{months:p[f.lang].months.join(),shortMonths:p[f.lang].shortMonths.join(),days:p[f.lang].weekdays.join(),shortDays:p[f.lang].shortWeekdays.join()}),m.find("input[name=rirangebyenddatecalendar]").dateinput({selectors:!0,lang:f.lang,format:f.i18n.shortDateFormat,firstDay:f.firstDay,yearRange:[-5,10]}).data("dateinput").setValue(new Date),n.val()&&(-1===S(m,f,n.val(),!1)?g.find("label[class=ridisplay]").text(f.i18n.noRule):c());g.find("button[name=ridelete]").click(function(e){e.preventDefault(),g.find("label[class=ridisplay]").text(f.i18n.displayUnactivate),n.val("").change(),g.find(".rioccurrences").hide(),g.find('button[name="riedit"]').text(f.i18n.add_rules),g.find('button[name="ridelete"]').hide()}),g.find("button[name=riedit]").click(function(e){r(n.val()),e.preventDefault(),m.overlay().load()}),m.find("div.riaddoccurrence input#adddate").dateinput({selectors:!0,lang:f.lang,format:f.i18n.shortDateFormat,firstDay:f.firstDay,yearRange:[-5,10]}).data("dateinput").setValue(new Date),m.find("input#addaction").click(function(e){e.preventDefault();var t=m.find(".riaddoccurrence input#adddate").data("dateinput"),n=t.getValue("yyyymmddT000000");void 0===m.ical.RDATE&&(m.ical.RDATE=[]);var i=m.find(".riaddoccurrence div.errorarea");if(i.text(""),i.hide(),-1===A.inArray(n,m.ical.RDATE)){m.ical.RDATE.push(n);var o=['<div class="occurrence rdate" style="display: none;">','<span class="rdate">',t.getValue(f.i18n.longDateFormat),'<span class="rlabel">'+f.i18n.additionalDate+"</span>","</span>",'<span class="action">','<a date="'+n+'" href="#" class="rdate" >',"Include","</a>","</span>","</div>"].join("\n");m.find("div.rioccurrences").prepend(o),A(m.find("div.rioccurrences div")[0]).slideDown(),A(m.find("div.rioccurrences .action a.rdate")[0]).click(b)}else i.text(f.i18n.alreadyAdded).show()}),m.find("a.rirefreshbutton").click(function(e){e.preventDefault(),h()}),m.find("select[name=rirtemplate]").change(function(e){o(A(this))}),m.find("select").change(function(e){A(this).parent().find("> input").click().change()}),m.find("input[name=rirangebyoccurrencesvalue]").change(function(e){A(this).parent().find("input[name=rirangetype]").click().change()}),m.find("input[name=rirangebyenddatecalendar]").change(function(){A(this).parent().find("input[name=rirangetype]").click(),0!==m.find(".rioccurrencesactions:visible").length&&h()}),m.find("input:radio, .riweeklyweekday > input, input[name=ridailyinterval], input[name=riweeklyinterval], input[name=rimonthlyinterval], input[name=riyearlyinterval]").change(function(e){0!==m.find(".rioccurrencesactions:visible").length&&h()}),m.find(".ricancelbutton").click(function(e){e.preventDefault(),m.overlay().close()}),m.find(".risavebutton").click(u),A.extend(this,{display:g,form:m,loadData:r,save:u})}A.fn.recurrenceinput=function(e){if(this.data("recurrenceinput"))return this.data("recurrenceinput");var t=A.extend({},o.conf);A.extend(t,e),A.extend(t,{i18n:p[t.lang],name:this.attr("name")});var n=new i(t,this);return n.form.appendTo("body"),this.after(n.display),this.hide(),this.data("recurrenceinput",n),n}}(jQuery)}.apply(e,arguments)})}(this),define("mockup-patterns-recurrence",["jquery","pat-base","jquery.recurrenceinput"],function(e,t){"use strict";return t.extend({name:"recurrence",trigger:".pat-recurrence",parser:"mockup",defaults:{language:"en",localization:null,configuration:{}},init:function(){this.$el.addClass("recurrence-widget"),this.options.localization&&e.tools.recurrenceinput.localize(this.options.language,this.options.localization),this.$el.recurrenceinput(this.options.configuration)}})}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("sortable",t):(e=e||self).Sortable=t()}(this,function(){function U(){return(U=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function e(e){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var w=e(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),k=e(/Edge/i),c=e(/firefox/i),d=e(/safari/i)&&!e(/chrome/i)&&!e(/android/i),t=e(/iP(ad|od|hone)/i),n=e(/chrome/i)&&e(/android/i),i={capture:!1,passive:!1};function u(e,t,n){e.addEventListener(t,n,!w&&i)}function a(e,t,n){e.removeEventListener(t,n,!w&&i)}function r(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(e){return}}else;}function H(e,t,n,i){if(e){n=n||document;do{if(null!=t&&(">"!==t[0]||e.parentNode===n)&&r(e,t)||i&&e===n)return e;if(e===n)break}while(e=(o=e).host&&o!==document&&o.host.nodeType?o.host:o.parentNode)}var o;return null}var o,s=/\s+/g;function z(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var i=(" "+e.className+" ").replace(s," ").replace(" "+t+" "," ");e.className=(i+(n?" "+t:"")).replace(s," ")}}function W(e,t,n){var i=e&&e.style;if(i){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),void 0===t?n:n[t];t in i||-1!==t.indexOf("webkit")||(t="-webkit-"+t),i[t]=n+("string"==typeof n?"":"px")}}function g(e,t){var n="";if("string"==typeof e)n=e;else do{var i=W(e,"transform");i&&"none"!==i&&(n=i+" "+n)}while(!t&&(e=e.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(n)}function h(e,t,n){if(e){var i=e.getElementsByTagName(t),o=0,a=i.length;if(n)for(;o<a;o++)n(i[o],o);return i}return[]}function I(){return document.scrollingElement||document.documentElement}function Y(e,t,n,i,o){if(e.getBoundingClientRect||e===window){var a,r,s,l,c,d,u;if(u=e!==window&&e!==I()?(r=(a=e.getBoundingClientRect()).top,s=a.left,l=a.bottom,c=a.right,d=a.height,a.width):(s=r=0,l=window.innerHeight,c=window.innerWidth,d=window.innerHeight,window.innerWidth),(t||n)&&e!==window&&(o=o||e.parentNode,!w))do{if(o&&o.getBoundingClientRect&&("none"!==W(o,"transform")||n&&"static"!==W(o,"position"))){var h=o.getBoundingClientRect();r-=h.top+parseInt(W(o,"border-top-width")),s-=h.left+parseInt(W(o,"border-left-width")),l=r+a.height,c=s+a.width;break}}while(o=o.parentNode);if(i&&e!==window){var p=g(o||e),f=p&&p.a,m=p&&p.d;p&&(l=(r/=m)+(d/=m),c=(s/=f)+(u/=f))}return{top:r,left:s,bottom:l,right:c,width:u,height:d}}}function B(e,t,n){for(var i=_(e,!0),o=Y(e)[t];i;){var a=Y(i)[n];if(!("top"===n||"left"===n?a<=o:o<=a))return i;if(i===I())break;i=_(i,!1)}return!1}function p(e,t,n){for(var i=0,o=0,a=e.children;o<a.length;){if("none"!==a[o].style.display&&a[o]!==Ie.ghost&&a[o]!==Ie.dragged&&H(a[o],n.draggable,e,!1)){if(i===t)return a[o];i++}o++}return null}function q(e,t){for(var n=e.lastElementChild;n&&(n===Ie.ghost||"none"===W(n,"display")||t&&!r(n,t));)n=n.previousElementSibling;return n||null}function V(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"===e.nodeName.toUpperCase()||e===Ie.clone||t&&!r(e,t)||n++;return n}function f(e){var t=0,n=0,i=I();if(e)do{var o=g(e);t+=e.scrollLeft*o.a,n+=e.scrollTop*o.d}while(e!==i&&(e=e.parentNode));return[t,n]}function _(e,t){if(!e||!e.getBoundingClientRect)return I();var n=e,i=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var o=W(n);if(n.clientWidth<n.scrollWidth&&("auto"==o.overflowX||"scroll"==o.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==o.overflowY||"scroll"==o.overflowY)){if(!n.getBoundingClientRect||n===document.body)return I();if(i||t)return n;i=!0}}}while(n=n.parentNode);return I()}function v(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function l(t,n){return function(){if(!o){var e=arguments;1===e.length?t.call(this,e[0]):t.apply(this,e),o=setTimeout(function(){o=void 0},n)}}}function X(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function m(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}function y(e,t){W(e,"position","absolute"),W(e,"top",t.top),W(e,"left",t.left),W(e,"width",t.width),W(e,"height",t.height)}function b(e){W(e,"position",""),W(e,"top",""),W(e,"left",""),W(e,"width",""),W(e,"height","")}var K="Sortable"+(new Date).getTime(),x=[],S={initializeByDefault:!0},T={mount:function(e){for(var t in S)!S.hasOwnProperty(t)||t in e||(e[t]=S[t]);x.push(e)},pluginEvent:function(t,n,i){var e=this;this.eventCanceled=!1,i.cancel=function(){e.eventCanceled=!0};var o=t+"Global";x.forEach(function(e){n[e.pluginName]&&(n[e.pluginName][o]&&n[e.pluginName][o](U({sortable:n},i)),n.options[e.pluginName]&&n[e.pluginName][t]&&n[e.pluginName][t](U({sortable:n},i)))})},initializePlugins:function(i,o,a,e){for(var t in x.forEach(function(e){var t=e.pluginName;if(i.options[t]||e.initializeByDefault){var n=new e(i,o,i.options);n.sortable=i,n.options=i.options,i[t]=n,Object.assign(a,n.defaults)}}),i.options)if(i.options.hasOwnProperty(t)){var n=this.modifyOption(i,t,i.options[t]);void 0!==n&&(i.options[t]=n)}},getEventProperties:function(t,n){var i={};return x.forEach(function(e){"function"==typeof e.eventProperties&&Object.assign(i,e.eventProperties.call(n[e.pluginName],t))}),i},modifyOption:function(t,n,i){var o;return x.forEach(function(e){t[e.pluginName]&&e.optionListeners&&"function"==typeof e.optionListeners[n]&&(o=e.optionListeners[n].call(t[e.pluginName],i))}),o}};function E(e){var t=e.sortable,n=e.rootEl,i=e.name,o=e.targetEl,a=e.cloneEl,r=e.toEl,s=e.fromEl,l=e.oldIndex,c=e.newIndex,d=e.oldDraggableIndex,u=e.newDraggableIndex,h=e.originalEvent,p=e.putSortable,f=e.extraEventProperties;if(t=t||n&&n[K]){var m,g=t.options,v="on"+i.charAt(0).toUpperCase()+i.substr(1);!window.CustomEvent||w||k?(m=document.createEvent("Event")).initEvent(i,!0,!0):m=new CustomEvent(i,{bubbles:!0,cancelable:!0}),m.to=r||n,m.from=s||n,m.item=o||n,m.clone=a,m.oldIndex=l,m.newIndex=c,m.oldDraggableIndex=d,m.newDraggableIndex=u,m.originalEvent=h,m.pullMode=p?p.lastPutMode:void 0;var y=U({},f,T.getEventProperties(i,t));for(var b in y)m[b]=y[b];n&&n.dispatchEvent(m),g[v]&&g[v].call(t,m)}}function G(e,t,n){var i=void 0===n?{}:n,o=i.evt,a=function(e,t){if(null==e)return{};var n,i,o={},a=Object.keys(e);for(i=0;i<a.length;i++)0<=t.indexOf(n=a[i])||(o[n]=e[n]);return o}(i,["evt"]);T.pluginEvent.bind(Ie)(e,t,U({dragEl:Q,parentEl:Z,ghostEl:ee,rootEl:te,nextEl:ne,lastDownEl:C,cloneEl:D,cloneHidden:O,dragStarted:L,putSortable:re,activeSortable:Ie.active,originalEvent:o,oldIndex:$,oldDraggableIndex:A,newIndex:ie,newDraggableIndex:oe,hideGhostForTarget:Ce,unhideGhostForTarget:De,cloneNowHidden:function(){O=!0},cloneNowShown:function(){O=!1},dispatchSortableEvent:function(e){J({sortable:t,name:e,originalEvent:o})}},a))}function J(e){E(U({putSortable:re,cloneEl:D,targetEl:Q,rootEl:te,oldIndex:$,oldDraggableIndex:A,newIndex:ie,newDraggableIndex:oe},e))}var Q,Z,ee,te,ne,C,D,O,$,ie,A,oe,ae,re,M,R,N,P,j,F,L,se,le,ce,de,ue=!1,he=!1,pe=[],fe=!1,me=!1,ge=[],ve=!1,ye=[],be="undefined"!=typeof document,we=t,ke=k||w?"cssFloat":"float",xe=be&&!n&&!t&&"draggable"in document.createElement("div"),Se=function(){if(be){if(w)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),Te=function(e,t){var n=W(e),i=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),o=p(e,0,t),a=p(e,1,t),r=o&&W(o),s=a&&W(a),l=r&&parseInt(r.marginLeft)+parseInt(r.marginRight)+Y(o).width,c=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+Y(a).width;return"flex"===n.display?"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal":"grid"===n.display?n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal":o&&r.float&&"none"!==r.float?!a||"both"!==s.clear&&s.clear!==("left"===r.float?"left":"right")?"horizontal":"vertical":o&&("block"===r.display||"flex"===r.display||"table"===r.display||"grid"===r.display||i<=l&&"none"===n[ke]||a&&"none"===n[ke]&&i<l+c)?"vertical":"horizontal"},Ee=function(e){function s(a,r){return function(e,t,n,i){if(null==a&&(r||e.options.group.name&&t.options.group.name&&e.options.group.name===t.options.group.name))return!0;if(null==a||!1===a)return!1;if(r&&"clone"===a)return a;if("function"==typeof a)return s(a(e,t,n,i),r)(e,t,n,i);var o=(r?e:t).options.group.name;return!0===a||"string"==typeof a&&a===o||a.join&&-1<a.indexOf(o)}}var t={},n=e.group;n&&"object"==typeof n||(n={name:n}),t.name=n.name,t.checkPull=s(n.pull,!0),t.checkPut=s(n.put),t.revertClone=n.revertClone,e.group=t},Ce=function(){!Se&&ee&&W(ee,"display","none")},De=function(){!Se&&ee&&W(ee,"display","")};be&&document.addEventListener("click",function(e){if(he)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),he=!1},!0);function Oe(e){if(Q){var t=(o=(e=e.touches?e.touches[0]:e).clientX,a=e.clientY,pe.some(function(e){if(!q(e)){var t=Y(e),n=e[K].options.emptyInsertThreshold;return n&&o>=t.left-n&&o<=t.right+n&&a>=t.top-n&&a<=t.bottom+n?r=e:void 0}}),r);if(t){var n={};for(var i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);n.target=n.rootEl=t,n.preventDefault=void 0,n.stopPropagation=void 0,t[K]._onDragOver(n)}}var o,a,r}function $e(e){Q&&Q.parentNode[K]._isOutsideThisEl(e.target)}var Ae;function Ie(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not "+{}.toString.call(e);this.el=e,this.options=t=Object.assign({},t),e[K]=this;var n,i,o={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Te(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Ie.supportPointer&&"PointerEvent"in window,emptyInsertThreshold:5};for(var a in T.initializePlugins(this,e,o),o)a in t||(t[a]=o[a]);for(var r in Ee(t),this)"_"===r.charAt(0)&&"function"==typeof this[r]&&(this[r]=this[r].bind(this));this.nativeDraggable=!t.forceFallback&&xe,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?u(e,"pointerdown",this._onTapStart):(u(e,"mousedown",this._onTapStart),u(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(u(e,"dragover",this),u(e,"dragenter",this)),pe.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),Object.assign(this,(i=[],{captureAnimationState:function(){i=[],this.options.animation&&[].slice.call(this.el.children).forEach(function(e){if("none"!==W(e,"display")&&void 0!==e){i.push({target:e,rect:Y(e)});var t=U({},i[i.length-1].rect);if(e.thisAnimationDuration){var n=g(e,!0);n&&(t.top-=n.f,t.left-=n.e)}e.fromRect=t}})},addAnimationState:function(e){i.push(e)},removeAnimationState:function(e){i.splice(function(e,t){for(var n in e)if(e.hasOwnProperty(n))for(var i in t)if(t.hasOwnProperty(i)&&t[i]===e[n][i])return Number(n);return-1}(i,{target:e}),1)},animateAll:function(e){var p=this;if(!this.options.animation)return clearTimeout(n),void("function"==typeof e&&e());var f=!1,m=0;i.forEach(function(e){var t,n,i,o,a=0,r=e.target,s=r.fromRect,l=Y(r),c=r.prevFromRect,d=r.prevToRect,u=e.rect,h=g(r,!0);h&&(l.top-=h.f,l.left-=h.e),r.toRect=l,r.thisAnimationDuration&&v(c,l)&&!v(s,l)&&(u.top-l.top)/(u.left-l.left)==(s.top-l.top)/(s.left-l.left)&&(t=u,n=c,i=d,o=p.options,a=Math.sqrt(Math.pow(n.top-t.top,2)+Math.pow(n.left-t.left,2))/Math.sqrt(Math.pow(n.top-i.top,2)+Math.pow(n.left-i.left,2))*o.animation),v(l,s)||(r.prevFromRect=s,r.prevToRect=l,a=a||p.options.animation,p.animate(r,u,l,a)),a&&(f=!0,m=Math.max(m,a),clearTimeout(r.animationResetTimer),r.animationResetTimer=setTimeout(function(){r.animationTime=0,r.prevFromRect=null,r.fromRect=null,r.prevToRect=null,r.thisAnimationDuration=null},a),r.thisAnimationDuration=a)}),clearTimeout(n),f?n=setTimeout(function(){"function"==typeof e&&e()},m):"function"==typeof e&&e(),i=[]},animate:function(e,t,n,i){if(i){W(e,"transition",""),W(e,"transform","");var o=g(this.el),a=(t.left-n.left)/(o&&o.a||1),r=(t.top-n.top)/(o&&o.d||1);e.animatingX=!!a,e.animatingY=!!r,W(e,"transform","translate3d("+a+"px,"+r+"px,0)"),this.forRepaintDummy=e.offsetWidth,W(e,"transition","transform "+i+"ms"+(this.options.easing?" "+this.options.easing:"")),W(e,"transform","translate3d(0,0,0)"),"number"==typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout(function(){W(e,"transition",""),W(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1},i)}}}))}function _e(e,t,n,i,o,a,r,s){var l,c,d=e[K],u=d.options.onMove;return!window.CustomEvent||w||k?(l=document.createEvent("Event")).initEvent("move",!0,!0):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=t,l.from=e,l.dragged=n,l.draggedRect=i,l.related=o||t,l.relatedRect=a||Y(t),l.willInsertAfter=s,l.originalEvent=r,e.dispatchEvent(l),u&&(c=u.call(d,l,r)),c}function Me(e){e.draggable=!1}function Re(){ve=!1}function Ne(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,i=0;n--;)i+=t.charCodeAt(n);return i.toString(36)}function Pe(e){return setTimeout(e,0)}function je(e){return clearTimeout(e)}Ie.prototype={constructor:Ie,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(se=null)},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,Q):this.options.direction},_onTapStart:function(t){if(t.cancelable){var n=this,i=this.el,e=this.options,o=e.preventOnFilter,a=t.type,r=t.touches&&t.touches[0]||t.pointerType&&"touch"===t.pointerType&&t,s=(r||t).target,l=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||s,c=e.filter;if(function(e){ye.length=0;for(var t=e.getElementsByTagName("input"),n=t.length;n--;){var i=t[n];i.checked&&ye.push(i)}}(i),!Q&&!(/mousedown|pointerdown/.test(a)&&0!==t.button||e.disabled)&&!l.isContentEditable&&(this.nativeDraggable||!d||!s||"SELECT"!==s.tagName.toUpperCase())&&!((s=H(s,e.draggable,i,!1))&&s.animated||C===s)){if($=V(s),A=V(s,e.draggable),"function"==typeof c){if(c.call(this,t,s,this))return J({sortable:n,rootEl:l,name:"filter",targetEl:s,toEl:i,fromEl:i}),G("filter",n,{evt:t}),void(o&&t.cancelable&&t.preventDefault())}else if(c=c&&c.split(",").some(function(e){if(e=H(l,e.trim(),i,!1))return J({sortable:n,rootEl:e,name:"filter",targetEl:s,fromEl:i,toEl:i}),G("filter",n,{evt:t}),!0}))return void(o&&t.cancelable&&t.preventDefault());e.handle&&!H(l,e.handle,i,!1)||this._prepareDragStart(t,r,s)}}},_prepareDragStart:function(e,t,n){var i,o=this,a=o.el,r=o.options,s=a.ownerDocument;if(n&&!Q&&n.parentNode===a){var l=Y(n);if(te=a,Z=(Q=n).parentNode,ne=Q.nextSibling,C=n,ae=r.group,j=(M={target:Ie.dragged=Q,clientX:(t||e).clientX,clientY:(t||e).clientY}).clientX-l.left,F=M.clientY-l.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,Q.style["will-change"]="all",i=function(){G("delayEnded",o,{evt:e}),Ie.eventCanceled?o._onDrop():(o._disableDelayedDragEvents(),!c&&o.nativeDraggable&&(Q.draggable=!0),o._triggerDragStart(e,t),J({sortable:o,name:"choose",originalEvent:e}),z(Q,r.chosenClass,!0))},r.ignore.split(",").forEach(function(e){h(Q,e.trim(),Me)}),u(s,"dragover",Oe),u(s,"mousemove",Oe),u(s,"touchmove",Oe),u(s,"mouseup",o._onDrop),u(s,"touchend",o._onDrop),u(s,"touchcancel",o._onDrop),c&&this.nativeDraggable&&(this.options.touchStartThreshold=4,Q.draggable=!0),G("delayStart",this,{evt:e}),!r.delay||r.delayOnTouchOnly&&!t||this.nativeDraggable&&(k||w))i();else{if(Ie.eventCanceled)return void this._onDrop();u(s,"mouseup",o._disableDelayedDrag),u(s,"touchend",o._disableDelayedDrag),u(s,"touchcancel",o._disableDelayedDrag),u(s,"mousemove",o._delayedDragTouchMoveHandler),u(s,"touchmove",o._delayedDragTouchMoveHandler),r.supportPointer&&u(s,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(i,r.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){Q&&Me(Q),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;a(e,"mouseup",this._disableDelayedDrag),a(e,"touchend",this._disableDelayedDrag),a(e,"touchcancel",this._disableDelayedDrag),a(e,"mousemove",this._delayedDragTouchMoveHandler),a(e,"touchmove",this._delayedDragTouchMoveHandler),a(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?u(document,this.options.supportPointer?"pointermove":t?"touchmove":"mousemove",this._onTouchMove):(u(Q,"dragend",this),u(te,"dragstart",this._onDragStart));try{document.selection?Pe(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(e,t){if(ue=!1,te&&Q){G("dragStarted",this,{evt:t}),this.nativeDraggable&&u(document,"dragover",$e);var n=this.options;e||z(Q,n.dragClass,!1),z(Q,n.ghostClass,!0),Ie.active=this,e&&this._appendGhost(),J({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(R){this._lastX=R.clientX,this._lastY=R.clientY,Ce();for(var e=document.elementFromPoint(R.clientX,R.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(R.clientX,R.clientY))!==t;)t=e;if(Q.parentNode[K]._isOutsideThisEl(e),t)do{if(t[K]&&t[K]._onDragOver({clientX:R.clientX,clientY:R.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break;e=t}while(t=t.parentNode);De()}},_onTouchMove:function(e){if(M){var t=this.options,n=t.fallbackTolerance,i=t.fallbackOffset,o=e.touches?e.touches[0]:e,a=ee&&g(ee,!0),r=ee&&a&&a.a,s=ee&&a&&a.d,l=we&&de&&f(de),c=(o.clientX-M.clientX+i.x)/(r||1)+(l?l[0]-ge[0]:0)/(r||1),d=(o.clientY-M.clientY+i.y)/(s||1)+(l?l[1]-ge[1]:0)/(s||1);if(!Ie.active&&!ue){if(n&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}if(ee){a?(a.e+=c-(N||0),a.f+=d-(P||0)):a={a:1,b:0,c:0,d:1,e:c,f:d};var u="matrix("+a.a+","+a.b+","+a.c+","+a.d+","+a.e+","+a.f+")";W(ee,"webkitTransform",u),W(ee,"mozTransform",u),W(ee,"msTransform",u),W(ee,"transform",u),N=c,P=d,R=o}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!ee){var e=this.options.fallbackOnBody?document.body:te,t=Y(Q,!0,we,!0,e),n=this.options;if(we){for(de=e;"static"===W(de,"position")&&"none"===W(de,"transform")&&de!==document;)de=de.parentNode;de!==document.body&&de!==document.documentElement?(de===document&&(de=I()),t.top+=de.scrollTop,t.left+=de.scrollLeft):de=I(),ge=f(de)}z(ee=Q.cloneNode(!0),n.ghostClass,!1),z(ee,n.fallbackClass,!0),z(ee,n.dragClass,!0),W(ee,"transition",""),W(ee,"transform",""),W(ee,"box-sizing","border-box"),W(ee,"margin",0),W(ee,"top",t.top),W(ee,"left",t.left),W(ee,"width",t.width),W(ee,"height",t.height),W(ee,"opacity","0.8"),W(ee,"position",we?"absolute":"fixed"),W(ee,"zIndex","100000"),W(ee,"pointerEvents","none"),Ie.ghost=ee,e.appendChild(ee),W(ee,"transform-origin",j/parseInt(ee.style.width)*100+"% "+F/parseInt(ee.style.height)*100+"%")}},_onDragStart:function(e,t){var n=this,i=e.dataTransfer,o=n.options;G("dragStart",this,{evt:e}),Ie.eventCanceled?this._onDrop():(G("setupClone",this),Ie.eventCanceled||((D=m(Q)).draggable=!1,D.style["will-change"]="",this._hideClone(),z(D,this.options.chosenClass,!1),Ie.clone=D),n.cloneId=Pe(function(){G("clone",n),Ie.eventCanceled||(n.options.removeCloneOnHide||te.insertBefore(D,Q),n._hideClone(),J({sortable:n,name:"clone"}))}),t||z(Q,o.dragClass,!0),t?(he=!0,n._loopId=setInterval(n._emulateDragOver,50)):(a(document,"mouseup",n._onDrop),a(document,"touchend",n._onDrop),a(document,"touchcancel",n._onDrop),i&&(i.effectAllowed="move",o.setData&&o.setData.call(n,i,Q)),u(document,"drop",n),W(Q,"transform","translateZ(0)")),ue=!0,n._dragStartId=Pe(n._dragStarted.bind(n,t,e)),u(document,"selectstart",n),L=!0,d&&W(document.body,"user-select","none"))},_onDragOver:function(u){var n,h,i,p,e,t,o,a,r,s,l,c,d=this.el,f=u.target,m=this.options,g=m.group,v=Ie.active,y=ae===g,b=m.sort,w=re||v,k=this,x=!1;if(!ve){if(void 0!==u.preventDefault&&u.cancelable&&u.preventDefault(),f=H(f,m.draggable,d,!0),P("dragOver"),Ie.eventCanceled)return x;if(Q.contains(u.target)||f.animated&&f.animatingX&&f.animatingY||k._ignoreWhileAnimating===f)return F(!1);if(he=!1,v&&!m.disabled&&(y?b||(i=!te.contains(Q)):re===this||(this.lastPutMode=ae.checkPull(this,v,Q,u))&&g.checkPut(this,v,Q,u))){if(p="vertical"===this._getDirection(u,f),n=Y(Q),P("dragOverValid"),Ie.eventCanceled)return x;if(i)return Z=te,j(),this._hideClone(),P("revert"),Ie.eventCanceled||(ne?te.insertBefore(Q,ne):te.appendChild(Q)),F(!0);var S=q(d,m.draggable);if(S&&(r=u,s=p,c=Y(q((l=this).el,l.options.draggable)),!(s?r.clientX>c.right+10||r.clientX<=c.right&&r.clientY>c.bottom&&r.clientX>=c.left:r.clientX>c.right&&r.clientY>c.top||r.clientX<=c.right&&r.clientY>c.bottom+10)||S.animated)){if(f.parentNode===d){h=Y(f);var T,E,C,D=Q.parentNode!==d,O=(e=Q.animated&&Q.toRect||n,t=f.animated&&f.toRect||h,o=p?e.left:e.top,a=p?t.left:t.top,!(o===a||(p?e.right:e.bottom)===(p?t.right:t.bottom)||o+(p?e.width:e.height)/2===a+(p?t.width:t.height)/2)),$=p?"top":"left",A=B(f,"top","top")||B(Q,"top","top"),I=A?A.scrollTop:void 0;if(se!==f&&(E=h[$],fe=!1,me=!O&&m.invertSwap||D),0!==(T=function(e,t,n,i,o){var a,r=p?u.clientY:u.clientX,s=p?h.height:h.width,l=p?h.top:h.left,c=p?h.bottom:h.right,d=!1;if(!i)if(o&&ce<s*t){if(!fe&&(1===le?l+s*n/2<r:r<c-s*n/2)&&(fe=!0),fe)d=!0;else if(1===le?r<l+ce:c-ce<r)return-le}else if(l+s*(1-t)/2<r&&r<c-s*(1-t)/2)return a=e,V(Q)<V(a)?1:-1;return(d=d||i)&&(r<l+s*n/2||c-s*n/2<r)?l+s/2<r?1:-1:0}(f,O?1:m.swapThreshold,null==m.invertedSwapThreshold?m.swapThreshold:m.invertedSwapThreshold,me,se===f)))for(var _=V(Q);(C=Z.children[_-=T])&&("none"===W(C,"display")||C===ee););if(0===T||C===f)return F(!1);le=T;var M=(se=f).nextElementSibling,R=!1,N=_e(te,d,Q,n,f,h,u,R=1===T);if(!1!==N)return 1!==N&&-1!==N||(R=1===N),ve=!0,setTimeout(Re,30),j(),R&&!M?d.appendChild(Q):f.parentNode.insertBefore(Q,R?M:f),A&&X(A,0,I-A.scrollTop),Z=Q.parentNode,void 0===E||me||(ce=Math.abs(E-Y(f)[$])),L(),F(!0)}}else{if(S===Q)return F(!1);if(S&&d===u.target&&(f=S),f&&(h=Y(f)),!1!==_e(te,d,Q,n,f,h,u,!!f))return j(),d.appendChild(Q),Z=d,L(),F(!0)}if(d.contains(Q))return F(!1)}return!1}function P(e,t){G(e,k,U({evt:u,isOwner:y,axis:p?"vertical":"horizontal",revert:i,dragRect:n,targetRect:h,canSort:b,fromSortable:w,target:f,completed:F,onMove:function(e,t){return _e(te,d,Q,n,e,Y(e),u,t)},changed:L},t))}function j(){P("dragOverAnimationCapture"),k.captureAnimationState(),k!==w&&w.captureAnimationState()}function F(e){return P("dragOverCompleted",{insertion:e}),e&&(y?v._hideClone():v._showClone(k),k!==w&&(z(Q,re?re.options.ghostClass:v.options.ghostClass,!1),z(Q,m.ghostClass,!0)),re!==k&&k!==Ie.active?re=k:k===Ie.active&&re&&(re=null),w===k&&(k._ignoreWhileAnimating=f),k.animateAll(function(){P("dragOverAnimationComplete"),k._ignoreWhileAnimating=null}),k!==w&&(w.animateAll(),w._ignoreWhileAnimating=null)),(f===Q&&!Q.animated||f===d&&!f.animated)&&(se=null),m.dragoverBubble||u.rootEl||f===document||(Q.parentNode[K]._isOutsideThisEl(u.target),e||Oe(u)),!m.dragoverBubble&&u.stopPropagation&&u.stopPropagation(),x=!0}function L(){ie=V(Q),oe=V(Q,m.draggable),J({sortable:k,name:"change",toEl:d,newIndex:ie,newDraggableIndex:oe,originalEvent:u})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){a(document,"mousemove",this._onTouchMove),a(document,"touchmove",this._onTouchMove),a(document,"pointermove",this._onTouchMove),a(document,"dragover",Oe),a(document,"mousemove",Oe),a(document,"touchmove",Oe)},_offUpEvents:function(){var e=this.el.ownerDocument;a(e,"mouseup",this._onDrop),a(e,"touchend",this._onDrop),a(e,"pointerup",this._onDrop),a(e,"touchcancel",this._onDrop),a(document,"selectstart",this)},_onDrop:function(e){var t=this.el,n=this.options;ie=V(Q),oe=V(Q,n.draggable),G("drop",this,{evt:e}),Z=Q&&Q.parentNode,ie=V(Q),oe=V(Q,n.draggable),Ie.eventCanceled||(fe=me=ue=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),je(this.cloneId),je(this._dragStartId),this.nativeDraggable&&(a(document,"drop",this),a(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),d&&W(document.body,"user-select",""),W(Q,"transform",""),e&&(L&&(e.cancelable&&e.preventDefault(),n.dropBubble||e.stopPropagation()),ee&&ee.parentNode&&ee.parentNode.removeChild(ee),(te===Z||re&&"clone"!==re.lastPutMode)&&D&&D.parentNode&&D.parentNode.removeChild(D),Q&&(this.nativeDraggable&&a(Q,"dragend",this),Me(Q),Q.style["will-change"]="",L&&!ue&&z(Q,re?re.options.ghostClass:this.options.ghostClass,!1),z(Q,this.options.chosenClass,!1),J({sortable:this,name:"unchoose",toEl:Z,newIndex:null,newDraggableIndex:null,originalEvent:e}),te!==Z?(0<=ie&&(J({rootEl:Z,name:"add",toEl:Z,fromEl:te,originalEvent:e}),J({sortable:this,name:"remove",toEl:Z,originalEvent:e}),J({rootEl:Z,name:"sort",toEl:Z,fromEl:te,originalEvent:e}),J({sortable:this,name:"sort",toEl:Z,originalEvent:e})),re&&re.save()):ie!==$&&0<=ie&&(J({sortable:this,name:"update",toEl:Z,originalEvent:e}),J({sortable:this,name:"sort",toEl:Z,originalEvent:e})),Ie.active&&(null!=ie&&-1!==ie||(ie=$,oe=A),J({sortable:this,name:"end",toEl:Z,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){G("nulling",this),te=Q=Z=ee=ne=D=C=O=M=R=L=ie=oe=$=A=se=le=re=ae=Ie.dragged=Ie.ghost=Ie.clone=Ie.active=null,ye.forEach(function(e){e.checked=!0}),ye.length=N=P=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":Q&&(this._onDragOver(e),(t=e).dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault());break;case"selectstart":e.preventDefault()}var t},toArray:function(){for(var e,t=[],n=this.el.children,i=0,o=n.length,a=this.options;i<o;i++)H(e=n[i],a.draggable,this.el,!1)&&t.push(e.getAttribute(a.dataIdAttr)||Ne(e));return t},sort:function(e){var i={},o=this.el;this.toArray().forEach(function(e,t){var n=o.children[t];H(n,this.options.draggable,o,!1)&&(i[e]=n)},this),e.forEach(function(e){i[e]&&(o.removeChild(i[e]),o.appendChild(i[e]))})},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return H(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var n=this.options;if(void 0===t)return n[e];var i=T.modifyOption(this,e,t);n[e]=void 0!==i?i:t,"group"===e&&Ee(n)},destroy:function(){G("destroy",this);var e=this.el;e[K]=null,a(e,"mousedown",this._onTapStart),a(e,"touchstart",this._onTapStart),a(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(a(e,"dragover",this),a(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),pe.splice(pe.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!O){if(G("hideClone",this),Ie.eventCanceled)return;W(D,"display","none"),this.options.removeCloneOnHide&&D.parentNode&&D.parentNode.removeChild(D),O=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(O){if(G("showClone",this),Ie.eventCanceled)return;Q.parentNode!=te||this.options.group.revertClone?ne?te.insertBefore(D,ne):te.appendChild(D):te.insertBefore(D,Q),this.options.group.revertClone&&this.animate(Q,D),W(D,"display",""),O=!1}}else this._hideClone()}},be&&u(document,"touchmove",function(e){(Ie.active||ue)&&e.cancelable&&e.preventDefault()}),Ie.utils={on:u,off:a,css:W,find:h,is:function(e,t){return!!H(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},throttle:l,closest:H,toggleClass:z,clone:m,index:V,nextTick:Pe,cancelNextTick:je,detectDirection:Te,getChild:p},Ie.get=function(e){return e[K]},Ie.mount=function(){var e=[].slice.call(arguments);e[0].constructor===Array&&(e=e[0]),e.forEach(function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not "+{}.toString.call(e);e.utils&&(Ie.utils=U({},Ie.utils,e.utils)),T.mount(e)})},Ie.create=function(e,t){return new Ie(e,t)};var Fe,Le,Ue,He,ze,We=[],Ye=[],Be=!(Ie.version="1.12.0"),qe=!1,Ve=!1;function Xe(i,o){Ye.forEach(function(e,t){var n=o.children[e.sortableIndex+(i?Number(t):0)];n?o.insertBefore(e,n):o.appendChild(e)})}function Ke(){We.forEach(function(e){e!==Ue&&e.parentNode&&e.parentNode.removeChild(e)})}function Ge(e){var t=e.originalEvent,n=e.putSortable,i=e.dragEl,o=e.dispatchSortableEvent,a=e.unhideGhostForTarget;if(t){var r=n||e.activeSortable;(0,e.hideGhostForTarget)();var s=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,l=document.elementFromPoint(s.clientX,s.clientY);a(),r&&!r.el.contains(l)&&(o("spill"),this.onSpill({dragEl:i,putSortable:n}))}}function Je(){}function Qe(){}Je.prototype={startIndex:null,dragStart:function(e){this.startIndex=e.oldDraggableIndex},onSpill:function(e){var t=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var i=p(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(t,i):this.sortable.el.appendChild(t),this.sortable.animateAll(),n&&n.animateAll()},drop:Ge},Object.assign(Je,{pluginName:"revertOnSpill"}),Qe.prototype={onSpill:function(e){var t=e.dragEl,n=e.putSortable||this.sortable;n.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),n.animateAll()},drop:Ge},Object.assign(Qe,{pluginName:"removeOnSpill"});var Ze,et,tt,nt,it,ot,at=[],rt=!1;function st(){at.forEach(function(e){clearInterval(e.pid)}),at=[]}function lt(){clearInterval(ot)}var ct=l(function(n,e,t,i){if(e.scroll){var o,a=(n.touches?n.touches[0]:n).clientX,r=(n.touches?n.touches[0]:n).clientY,s=e.scrollSensitivity,l=e.scrollSpeed,c=I(),d=!1;et!==t&&(et=t,st(),o=e.scrollFn,!0===(Ze=e.scroll)&&(Ze=_(t,!0)));var u=0,h=Ze;do{var p=h,f=Y(p),m=f.top,g=f.bottom,v=f.left,y=f.right,b=f.width,w=f.height,k=void 0,x=void 0,S=p.scrollWidth,T=p.scrollHeight,E=W(p),C=p.scrollLeft,D=p.scrollTop;x=p===c?(k=b<S&&("auto"===E.overflowX||"scroll"===E.overflowX||"visible"===E.overflowX),w<T&&("auto"===E.overflowY||"scroll"===E.overflowY||"visible"===E.overflowY)):(k=b<S&&("auto"===E.overflowX||"scroll"===E.overflowX),w<T&&("auto"===E.overflowY||"scroll"===E.overflowY));var O=k&&(Math.abs(y-a)<=s&&C+b<S)-(Math.abs(v-a)<=s&&!!C),$=x&&(Math.abs(g-r)<=s&&D+w<T)-(Math.abs(m-r)<=s&&!!D);if(!at[u])for(var A=0;A<=u;A++)at[A]||(at[A]={});at[u].vx==O&&at[u].vy==$&&at[u].el===p||(at[u].el=p,at[u].vx=O,at[u].vy=$,clearInterval(at[u].pid),0==O&&0==$||(d=!0,at[u].pid=setInterval(function(){i&&0===this.layer&&Ie.active._onTouchMove(it);var e=at[this.layer].vy?at[this.layer].vy*l:0,t=at[this.layer].vx?at[this.layer].vx*l:0;"function"==typeof o&&"continue"!==o.call(Ie.dragged.parentNode[K],t,e,n,it,at[this.layer].el)||X(at[this.layer].el,t,e)}.bind({layer:u}),24))),u++}while(e.bubbleScroll&&h!==c&&(h=_(h,!1)));rt=d}},30);return Ie.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?u(document,"dragover",this._handleAutoScroll):u(document,this.options.supportPointer?"pointermove":t.touches?"touchmove":"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?a(document,"dragover",this._handleAutoScroll):(a(document,"pointermove",this._handleFallbackAutoScroll),a(document,"touchmove",this._handleFallbackAutoScroll),a(document,"mousemove",this._handleFallbackAutoScroll)),lt(),st(),clearTimeout(o),o=void 0},nulling:function(){it=et=Ze=rt=ot=tt=nt=null,at.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(t,n){var i=this,o=(t.touches?t.touches[0]:t).clientX,a=(t.touches?t.touches[0]:t).clientY,e=document.elementFromPoint(o,a);if(it=t,n||k||w||d){ct(t,this.options,e,n);var r=_(e,!0);!rt||ot&&o===tt&&a===nt||(ot&&lt(),ot=setInterval(function(){var e=_(document.elementFromPoint(o,a),!0);e!==r&&(r=e,st()),ct(t,i.options,e,n)},10),tt=o,nt=a)}else{if(!this.options.bubbleScroll||_(e,!0)===I())return void st();ct(t,this.options,_(e,!1),!1)}}},Object.assign(e,{pluginName:"scroll",initializeByDefault:!0})}),Ie.mount(Qe,Je),Ie.mount(new function(){function e(){this.defaults={swapClass:"sortable-swap-highlight"}}return e.prototype={dragStart:function(e){Ae=e.dragEl},dragOverValid:function(e){var t=e.completed,n=e.target,i=e.changed,o=e.cancel;if(e.activeSortable.options.swap){var a=this.options;if(n&&n!==this.sortable.el){var r=Ae;Ae=!1!==(0,e.onMove)(n)?(z(n,a.swapClass,!0),n):null,r&&r!==Ae&&z(r,a.swapClass,!1)}i(),t(!0),o()}},drop:function(e){var t,n,i,o,a,r,s=e.activeSortable,l=e.putSortable,c=e.dragEl,d=l||this.sortable,u=this.options;Ae&&z(Ae,u.swapClass,!1),Ae&&(u.swap||l&&l.options.swap)&&c!==Ae&&(d.captureAnimationState(),d!==s&&s.captureAnimationState(),r=(n=Ae).parentNode,(a=(t=c).parentNode)&&r&&!a.isEqualNode(n)&&!r.isEqualNode(t)&&(i=V(t),o=V(n),a.isEqualNode(r)&&i<o&&o++,a.insertBefore(n,a.children[i]),r.insertBefore(t,r.children[o])),d.animateAll(),d!==s&&s.animateAll())},nulling:function(){Ae=null}},Object.assign(e,{pluginName:"swap",eventProperties:function(){return{swapItem:Ae}}})}),Ie.mount(new function(){function e(i){for(var e in this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this));i.options.supportPointer?u(document,"pointerup",this._deselectMultiDrag):(u(document,"mouseup",this._deselectMultiDrag),u(document,"touchend",this._deselectMultiDrag)),u(document,"keydown",this._checkKeyDown),u(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(e,t){var n="";We.length&&Le===i?We.forEach(function(e,t){n+=(t?", ":"")+e.textContent}):n=t.textContent,e.setData("Text",n)}}}return e.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(e){Ue=e.dragEl},delayEnded:function(){this.isMultiDrag=~We.indexOf(Ue)},setupClone:function(e){var t=e.sortable,n=e.cancel;if(this.isMultiDrag){for(var i=0;i<We.length;i++)Ye.push(m(We[i])),Ye[i].sortableIndex=We[i].sortableIndex,Ye[i].draggable=!1,Ye[i].style["will-change"]="",z(Ye[i],this.options.selectedClass,!1),We[i]===Ue&&z(Ye[i],this.options.chosenClass,!1);t._hideClone(),n()}},clone:function(e){var t=e.dispatchSortableEvent,n=e.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||We.length&&Le===e.sortable&&(Xe(!0,e.rootEl),t("clone"),n()))},showClone:function(e){var t=e.cloneNowShown,n=e.cancel;this.isMultiDrag&&(Xe(!1,e.rootEl),Ye.forEach(function(e){W(e,"display","")}),t(),ze=!1,n())},hideClone:function(e){var t=this,n=e.cloneNowHidden,i=e.cancel;this.isMultiDrag&&(Ye.forEach(function(e){W(e,"display","none"),t.options.removeCloneOnHide&&e.parentNode&&e.parentNode.removeChild(e)}),n(),ze=!0,i())},dragStartGlobal:function(e){!this.isMultiDrag&&Le&&Le.multiDrag._deselectMultiDrag(),We.forEach(function(e){e.sortableIndex=V(e)}),We=We.sort(function(e,t){return e.sortableIndex-t.sortableIndex}),Ve=!0},dragStarted:function(e){var t=this,n=e.sortable;if(this.isMultiDrag){if(this.options.sort&&(n.captureAnimationState(),this.options.animation)){We.forEach(function(e){e!==Ue&&W(e,"position","absolute")});var i=Y(Ue,!1,!0,!0);We.forEach(function(e){e!==Ue&&y(e,i)}),Be=qe=!0}n.animateAll(function(){Be=qe=!1,t.options.animation&&We.forEach(function(e){b(e)}),t.options.sort&&Ke()})}},dragOver:function(e){var t=e.completed,n=e.cancel;qe&&~We.indexOf(e.target)&&(t(!1),n())},revert:function(e){var i,o,t=e.fromSortable,n=e.rootEl,a=e.sortable,r=e.dragRect;1<We.length&&(We.forEach(function(e){a.addAnimationState({target:e,rect:qe?Y(e):r}),b(e),e.fromRect=r,t.removeAnimationState(e)}),qe=!1,i=!this.options.removeCloneOnHide,o=n,We.forEach(function(e,t){var n=o.children[e.sortableIndex+(i?Number(t):0)];n?o.insertBefore(e,n):o.appendChild(e)}))},dragOverCompleted:function(e){var t=e.sortable,n=e.isOwner,i=e.activeSortable,o=e.parentEl,a=e.putSortable,r=this.options;if(e.insertion){if(n&&i._hideClone(),Be=!1,r.animation&&1<We.length&&(qe||!n&&!i.options.sort&&!a)){var s=Y(Ue,!1,!0,!0);We.forEach(function(e){e!==Ue&&(y(e,s),o.appendChild(e))}),qe=!0}if(!n)if(qe||Ke(),1<We.length){var l=ze;i._showClone(t),i.options.animation&&!ze&&l&&Ye.forEach(function(e){i.addAnimationState({target:e,rect:He}),e.fromRect=He,e.thisAnimationDuration=null})}else i._showClone(t)}},dragOverAnimationCapture:function(e){var t=e.dragRect,n=e.isOwner,i=e.activeSortable;if(We.forEach(function(e){e.thisAnimationDuration=null}),i.options.animation&&!n&&i.multiDrag.isMultiDrag){He=Object.assign({},t);var o=g(Ue,!0);He.top-=o.f,He.left-=o.e}},dragOverAnimationComplete:function(){qe&&(qe=!1,Ke())},drop:function(e){var t=e.originalEvent,n=e.rootEl,i=e.parentEl,o=e.sortable,a=e.dispatchSortableEvent,r=e.oldIndex,s=e.putSortable,l=s||this.sortable;if(t){var c=this.options,d=i.children;if(!Ve)if(c.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),z(Ue,c.selectedClass,!~We.indexOf(Ue)),~We.indexOf(Ue))We.splice(We.indexOf(Ue),1),Fe=null,E({sortable:o,rootEl:n,name:"deselect",targetEl:Ue,originalEvt:t});else{if(We.push(Ue),E({sortable:o,rootEl:n,name:"select",targetEl:Ue,originalEvt:t}),t.shiftKey&&Fe&&o.el.contains(Fe)){var u,h,p=V(Fe),f=V(Ue);if(~p&&~f&&p!==f)for(u=p<f?(h=p,f):(h=f,p+1);h<u;h++)~We.indexOf(d[h])||(z(d[h],c.selectedClass,!0),We.push(d[h]),E({sortable:o,rootEl:n,name:"select",targetEl:d[h],originalEvt:t}))}else Fe=Ue;Le=l}if(Ve&&this.isMultiDrag){if((i[K].options.sort||i!==n)&&1<We.length){var m=Y(Ue),g=V(Ue,":not(."+this.options.selectedClass+")");if(!Be&&c.animation&&(Ue.thisAnimationDuration=null),l.captureAnimationState(),!Be&&(c.animation&&(Ue.fromRect=m,We.forEach(function(e){if(e.thisAnimationDuration=null,e!==Ue){var t=qe?Y(e):m;e.fromRect=t,l.addAnimationState({target:e,rect:t})}})),Ke(),We.forEach(function(e){d[g]?i.insertBefore(e,d[g]):i.appendChild(e),g++}),r===V(Ue))){var v=!1;We.forEach(function(e){e.sortableIndex===V(e)||(v=!0)}),v&&a("update")}We.forEach(function(e){b(e)}),l.animateAll()}Le=l}(n===i||s&&"clone"!==s.lastPutMode)&&Ye.forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)})}},nullingGlobal:function(){this.isMultiDrag=Ve=!1,Ye.length=0},destroyGlobal:function(){this._deselectMultiDrag(),a(document,"pointerup",this._deselectMultiDrag),a(document,"mouseup",this._deselectMultiDrag),a(document,"touchend",this._deselectMultiDrag),a(document,"keydown",this._checkKeyDown),a(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(e){if(!(void 0!==Ve&&Ve||Le!==this.sortable||e&&H(e.target,this.options.draggable,this.sortable.el,!1)||e&&0!==e.button))for(;We.length;){var t=We[0];z(t,this.options.selectedClass,!1),We.shift(),E({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:t,originalEvt:e})}},_checkKeyDown:function(e){e.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(e){e.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},Object.assign(e,{pluginName:"multiDrag",utils:{select:function(e){var t=e.parentNode[K];t&&t.options.multiDrag&&!~We.indexOf(e)&&(Le&&Le!==t&&(Le.multiDrag._deselectMultiDrag(),Le=t),z(e,t.options.selectedClass,!0),We.push(e))},deselect:function(e){var t=e.parentNode[K],n=We.indexOf(e);t&&t.options.multiDrag&&~n&&(z(e,t.options.selectedClass,!1),We.splice(n,1))}},eventProperties:function(){var n=this,i=[],o=[];return We.forEach(function(e){var t;i.push({multiDragElement:e,index:e.sortableIndex}),t=qe&&e!==Ue?-1:qe?V(e,":not(."+n.options.selectedClass+")"):V(e),o.push({multiDragElement:e,index:t})}),{items:[].concat(We),clones:[].concat(Ye),oldIndicies:i,newIndicies:o}},optionListeners:{multiDragKey:function(e){return"ctrl"===(e=e.toLowerCase())?e="Control":1<e.length&&(e=e.charAt(0).toUpperCase()+e.substr(1)),e}}})}),Ie}),function(e){define("select2",[],function(){return function(){var o;void 0===(o=jQuery).fn.each2&&o.extend(o.fn,{each2:function(e){for(var t=o([0]),n=-1,i=this.length;++n<i&&(t.context=t[0]=this[n])&&!1!==e.call(t[0],n,t););return this}}),function(k,w){"use strict";if(window.Select2===w){var e,t,n,x,a,o,S,i,c={x:0,y:0},s={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){switch(e=e.which?e.which:e){case s.LEFT:case s.RIGHT:case s.UP:case s.DOWN:return!0}return!1},isControl:function(e){switch(e.which){case s.SHIFT:case s.CTRL:case s.ALT:return!0}return!!e.metaKey},isFunctionKey:function(e){return 112<=(e=e.which?e.which:e)&&e<=123}},r={"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ω":"ω","ς":"σ"};o=k(document),i=1,x=function(){return i++},e=I(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(e){var a,t,n,i,o,r=".select2-results";this.opts=e=this.prepareOpts(e),this.id=e.id,e.element.data("select2")!==w&&null!==e.element.data("select2")&&e.element.data("select2").destroy(),this.container=this.createContainer(),this.liveRegion=k(".select2-hidden-accessible"),0==this.liveRegion.length&&(this.liveRegion=k("<span>",{role:"status","aria-live":"polite"}).addClass("select2-hidden-accessible").appendTo(document.body)),this.containerId="s2id_"+(e.element.attr("id")||"autogen"+x()),this.containerEventName=this.containerId.replace(/([.])/g,"_").replace(/([;&,\-\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.container.attr("title",e.element.attr("title")),this.body=k(document.body),y(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.attr("style",e.element.attr("style")),this.container.css($(e.containerCss,this.opts.element)),this.container.addClass($(e.containerCssClass,this.opts.element)),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",v),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),y(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass($(e.dropdownCssClass,this.opts.element)),this.dropdown.data("select2",this),this.dropdown.on("click",v),this.results=a=this.container.find(r),this.search=t=this.container.find("input.select2-input"),this.queryCount=0,this.resultsPage=0,this.context=null,this.initContainer(),this.container.on("click",v),this.results.on("mousemove",function(e){c!==w&&c.x===e.pageX&&c.y===e.pageY||k(e.target).trigger("mousemove-filtered",e)}),this.dropdown.on("mousemove-filtered",r,this.bind(this.highlightUnderEvent)),this.dropdown.on("touchstart touchmove touchend",r,this.bind(function(e){this._touchEvent=!0,this.highlightUnderEvent(e)})),this.dropdown.on("touchmove",r,this.bind(this.touchMoved)),this.dropdown.on("touchstart touchend",r,this.bind(this.clearTouchMoved)),this.dropdown.on("click",this.bind(function(e){this._touchEvent&&(this._touchEvent=!1,this.selectHighlighted())})),n=80,i=this.results,o=g(n,function(e){i.trigger("scroll-debounced",e)}),i.on("scroll",function(e){0<=u(e.target,i.get())&&o(e)}),this.dropdown.on("scroll-debounced",r,this.bind(this.loadMoreIfNeeded)),k(this.container).on("change",".select2-input",function(e){e.stopPropagation()}),k(this.dropdown).on("change",".select2-input",function(e){e.stopPropagation()}),k.fn.mousewheel&&a.mousewheel(function(e,t,n,i){var o=a.scrollTop();0<i&&o-i<=0?(a.scrollTop(0),v(e)):i<0&&a.get(0).scrollHeight-a.scrollTop()+i<=a.height()&&(a.scrollTop(a.get(0).scrollHeight-a.height()),v(e))}),m(t),t.on("keyup-change input paste",this.bind(this.updateResults)),t.on("focus",function(){t.addClass("select2-focused")}),t.on("blur",function(){t.removeClass("select2-focused")}),this.dropdown.on("mouseup",r,this.bind(function(e){0<k(e.target).closest(".select2-result-selectable").length&&(this.highlightUnderEvent(e),this.selectHighlighted(e))})),this.dropdown.on("click mouseup mousedown touchstart touchend focusin",function(e){e.stopPropagation()}),this.lastSearchTerm=w,k.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),null!==e.maximumInputLength&&this.search.attr("maxlength",e.maximumInputLength);var s=e.element.prop("disabled");s===w&&(s=!1),this.enable(!s);var l=e.element.prop("readonly");l===w&&(l=!1),this.readonly(l),S=S||function(){var e=k("<div class='select2-measure-scrollbar'></div>");e.appendTo(document.body);var t={width:e.width()-e[0].clientWidth,height:e.height()-e[0].clientHeight};return e.remove(),t}(),this.autofocus=e.element.prop("autofocus"),e.element.prop("autofocus",!1),this.autofocus&&this.focus(),this.search.attr("placeholder",e.searchInputPlaceholder)},destroy:function(){var e=this.opts.element,t=e.data("select2"),n=this;this.close(),e.length&&e[0].detachEvent&&n._sync&&e.each(function(){n._sync&&this.detachEvent("onpropertychange",n._sync)}),this.propertyObserver&&(this.propertyObserver.disconnect(),this.propertyObserver=null),this._sync=null,t!==w&&(t.container.remove(),t.liveRegion.remove(),t.dropdown.remove(),e.removeData("select2").off(".select2"),e.is("input[type='hidden']")?e.css("display",""):(e.show().prop("autofocus",this.autofocus||!1),this.elementTabIndex?e.attr({tabindex:this.elementTabIndex}):e.removeAttr("tabindex"),e.show())),A.call(this,"container","liveRegion","dropdown","results","search")},optionToData:function(e){return e.is("option")?{id:e.prop("value"),text:e.text(),element:e.get(),css:e.attr("class"),disabled:e.prop("disabled"),locked:p(e.attr("locked"),"locked")||p(e.data("locked"),!0)}:e.is("optgroup")?{text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")}:void 0},prepareOpts:function(y){var r,e,t,n,b=this;if("select"===(r=y.element).get(0).tagName.toLowerCase()&&(this.select=e=y.element),e&&k.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in y)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),y.debug=y.debug||k.fn.select2.defaults.debug,y.debug&&console&&console.warn&&(null!=y.id&&console.warn("Select2: The `id` option has been removed in Select2 4.0.0, consider renaming your `id` property or mapping the property before your data makes it to Select2. You can read more at https://select2.github.io/announcements-4.0.html#changed-id"),null!=y.text&&console.warn("Select2: The `text` option has been removed in Select2 4.0.0, consider renaming your `text` property or mapping the property before your data makes it to Select2. You can read more at https://select2.github.io/announcements-4.0.html#changed-id"),null!=y.sortResults&&console.warn("Select2: the `sortResults` option has been renamed to `sorter` in Select2 4.0.0. "),null!=y.selectOnBlur&&console.warn("Select2: The `selectOnBlur` option has been renamed to `selectOnClose` in Select2 4.0.0."),null!=y.ajax&&null!=y.ajax.results&&console.warn("Select2: The `ajax.results` option has been renamed to `ajax.processResults` in Select2 4.0.0."),null!=y.formatNoResults&&console.warn("Select2: The `formatNoResults` option has been renamed to `language.noResults` in Select2 4.0.0."),null!=y.formatSearching&&console.warn("Select2: The `formatSearching` option has been renamed to `language.searching` in Select2 4.0.0."),null!=y.formatInputTooShort&&console.warn("Select2: The `formatInputTooShort` option has been renamed to `language.inputTooShort` in Select2 4.0.0."),null!=y.formatInputTooLong&&console.warn("Select2: The `formatInputTooLong` option has been renamed to `language.inputTooLong` in Select2 4.0.0."),null!=y.formatLoading&&console.warn("Select2: The `formatLoading` option has been renamed to `language.loadingMore` in Select2 4.0.0."),null!=y.formatSelectionTooBig&&console.warn("Select2: The `formatSelectionTooBig` option has been renamed to `language.maximumSelected` in Select2 4.0.0."),y.element.data("select2Tags")&&console.warn("Select2: The `data-select2-tags` attribute has been renamed to `data-tags` in Select2 4.0.0.")),null!=y.element.data("tags")){var i=y.element.data("tags");k.isArray(i)||(i=[]),y.element.data("select2Tags",i)}if(null!=y.sorter&&(y.sortResults=y.sorter),null!=y.selectOnClose&&(y.selectOnBlur=y.selectOnClose),null!=y.ajax&&k.isFunction(y.ajax.processResults)&&(y.ajax.results=y.ajax.processResults),null!=y.language){var o=y.language;k.isFunction(o.noMatches)&&(y.formatNoMatches=o.noMatches),k.isFunction(o.searching)&&(y.formatSearching=o.searching),k.isFunction(o.inputTooShort)&&(y.formatInputTooShort=o.inputTooShort),k.isFunction(o.inputTooLong)&&(y.formatInputTooLong=o.inputTooLong),k.isFunction(o.loadingMore)&&(y.formatLoading=o.loadingMore),k.isFunction(o.maximumSelected)&&(y.formatSelectionTooBig=o.maximumSelected)}if("function"!=typeof(y=k.extend({},{populateResults:function(e,t,f){var m,g=this.opts.id,v=this.liveRegion;(m=function(e,t,n){var i,o,a,r,s,l,c,d,u,h,p=[];for(i=0,o=(e=y.sortResults(e,t,f)).length;i<o;i+=1)r=!(s=!0===(a=e[i]).disabled)&&g(a)!==w,l=a.children&&0<a.children.length,(c=k("<li></li>")).addClass("select2-results-dept-"+n),c.addClass("select2-result"),c.addClass(r?"select2-result-selectable":"select2-result-unselectable"),s&&c.addClass("select2-disabled"),l&&c.addClass("select2-result-with-children"),c.addClass(b.opts.formatResultCssClass(a)),c.attr("role","presentation"),(d=k(document.createElement("div"))).addClass("select2-result-label"),d.attr("id","select2-result-label-"+x()),d.attr("role","option"),(h=y.formatResult(a,d,f,b.opts.escapeMarkup))!==w&&(d.html(h),c.append(d)),l&&((u=k("<ul></ul>")).addClass("select2-result-sub"),m(a.children,u,n+1),c.append(u)),c.data("select2-data",a),p.push(c[0]);t.append(p),v.text(y.formatMatches(e.length))})(t,e,0)}},k.fn.select2.defaults,y)).id&&(t=y.id,y.id=function(e){return e[t]}),k.isArray(y.element.data("select2Tags"))){if("tags"in y)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+y.element.attr("id");y.tags=y.element.data("select2Tags")}if(e?(y.query=this.bind(function(i){var e,t,o,n={results:[],more:!1},a=i.term;o=function(e,t){var n;e.is("option")?i.matcher(a,e.text(),e)&&t.push(b.optionToData(e)):e.is("optgroup")&&(n=b.optionToData(e),e.children().each2(function(e,t){o(t,n.children)}),0<n.children.length&&t.push(n))},e=r.children(),this.getPlaceholder()!==w&&0<e.length&&(t=this.getPlaceholderOption())&&(e=e.not(t)),e.each2(function(e,t){o(t,n.results)}),i.callback(n)}),y.id=function(e){return e.id}):"query"in y||("ajax"in y?((n=y.element.data("ajax-url"))&&0<n.length&&(y.ajax.url=n),y.query=E.call(y.element,y.ajax)):"data"in y?y.query=C(y.data):"tags"in y&&(y.query=D(y.tags),y.createSearchChoice===w&&(y.createSearchChoice=function(e){return{id:k.trim(e),text:k.trim(e)}}),y.initSelection===w&&(y.initSelection=function(e,t){var n=[];k(h(e.val(),y.separator,y.transformVal)).each(function(){var e={id:this,text:this},t=y.tags;k.isFunction(t)&&(t=t()),k(t).each(function(){if(p(this.id,e.id))return e=this,!1}),n.push(e)}),t(n)}))),"function"!=typeof y.query)throw"query function not defined for Select2 "+y.element.attr("id");if("top"===y.createSearchChoicePosition)y.createSearchChoicePosition=function(e,t){e.unshift(t)};else if("bottom"===y.createSearchChoicePosition)y.createSearchChoicePosition=function(e,t){e.push(t)};else if("function"!=typeof y.createSearchChoicePosition)throw"invalid createSearchChoicePosition option must be 'top', 'bottom' or a custom function";return y},monitorSource:function(){var e,n=this.opts.element,t=this;n.on("change.select2",this.bind(function(e){!0!==this.opts.element.data("select2-change-triggered")&&this.initSelection()})),this._sync=this.bind(function(){var e=n.prop("disabled");e===w&&(e=!1),this.enable(!e);var t=n.prop("readonly");t===w&&(t=!1),this.readonly(t),this.container&&(y(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass($(this.opts.containerCssClass,this.opts.element))),this.dropdown&&(y(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass($(this.opts.dropdownCssClass,this.opts.element)))}),n.length&&n[0].attachEvent&&n.each(function(){this.attachEvent("onpropertychange",t._sync)}),(e=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver)!==w&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new e(function(e){k.each(e,t._sync)}),this.propertyObserver.observe(n.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(e){var t=k.Event("select2-selecting",{val:this.id(e),object:e,choice:e});return this.opts.element.trigger(t),!t.isDefaultPrevented()},triggerChange:function(e){e=e||{},e=k.extend({},e,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(e),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return!0===this.enabledInterface},enableInterface:function(){var e=this._enabled&&!this._readonly,t=!e;return e!==this.enabledInterface&&(this.container.toggleClass("select2-container-disabled",t),this.close(),this.enabledInterface=e,!0)},enable:function(e){e===w&&(e=!0),this._enabled!==e&&(this._enabled=e,this.opts.element.prop("disabled",!e),this.enableInterface())},disable:function(){this.enable(!1)},readonly:function(e){e===w&&(e=!1),this._readonly!==e&&(this._readonly=e,this.opts.element.prop("readonly",e),this.enableInterface())},opened:function(){return!!this.container&&this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var e,t,n,i,o,a=this.dropdown,r=this.container,s=r.offset(),l=r.outerHeight(!1),c=r.outerWidth(!1),d=a.outerHeight(!1),u=k(window),h=u.width(),p=u.height(),f=u.scrollLeft()+h,m=u.scrollTop()+p,g=s.top+l,v=s.left,y=g+d<=m,b=s.top-d>=u.scrollTop(),w=a.outerWidth(!1);a.hasClass("select2-drop-above")?(t=!0,!b&&y&&(t=!(n=!0))):(t=!1,!y&&b&&(t=n=!0)),n&&(a.hide(),s=this.container.offset(),l=this.container.outerHeight(!1),c=this.container.outerWidth(!1),d=a.outerHeight(!1),f=u.scrollLeft()+h,m=u.scrollTop()+p,g=s.top+l,v=s.left,w=a.outerWidth(!1),a.show(),this.focusSearch()),this.opts.dropdownAutoWidth?(o=k(".select2-results",a)[0],a.addClass("select2-drop-auto-width"),a.css("width",""),c<(w=a.outerWidth(!1)+(o.scrollHeight===o.clientHeight?0:S.width))?c=w:w=c,d=a.outerHeight(!1)):this.container.removeClass("select2-drop-auto-width"),"static"!==this.body.css("position")&&(g-=(e=this.body.offset()).top,v-=e.left),!(v+w<=f)&&s.left+f+r.outerWidth(!1)>w&&(v=s.left+this.container.outerWidth(!1)-w),i={left:v,width:c},t?(this.container.addClass("select2-drop-above"),a.addClass("select2-drop-above"),d=a.outerHeight(!1),i.top=s.top-d,i.bottom="auto"):(i.top=g,i.bottom="auto",this.container.removeClass("select2-drop-above"),a.removeClass("select2-drop-above")),i=k.extend(i,$(this.opts.dropdownCss,this.opts.element)),a.css(i)},shouldOpen:function(){var e;return!this.opened()&&(!1!==this._enabled&&!0!==this._readonly&&(e=k.Event("select2-opening"),this.opts.element.trigger(e),!e.isDefaultPrevented()))},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return!!this.shouldOpen()&&(this.opening(),o.on("mousemove.select2Event",function(e){c.x=e.pageX,c.y=e.pageY}),!0)},opening:function(){var i,e=this.containerEventName,t="scroll."+e,n="resize."+e,o="orientationchange."+e;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body.children().last()[0]&&this.dropdown.detach().appendTo(this.body),0===(i=k("#select2-drop-mask")).length&&((i=k(document.createElement("div"))).attr("id","select2-drop-mask").attr("class","select2-drop-mask"),i.hide(),i.appendTo(this.body),i.on("mousedown touchstart click",function(e){l(i);var t,n=k("#select2-drop");0<n.length&&((t=n.data("select2")).opts.selectOnBlur&&t.selectHighlighted({noFocus:!0}),t.close(),e.preventDefault(),e.stopPropagation())})),this.dropdown.prev()[0]!==i[0]&&this.dropdown.before(i),k("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),i.show(),this.positionDropdown(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var a=this;this.container.parents().add(window).each(function(){k(this).on(n+" "+t+" "+o,function(e){a.opened()&&a.positionDropdown()})})},close:function(){if(this.opened()){var e=this.containerEventName,t="scroll."+e,n="resize."+e,i="orientationchange."+e;this.container.parents().add(window).each(function(){k(this).off(t).off(n).off(i)}),this.clearDropdownAlignmentPreference(),k("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),o.off("mousemove.select2Event"),this.clearSearch(),this.search.removeClass("select2-active"),this.search.removeAttr("aria-activedescendant"),this.opts.element.trigger(k.Event("select2-close"))}},externalSearch:function(e){this.open(),this.search.val(e),this.updateResults(!1)},clearSearch:function(){},prefillNextSearchTerm:function(){if(""!==this.search.val())return!1;var e=this.opts.nextSearchTerm(this.data(),this.lastSearchTerm);return e!==w&&(this.search.val(e),this.search.select(),!0)},getMaximumSelectionSize:function(){return $(this.opts.maximumSelectionSize,this.opts.element)},ensureHighlightVisible:function(){var e,t,n,i,o,a,r,s,l=this.results;(t=this.highlight())<0||(0!=t?(e=this.findHighlightableChoices().find(".select2-result-label"),i=(s=((n=k(e[t])).offset()||{}).top||0)+n.outerHeight(!0),t===e.length-1&&0<(r=l.find("li.select2-more-results")).length&&(i=r.offset().top+r.outerHeight(!0)),(o=l.offset().top+l.outerHeight(!1))<i&&l.scrollTop(l.scrollTop()+(i-o)),(a=s-l.offset().top)<0&&"none"!=n.css("display")&&l.scrollTop(l.scrollTop()+a)):l.scrollTop(0))},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled):not(.select2-selected)")},moveHighlight:function(e){for(var t=this.findHighlightableChoices(),n=this.highlight();-1<n&&n<t.length;){var i=k(t[n+=e]);if(i.hasClass("select2-result-selectable")&&!i.hasClass("select2-disabled")&&!i.hasClass("select2-selected")){this.highlight(n);break}}},highlight:function(e){var t,n,i=this.findHighlightableChoices();if(0===arguments.length)return u(i.filter(".select2-highlighted")[0],i.get());e>=i.length&&(e=i.length-1),e<0&&(e=0),this.removeHighlight(),(t=k(i[e])).addClass("select2-highlighted"),this.search.attr("aria-activedescendant",t.find(".select2-result-label").attr("id")),this.ensureHighlightVisible(),this.liveRegion.text(t.text()),(n=t.data("select2-data"))&&this.opts.element.trigger({type:"select2-highlight",val:this.id(n),choice:n})},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},touchMoved:function(){this._touchMoved=!0},clearTouchMoved:function(){this._touchMoved=!1},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(e){var t=k(e.target).closest(".select2-result-selectable");if(0<t.length&&!t.is(".select2-highlighted")){var n=this.findHighlightableChoices();this.highlight(n.index(t))}else 0==t.length&&this.removeHighlight()},loadMoreIfNeeded:function(){var t=this.results,n=t.find("li.select2-more-results"),i=this.resultsPage+1,o=this,a=this.search.val(),r=this.context;0!==n.length&&n.offset().top-t.offset().top-t.height()<=this.opts.loadMorePadding&&(n.addClass("select2-active"),this.opts.query({element:this.opts.element,term:a,page:i,context:r,matcher:this.opts.matcher,callback:this.bind(function(e){o.opened()&&(o.opts.populateResults.call(this,t,e.results,{term:a,page:i,context:r}),o.postprocessResults(e,!1,!1),!0===e.more?(n.detach().appendTo(t).html(o.opts.escapeMarkup($(o.opts.formatLoadMore,o.opts.element,i+1))),window.setTimeout(function(){o.loadMoreIfNeeded()},10)):n.remove(),o.positionDropdown(),o.resultsPage=i,o.context=e.context,this.opts.element.trigger({type:"select2-loaded",items:e}))})}))},tokenize:function(){},updateResults:function(n){var e,t,i,o=this.search,a=this.results,r=this.opts,s=this,l=o.val(),c=k.data(this.container,"select2-last-term");if((!0===n||!c||!p(l,c))&&(k.data(this.container,"select2-last-term",l),!0===n||!1!==this.showSearchInput&&this.opened())){i=++this.queryCount;var d=this.getMaximumSelectionSize();if(!(1<=d&&(e=this.data(),k.isArray(e)&&e.length>=d&&O(r.formatSelectionTooBig,"formatSelectionTooBig"))))return o.val().length<r.minimumInputLength?(O(r.formatInputTooShort,"formatInputTooShort")?h("<li class='select2-no-results'>"+$(r.formatInputTooShort,r.element,o.val(),r.minimumInputLength)+"</li>"):h(""),void(n&&this.showSearch&&this.showSearch(!0))):void(r.maximumInputLength&&o.val().length>r.maximumInputLength?O(r.formatInputTooLong,"formatInputTooLong")?h("<li class='select2-no-results'>"+$(r.formatInputTooLong,r.element,o.val(),r.maximumInputLength)+"</li>"):h(""):(r.formatSearching&&0===this.findHighlightableChoices().length&&h("<li class='select2-searching'>"+$(r.formatSearching,r.element)+"</li>"),o.addClass("select2-active"),this.removeHighlight(),(t=this.tokenize())!=w&&null!=t&&o.val(t),this.resultsPage=1,r.query({element:r.element,term:o.val(),page:this.resultsPage,context:null,matcher:r.matcher,callback:this.bind(function(e){var t;if(i==this.queryCount)if(this.opened())if(e.hasError!==w&&O(r.formatAjaxError,"formatAjaxError"))h("<li class='select2-ajax-error'>"+$(r.formatAjaxError,r.element,e.jqXHR,e.textStatus,e.errorThrown)+"</li>");else{if(this.context=e.context===w?null:e.context,this.opts.createSearchChoice&&""!==o.val()&&(t=this.opts.createSearchChoice.call(s,o.val(),e.results))!==w&&null!==t&&s.id(t)!==w&&null!==s.id(t)&&0===k(e.results).filter(function(){return p(s.id(this),s.id(t))}).length&&this.opts.createSearchChoicePosition(e.results,t),0===e.results.length&&O(r.formatNoMatches,"formatNoMatches"))return h("<li class='select2-no-results'>"+$(r.formatNoMatches,r.element,o.val())+"</li>"),void(this.showSearch&&this.showSearch(o.val()));a.empty(),s.opts.populateResults.call(this,a,e.results,{term:o.val(),page:this.resultsPage,context:null}),!0===e.more&&O(r.formatLoadMore,"formatLoadMore")&&(a.append("<li class='select2-more-results'>"+r.escapeMarkup($(r.formatLoadMore,r.element,this.resultsPage))+"</li>"),window.setTimeout(function(){s.loadMoreIfNeeded()},10)),this.postprocessResults(e,n),u(),this.opts.element.trigger({type:"select2-loaded",items:e})}else this.search.removeClass("select2-active")})})));h("<li class='select2-selection-limit'>"+$(r.formatSelectionTooBig,r.element,d)+"</li>")}function u(){o.removeClass("select2-active"),s.positionDropdown(),a.find(".select2-no-results,.select2-selection-limit,.select2-searching").length?s.liveRegion.text(a.text()):s.liveRegion.text(s.opts.formatMatches(a.find('.select2-result-selectable:not(".select2-selected")').length))}function h(e){a.html(e),u()}},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){var i;(i=this.search)[0]!==document.activeElement&&window.setTimeout(function(){var e,t=i[0],n=i.val().length;i.focus(),(0<t.offsetWidth||0<t.offsetHeight)&&t===document.activeElement&&(t.setSelectionRange?t.setSelectionRange(n,n):t.createTextRange&&((e=t.createTextRange()).collapse(!1),e.select()))},0)},selectHighlighted:function(e){if(this._touchMoved)this.clearTouchMoved();else{var t=this.highlight(),n=this.results.find(".select2-highlighted").closest(".select2-result").data("select2-data");n?(this.highlight(t),this.onSelect(n,e)):e&&e.noFocus&&this.close()}},getPlaceholder:function(){var e;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((e=this.getPlaceholderOption())!==w?e.text():w)},getPlaceholderOption:function(){if(this.select){var e=this.select.children("option").first();if(this.opts.placeholderOption!==w)return"first"===this.opts.placeholderOption&&e||"function"==typeof this.opts.placeholderOption&&this.opts.placeholderOption(this.select);if(""===k.trim(e.text())&&""===e.val())return e}},initContainerWidth:function(){var e=function(){var e,t,n,i,o;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"!==this.opts.width&&"resolve"!==this.opts.width)return k.isFunction(this.opts.width)?this.opts.width():this.opts.width;if("string"==typeof(e=this.opts.element.attr("style")))for(i=0,o=(t=e.split(";")).length;i<o;i+=1)if(null!==(n=t[i].replace(/\s/g,"").match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i))&&1<=n.length)return n[1];return"resolve"===this.opts.width?0<(e=this.opts.element.css("width")).indexOf("%")?e:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px":null}.call(this);null!==e&&this.container.css("width",e)}}),t=I(e,{createContainer:function(){return k(document.createElement("div")).attr({class:"select2-container"}).html(["<a href='javascript:void(0)' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&#160;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow' role='presentation'><b role='presentation'></b></span>","</a>","<label for='' class='select2-offscreen'></label>","<input class='select2-focusser select2-offscreen' type='text' aria-haspopup='true' role='button' />","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <label for='' class='select2-offscreen'></label>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input' role='combobox' aria-expanded='true'","       aria-autocomplete='list' />","   </div>","   <ul class='select2-results' role='listbox'>","   </ul>","</div>"].join(""))},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var e,t,n;0<=this.opts.minimumResultsForSearch&&this.showSearch(!0),this.parent.opening.apply(this,arguments),!1!==this.showSearchInput&&this.search.val(this.focusser.val()),this.opts.shouldFocusInput(this)&&(this.search.focus(),(e=this.search.get(0)).createTextRange?((t=e.createTextRange()).collapse(!1),t.select()):e.setSelectionRange&&(n=this.search.val().length,e.setSelectionRange(n,n))),this.prefillNextSearchTerm(),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger(k.Event("select2-open"))},close:function(){this.opened()&&(this.parent.close.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},focus:function(){this.opened()?this.close():(this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus()},destroy:function(){k("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),A.call(this,"selection","focusser")},initContainer:function(){var t,e,n=this.container,i=this.dropdown,o=x();this.opts.minimumResultsForSearch<0?this.showSearch(!1):this.showSearch(!0),this.selection=t=n.find(".select2-choice"),this.focusser=n.find(".select2-focusser"),t.find(".select2-chosen").attr("id","select2-chosen-"+o),this.focusser.attr("aria-labelledby","select2-chosen-"+o),this.results.attr("id","select2-results-"+o),this.search.attr("aria-owns","select2-results-"+o),this.focusser.attr("id","s2id_autogen"+o),e=k("label[for='"+this.opts.element.attr("id")+"']"),this.opts.element.on("focus.select2",this.bind(function(){this.focus()})),this.focusser.prev().text(e.text()).attr("for",this.focusser.attr("id"));var a=this.opts.element.attr("title");this.opts.element.attr("title",a||e.text()),this.focusser.attr("tabindex",this.elementTabIndex),this.search.attr("id",this.focusser.attr("id")+"_search"),this.search.prev().text(k("label[for='"+this.focusser.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()&&229!=e.keyCode)if(e.which!==s.PAGE_UP&&e.which!==s.PAGE_DOWN)switch(e.which){case s.UP:case s.DOWN:return this.moveHighlight(e.which===s.UP?-1:1),void v(e);case s.ENTER:return this.selectHighlighted(),void v(e);case s.TAB:return void this.selectHighlighted({noFocus:!0});case s.ESC:return this.cancel(e),void v(e)}else v(e)})),this.search.on("blur",this.bind(function(e){document.activeElement===this.body.get(0)&&window.setTimeout(this.bind(function(){this.opened()&&this.results&&1<this.results.length&&this.search.focus()}),0)})),this.focusser.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()&&e.which!==s.TAB&&!s.isControl(e)&&!s.isFunctionKey(e)&&e.which!==s.ESC){if(!1!==this.opts.openOnEnter||e.which!==s.ENTER){if(e.which==s.DOWN||e.which==s.UP||e.which==s.ENTER&&this.opts.openOnEnter){if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return;return this.open(),void v(e)}return e.which==s.DELETE||e.which==s.BACKSPACE?(this.opts.allowClear&&this.clear(),void v(e)):void 0}v(e)}})),m(this.focusser),this.focusser.on("keyup-change input",this.bind(function(e){if(0<=this.opts.minimumResultsForSearch){if(e.stopPropagation(),this.opened())return;this.open()}})),t.on("mousedown touchstart","abbr",this.bind(function(e){var t;this.isInterfaceEnabled()&&(this.clear(),(t=e).preventDefault(),t.stopImmediatePropagation(),this.close(),this.selection&&this.selection.focus())})),t.on("mousedown touchstart",this.bind(function(e){l(t),this.container.hasClass("select2-container-active")||this.opts.element.trigger(k.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),v(e)})),i.on("mousedown touchstart",this.bind(function(){this.opts.shouldFocusInput(this)&&this.search.focus()})),t.on("focus",this.bind(function(e){v(e)})),this.focusser.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(k.Event("select2-focus")),this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger(k.Event("select2-blur")))})),this.search.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(k.Event("select2-focus")),this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.opts.element.hide(),this.setPlaceholder()},clear:function(e){var t=this.selection.data("select2-data");if(t){var n=k.Event("select2-clearing");if(this.opts.element.trigger(n),n.isDefaultPrevented())return;var i=this.getPlaceholderOption();this.opts.element.val(i?i.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),!1!==e&&(this.opts.element.trigger({type:"select2-removed",val:this.id(t),choice:t}),this.triggerChange({removed:t}))}},initSelection:function(){if(this.isPlaceholderOptionSelected())this.updateSelection(null),this.close(),this.setPlaceholder();else{var t=this;this.opts.initSelection.call(null,this.opts.element,function(e){e!==w&&null!==e&&(t.updateSelection(e),t.close(),t.setPlaceholder(),t.lastSearchTerm=t.search.val())})}},isPlaceholderOptionSelected:function(){var e;return this.getPlaceholder()!==w&&((e=this.getPlaceholderOption())!==w&&e.prop("selected")||""===this.opts.element.val()||this.opts.element.val()===w||null===this.opts.element.val())},prepareOpts:function(){var r=this.parent.prepareOpts.apply(this,arguments),i=this;return"select"===r.element.get(0).tagName.toLowerCase()?r.initSelection=function(e,t){var n=e.find("option").filter(function(){return this.selected&&!this.disabled});t(i.optionToData(n))}:"data"in r&&(r.initSelection=r.initSelection||function(e,t){var o=e.val(),a=null;r.query({matcher:function(e,t,n){var i=p(o,r.id(n));return i&&(a=n),i},callback:k.isFunction(t)?function(){t(a)}:k.noop})}),r},getPlaceholder:function(){return this.select&&this.getPlaceholderOption()===w?w:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var e=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&e!==w){if(this.select&&this.getPlaceholderOption()===w)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")}},postprocessResults:function(e,t,n){var i=0,o=this;if(this.findHighlightableChoices().each2(function(e,t){if(p(o.id(t.data("select2-data")),o.opts.element.val()))return i=e,!1}),!1!==n&&(!0===t&&0<=i?this.highlight(i):this.highlight(0)),!0===t){var a=this.opts.minimumResultsForSearch;0<=a&&this.showSearch(function n(e){var i=0;return k.each(e,function(e,t){t.children?i+=n(t.children):i++}),i}(e.results)>=a)}},showSearch:function(e){this.showSearchInput!==e&&(this.showSearchInput=e,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!e),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!e),k(this.dropdown,this.container).toggleClass("select2-with-searchbox",e))},onSelect:function(e,t){if(this.triggerSelect(e)){var n=this.opts.element.val(),i=this.data();this.opts.element.val(this.id(e)),this.updateSelection(e),this.opts.element.trigger({type:"select2-selected",val:this.id(e),choice:e}),this.lastSearchTerm=this.search.val(),this.close(),t&&t.noFocus||!this.opts.shouldFocusInput(this)||this.focusser.focus(),p(n,this.id(e))||this.triggerChange({added:e,removed:i})}},updateSelection:function(e){var t,n,i=this.selection.find(".select2-chosen");this.selection.data("select2-data",e),i.empty(),null!==e&&(t=this.opts.formatSelection(e,i,this.opts.escapeMarkup)),t!==w&&i.append(t),(n=this.opts.formatSelectionCssClass(e,i))!==w&&i.addClass(n),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==w&&this.container.addClass("select2-allowclear")},val:function(){var e,t=!1,n=null,i=this,o=this.data();if(0===arguments.length)return this.opts.element.val();if(e=arguments[0],1<arguments.length&&(t=arguments[1],this.opts.debug&&console&&console.warn&&console.warn('Select2: The second option to `select2("val")` is not supported in Select2 4.0.0. The `change` event will always be triggered in 4.0.0.')),this.select)this.opts.debug&&console&&console.warn&&console.warn('Select2: Setting the value on a <select> using `select2("val")` is no longer supported in 4.0.0. You can use the `.val(newValue).trigger("change")` method provided by jQuery instead.'),this.select.val(e).find("option").filter(function(){return this.selected}).each2(function(e,t){return n=i.optionToData(t),!1}),this.updateSelection(n),this.setPlaceholder(),t&&this.triggerChange({added:n,removed:o});else{if(!e&&0!==e)return void this.clear(t);if(this.opts.initSelection===w)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){i.opts.element.val(e?i.id(e):""),i.updateSelection(e),i.setPlaceholder(),t&&i.triggerChange({added:e,removed:o})})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(e){var t,n=!1;if(0===arguments.length)return(t=this.selection.data("select2-data"))==w&&(t=null),t;this.opts.debug&&console&&console.warn&&console.warn('Select2: The `select2("data")` method can no longer set selected values in 4.0.0, consider using the `.val()` method instead.'),1<arguments.length&&(n=arguments[1]),e?(t=this.data(),this.opts.element.val(e?this.id(e):""),this.updateSelection(e),n&&this.triggerChange({added:e,removed:t})):this.clear(n)}}),n=I(e,{createContainer:function(){return k(document.createElement("div")).attr({class:"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <label for='' class='select2-offscreen'></label>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""))},prepareOpts:function(){var l=this.parent.prepareOpts.apply(this,arguments),i=this;return"select"===l.element.get(0).tagName.toLowerCase()?l.initSelection=function(e,t){var n=[];e.find("option").filter(function(){return this.selected&&!this.disabled}).each2(function(e,t){n.push(i.optionToData(t))}),t(n)}:"data"in l&&(l.initSelection=l.initSelection||function(e,a){var r=h(e.val(),l.separator,l.transformVal),s=[];l.query({matcher:function(e,t,n){var i=k.grep(r,function(e){return p(e,l.id(n))}).length;return i&&s.push(n),i},callback:k.isFunction(a)?function(){for(var e=[],t=0;t<r.length;t++)for(var n=r[t],i=0;i<s.length;i++){var o=s[i];if(p(n,l.id(o))){e.push(o),s.splice(i,1);break}}a(e)}:k.noop})}),l},selectChoice:function(e){var t=this.container.find(".select2-search-choice-focus");t.length&&e&&e[0]==t[0]||(t.length&&this.opts.element.trigger("choice-deselected",t),t.removeClass("select2-search-choice-focus"),e&&e.length&&(this.close(),e.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",e)))},destroy:function(){k("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),A.call(this,"searchContainer","selection")},initContainer:function(){var r,e=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=r=this.container.find(e);var t=this;this.selection.on("click",".select2-container:not(.select2-container-disabled) .select2-search-choice:not(.select2-locked)",function(e){t.search[0].focus(),t.selectChoice(k(this))}),this.search.attr("id","s2id_autogen"+x()),this.search.prev().text(k("label[for='"+this.opts.element.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.opts.element.on("focus.select2",this.bind(function(){this.focus()})),this.search.on("input paste",this.bind(function(){this.search.attr("placeholder")&&0==this.search.val().length||this.isInterfaceEnabled()&&(this.opened()||this.open())})),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()){++this.keydowns;var t=r.find(".select2-search-choice-focus"),n=t.prev(".select2-search-choice:not(.select2-locked)"),i=t.next(".select2-search-choice:not(.select2-locked)"),o=function(e){var t=0,n=0;if("selectionStart"in(e=k(e)[0]))t=e.selectionStart,n=e.selectionEnd-t;else if("selection"in document){e.focus();var i=document.selection.createRange();n=document.selection.createRange().text.length,i.moveStart("character",-e.value.length),t=i.text.length-n}return{offset:t,length:n}}(this.search);if(t.length&&(e.which==s.LEFT||e.which==s.RIGHT||e.which==s.BACKSPACE||e.which==s.DELETE||e.which==s.ENTER)){var a=t;return e.which==s.LEFT&&n.length?a=n:e.which==s.RIGHT?a=i.length?i:null:e.which===s.BACKSPACE?this.unselect(t.first())&&(this.search.width(10),a=n.length?n:i):e.which==s.DELETE?this.unselect(t.first())&&(this.search.width(10),a=i.length?i:null):e.which==s.ENTER&&(a=null),this.selectChoice(a),v(e),void(a&&a.length||this.open())}if((e.which===s.BACKSPACE&&1==this.keydowns||e.which==s.LEFT)&&0==o.offset&&!o.length)return this.selectChoice(r.find(".select2-search-choice:not(.select2-locked)").last()),void v(e);if(this.selectChoice(null),this.opened())switch(e.which){case s.UP:case s.DOWN:return this.moveHighlight(e.which===s.UP?-1:1),void v(e);case s.ENTER:return this.selectHighlighted(),void v(e);case s.TAB:return this.selectHighlighted({noFocus:!0}),void this.close();case s.ESC:return this.cancel(e),void v(e)}if(e.which!==s.TAB&&!s.isControl(e)&&!s.isFunctionKey(e)&&e.which!==s.BACKSPACE&&e.which!==s.ESC){if(e.which===s.ENTER){if(!1===this.opts.openOnEnter)return;if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return}this.open(),e.which!==s.PAGE_UP&&e.which!==s.PAGE_DOWN||v(e),e.which===s.ENTER&&v(e)}}})),this.search.on("keyup",this.bind(function(e){this.keydowns=0,this.resizeSearch()})),this.search.on("blur",this.bind(function(e){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),e.stopImmediatePropagation(),this.opts.element.trigger(k.Event("select2-blur"))})),this.container.on("click",e,this.bind(function(e){this.isInterfaceEnabled()&&(0<k(e.target).closest(".select2-search-choice").length||(this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger(k.Event("select2-focus")),this.open(),this.focusSearch(),e.preventDefault()))})),this.container.on("focus",e,this.bind(function(){this.isInterfaceEnabled()&&(this.container.hasClass("select2-container-active")||this.opts.element.trigger(k.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.initContainerWidth(),this.opts.element.hide(),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var t=this;this.opts.initSelection.call(null,this.opts.element,function(e){e!==w&&null!==e&&(t.updateSelection(e),t.close(),t.clearSearch())})}},clearSearch:function(){var e=this.getPlaceholder(),t=this.getMaxSearchWidth();e!==w&&0===this.getVal().length&&!1===this.search.hasClass("select2-focused")?(this.search.val(e).addClass("select2-default"),this.search.width(0<t?t:this.container.css("width"))):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),this.prefillNextSearchTerm(),this.updateResults(!0),this.opts.shouldFocusInput(this)&&this.search.focus(),this.opts.element.trigger(k.Event("select2-open"))},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(e){var t={},n=[],i=this;k(e).each(function(){i.id(this)in t||(t[i.id(this)]=0,n.push(this))}),this.selection.find(".select2-search-choice").remove(),this.addSelectedChoice(n),i.postprocessResults()},tokenize:function(){var e=this.search.val();null!=(e=this.opts.tokenizer.call(this,e,this.data(),this.bind(this.onSelect),this.opts))&&e!=w&&(this.search.val(e),0<e.length&&this.open())},onSelect:function(e,t){this.triggerSelect(e)&&""!==e.text&&(this.addSelectedChoice(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),this.lastSearchTerm=this.search.val(),this.clearSearch(),this.updateResults(),!this.select&&this.opts.closeOnSelect||this.postprocessResults(e,!1,!0===this.opts.closeOnSelect),!this.opts.closeOnSelect&&0<this.countSelectableResults()?(this.search.width(10),this.resizeSearch(),0<this.getMaximumSelectionSize()&&this.val().length>=this.getMaximumSelectionSize()?this.updateResults(!0):this.prefillNextSearchTerm()&&this.updateResults(),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:e}),t&&t.noFocus||this.focusSearch())},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(e){var t=this.getVal(),n=this;k(e).each(function(){t.push(n.createChoice(this))}),this.setVal(t)},createChoice:function(e){var t,n,i=!e.locked,o=k("<li class='select2-search-choice'>    <div></div>    <a href='#' class='select2-search-choice-close' tabindex='-1'></a></li>"),a=k("<li class='select2-search-choice select2-locked'><div></div></li>"),r=i?o:a,s=this.id(e);return(t=this.opts.formatSelection(e,r.find("div"),this.opts.escapeMarkup))!=w&&r.find("div").replaceWith(k("<div></div>").html(t)),(n=this.opts.formatSelectionCssClass(e,r.find("div")))!=w&&r.addClass(n),i&&r.find(".select2-search-choice-close").on("mousedown",v).on("click dblclick",this.bind(function(e){this.isInterfaceEnabled()&&(this.unselect(k(e.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),v(e),this.close(),this.focusSearch())})).on("focus",this.bind(function(){this.isInterfaceEnabled()&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),r.data("select2-data",e),r.insertBefore(this.searchContainer),s},unselect:function(e){var t,n,i=this.getVal();if(0===(e=e.closest(".select2-search-choice")).length)throw"Invalid argument: "+e+". Must be .select2-search-choice";if(t=e.data("select2-data")){var o=k.Event("select2-removing");if(o.val=this.id(t),o.choice=t,this.opts.element.trigger(o),o.isDefaultPrevented())return!1;for(;0<=(n=u(this.id(t),i));)i.splice(n,1),this.setVal(i),this.select&&this.postprocessResults();return e.remove(),this.opts.element.trigger({type:"select2-removed",val:this.id(t),choice:t}),this.triggerChange({removed:t}),!0}},postprocessResults:function(e,t,n){var i=this.getVal(),o=this.results.find(".select2-result"),a=this.results.find(".select2-result-with-children"),r=this;o.each2(function(e,t){0<=u(r.id(t.data("select2-data")),i)&&(t.addClass("select2-selected"),t.find(".select2-result-selectable").addClass("select2-selected"))}),a.each2(function(e,t){t.is(".select2-result-selectable")||0!==t.find(".select2-result-selectable:not(.select2-selected)").length||t.addClass("select2-selected")}),-1==this.highlight()&&!1!==n&&!0===this.opts.closeOnSelect&&r.highlight(0),!this.opts.createSearchChoice&&0<!o.filter(".select2-result:not(.select2-selected)").length&&(!e||e&&!e.more&&0===this.results.find(".select2-no-results").length)&&O(r.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+$(r.opts.formatNoMatches,r.opts.element,r.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-f(this.search)},resizeSearch:function(){var e,t,n,i,o=f(this.search);e=function(e){if(!a){var t=e[0].currentStyle||window.getComputedStyle(e[0],null);(a=k(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:t.fontSize,fontFamily:t.fontFamily,fontStyle:t.fontStyle,fontWeight:t.fontWeight,letterSpacing:t.letterSpacing,textTransform:t.textTransform,whiteSpace:"nowrap"})).attr("class","select2-sizer"),k(document.body).append(a)}return a.text(e.val()),a.width()}(this.search)+10,t=this.search.offset().left,(i=(n=this.selection.width())-(t-this.selection.offset().left)-o)<e&&(i=n-o),i<40&&(i=n-o),i<=0&&(i=e),this.search.width(Math.floor(i))},getVal:function(){var e;return this.select?null===(e=this.select.val())?[]:e:h(e=this.opts.element.val(),this.opts.separator,this.opts.transformVal)},setVal:function(e){if(this.select)this.select.val(e);else{var t=[],n={};k(e).each(function(){this in n||(t.push(this),n[this]=0)}),this.opts.element.val(0===t.length?"":t.join(this.opts.separator))}},buildChangeDetails:function(e,t){t=t.slice(0),e=e.slice(0);for(var n=0;n<t.length;n++)for(var i=0;i<e.length;i++)if(p(this.opts.id(t[n]),this.opts.id(e[i]))){t.splice(n,1),n--,e.splice(i,1);break}return{added:t,removed:e}},val:function(e,n){var i,o=this;if(0===arguments.length)return this.getVal();if((i=this.data()).length||(i=[]),!e&&0!==e)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),void(n&&this.triggerChange({added:this.data(),removed:i}));if(this.setVal(e),this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),n&&this.triggerChange(this.buildChangeDetails(i,this.data()));else{if(this.opts.initSelection===w)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(e){var t=k.map(e,o.id);o.setVal(t),o.updateSelection(e),o.clearSearch(),n&&o.triggerChange(o.buildChangeDetails(i,o.data()))})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var e=[],t=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){e.push(t.opts.id(k(this).data("select2-data")))}),this.setVal(e),this.triggerChange()},data:function(e,t){var n,i,o=this;if(0===arguments.length)return this.selection.children(".select2-search-choice").map(function(){return k(this).data("select2-data")}).get();i=this.data(),e=e||[],n=k.map(e,function(e){return o.opts.id(e)}),this.setVal(n),this.updateSelection(e),this.clearSearch(),t&&this.triggerChange(this.buildChangeDetails(i,this.data()))}}),k.fn.select2=function(){var e,t,n,i,o,a=Array.prototype.slice.call(arguments,0),r=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],s=["opened","isFocused","container","dropdown"],l=["val","data"],c={search:"externalSearch"};return this.each(function(){if(0===a.length||"object"==typeof a[0])(e=0===a.length?{}:k.extend({},a[0])).element=k(this),"select"===e.element.get(0).tagName.toLowerCase()?o=e.element.prop("multiple"):(o=e.multiple||!1,"tags"in e&&(e.multiple=o=!0)),(t=o?new window.Select2.class.multi:new window.Select2.class.single).init(e);else{if("string"!=typeof a[0])throw"Invalid arguments to select2 plugin: "+a;if(u(a[0],r)<0)throw"Unknown method: "+a[0];if(i=w,(t=k(this).data("select2"))===w)return;if(n=a[0],i="container"===n?t.container:"dropdown"===n?t.dropdown:(c[n]&&(n=c[n]),t[n].apply(t,a.slice(1))),0<=u(a[0],s)||0<=u(a[0],l)&&1==a.length)return!1}}),i===w?this:i},k.fn.select2.defaults={debug:!1,width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,n,i){var o=[];return b(this.text(e),n.term,o,i),o.join("")},transformVal:function(e){return k.trim(e)},formatSelection:function(e,t,n){return e?n(this.text(e)):w},sortResults:function(e,t,n){return e},formatResultCssClass:function(e){return e.css},formatSelectionCssClass:function(e,t){return w},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e==w?null:e.id},text:function(e){return e&&this.data&&this.data.text?k.isFunction(this.data.text)?this.data.text(e):e[this.data.text]:e.text},matcher:function(e,t){return 0<=d(""+t).toUpperCase().indexOf(d(""+e).toUpperCase())},separator:",",tokenSeparators:[],tokenizer:function(e,t,n,i){var o,a,r,s,l,c=e,d=!1;if(!i.createSearchChoice||!i.tokenSeparators||i.tokenSeparators.length<1)return w;for(;;){for(a=-1,r=0,s=i.tokenSeparators.length;r<s&&(l=i.tokenSeparators[r],!(0<=(a=e.indexOf(l))));r++);if(a<0)break;if(o=e.substring(0,a),e=e.substring(a+l.length),0<o.length&&(o=i.createSearchChoice.call(this,o,t))!==w&&null!==o&&i.id(o)!==w&&null!==i.id(o)){for(d=!1,r=0,s=t.length;r<s;r++)if(p(i.id(o),i.id(t[r]))){d=!0;break}d||n(o)}}return c!==e?e:void 0},escapeMarkup:T,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(e){return null},nextSearchTerm:function(e,t){return w},searchInputPlaceholder:"",createSearchChoicePosition:"top",shouldFocusInput:function(e){return!("ontouchstart"in window||0<navigator.msMaxTouchPoints)||!(e.opts.minimumResultsForSearch<0)}},k.fn.select2.locales=[],k.fn.select2.locales.en={formatMatches:function(e){return 1===e?"One result is available, press enter to select it.":e+" results are available, use up and down arrow keys to navigate."},formatNoMatches:function(){return"No matches found"},formatAjaxError:function(e,t,n){return"Loading failed"},formatInputTooShort:function(e,t){var n=t-e.length;return"Please enter "+n+" or more character"+(1==n?"":"s")},formatInputTooLong:function(e,t){var n=e.length-t;return"Please delete "+n+" character"+(1==n?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(1==e?"":"s")},formatLoadMore:function(e){return"Loading more results…"},formatSearching:function(){return"Searching…"}},k.extend(k.fn.select2.defaults,k.fn.select2.locales.en),k.fn.select2.ajaxDefaults={transport:k.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:E,local:C,tags:D},util:{debounce:g,markMatch:b,escapeMarkup:T,stripDiacritics:d},class:{abstract:e,single:t,multi:n}}}function l(e){var t=k(document.createTextNode(""));e.before(t),t.before(e),t.remove()}function d(e){return e.replace(/[^\u0000-\u007E]/g,function(e){return r[e]||e})}function u(e,t){for(var n=0,i=t.length;n<i;n+=1)if(p(e,t[n]))return n;return-1}function p(e,t){return e===t||e!==w&&t!==w&&(null!==e&&null!==t&&(e.constructor===String?e+""==t+"":t.constructor===String&&t+""==e+""))}function h(e,t,n){var i,o,a;if(null===e||e.length<1)return[];for(o=0,a=(i=e.split(t)).length;o<a;o+=1)i[o]=n(i[o]);return i}function f(e){return e.outerWidth(!1)-e.width()}function m(t){var n="keyup-change-value";t.on("keydown",function(){k.data(t,n)===w&&k.data(t,n,t.val())}),t.on("keyup",function(){var e=k.data(t,n);e!==w&&t.val()!==e&&(k.removeData(t,n),t.trigger("keyup-change"))})}function g(t,n,i){var o;return i=i||w,function(){var e=arguments;window.clearTimeout(o),o=window.setTimeout(function(){n.apply(i,e)},t)}}function v(e){e.preventDefault(),e.stopPropagation()}function y(e,t,n){var i,o,a=[];(i=k.trim(e.attr("class")))&&k((i=""+i).split(/\s+/)).each2(function(){0===this.indexOf("select2-")&&a.push(this)}),(i=k.trim(t.attr("class")))&&k((i=""+i).split(/\s+/)).each2(function(){0!==this.indexOf("select2-")&&(o=n(this))&&a.push(o)}),e.attr("class",a.join(" "))}function b(e,t,n,i){var o=d(e.toUpperCase()).indexOf(d(t.toUpperCase())),a=t.length;o<0?n.push(i(e)):(n.push(i(e.substring(0,o))),n.push("<span class='select2-match'>"),n.push(i(e.substring(o,o+a))),n.push("</span>"),n.push(i(e.substring(o+a,e.length))))}function T(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})}function E(r){var e,s=null,t=r.quietMillis||100,l=r.url,c=this;return function(a){window.clearTimeout(e),e=window.setTimeout(function(){var e=r.data,t=l,n=r.transport||k.fn.select2.ajaxDefaults.transport,i={type:r.type||"GET",cache:r.cache||!1,jsonpCallback:r.jsonpCallback||w,dataType:r.dataType||"json"},o=k.extend({},k.fn.select2.ajaxDefaults.params,i);e=e?e.call(c,a.term,a.page,a.context):null,t="function"==typeof t?t.call(c,a.term,a.page,a.context):t,s&&"function"==typeof s.abort&&s.abort(),r.params&&(k.isFunction(r.params)?k.extend(o,r.params.call(c)):k.extend(o,r.params)),k.extend(o,{url:t,dataType:r.dataType,data:e,success:function(e){var t=r.results(e,a.page,a);a.callback(t)},error:function(e,t,n){var i={hasError:!0,jqXHR:e,textStatus:t,errorThrown:n};a.callback(i)}}),s=n.call(c,o)},t)}}function C(e){var t,n,i=e,s=function(e){return""+e.text};k.isArray(i)&&(i={results:n=i}),!1===k.isFunction(i)&&(n=i,i=function(){return n});var o=i();return o.text&&(s=o.text,k.isFunction(s)||(t=o.text,s=function(e){return e[t]})),function(o){var a,r=o.term,n={results:[]};""!==r?(a=function(e,t){var n,i;if((e=e[0]).children){for(i in n={},e)e.hasOwnProperty(i)&&(n[i]=e[i]);n.children=[],k(e.children).each2(function(e,t){a(t,n.children)}),(n.children.length||o.matcher(r,s(n),e))&&t.push(n)}else o.matcher(r,s(e),e)&&t.push(e)},k(i().results).each2(function(e,t){a(t,n.results)}),o.callback(n)):o.callback(i())}}function D(t){var a=k.isFunction(t);return function(n){var i=n.term,o={results:[]},e=a?t(n):t;k.isArray(e)&&(k(e).each(function(){var e=this.text!==w,t=e?this.text:this;""!==i&&!n.matcher(i,t)||o.results.push(e?this:{id:this,text:this})}),n.callback(o))}}function O(e,t){if(k.isFunction(e))return 1;if(e){if("string"==typeof e)return 1;throw new Error(t+" must be a string, function, or falsy value")}}function $(e,t){if(k.isFunction(e)){var n=Array.prototype.slice.call(arguments,2);return e.apply(t,n)}return e}function A(){var n=this;k.each(arguments,function(e,t){n[t].remove(),n[t]=null})}function I(e,t){function n(){}return((n.prototype=new e).constructor=n).prototype.parent=e.prototype,n.prototype=k.extend(n.prototype,t),n}}(jQuery)}.apply(e,arguments)})}(this),define("mockup-patterns-select2",["jquery","pat-base","mockup-utils","sortable","select2"],function(s,e,l,i){"use strict";return e.extend({name:"select2",trigger:".pat-select2",parser:"mockup",defaults:{separator:","},initializeValues:function(){var a=this;a.options.initialValues&&(a.options.id=function(e){return e.id},a.options.initSelection=function(e,t){var n=[],i=e.val(),o=a.options.initialValues;"string"==typeof a.options.initialValues&&""!==a.options.initialValues&&("{"===a.options.initialValues[0]?o=JSON.parse(a.options.initialValues):(o={},s(a.options.initialValues.split(a.options.separator)).each(function(){var e=this.split(":"),t=s.trim(e[0]),n=s.trim(e[1]);o[t]=n}))),s(i.split(a.options.separator)).each(function(){var e=this;o[this]&&(e=o[this]),n.push({id:l.removeHTML(this),text:l.removeHTML(e)})}),t(n)})},initializeTags:function(){var e=this;e.options.tags&&"string"==typeof e.options.tags&&("["===e.options.tags.substr(0,1)?e.options.tags=JSON.parse(e.options.tags):e.options.tags=e.options.tags.split(e.options.separator)),e.options.tags&&!e.options.allowNewItems&&(e.options.data=s.map(e.options.tags,function(e,t){return{id:e,text:e}}),e.options.multiple=!0,delete e.options.tags)},initializeOrdering:function(){var n=this;n.options.orderable&&this.$el.on("change",function(e){var t=this.$select2[0].querySelector(".select2-choices");new i(t,{draggable:"li",dragClass:"select2-choice-dragging",chosenClass:"dragging",onStart:function(e){n.$el.select2("onSortStart")}.bind(this),onEnd:function(e){this.$el.select2("onSortEnd")}.bind(this)})}.bind(this))},initializeSelect2:function(){var n=this;function t(e,t){return e?(n.options.debug&&console.debug("callback",e,t),"string"==typeof e&&(e=window[e]),e(t)):e}n.options.formatResultCssClass=function(e){if(e.id)return"select2-option-"+e.id.toLowerCase().replace(/[ \:\)\(\[\]\{\}\_\+\=\&\*\%\#]/g,"-")},n.$el.select2(n.options),n.$el.on("select2-selected",function(e){t(n.options.onSelected,e)}),n.$el.on("select2-selecting",function(e){t(n.options.onSelecting,e)}),n.$el.on("select2-deselecting",function(e){t(n.options.onDeselecting,e)}),n.$el.on("select2-deselected",function(e){t(n.options.onDeselected,e)}),n.$select2=n.$el.parent().find(".select2-container"),n.$el.parent().off("close.plone-modal.patterns"),n.options.orderable&&n.$select2.addClass("select2-orderable")},opened:function(){return 1===s(".select2-dropdown-open",this.$el.parent()).length},init:function(){var a=this;if(a.options.allowNewItems=!a.options.hasOwnProperty("allowNewItems")||JSON.parse(a.options.allowNewItems),a.options.ajax||a.options.vocabularyUrl){a.options.vocabularyUrl&&(a.options.multiple=void 0===a.options.multiple||a.options.multiple,a.options.ajax=a.options.ajax||{},a.options.ajax.url=a.options.vocabularyUrl,a.options.initSelection=function(e,t){var n=[],i=e.val();s(i.split(a.options.separator)).each(function(){var e=l.removeHTML(this);n.push({id:e,text:e})}),t(n)});var r="";a.options.ajax=s.extend({quietMillis:300,data:function(e,t){return{query:r=e,page_limit:10,page:t}},results:function(e,t){var n=e.results;if(a.options.vocabularyUrl){var i=[];s.each(e.results,function(e,t){i.push(t.id)}),n=[];var o=""===r||0<=s.inArray(r,i);a.options.allowNewItems&&!o&&(r=l.removeHTML(r),n.push({id:r,text:r})),s.each(e.results,function(e,t){n.push(t)})}return{results:n}}},a.options.ajax)}else if(a.options.multiple&&a.$el.is("select")){var e=a.$el.val()||[],t=s.map(a.$el.find("option"),function(e){return{text:s(e).html(),id:e.value}}),n=s('<input type="hidden" />');n.val(e.join(a.options.separator)),n.attr("class",a.$el.attr("class")),n.attr("name",a.$el.attr("name")),n.attr("id",a.$el.attr("id")),a.$orig=a.$el,a.$el.replaceWith(n),a.$el=n,a.options.data=t}a.initializeValues(),a.initializeTags(),a.initializeOrdering(),a.initializeSelect2()}})}),define("mockup-ui-url/views/base",["jquery","underscore","backbone","translate"],function(n,i,o,a){"use strict";return o.View.extend({isUIView:!0,eventPrefix:"ui",template:null,idPrefix:"base-",appendInContainer:!0,initialize:function(e){for(var t in this.options=e,this.options)this[t]=this.options[t];this.options._t=a},render:function(){return this.applyTemplate(),this.trigger("render",this),this.afterRender(),this.options.id&&this.$el.attr("id",this.idPrefix+this.options.id),this},afterRender:function(){},serializedModel:function(){return this.options},applyTemplate:function(){if(null!==this.template){var e=n.extend({_t:a},this.options,this.serializedModel()),t=this.template;"string"==typeof t&&(t=i.template(t)),this.$el.html(t(e))}},propagateEvent:function(e){if(0<e.indexOf(":")){var t=e.split(":")[0];if(""!==this.eventPrefix&&(t===this.eventPrefix||t===this.eventPrefix+"."+this.id))return!0}return!1},uiEventTrigger:function(e){var t=[].slice.call(arguments,0);""!==this.eventPrefix&&(t[0]=this.eventPrefix+":"+e,o.View.prototype.trigger.apply(this,t),this.id&&(t[0]=this.eventPrefix+"."+this.id+":"+e,o.View.prototype.trigger.apply(this,t)))}})}),define("mockup-patterns-tooltip",["jquery","pat-base"],function(f,e,t){"use strict";function n(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)}return n.VERSION="3.2.0",n.DEFAULTS={animation:!0,placement:"auto",selector:!1,template:'<div class="tooltip mockup-tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!0,container:!1,viewport:{selector:"body",padding:0}},n.prototype.init=function(e,t,n){this.enabled=!0,this.type=e,this.$element=f(t),this.options=this.getOptions(n),this.$viewport=this.options.viewport&&f(this.options.viewport.selector||this.options.viewport);for(var i=this.options.trigger.split(" "),o=i.length;o--;){var a=i[o];if("click"==a)this.$element.on("click."+this.type,this.options.selector,f.proxy(this.toggle,this));else if("manual"!=a){var r="hover"==a?"mouseenter":"focusin",s="hover"==a?"mouseleave":"focusout";this.$element.on(r+"."+this.type,this.options.selector,f.proxy(this.enter,this)),this.$element.on(s+"."+this.type,this.options.selector,f.proxy(this.leave,this))}}this.options.selector?this._options=f.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.getOptions=function(e){return(e=f.extend({},this.getDefaults(),this.$element.data(),e)).delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},n.prototype.getDelegateOptions=function(){var n={},i=this.getDefaults();return this._options&&f.each(this._options,function(e,t){i[e]!=t&&(n[e]=t)}),n},n.prototype.enter=function(e){var t=e instanceof this.constructor?e:f(e.currentTarget).data("bs."+this.type);if(t||(t=new this.constructor(e.currentTarget,this.getDelegateOptions()),f(e.currentTarget).data("bs."+this.type,t)),t.leaving=!1,clearTimeout(t.timeout),t.hoverState="in",!t.options.delay||!t.options.delay.show)return t.show();t.timeout=setTimeout(function(){"in"==t.hoverState&&t.show()},t.options.delay.show)},n.prototype.leave=function(e){var t=e instanceof this.constructor?e:f(e.currentTarget).data("bs."+this.type);if(t.leaving=!0,t||(t=new this.constructor(e.currentTarget,this.getDelegateOptions()),f(e.currentTarget).data("bs."+this.type,t)),clearTimeout(t.timeout),t.hoverState="out",!t.options.delay||!t.options.delay.hide)return t.hide();t.timeout=setTimeout(function(){"out"==t.hoverState&&t.hide()},t.options.delay.hide)},n.prototype.show=function(){var e=f.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var t=f.contains(document.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!t)return;var u=this.tip(),h=this.getUID(this.type),p=this;this.setContent().then(function(){u.attr("id",h),p.$element.attr("aria-describedby",h),p.options.animation&&u.addClass("fade");var e="function"==typeof p.options.placement?p.options.placement.call(p,u[0],p.$element[0]):p.options.placement,t=/\s?auto?\s?/i,n=t.test(e);n&&(e=e.replace(t,"")||"top"),u.detach().css({top:0,left:0,display:"block"}).addClass(e).data("bs."+p.type,p),p.options.container?u.appendTo(p.options.container):u.insertAfter(p.$element);var i=p.getPosition(),o=u[0].offsetWidth,a=u[0].offsetHeight;if(n){var r=e,s=p.$element.parent(),l=p.getPosition(s);e="bottom"==e&&i.top+i.height+a-l.scroll>l.height?"top":"top"==e&&i.top-l.scroll-a<0?"bottom":"right"==e&&i.right+o>l.width?"left":"left"==e&&i.left-o<l.left?"right":e,u.removeClass(r).addClass(e)}var c=p.getCalculatedOffset(e,i,o,a);p.applyPlacement(c,e);function d(){p.$element.trigger("shown.bs."+p.type),p.hoverState=null,p.leaving&&p.leave(p)}f.support.transition&&p.$tip.hasClass("fade")?u.one("bsTransitionEnd",d).emulateTransitionEnd(150):d()})}},n.prototype.applyPlacement=function(e,t){var n=this.tip(),i=n[0].offsetWidth,o=n[0].offsetHeight,a=parseInt(n.css("margin-top"),10),r=parseInt(n.css("margin-left"),10);isNaN(a)&&(a=0),isNaN(r)&&(r=0),e.top=e.top+a,e.left=e.left+r,f.offset.setOffset(n[0],f.extend({using:function(e){n.css({top:Math.round(e.top),left:Math.round(e.left)})}},e),0),n.addClass("in");var s=n[0].offsetWidth,l=n[0].offsetHeight;"top"==t&&l!=o&&(e.top=e.top+o-l);var c=this.getViewportAdjustedDelta(t,e,s,l);c.left?e.left+=c.left:e.top+=c.top;var d=c.left?2*c.left-i+s:2*c.top-o+l,u=c.left?"left":"top",h=c.left?"offsetWidth":"offsetHeight";n.offset(e),this.replaceArrow(d,n[0][h],u)},n.prototype.replaceArrow=function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},n.prototype.setContent=function(){var t=this.tip(),n=this.options.html?"html":"text",i=this.options.patTooltip?this.options.patTooltip.contentSelector:null;function o(e){"html"===n&&i&&(e=f(e).find(i).html()),t.find(".tooltip-inner")[n](e)}function e(){t.removeClass("fade in top bottom left right")}var a=this.getTitle(),r=this.getUrl();return r?(e(),f.get(r).then(function(e){o(e)})):(e(),o(a),new Promise(function(e,t){e(a)}))},n.prototype.getUrl=function(){return this.options.patTooltip?this.options.patTooltip.ajaxUrl:null},n.prototype.hide=function(){var e=this,t=this.tip(),n=f.Event("hide.bs."+this.type);function i(){"in"!=e.hoverState&&t.detach(),e.$element.trigger("hidden.bs."+e.type)}if(this.$element.removeAttr("aria-describedby"),this.$element.trigger(n),!n.isDefaultPrevented())return t.removeClass("in"),f.support.transition&&this.$tip.hasClass("fade")?t.one("bsTransitionEnd",i).emulateTransitionEnd(150):i(),this.hoverState=null,this},n.prototype.fixTitle=function(){var e=this.$element;!e.attr("title")&&"string"==typeof e.attr("data-original-title")||e.attr("data-original-title",e.attr("title")||"").attr("title","")},n.prototype.hasContent=function(){return this.getTitle()||this.getUrl()},n.prototype.getPosition=function(e){var t=(e=e||this.$element)[0],n="BODY"==t.tagName;return f.extend({},"function"==typeof t.getBoundingClientRect?t.getBoundingClientRect():null,{scroll:n?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop(),width:n?f(window).width():e.outerWidth(),height:n?f(window).height():e.outerHeight()},n?{top:0,left:0}:e.offset())},n.prototype.getCalculatedOffset=function(e,t,n,i){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-n/2}:"top"==e?{top:t.top-i,left:t.left+t.width/2-n/2}:"left"==e?{top:t.top+t.height/2-i/2,left:t.left-n}:{top:t.top+t.height/2-i/2,left:t.left+t.width}},n.prototype.getViewportAdjustedDelta=function(e,t,n,i){var o={top:0,left:0};if(!this.$viewport)return o;var a=this.options.viewport&&this.options.viewport.padding||0,r=this.getPosition(this.$viewport);if(/right|left/.test(e)){var s=t.top-a-r.scroll,l=t.top+a-r.scroll+i;s<r.top?o.top=r.top-s:l>r.top+r.height&&(o.top=r.top+r.height-l)}else{var c=t.left-a,d=t.left+a+n;c<r.left?o.left=r.left-c:d>r.width&&(o.left=r.left+r.width-d)}return o},n.prototype.getTitle=function(){var e=this.$element,t=this.options;return e.attr("data-original-title")||("function"==typeof t.title?t.title.call(e[0]):t.title)},n.prototype.getUID=function(e){for(;e+=~~(1e6*Math.random()),document.getElementById(e););return e},n.prototype.tip=function(){if(this.$tip)return this.$tip;var e=this.$tip||f(this.options.template);return this.options.patTooltip&&(this.options.patTooltip.style&&e.css(this.options.patTooltip.style),this.options.patTooltip.class&&e.addClass(this.options.patTooltip.class),this.options.patTooltip.innerStyle&&e.find(".tooltip-inner").css(this.options.patTooltip.innerStyle)),this.$tip=e},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},n.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},n.prototype.enable=function(){this.enabled=!0},n.prototype.disable=function(){this.enabled=!1},n.prototype.toggleEnabled=function(){this.enabled=!this.enabled},n.prototype.toggle=function(e){var t=this;e&&((t=f(e.currentTarget).data("bs."+this.type))||(t=new this.constructor(e.currentTarget,this.getDelegateOptions()),f(e.currentTarget).data("bs."+this.type,t))),t.tip().hasClass("in")?t.leave(t):t.enter(t)},n.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)},e.extend({name:"tooltip",trigger:".pat-tooltip",parser:"mockup",defaults:{html:!1,placement:"top"},init:function(){"true"===this.options.html||!0===this.options.html?this.options.html=!0:this.options.html=!1,this.data=new n(this.$el[0],this.options)}})}),define("mockup-ui-url/views/button",["underscore","mockup-ui-url/views/base","mockup-patterns-tooltip"],function(n,i,o){"use strict";return i.extend({tagName:"a",className:"btn",eventPrefix:"button",context:"default",idPrefix:"btn-",attributes:{href:"#"},extraClasses:[],tooltip:null,template:'<% if (icon) { %><span class="glyphicon glyphicon-<%= icon %>"></span><% } %> <%= title %>',events:{click:"handleClick"},initialize:function(e){if(!e.id){var t=e.title||"";e.id=""!==t?t.toLowerCase().replace(" ","-"):this.cid}i.prototype.initialize.apply(this,[e]),this.on("render",function(){if(this.$el.attr("title",this.options.title||""),this.$el.attr("aria-label",this.options.title||this.options.tooltip||""),null!==this.context&&this.$el.addClass("btn-"+this.context),n.each(this.extraClasses,function(e){this.$el.addClass(e)}.bind(this)),null!==this.tooltip){this.$el.attr("title",this.tooltip);new o(this.$el);this.$el.on("hidden",function(e){"hidden"===e.type&&e.stopPropagation()})}},this)},handleClick:function(e){e.preventDefault(),this.$el.is(".disabled")||this.uiEventTrigger("click",this,e)},serializedModel:function(){return n.extend({icon:"",title:""},this.options)},disable:function(){this.$el.addClass("disabled")},enable:function(){this.$el.removeClass("disabled")}})}),define("text",["module"],function(e){"use strict";var c,o,r,s,l,i=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],n=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,d="undefined"!=typeof location&&location.href,u=d&&location.protocol&&location.protocol.replace(/\:/,""),h=d&&location.hostname,p=d&&(location.port||void 0),f={},m=e.config&&e.config()||{};function g(e,t){return void 0===e||""===e?t:e}return c={version:"2.0.15",strip:function(e){if(e){var t=(e=e.replace(n,"")).match(a);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:m.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;t<3;t+=1){n=i[t];try{e=new ActiveXObject(n)}catch(e){}if(e){i=[n];break}}return e},parseName:function(e){var t,n,i,o=!1,a=e.lastIndexOf("."),r=0===e.indexOf("./")||0===e.indexOf("../");return-1!==a&&(!r||1<a)?(t=e.substring(0,a),n=e.substring(a+1)):t=e,-1!==(a=(i=n||t).indexOf("!"))&&(o="strip"===i.substring(a+1),i=i.substring(0,a),n?n=i:t=i),{moduleName:t,ext:n,strip:o}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,n,i){var o,a,r,s=c.xdRegExp.exec(e);return!s||(o=s[2],r=(a=(a=s[3]).split(":"))[1],a=a[0],(!o||o===t)&&(!a||a.toLowerCase()===n.toLowerCase())&&(!r&&!a||function(e,t,n,i){if(t===i)return!0;if(e===n){if("http"===e)return g(t,"80")===g(i,"80");if("https"===e)return g(t,"443")===g(i,"443")}return!1}(o,r,t,i)))},finishLoad:function(e,t,n,i){n=t?c.strip(n):n,m.isBuild&&(f[e]=n),i(n)},load:function(t,e,n,i){if(i&&i.isBuild&&!i.inlineText)n();else{m.isBuild=i&&i.isBuild;var o=c.parseName(t),a=o.moduleName+(o.ext?"."+o.ext:""),r=e.toUrl(a),s=m.useXhr||c.useXhr;0!==r.indexOf("empty:")?!d||s(r,u,h,p)?c.get(r,function(e){c.finishLoad(t,o.strip,e,n)},function(e){n.error&&n.error(e)}):e([a],function(e){c.finishLoad(o.moduleName+"."+o.ext,o.strip,e,n)}):n()}},write:function(e,t,n,i){if(f.hasOwnProperty(t)){var o=c.jsEscape(f[t]);n.asModule(e+"!"+t,"define(function () { return '"+o+"';});\n")}},writeFile:function(n,e,t,i,o){var a=c.parseName(e),r=a.ext?"."+a.ext:"",s=a.moduleName+r,l=t.toUrl(a.moduleName+r)+".js";c.load(s,t,function(e){function t(e){return i(l,e)}t.asModule=function(e,t){return i.asModule(e,l,t)},c.write(n,s,t,o)},o)}},"node"===m.env||!m.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(o=require.nodeRequire("fs"),c.get=function(e,t,n){try{var i=o.readFileSync(e,"utf8");"\ufeff"===i[0]&&(i=i.substring(1)),t(i)}catch(e){n&&n(e)}}):"xhr"===m.env||!m.env&&c.createXhr()?c.get=function(i,o,a,e){var t,r=c.createXhr();if(r.open("GET",i,!0),e)for(t in e)e.hasOwnProperty(t)&&r.setRequestHeader(t.toLowerCase(),e[t]);m.onXhr&&m.onXhr(r,i),r.onreadystatechange=function(e){var t,n;4===r.readyState&&(399<(t=r.status||0)&&t<600?((n=new Error(i+" HTTP status: "+t)).xhr=r,a&&a(n)):o(r.responseText),m.onXhrComplete&&m.onXhrComplete(r,i))},r.send(null)}:"rhino"===m.env||!m.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?c.get=function(e,t){var n,i,o=new java.io.File(e),a=java.lang.System.getProperty("line.separator"),r=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),"utf-8")),s="";try{for(n=new java.lang.StringBuffer,(i=r.readLine())&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&n.append(i);null!==(i=r.readLine());)n.append(a),n.append(i);s=String(n.toString())}finally{r.close()}t(s)}:("xpconnect"===m.env||!m.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(r=Components.classes,s=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),l="@mozilla.org/windows-registry-key;1"in r,c.get=function(e,t){var n,i,o,a={};l&&(e=e.replace(/\//g,"\\")),o=new FileUtils.File(e);try{(n=r["@mozilla.org/network/file-input-stream;1"].createInstance(s.nsIFileInputStream)).init(o,1,0,!1),(i=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(s.nsIConverterInputStream)).init(n,"utf-8",n.available(),s.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),i.readString(n.available(),a),i.close(),n.close(),t(a.value)}catch(e){throw new Error((o&&o.path||"")+": "+e)}}),c}),define("text!mockup-patterns-relateditems-url/templates/breadcrumb.xml",[],function(){return'<span class="separator">/<span>\n<a href="<%- path %>" class="crumb"><%- text %></a>\n'}),define("text!mockup-patterns-relateditems-url/templates/favorite.xml",[],function(){return'<li><a href="<%- path %>" class="fav" aria-labelledby="blip"><%- title %></a></li>\n'}),define("text!mockup-patterns-relateditems-url/templates/recentlyused.xml",[],function(){return'<li class="pattern-relateditems-recentlyused">\n  <a class="pattern-relateditems-recentlyused-select" data-uid="<%- UID %>">\n    <div class="pattern-relateditems-recentlyused-info">\n      <span\n        class="pattern-relateditems-recentlyused-title <%- portal_type ? \'contenttype-\' + portal_type.toLowerCase() : \'\' %> <%- review_state ? \'state-\' + review_state : \'\' %>"\n        title="<%- portal_type %>">\n        <%- Title %>\n      </span>\n      <span class="pattern-relateditems-recentlyused-path"><%- path %></span>\n    </div>\n    <% if (getURL && (getIcon || portal_type === "Image")) { %>\n      <div class="pattern-relateditems-recentlyused-image">\n        <img src="<%- getURL %>/@@images/image/tile" />\n      </div>\n    <% } %>\n  </a>\n</li>\n'}),define("text!mockup-patterns-relateditems-url/templates/result.xml",[],function(){return'<div class="pattern-relateditems-result <%- oneLevelUp ? \'one-level-up\' : \'\' %>">\n  <div class="pattern-relateditems-result-browse-wrapper">\n  <% if (!oneLevelUp) { %>\n    <a\n      class="pattern-relateditems-result-select<%- selectable ? \' selectable\' : \'\' %><%- oneLevelUp ? \' one-level-up\' : \'\' %>"\n      data-path="<%- path %>">\n  <% } %>\n      <div class="pattern-relateditems-result-info">\n        <span\n          class="pattern-relateditems-result-title <%- portal_type ? \'contenttype-\' + portal_type.toLowerCase() : \'\' %> <%- review_state ? \'state-\' + review_state : \'\' %>"\n          title="<%- portal_type %>">\n          <%- Title %>\n        </span>\n        <span class="pattern-relateditems-result-path"><%- oneLevelUp ? currentPath : path %></span>\n      </div>\n      <% if (is_folderish) { %>\n        <a\n          class="pattern-relateditems-result-browse"\n          data-path="<%- path %>"\n          title="<%- oneLevelUp ? one_level_up : open_folder %>">\n          <span class="<%- oneLevelUp ? \'icon-left-circle\' : \'icon-right-circle\' %>"></span>\n        </a>\n      <% } %>\n  <% if (!oneLevelUp) { %>\n    </a>\n  <% } %>\n  </div>\n  <% if (getURL && (getIcon || portal_type === "Image")) { %>\n    <% if (!oneLevelUp) { %>\n    <a\n      class="pattern-relateditems-result-select<%- selectable ? \' selectable\' : \'\' %><%- oneLevelUp ? \' one-level-up\' : \'\' %>"\n      data-path="<%- path %>">\n    <% } %>\n    <div class="pattern-relateditems-result-image">\n      <img src="<%- getURL %>/@@images/image/thumb" />\n    </div>\n    <% if (!oneLevelUp) { %>\n    </a>\n    <% } %>\n  <% } %>\n</div>\n'}),define("text!mockup-patterns-relateditems-url/templates/selection.xml",[],function(){return'<div class="pattern-relateditems-item">\n  <div class="pattern-relateditems-result-info">\n    <span\n      class="pattern-relateditems-item-title <%- portal_type ? \'contenttype-\' + portal_type.toLowerCase() : \'\' %> <%- review_state ? \'state-\' + review_state : \'\' %>"\n      title="<%- portal_type %>">\n      <%- Title %>\n    </span>\n    <span class="pattern-relateditems-item-path"><%- path %></span>\n  </div>\n  <% if (getURL && (getIcon || portal_type === "Image")) { %>\n    <div class="pattern-relateditems-item-image">\n      <img src="<%- getURL %>/@@images/image/thumb" />\n    </div>\n  <% } %>\n</div>\n'}),define("text!mockup-patterns-relateditems-url/templates/toolbar.xml",[],function(){return'<% if (mode!==\'auto\') { %>\n<div class="btn-group mode-selector" role="group">\n  <button type="button" class="mode search btn <% if (mode==\'search\') { %>btn-primary<% } else {%>btn-default<% } %>"><%- searchModeText %></button>\n  <button type="button" class="mode browse btn <% if (mode==\'browse\') { %>btn-primary<% } else {%>btn-default<% } %>"><%- browseModeText %></button>\n</div>\n<% } %>\n<div class="path-wrapper">\n  <span class="pattern-relateditems-path-label"><%- searchText %></span>\n  <a class="crumb" href="/"><span class="glyphicon glyphicon-home"/></a>\n  <%= items %>\n</div>\n<div class="controls pull-right">\n\n  <% if (recentlyUsedItems) { %>\n  <div class="recentlyUsed dropdown pull-right">\n    <button type="button" class="recentlyUsed dropdown-toggle btn btn-primary" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n      <span class="glyphicon glyphicon-time"/>\n      <%- recentlyUsedText %>\n      <span class="caret"/>\n    </button>\n    <ul class="dropdown-menu">\n      <%= recentlyUsedItems %>\n    </ul>\n  </div>\n  <% } %>\n\n  <% if (favorites.length > 0) { %>\n  <div class="favorites dropdown pull-right">\n    <button type="button" class="favorites dropdown-toggle btn btn-primary" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n      <span class="glyphicon glyphicon-star"/>\n      <%- favText %>\n      <span class="caret"/>\n    </button>\n    <ul class="dropdown-menu">\n      <%= favItems %>\n    </ul>\n  </div>\n  <% } %>\n</div>\n'}),define("mockup-patterns-relateditems",["jquery","underscore","pat-base","mockup-patterns-select2","mockup-ui-url/views/button","mockup-utils","pat-registry","translate","text!mockup-patterns-relateditems-url/templates/breadcrumb.xml","text!mockup-patterns-relateditems-url/templates/favorite.xml","text!mockup-patterns-relateditems-url/templates/recentlyused.xml","text!mockup-patterns-relateditems-url/templates/result.xml","text!mockup-patterns-relateditems-url/templates/selection.xml","text!mockup-patterns-relateditems-url/templates/toolbar.xml","bootstrap-dropdown"],function(c,d,e,a,u,h,r,p,t,n,i,o,s,l){"use strict";var f=37,m=39;return e.extend({name:"relateditems",trigger:".pat-relateditems",parser:"mockup",currentPath:void 0,selectedUIDs:[],openAfterInit:void 0,defaults:{vocabularyUrl:null,attributes:["UID","Title","portal_type","path","getURL","getIcon","is_folderish","review_state"],basePath:"",pageSize:10,browsing:void 0,closeOnSelect:!0,contextPath:void 0,dropdownCssClass:"pattern-relateditems-dropdown",favorites:[],recentlyUsed:!1,recentlyUsedMaxItems:20,recentlyUsedKey:"relateditems_recentlyused",maximumSelectionSize:-1,minimumInputLength:0,mode:"auto",orderable:!0,pathOperator:"plone.app.querystring.operation.string.path",rootPath:"/",rootUrl:"",scanSelection:!1,selectableTypes:null,separator:",",sortOn:null,sortOrder:"ascending",tokenSeparators:[","," "],upload:!1,uploadAllowView:void 0,width:"100%",breadcrumbTemplate:t,breadcrumbTemplateSelector:null,favoriteTemplate:n,favoriteTemplateSelector:null,recentlyusedTemplate:i,recentlyusedTemplateSelector:null,resultTemplate:o,resultTemplateSelector:null,selectionTemplate:s,selectionTemplateSelector:null,toolbarTemplate:l,toolbarTemplateSelector:null,multiple:!0},recentlyUsed:function(e){var t=h.storage.get(this.options.recentlyUsedKey)||[];t=t.slice(t.length-1e3,t.length),e&&t.filter(this.isSelectable.bind(this));var n=parseInt(this.options.recentlyUsedMaxItems,10);return n&&(t=t.slice(t.length-n,t.length)),t},applyTemplate:function(e,t){var n,i=this;n=i.options[e+"TemplateSelector"]&&(n=c(i.options[e+"TemplateSelector"]).html())||i.options[e+"Template"];var o=c.extend(!0,{},i.options,t,{browsing:i.browsing,open_folder:p("Open folder"),current_directory:p("current directory:"),one_level_up:p("Go one level up")});return o._item=t,d.template(n)(o)},setAjax:function(){var e={url:this.options.vocabularyUrl,dataType:"JSON",quietMillis:500,data:function(e,t){var n=[];e&&(e="*"+e+"*",n.push({i:"SearchableText",o:"plone.app.querystring.operation.string.contains",v:e})),!this.browsing&&this.options.selectableTypes&&n.push({i:"portal_type",o:"plone.app.querystring.operation.selection.any",v:this.options.selectableTypes}),n.push({i:"path",o:this.options.pathOperator,v:this.options.rootPath+this.currentPath+(this.browsing?"::1":"")});var i=this.options.sortOn,o=i?this.options.sortOrder:null;return this.browsing&&null===i&&(i="getObjPositionInParent",o="ascending"),{query:JSON.stringify({criteria:n,sort_on:i,sort_order:o}),attributes:JSON.stringify(this.options.attributes),batch:JSON.stringify({page:t||1,size:this.options.pageSize})}}.bind(this),results:function(e,t){var n=t*this.options.pageSize<e.total,i=e.results;this.selectedUIDs=(this.$el.select2("data")||[]).map(function(e){return e.UID}),i=i.filter(function(e){return!!(this.browsing&&e.is_folderish||this.isSelectable(e)&&-1===this.selectedUIDs.indexOf(e.UID))}.bind(this));var o=this.currentPath.split("/");return 1===t&&this.browsing&&1<o.length&&"/"!==this.currentPath&&(i=[{oneLevelUp:!0,Title:p("One level up"),path:o.slice(0,o.length-1).join("/")||"/",currentPath:this.currentPath,is_folderish:!0,selectable:!1}].concat(i)),{results:i,more:n}}.bind(this)};this.options.ajax=e},renderToolbar:function(){var e,o=this,t=o.currentPath.split("/"),n="",i="";d.each(t,function(e){if(""!==e){var t={};t.path=n=n+"/"+e,t.text=e,i+=o.applyTemplate("breadcrumb",t)}});var a="";d.each(o.options.favorites,function(e){var t=d.clone(e);t.path=t.path.substr(o.options.rootPath.length)||"/",a+=o.applyTemplate("favorite",t)});var r="";if(o.options.recentlyUsed){var s=o.recentlyUsed(!0);d.each(s.reverse(),function(e){r+=o.applyTemplate("recentlyused",e)})}function l(e,t){var n="upload-"+h.generateId(),i=new u({id:n,title:p("Upload"),tooltip:p("Upload files"),icon:"upload"});t&&i.disable(),c(".controls",o.$toolbar).prepend(i.render().el),o.uploadView=new e({triggerView:i,app:o}),c("#btn-"+n,o.$toolbar).append(o.uploadView.render().el)}e=o.applyTemplate("toolbar",{items:i,favItems:a,favText:p("Favorites"),searchText:p("Current path:"),searchModeText:p("Search"),browseModeText:p("Browse"),recentlyUsedItems:r,recentlyUsedText:p("Recently Used")}),o.$toolbar.html(e),c(".dropdown-toggle",o.$toolbar).dropdown(),c(".pattern-relateditems-dropdown").unbind("mouseup"),c(".pattern-relateditems-dropdown").bind("mouseup",function(e){e.stopPropagation()}),c("button.mode.search",o.$toolbar).on("click",function(e){e.preventDefault(),o.browsing?(c("button.mode.search",o.$toolbar).toggleClass("btn-primary btn-default"),c("button.mode.browse",o.$toolbar).toggleClass("btn-primary btn-default"),o.browsing=!1,0<o.$el.select2("data").length&&(o.openAfterInit=!0),o.openAfterInit||(o.$el.select2("close"),o.$el.select2("open"))):(o.$el.select2("close"),o.$el.select2("open"))}),c("button.mode.browse",o.$toolbar).on("click",function(e){e.preventDefault(),o.browsing?(o.$el.select2("close"),o.$el.select2("open")):(c("button.mode.search",o.$toolbar).toggleClass("btn-primary btn-default"),c("button.mode.browse",o.$toolbar).toggleClass("btn-primary btn-default"),o.browsing=!0,0<o.$el.select2("data").length&&(o.openAfterInit=!0),o.openAfterInit||(o.$el.select2("close"),o.$el.select2("open")))}),c("a.crumb",o.$toolbar).on("click",function(e){e.preventDefault(),o.browseTo(c(this).attr("href"))}),c("a.fav",o.$toolbar).on("click",function(e){e.preventDefault(),o.browseTo(c(this).attr("href"))}),o.options.recentlyUsed&&c(".pattern-relateditems-recentlyused-select",o.$toolbar).on("click",function(e){e.preventDefault();var t=c(this).data("uid"),n=o.recentlyUsed().filter(function(e){return e.UID===t});if(0<n.length&&(n=n[0],o.selectItem(n),0<o.options.maximumSelectionSize&&o.$el.select2("data").length>=o.options.maximumSelectionSize))return}),o.options.upload&&h.featureSupport.dragAndDrop()&&h.featureSupport.fileApi()&&require(["mockup-patterns-relateditems-upload"],function(t){o.options.uploadAllowView?c.ajax({url:o.options.uploadAllowView,dataType:"JSON",data:{path:o.options.rootPath+o.currentPath},type:"GET",success:function(e){l(t,!e.allowUpload)}}):l(t)})},browseTo:function(e){var t=this;t.emit("before-browse"),t.currentPath=e,t.$el.select2("close"),t.renderToolbar(),t.$el.select2("open"),t.emit("after-browse")},selectItem:function(t){var e=this;e.emit("selecting");var n=e.$el.select2("data");if(n.push(t),e.$el.select2("data",n,!0),e.options.recentlyUsed){var i=e.recentlyUsed(),o=i.filter(function(e){return e.UID===t.UID});0<o.length&&i.splice(i.indexOf(o[0]),1),i.push(t),h.storage.set(e.options.recentlyUsedKey,i)}e.emit("selected")},deselectItem:function(n){this.emit("deselecting");var i=this.$el.select2("data");d.each(i,function(e,t){e.UID===n.UID&&i.splice(t,1)}),this.$el.select2("data",i,!0),this.emit("deselected")},isSelectable:function(e){return!1!==e.selectable&&(null===this.options.selectableTypes||-1!==this.options.selectableTypes.indexOf(e.portal_type))},init:function(){var o=this;o.browsing="search"!==o.options.mode,o.options.rootPath=o.options.rootPath.replace(/\/$/,""),o.currentPath=o.options.basePath.substr(o.options.rootPath.length)||"/",o.setAjax(),o.$el.wrap('<div class="pattern-relateditems-container" />'),o.$container=o.$el.parents(".pattern-relateditems-container"),o.$container.width(o.options.width),a.prototype.initializeValues.call(o),a.prototype.initializeTags.call(o),o.options.formatSelection=function(e){e=c.extend(!0,{Title:"",getIcon:"",getURL:"",path:"",portal_type:"",review_state:""},e);var t=c(o.applyTemplate("selection",e));if(o.options.scanSelection&&r.scan(t),1==o.options.maximumSelectionSize){var n=e.path,i=n.split("/");n=(i=i.slice(0,-1)).join("/"),o.currentPath=n,o.renderToolbar()}return t},a.prototype.initializeOrdering.call(o),o.options.formatResult=function(n){n.selectable=o.isSelectable(n),n=c.extend(!0,{Title:"",getIcon:"",getURL:"",is_folderish:!1,oneLevelUp:!1,path:"",portal_type:"",review_state:"",selectable:!1},n),-1!==o.selectedUIDs.indexOf(n.UID)&&(n.selectable=!1);var e=c(o.applyTemplate("result",n));return c(".pattern-relateditems-result-select",e).on("click",function(e){if(e.preventDefault(),c(this).is(".selectable")){var t=c(this).parents(".pattern-relateditems-result");if(t.is(".pattern-relateditems-active"))t.removeClass("pattern-relateditems-active"),o.deselectItem(n);else{if(0<o.options.maximumSelectionSize)o.$el.select2("data").length>=o.options.maximumSelectionSize&&o.$el.select2("close");o.selectItem(n),t.addClass("pattern-relateditems-active"),o.options.closeOnSelect&&o.$el.select2("close")}}}),c(".pattern-relateditems-result-browse",e).on("click",function(e){e.preventDefault(),e.stopPropagation();var t=c(this).data("path");o.browseTo(t)}),c(e)},o.options.initSelection=function(e,n){var t=c(e).val();if(""!==t){var i=t.split(o.options.separator);new h.QueryHelper(c.extend(!0,{},o.options,{pattern:o})).search("UID","plone.app.querystring.operation.list.contains",i,function(e){var t=e.results.reduce(function(e,t){return e[t.UID]=t,e},{});try{n(i.map(function(e){return t[e]}).filter(function(e){return void 0!==e}))}catch(e){}o.openAfterInit&&(o.$el.select2("open"),o.openAfterInit=void 0)},!1)}},o.options.tokenizer=function(e){"auto"===this.options.mode&&(this.browsing=!e)}.bind(this),o.options.id=function(e){return e.UID},a.prototype.initializeSelect2.call(o),o.$toolbar=c('<div class="toolbar ui-offset-parent" />'),o.$container.prepend(o.$toolbar),o.$el.on("select2-selecting",function(e){o.isSelectable(e.choice)||e.preventDefault()}),o.renderToolbar(),c(document).on("keyup",o.$el,function(e){if(a.prototype.opened.call(o)&&(e.which===f||e.which===m)){e.stopPropagation();var t=e.which===f?".pattern-relateditems-result.one-level-up":".select2-highlighted",n=c(".pattern-relateditems-result-browse",t);if(1!==n.length)return;var i=n.data("path");o.browseTo(i)}})}})}),function(e){"function"==typeof define&&define.amd?define("picker",["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):"object"==typeof window?window.Picker=e(jQuery):this.Picker=e(jQuery)}(function(m){var i=m(window),g=m(document),o=m(document.documentElement),v=null!=document.documentElement.style.transition;function y(o,e,t,n){if(!o)return y;function i(){return this.start()}var a=!1,s={id:o.id||"P"+Math.abs(~~(Math.random()*new Date)),handlingOpen:!1},l=t?m.extend(!0,{},t.defaults,n):n||{},r=m.extend({},y.klasses(),l.klass),c=m(o),d=i.prototype={constructor:i,$node:c,start:function(){return s&&s.start?d:(s.methods={},s.start=!0,s.open=!1,s.type=o.type,o.autofocus=o==x(),o.readOnly=!l.editable,o.id=o.id||s.id,"text"!=o.type&&(o.type="text"),d.component=new t(d,l),d.$root=m('<div class="'+r.picker+'" id="'+o.id+'_root" />'),k(d.$root[0],"hidden",!0),d.$holder=m(u()).appendTo(d.$root),h(),l.formatSubmit&&function(){var e;!0===l.hiddenName?(e=o.name,o.name=""):e=(e=["string"==typeof l.hiddenPrefix?l.hiddenPrefix:"","string"==typeof l.hiddenSuffix?l.hiddenSuffix:"_submit"])[0]+o.name+e[1];d._hidden=m('<input type=hidden name="'+e+'"'+(c.data("value")||o.value?' value="'+d.get("select",l.formatSubmit)+'"':"")+">")[0],c.on("change."+s.id,function(){d._hidden.value=o.value?d.get("select",l.formatSubmit):""})}(),function(){c.data(e,d).addClass(r.input).val(c.data("value")?d.get("select",l.format):o.value).on("focus."+s.id+" click."+s.id,function(e){e.preventDefault(),d.open()}).on("mousedown",function(){s.handlingOpen=!0;var e=function(){setTimeout(function(){m(document).off("mouseup",e),s.handlingOpen=!1},0)};m(document).on("mouseup",e)}),l.editable||c.on("keydown."+s.id,f);k(o,{haspopup:!0,expanded:!1,readonly:!1,owns:o.id+"_root"})}(),l.containerHidden?m(l.containerHidden).append(d._hidden):c.after(d._hidden),l.container?m(l.container).append(d.$root):c.after(d.$root),d.on({start:d.component.onStart,render:d.component.onRender,stop:d.component.onStop,open:d.component.onOpen,close:d.component.onClose,set:d.component.onSet}).on({start:l.onStart,render:l.onRender,stop:l.onStop,open:l.onOpen,close:l.onClose,set:l.onSet}),a=function(e){var t,n="position";e.currentStyle?t=e.currentStyle[n]:window.getComputedStyle&&(t=getComputedStyle(e)[n]);return"fixed"==t}(d.$holder[0]),o.autofocus&&d.open(),d.trigger("start").trigger("render"))},render:function(e){return e?(d.$holder=m(u()),h(),d.$root.html(d.$holder)):d.$root.find("."+r.box).html(d.component.nodes(s.open)),d.trigger("render")},stop:function(){return s.start&&(d.close(),d._hidden&&d._hidden.parentNode.removeChild(d._hidden),d.$root.remove(),c.removeClass(r.input).removeData(e),setTimeout(function(){c.off("."+s.id)},0),o.type=s.type,o.readOnly=!1,d.trigger("stop"),s.methods={},s.start=!1),d},open:function(e){return s.open?d:(c.addClass(r.active),k(o,"expanded",!0),setTimeout(function(){d.$root.addClass(r.opened),k(d.$root[0],"hidden",!1)},0),!1!==e&&(s.open=!0,a&&m("body").css("overflow","hidden").css("padding-right","+="+b()),a&&v?d.$holder.find("."+r.frame).one("transitionend",function(){d.$holder.eq(0).focus()}):setTimeout(function(){d.$holder.eq(0).focus()},0),g.on("click."+s.id+" focusin."+s.id,function(e){if(!s.handlingOpen){var t=w(e,o);e.isSimulated||t==o||t==document||3==e.which||d.close(t===d.$holder[0])}}).on("keydown."+s.id,function(e){var t=e.keyCode,n=d.component.key[t],i=w(e,o);27==t?d.close(!0):i!=d.$holder[0]||!n&&13!=t?m.contains(d.$root[0],i)&&13==t&&(e.preventDefault(),i.click()):(e.preventDefault(),n?y._.trigger(d.component.key.go,d,[y._.trigger(n)]):d.$root.find("."+r.highlighted).hasClass(r.disabled)||(d.set("select",d.component.item.highlight),l.closeOnSelect&&d.close(!0)))})),d.trigger("open"))},close:function(e){return e&&(l.editable?o.focus():(d.$holder.off("focus.toOpen").focus(),setTimeout(function(){d.$holder.on("focus.toOpen",p)},0))),c.removeClass(r.active),k(o,"expanded",!1),setTimeout(function(){d.$root.removeClass(r.opened+" "+r.focused),k(d.$root[0],"hidden",!0)},0),s.open?(s.open=!1,a&&m("body").css("overflow","").css("padding-right","-="+b()),g.off("."+s.id),d.trigger("close")):d},clear:function(e){return d.set("clear",null,e)},set:function(e,t,n){var i,o,a=m.isPlainObject(e),r=a?e:{};if(n=a&&m.isPlainObject(t)?t:n||{},e){for(i in a||(r[e]=t),r)o=r[i],i in d.component.item&&(void 0===o&&(o=null),d.component.set(i,o,n)),"select"!=i&&"clear"!=i||!l.updateInput||c.val("clear"==i?"":d.get(i,l.format)).trigger("change");d.render()}return n.muted?d:d.trigger("set",r)},get:function(e,t){if(null!=s[e=e||"value"])return s[e];if("valueSubmit"==e){if(d._hidden)return d._hidden.value;e="value"}if("value"==e)return o.value;if(e in d.component.item){if("string"!=typeof t)return d.component.get(e);var n=d.component.get(e);return n?y._.trigger(d.component.formats.toString,d.component,[t,n]):""}},on:function(e,t,n){var i,o,a=m.isPlainObject(e),r=a?e:{};if(e)for(i in a||(r[e]=t),r)o=r[i],n&&(i="_"+i),s.methods[i]=s.methods[i]||[],s.methods[i].push(o);return d},off:function(){var e,t,n=arguments;for(e=0,namesCount=n.length;e<namesCount;e+=1)(t=n[e])in s.methods&&delete s.methods[t];return d},trigger:function(e,n){function t(e){var t=s.methods[e];t&&t.map(function(e){y._.trigger(e,d,[n])})}return t("_"+e),t(e),d}};function u(){return y._.node("div",y._.node("div",y._.node("div",y._.node("div",d.component.nodes(s.open),r.box),r.wrap),r.frame),r.holder,'tabindex="-1"')}function h(){d.$holder.on({keydown:f,"focus.toOpen":p,blur:function(){c.removeClass(r.target)},focusin:function(e){d.$root.removeClass(r.focused),e.stopPropagation()},"mousedown click":function(e){var t=w(e,o);t!=d.$holder[0]&&(e.stopPropagation(),"mousedown"!=e.type||m(t).is("input, select, textarea, button, option")||(e.preventDefault(),d.$holder.eq(0).focus()))}}).on("click","[data-pick], [data-nav], [data-clear], [data-close]",function(){var e=m(this),t=e.data(),n=e.hasClass(r.navDisabled)||e.hasClass(r.disabled),i=x();i=i&&(i.type||i.href?i:null),(n||i&&!m.contains(d.$root[0],i))&&d.$holder.eq(0).focus(),!n&&t.nav?d.set("highlight",d.component.item.highlight,{nav:t.nav}):!n&&"pick"in t?(d.set("select",t.pick),l.closeOnSelect&&d.close(!0)):t.clear?(d.clear(),l.closeOnClear&&d.close(!0)):t.close&&d.close(!0)})}function p(e){e.stopPropagation(),c.addClass(r.target),d.$root.addClass(r.focused),d.open()}function f(e){var t=e.keyCode,n=/^(8|46)$/.test(t);if(27==t)return d.close(!0),!1;(32==t||n||!s.open&&d.component.key[t])&&(e.preventDefault(),e.stopPropagation(),n?d.clear().close():d.open())}return new i}function b(){if(o.height()<=i.height())return 0;var e=m('<div style="visibility:hidden;width:100px" />').appendTo("body"),t=e[0].offsetWidth;e.css("overflow","scroll");var n=m('<div style="width:100%" />').appendTo(e)[0].offsetWidth;return e.remove(),t-n}function w(e,t){var n=[];return e.path&&(n=e.path),e.originalEvent&&e.originalEvent.path&&(n=e.originalEvent.path),n&&0<n.length?t&&0<=n.indexOf(t)?t:n[0]:e.target}function k(e,t,n){if(m.isPlainObject(t))for(var i in t)a(e,i,t[i]);else a(e,t,n)}function a(e,t,n){e.setAttribute(("role"==t?"":"aria-")+t,n)}function x(){try{return document.activeElement}catch(e){}}return y.klasses=function(e){return{picker:e=e||"picker",opened:e+"--opened",focused:e+"--focused",input:e+"__input",active:e+"__input--active",target:e+"__input--target",holder:e+"__holder",frame:e+"__frame",wrap:e+"__wrap",box:e+"__box"}},y._={group:function(e){for(var t,n="",i=y._.trigger(e.min,e);i<=y._.trigger(e.max,e,[i]);i+=e.i)t=y._.trigger(e.item,e,[i]),n+=y._.node(e.node,t[0],t[1],t[2]);return n},node:function(e,t,n,i){return t?"<"+e+(n=n?' class="'+n+'"':"")+(i=i?" "+i:"")+">"+(t=m.isArray(t)?t.join(""):t)+"</"+e+">":""},lead:function(e){return(e<10?"0":"")+e},trigger:function(e,t,n){return"function"==typeof e?e.apply(t,n||[]):e},digits:function(e){return/\d/.test(e[1])?2:1},isDate:function(e){return-1<{}.toString.call(e).indexOf("Date")&&this.isInteger(e.getDate())},isInteger:function(e){return-1<{}.toString.call(e).indexOf("Number")&&e%1==0},ariaAttr:function(e,t){m.isPlainObject(e)||(e={attribute:t});for(var n in t="",e){var i=("role"==n?"":"aria-")+n,o=e[n];t+=null==o?"":i+'="'+e[n]+'"'}return t}},y.extend=function(i,o){m.fn[i]=function(e,t){var n=this.data(i);return"picker"==e?n:n&&"string"==typeof e?y._.trigger(n[e],n,[t]):this.each(function(){m(this).data(i)||new y(this,i,o,e)})},m.fn[i].defaults=o.defaults},y}),function(e){"function"==typeof define&&define.amd?define("picker.date",["./picker","jquery"],e):"object"==typeof exports?module.exports=e(require("./picker.js"),require("jquery")):e(Picker,jQuery)}(function(e,f){var t,v=e._;function n(t,n){function e(){return a.currentStyle?"rtl"==a.currentStyle.direction:"rtl"==getComputedStyle(t.$root[0]).direction}var i,o=this,a=t.$node[0],r=a.value,s=t.$node.data("value"),l=s||r,c=s?n.formatSubmit:n.format;o.settings=n,o.$node=t.$node,o.queue={min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse navigate create validate",view:"parse create validate viewset",disable:"deactivate",enable:"activate"},o.item={},o.item.clear=null,o.item.disable=(n.disable||[]).slice(0),o.item.enable=-(!0===(i=o.item.disable)[0]?i.shift():-1),o.set("min",n.min).set("max",n.max).set("now"),l?o.set("select",l,{format:c,defaultValue:!0}):o.set("select",null).set("highlight",o.item.now),o.key={40:7,38:-7,39:function(){return e()?-1:1},37:function(){return e()?1:-1},go:function(e){var t=o.item.highlight,n=new Date(t.year,t.month,t.date+e);o.set("highlight",n,{interval:e}),this.render()}},t.on("render",function(){t.$root.find("."+n.klass.selectMonth).on("change",function(){var e=this.value;e&&(t.set("highlight",[t.get("view").year,e,t.get("highlight").date]),t.$root.find("."+n.klass.selectMonth).trigger("focus"))}),t.$root.find("."+n.klass.selectYear).on("change",function(){var e=this.value;e&&(t.set("highlight",[e,t.get("view").month,t.get("highlight").date]),t.$root.find("."+n.klass.selectYear).trigger("focus"))})},1).on("open",function(){var e="";o.disabled(o.get("now"))&&(e=":not(."+n.klass.buttonToday+")"),t.$root.find("button"+e+", select").attr("disabled",!1)},1).on("close",function(){t.$root.find("button, select").attr("disabled",!0)},1)}function i(e,t,n){var i=e.match(/[^\x00-\x7F]+|\w+/)[0];return n.mm||n.m||(n.m=t.indexOf(i)+1),i.length}function o(e){return e.match(/\w+/)[0].length}n.prototype.set=function(t,n,i){var o=this,e=o.item;return null===n?("clear"==t&&(t="select"),e[t]=n):(e["enable"==t?"disable":"flip"==t?"enable":t]=o.queue[t].split(" ").map(function(e){return n=o[e](t,n,i)}).pop(),"select"==t?o.set("highlight",e.select,i):"highlight"==t?o.set("view",e.highlight,i):t.match(/^(flip|min|max|disable|enable)$/)&&(e.select&&o.disabled(e.select)&&o.set("select",e.select,i),e.highlight&&o.disabled(e.highlight)&&o.set("highlight",e.highlight,i))),o},n.prototype.get=function(e){return this.item[e]},n.prototype.create=function(e,t,n){var i;return(t=void 0===t?e:t)==-1/0||t==1/0?i=t:t=f.isPlainObject(t)&&v.isInteger(t.pick)?t.obj:f.isArray(t)?(t=new Date(t[0],t[1],t[2]),v.isDate(t)?t:this.create().obj):v.isInteger(t)||v.isDate(t)?this.normalize(new Date(t),n):this.now(e,t,n),{year:i||t.getFullYear(),month:i||t.getMonth(),date:i||t.getDate(),day:i||t.getDay(),obj:i||t,pick:i||t.getTime()}},n.prototype.createRange=function(e,t){function n(e){return!0===e||f.isArray(e)||v.isDate(e)?i.create(e):e}var i=this;return v.isInteger(e)||(e=n(e)),v.isInteger(t)||(t=n(t)),v.isInteger(e)&&f.isPlainObject(t)?e=[t.year,t.month,t.date+e]:v.isInteger(t)&&f.isPlainObject(e)&&(t=[e.year,e.month,e.date+t]),{from:n(e),to:n(t)}},n.prototype.withinRange=function(e,t){return e=this.createRange(e.from,e.to),t.pick>=e.from.pick&&t.pick<=e.to.pick},n.prototype.overlapRanges=function(e,t){var n=this;return e=n.createRange(e.from,e.to),t=n.createRange(t.from,t.to),n.withinRange(e,t.from)||n.withinRange(e,t.to)||n.withinRange(t,e.from)||n.withinRange(t,e.to)},n.prototype.now=function(e,t,n){return t=new Date,n&&n.rel&&t.setDate(t.getDate()+n.rel),this.normalize(t,n)},n.prototype.navigate=function(e,t,n){var i,o,a,r,s=f.isArray(t),l=f.isPlainObject(t),c=this.item.view;if(s||l){for(r=l?(o=t.year,a=t.month,t.date):(o=+t[0],a=+t[1],+t[2]),n&&n.nav&&c&&c.month!==a&&(o=c.year,a=c.month),o=(i=new Date(o,a+(n&&n.nav?n.nav:0),1)).getFullYear(),a=i.getMonth();new Date(o,a,r).getMonth()!==a;)--r;t=[o,a,r]}return t},n.prototype.normalize=function(e){return e.setHours(0,0,0,0),e},n.prototype.measure=function(e,t){return v.isInteger(t)?t=this.now(e,t,{rel:t}):t?"string"==typeof t&&(t=this.parse(e,t)):t="min"==e?-1/0:1/0,t},n.prototype.viewset=function(e,t){return this.create([t.year,t.month,1])},n.prototype.validate=function(e,n,t){var i,o,a,r,s=this,l=n,c=t&&t.interval?t.interval:1,d=-1===s.item.enable,u=s.item.min,h=s.item.max,p=d&&s.item.disable.filter(function(e){if(f.isArray(e)){var t=s.create(e).pick;t<n.pick?i=!0:t>n.pick&&(o=!0)}return v.isInteger(e)}).length;if((!t||!t.nav&&!t.defaultValue)&&(!d&&s.disabled(n)||d&&s.disabled(n)&&(p||i||o)||!d&&(n.pick<=u.pick||n.pick>=h.pick)))for(d&&!p&&(!o&&0<c||!i&&c<0)&&(c*=-1);s.disabled(n)&&(1<Math.abs(c)&&(n.month<l.month||n.month>l.month)&&(n=l,c=0<c?1:-1),n.pick<=u.pick?(a=!0,c=1,n=s.create([u.year,u.month,u.date+(n.pick===u.pick?0:-1)])):n.pick>=h.pick&&(r=!0,c=-1,n=s.create([h.year,h.month,h.date+(n.pick===h.pick?0:1)])),!a||!r);)n=s.create([n.year,n.month,n.date+c]);return n},n.prototype.disabled=function(t){var n=this,e=n.item.disable.filter(function(e){return v.isInteger(e)?t.day===(n.settings.firstDay?e:e-1)%7:f.isArray(e)||v.isDate(e)?t.pick===n.create(e).pick:f.isPlainObject(e)?n.withinRange(e,t):void 0});return e=e.length&&!e.filter(function(e){return f.isArray(e)&&"inverted"==e[3]||f.isPlainObject(e)&&e.inverted}).length,-1===n.item.enable?!e:e||t.pick<n.item.min.pick||t.pick>n.item.max.pick},n.prototype.parse=function(e,i,t){var o=this,a={};return i&&"string"==typeof i?(t&&t.format||((t=t||{}).format=o.settings.format),o.formats.toArray(t.format).map(function(e){var t=o.formats[e],n=t?v.trigger(t,o,[i,a]):e.replace(/^!/,"").length;t&&(a[e]=i.substr(0,n)),i=i.substr(n)}),[a.yyyy||a.yy,(a.mm||a.m)-1,a.dd||a.d]):i},n.prototype.formats={d:function(e,t){return e?v.digits(e):t.date},dd:function(e,t){return e?2:v.lead(t.date)},ddd:function(e,t){return e?o(e):this.settings.weekdaysShort[t.day]},dddd:function(e,t){return e?o(e):this.settings.weekdaysFull[t.day]},m:function(e,t){return e?v.digits(e):t.month+1},mm:function(e,t){return e?2:v.lead(t.month+1)},mmm:function(e,t){var n=this.settings.monthsShort;return e?i(e,n,t):n[t.month]},mmmm:function(e,t){var n=this.settings.monthsFull;return e?i(e,n,t):n[t.month]},yy:function(e,t){return e?2:(""+t.year).slice(2)},yyyy:function(e,t){return e?4:t.year},toArray:function(e){return e.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},toString:function(e,t){var n=this;return n.formats.toArray(e).map(function(e){return v.trigger(n.formats[e],n,[0,t])||e.replace(/^!/,"")}).join("")}},n.prototype.isDateExact=function(e,t){return v.isInteger(e)&&v.isInteger(t)||"boolean"==typeof e&&"boolean"==typeof t?e===t:(v.isDate(e)||f.isArray(e))&&(v.isDate(t)||f.isArray(t))?this.create(e).pick===this.create(t).pick:!(!f.isPlainObject(e)||!f.isPlainObject(t))&&(this.isDateExact(e.from,t.from)&&this.isDateExact(e.to,t.to))},n.prototype.isDateOverlap=function(e,t){var n=this.settings.firstDay?1:0;return v.isInteger(e)&&(v.isDate(t)||f.isArray(t))?(e=e%7+n)===this.create(t).day+1:v.isInteger(t)&&(v.isDate(e)||f.isArray(e))?(t=t%7+n)===this.create(e).day+1:!(!f.isPlainObject(e)||!f.isPlainObject(t))&&this.overlapRanges(e,t)},n.prototype.flipEnable=function(e){var t=this.item;t.enable=e||(-1==t.enable?1:-1)},n.prototype.deactivate=function(e,t){var i=this,o=i.item.disable.slice(0);return"flip"==t?i.flipEnable():!1===t?(i.flipEnable(1),o=[]):!0===t?(i.flipEnable(-1),o=[]):t.map(function(e){for(var t,n=0;n<o.length;n+=1)if(i.isDateExact(e,o[n])){t=!0;break}t||(v.isInteger(e)||v.isDate(e)||f.isArray(e)||f.isPlainObject(e)&&e.from&&e.to)&&o.push(e)}),o},n.prototype.activate=function(e,t){var a=this,r=a.item.disable,s=r.length;return"flip"==t?a.flipEnable():!0===t?(a.flipEnable(1),r=[]):!1===t?(a.flipEnable(-1),r=[]):t.map(function(e){var t,n,i,o;for(i=0;i<s;i+=1){if(n=r[i],a.isDateExact(n,e)){t=r[i]=null,o=!0;break}if(a.isDateOverlap(n,e)){f.isPlainObject(e)?(e.inverted=!0,t=e):f.isArray(e)?(t=e)[3]||t.push("inverted"):v.isDate(e)&&(t=[e.getFullYear(),e.getMonth(),e.getDate(),"inverted"]);break}}if(t)for(i=0;i<s;i+=1)if(a.isDateExact(r[i],e)){r[i]=null;break}if(o)for(i=0;i<s;i+=1)if(a.isDateOverlap(r[i],e)){r[i]=null;break}t&&r.push(t)}),r.filter(function(e){return null!=e})},n.prototype.nodes=function(l){function e(e){return v.node("div"," ",d.klass["nav"+(e?"Next":"Prev")]+(e&&h.year>=m.year&&h.month>=m.month||!e&&h.year<=f.year&&h.month<=f.month?" "+d.klass.navDisabled:""),"data-nav="+(e||-1)+" "+v.ariaAttr({role:"button",controls:c.$node[0].id+"_table"})+' title="'+(e?d.labelMonthNext:d.labelMonthPrev)+'"')}function t(){var t=d.showMonthsShort?d.monthsShort:d.monthsFull;return d.selectMonths?v.node("select",v.group({min:0,max:11,i:1,node:"option",item:function(e){return[t[e],0,"value="+e+(h.month==e?" selected":"")+(h.year==f.year&&e<f.month||h.year==m.year&&e>m.month?" disabled":"")]}}),d.klass.selectMonth,(l?"":"disabled")+" "+v.ariaAttr({controls:c.$node[0].id+"_table"})+' title="'+d.labelMonthSelect+'"'):v.node("div",t[h.month],d.klass.month)}function n(){var t=h.year,e=!0===d.selectYears?5:~~(d.selectYears/2);if(e){var n=f.year,i=m.year,o=t-e,a=t+e;if(o<n&&(a+=n-o,o=n),i<a){var r=o-n,s=a-i;o-=s<r?s:r,a=i}return v.node("select",v.group({min:o,max:a,i:1,node:"option",item:function(e){return[e,0,"value="+e+(t==e?" selected":"")]}}),d.klass.selectYear,(l?"":"disabled")+" "+v.ariaAttr({controls:c.$node[0].id+"_table"})+' title="'+d.labelYearSelect+'"')}return v.node("div",t,d.klass.year)}var i,o,c=this,d=c.settings,a=c.item,r=a.now,s=a.select,u=a.highlight,h=a.view,p=a.disable,f=a.min,m=a.max,g=(i=(d.showWeekdaysFull?d.weekdaysFull:d.weekdaysShort).slice(0),o=d.weekdaysFull.slice(0),d.firstDay&&(i.push(i.shift()),o.push(o.shift())),v.node("thead",v.node("tr",v.group({min:0,max:6,i:1,node:"th",item:function(e){return[i[e],d.klass.weekdays,'scope=col title="'+o[e]+'"']}}))));return v.node("div",(d.selectYears?n()+t():t()+n())+e()+e(1),d.klass.header)+v.node("table",g+v.node("tbody",v.group({min:0,max:5,i:1,node:"tr",item:function(e){var t=d.firstDay&&0===c.create([h.year,h.month,1]).day?-7:0;return[v.group({min:7*e-h.day+t+1,max:function(){return this.min+7-1},i:1,node:"td",item:function(e){e=c.create([h.year,h.month,e+(d.firstDay?1:0)]);var t,n=s&&s.pick==e.pick,i=u&&u.pick==e.pick,o=p&&c.disabled(e)||e.pick<f.pick||e.pick>m.pick,a=v.trigger(c.formats.toString,c,[d.format,e]);return[v.node("div",e.date,((t=[d.klass.day]).push(h.month==e.month?d.klass.infocus:d.klass.outfocus),r.pick==e.pick&&t.push(d.klass.now),n&&t.push(d.klass.selected),i&&t.push(d.klass.highlighted),o&&t.push(d.klass.disabled),t.join(" ")),"data-pick="+e.pick+" "+v.ariaAttr({role:"gridcell",label:a,selected:!(!n||c.$node.val()!==a)||null,activedescendant:!!i||null,disabled:!!o||null})),"",v.ariaAttr({role:"presentation"})]}})]}})),d.klass.table,'id="'+c.$node[0].id+'_table" '+v.ariaAttr({role:"grid",controls:c.$node[0].id,readonly:!0}))+v.node("div",v.node("button",d.today,d.klass.buttonToday,"type=button data-pick="+r.pick+(l&&!c.disabled(r)?"":" disabled")+" "+v.ariaAttr({controls:c.$node[0].id}))+v.node("button",d.clear,d.klass.buttonClear,"type=button data-clear=1"+(l?"":" disabled")+" "+v.ariaAttr({controls:c.$node[0].id}))+v.node("button",d.close,d.klass.buttonClose,"type=button data-close=true "+(l?"":" disabled")+" "+v.ariaAttr({controls:c.$node[0].id})),d.klass.footer)},n.defaults={labelMonthNext:"Next month",labelMonthPrev:"Previous month",labelMonthSelect:"Select a month",labelYearSelect:"Select a year",monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],today:"Today",clear:"Clear",close:"Close",closeOnSelect:!0,closeOnClear:!0,updateInput:!0,format:"d mmmm, yyyy",klass:{table:(t=e.klasses().picker+"__")+"table",header:t+"header",navPrev:t+"nav--prev",navNext:t+"nav--next",navDisabled:t+"nav--disabled",month:t+"month",year:t+"year",selectMonth:t+"select--month",selectYear:t+"select--year",weekdays:t+"weekday",day:t+"day",disabled:t+"day--disabled",selected:t+"day--selected",highlighted:t+"day--highlighted",now:t+"day--today",infocus:t+"day--infocus",outfocus:t+"day--outfocus",footer:t+"footer",buttonClear:t+"button--clear",buttonToday:t+"button--today",buttonClose:t+"button--close"}},e.extend("pickadate",n)}),function(e){"function"==typeof define&&define.amd?define("picker.time",["./picker","jquery"],e):"object"==typeof exports?module.exports=e(require("./picker.js"),require("jquery")):e(Picker,jQuery)}(function(e,l){var t,o=1440,p=e._;function n(o,a){var e,t=this,n=o.$node[0].value,i=o.$node.data("value"),r=i||n,s=i?a.formatSubmit:a.format;t.settings=a,t.$node=o.$node,t.queue={interval:"i",min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse create validate",view:"parse create validate",disable:"deactivate",enable:"activate"},t.item={},t.item.clear=null,t.item.interval=a.interval||30,t.item.disable=(a.disable||[]).slice(0),t.item.enable=-(!0===(e=t.item.disable)[0]?e.shift():-1),t.set("min",a.min).set("max",a.max).set("now"),r?t.set("select",r,{format:s}):t.set("select",null).set("highlight",t.item.now),t.key={40:1,38:-1,39:1,37:-1,go:function(e){t.set("highlight",t.item.highlight.pick+e*t.item.interval,{interval:e*t.item.interval}),this.render()}},o.on("render",function(){function e(t){return["webkit","moz","ms","o",""].map(function(e){return(e?"-"+e+"-":"")+t})}function t(t,n){e("transform").map(function(e){t.css(e,n)}),e("transition").map(function(e){t.css(e,n)})}var n=o.$root.children(),i=n.find("."+a.klass.viewset);i.length&&(t(n,"none"),n[0].scrollTop=~~i.position().top-2*i[0].clientHeight,t(n,""))},1).on("open",function(){o.$root.find("button").attr("disabled",!1)},1).on("close",function(){o.$root.find("button").attr("disabled",!0)},1)}n.prototype.set=function(t,n,i){var o=this,e=o.item;return null===n?("clear"==t&&(t="select"),e[t]=n):(e["enable"==t?"disable":"flip"==t?"enable":t]=o.queue[t].split(" ").map(function(e){return n=o[e](t,n,i)}).pop(),"select"==t?o.set("highlight",e.select,i):"highlight"==t?o.set("view",e.highlight,i):"interval"==t?o.set("min",e.min,i).set("max",e.max,i):t.match(/^(flip|min|max|disable|enable)$/)&&(e.select&&o.disabled(e.select)&&o.set("select",n,i),e.highlight&&o.disabled(e.highlight)&&o.set("highlight",n,i),"min"==t&&o.set("max",e.max,i))),o},n.prototype.get=function(e){return this.item[e]},n.prototype.create=function(e,t,n){var i=this;return t=void 0===t?e:t,p.isDate(t)&&(t=[t.getHours(),t.getMinutes()]),l.isPlainObject(t)&&p.isInteger(t.pick)?t=t.pick:l.isArray(t)?t=60*t[0]+ +t[1]:p.isInteger(t)||(t=i.now(e,t,n)),"max"==e&&t<i.item.min.pick&&(t+=o),"min"!=e&&"max"!=e&&(t-i.item.min.pick)%i.item.interval!=0&&(t+=i.item.interval),{hour:~~(24+(t=i.normalize(e,t,n))/60)%24,mins:(60+t%60)%60,time:(o+t)%o,pick:t%o}},n.prototype.createRange=function(e,t){function n(e){return!0===e||l.isArray(e)||p.isDate(e)?i.create(e):e}var i=this;return p.isInteger(e)||(e=n(e)),p.isInteger(t)||(t=n(t)),p.isInteger(e)&&l.isPlainObject(t)?e=[t.hour,t.mins+e*i.settings.interval]:p.isInteger(t)&&l.isPlainObject(e)&&(t=[e.hour,e.mins+t*i.settings.interval]),{from:n(e),to:n(t)}},n.prototype.withinRange=function(e,t){return e=this.createRange(e.from,e.to),t.pick>=e.from.pick&&t.pick<=e.to.pick},n.prototype.overlapRanges=function(e,t){var n=this;return e=n.createRange(e.from,e.to),t=n.createRange(t.from,t.to),n.withinRange(e,t.from)||n.withinRange(e,t.to)||n.withinRange(t,e.from)||n.withinRange(t,e.to)},n.prototype.now=function(e,t){var n,i=this.item.interval,o=new Date,a=60*o.getHours()+o.getMinutes();return a-=a%i,n=t<0&&i*t+a<=-i,a+="min"==e&&n?0:i,p.isInteger(t)&&(a+=i*(n&&"max"!=e?t+1:t)),a},n.prototype.normalize=function(e,t){var n=this.item.interval,i=this.item.min&&this.item.min.pick||0;return t-="min"==e?0:(t-i)%n},n.prototype.measure=function(e,t,n){return"string"==typeof(t=t||("min"==e?[0,0]:[23,59]))?t=this.parse(e,t):!0===t||p.isInteger(t)?t=this.now(e,t,n):l.isPlainObject(t)&&p.isInteger(t.pick)&&(t=this.normalize(e,t.pick,n)),t},n.prototype.validate=function(e,t,n){var i=this,o=n&&n.interval?n.interval:i.item.interval;return i.disabled(t)&&(t=i.shift(t,o)),t=i.scope(t),i.disabled(t)&&(t=i.shift(t,-1*o)),t},n.prototype.disabled=function(t){var n=this,e=n.item.disable.filter(function(e){return p.isInteger(e)?t.hour==e:l.isArray(e)||p.isDate(e)?t.pick==n.create(e).pick:l.isPlainObject(e)?n.withinRange(e,t):void 0});return e=e.length&&!e.filter(function(e){return l.isArray(e)&&"inverted"==e[2]||l.isPlainObject(e)&&e.inverted}).length,-1===n.item.enable?!e:e||t.pick<n.item.min.pick||t.pick>n.item.max.pick},n.prototype.shift=function(e,t){var n=this,i=n.item.min.pick,o=n.item.max.pick;for(t=t||n.item.interval;n.disabled(e)&&!((e=n.create(e.pick+=t)).pick<=i||e.pick>=o););return e},n.prototype.scope=function(e){var t=this.item.min.pick,n=this.item.max.pick;return this.create(e.pick>n?n:e.pick<t?t:e)},n.prototype.parse=function(e,o,t){var n,i,a,r,s,l=this,c={};if(!o||"string"!=typeof o)return o;for(r in t&&t.format||((t=t||{}).format=l.settings.format),l.formats.toArray(t.format).map(function(e){var t,n=l.formats[e],i=n?p.trigger(n,l,[o,c]):e.replace(/^!/,"").length;n&&(t=o.substr(0,i),c[e]=t.match(/^\d+$/)?+t:t),o=o.substr(i)}),c)s=c[r],p.isInteger(s)?r.match(/^(h|hh)$/i)?(n=s,"h"!=r&&"hh"!=r||(n%=12)):"i"==r&&(i=s):r.match(/^a$/i)&&s.match(/^p/i)&&("h"in c||"hh"in c)&&(a=!0);return 60*(a?n+12:n)+i},n.prototype.formats={h:function(e,t){return e?p.digits(e):t.hour%12||12},hh:function(e,t){return e?2:p.lead(t.hour%12||12)},H:function(e,t){return e?p.digits(e):""+t.hour%24},HH:function(e,t){return e?p.digits(e):p.lead(t.hour%24)},i:function(e,t){return e?2:p.lead(t.mins)},a:function(e,t){return e?4:t.time%o<720?"a.m.":"p.m."},A:function(e,t){return e?2:t.time%o<720?"AM":"PM"},toArray:function(e){return e.split(/(h{1,2}|H{1,2}|i|a|A|!.)/g)},toString:function(e,t){var n=this;return n.formats.toArray(e).map(function(e){return p.trigger(n.formats[e],n,[0,t])||e.replace(/^!/,"")}).join("")}},n.prototype.isTimeExact=function(e,t){return p.isInteger(e)&&p.isInteger(t)||"boolean"==typeof e&&"boolean"==typeof t?e===t:(p.isDate(e)||l.isArray(e))&&(p.isDate(t)||l.isArray(t))?this.create(e).pick===this.create(t).pick:!(!l.isPlainObject(e)||!l.isPlainObject(t))&&(this.isTimeExact(e.from,t.from)&&this.isTimeExact(e.to,t.to))},n.prototype.isTimeOverlap=function(e,t){return p.isInteger(e)&&(p.isDate(t)||l.isArray(t))?e===this.create(t).hour:p.isInteger(t)&&(p.isDate(e)||l.isArray(e))?t===this.create(e).hour:!(!l.isPlainObject(e)||!l.isPlainObject(t))&&this.overlapRanges(e,t)},n.prototype.flipEnable=function(e){var t=this.item;t.enable=e||(-1==t.enable?1:-1)},n.prototype.deactivate=function(e,t){var i=this,o=i.item.disable.slice(0);return"flip"==t?i.flipEnable():!1===t?(i.flipEnable(1),o=[]):!0===t?(i.flipEnable(-1),o=[]):t.map(function(e){for(var t,n=0;n<o.length;n+=1)if(i.isTimeExact(e,o[n])){t=!0;break}t||(p.isInteger(e)||p.isDate(e)||l.isArray(e)||l.isPlainObject(e)&&e.from&&e.to)&&o.push(e)}),o},n.prototype.activate=function(e,t){var a=this,r=a.item.disable,s=r.length;return"flip"==t?a.flipEnable():!0===t?(a.flipEnable(1),r=[]):!1===t?(a.flipEnable(-1),r=[]):t.map(function(e){var t,n,i,o;for(i=0;i<s;i+=1){if(n=r[i],a.isTimeExact(n,e)){t=r[i]=null,o=!0;break}if(a.isTimeOverlap(n,e)){l.isPlainObject(e)?(e.inverted=!0,t=e):l.isArray(e)?(t=e)[2]||t.push("inverted"):p.isDate(e)&&(t=[e.getFullYear(),e.getMonth(),e.getDate(),"inverted"]);break}}if(t)for(i=0;i<s;i+=1)if(a.isTimeExact(r[i],e)){r[i]=null;break}if(o)for(i=0;i<s;i+=1)if(a.isTimeOverlap(r[i],e)){r[i]=null;break}t&&r.push(t)}),r.filter(function(e){return null!=e})},n.prototype.i=function(e,t){return p.isInteger(t)&&0<t?t:this.item.interval},n.prototype.nodes=function(e){var s=this,l=s.settings,c=s.item.select,d=s.item.highlight,u=s.item.view,h=s.item.disable;return p.node("ul",p.group({min:s.item.min.pick,max:s.item.max.pick,i:s.item.interval,node:"li",item:function(e){var t,n=(e=s.create(e)).pick,i=c&&c.pick==n,o=d&&d.pick==n,a=h&&s.disabled(e),r=p.trigger(s.formats.toString,s,[l.format,e]);return[p.trigger(s.formats.toString,s,[p.trigger(l.formatLabel,s,[e])||l.format,e]),(t=[l.klass.listItem],i&&t.push(l.klass.selected),o&&t.push(l.klass.highlighted),u&&u.pick==n&&t.push(l.klass.viewset),a&&t.push(l.klass.disabled),t.join(" ")),"data-pick="+e.pick+" "+p.ariaAttr({role:"option",label:r,selected:!(!i||s.$node.val()!==r)||null,activedescendant:!!o||null,disabled:!!a||null})]}})+p.node("li",p.node("button",l.clear,l.klass.buttonClear,"type=button data-clear=1"+(e?"":" disabled")+" "+p.ariaAttr({controls:s.$node[0].id})),"",p.ariaAttr({role:"presentation"})),l.klass.list,p.ariaAttr({role:"listbox",controls:s.$node[0].id}))},n.defaults={clear:"Clear",format:"h:i A",interval:30,closeOnSelect:!0,closeOnClear:!0,updateInput:!0,klass:{picker:(t=e.klasses().picker)+" "+t+"--time",holder:t+"__holder",list:t+"__list",listItem:t+"__list-item",disabled:t+"__list-item--disabled",selected:t+"__list-item--selected",highlighted:t+"__list-item--highlighted",viewset:t+"__list-item--viewset",now:t+"__list-item--now",buttonClear:t+"__button--clear"}},e.extend("pickatime",n)}),define("mockup-patterns-pickadate",["jquery","pat-base","mockup-utils","translate","picker","picker.date","picker.time","mockup-patterns-select2"],function(r,e,s,t){"use strict";return e.extend({name:"pickadate",trigger:".pat-pickadate",parser:"mockup",defaults:{separator:" ",date:{selectYears:!0,selectMonths:!0,formatSubmit:"yyyy-mm-dd",format:"yyyy-mm-dd",labelMonthNext:t("Next month"),labelMonthPrev:t("Previous month"),labelMonthSelect:t("Select a month"),labelYearSelect:t("Select a year"),clear:!1,close:!1,today:!1},time:{clear:!1},today:t("Today"),clear:t("Clear"),timezone:null,autoSetTimeOnDateChange:"+[0,0]",classWrapperName:"pattern-pickadate-wrapper",classSeparatorName:"pattern-pickadate-separator",classDateName:"pattern-pickadate-date",classDateWrapperName:"pattern-pickadate-date-wrapper",classTimeName:"pattern-pickadate-time",classTimeWrapperName:"pattern-pickadate-time-wrapper",classTimezoneName:"pattern-pickadate-timezone",classTimezoneWrapperName:"pattern-pickadate-timezone-wrapper",classClearName:"pattern-pickadate-clear",classNowName:"pattern-pickadate-now",placeholderDate:t("Enter date..."),placeholderTime:t("Enter time..."),placeholderTimezone:t("Enter timezone...")},parseTimeOffset:function(t){var e=void 0;0===t.indexOf("+")?(e="+",t=t.split("+")[1]):0===t.indexOf("-")&&(e="-",t=t.split("-")[1]);try{t=JSON.parse(t)}catch(e){t=void 0}if(!1===t)return!1;if(!0===t||!0!==Array.isArray(t))return[0,0];var n=parseInt(t[0],10)||0,i=parseInt(t[1],10)||0;if("+"===e||"-"===e){var o=new Date,a=o.getHours(),r=o.getMinutes();"+"===e?(23<(n=a+n)&&(n=23),59<(i=r+i)&&(i=59)):"-"===e&&((n=a-n)<0&&(n=0),(i=r-i)<0&&(i=0))}return[n,i]},init:function(){var n=this,e=n.$el.val().split(" "),t=e[0]||"",i=e[1]||"";if(!1===s.bool(n.options.date)&&(n.options.date=!1),!1===s.bool(n.options.time)&&(n.options.time=!1),n.options.autoSetTimeOnDateChange=n.parseTimeOffset(n.options.autoSetTimeOnDateChange),!1===n.options.date&&(i=e[0]),n.$el.hide(),n.$wrapper=r("<div/>").addClass(n.options.classWrapperName).insertAfter(n.$el),!1!==n.options.date&&(n.$date=r('<input type="text"/>').attr("placeholder",n.options.placeholderDate).attr("data-value",t).addClass(n.options.classDateName).appendTo(r("<div/>").addClass(n.options.classDateWrapperName).appendTo(n.$wrapper)).pickadate(r.extend(!0,{},n.options.date,{onSet:function(e){void 0!==e.select&&(n.$date.attr("data-value",e.select),!1!==n.options.autoSetTimeOnDateChange&&n.$time&&(n.$time.pickatime("picker").get("select")||n.$time.pickatime("picker").set("select",n.options.autoSetTimeOnDateChange)),!1!==n.options.time&&""===n.$time.attr("data-value")||n.updateValue.call(n)),e.hasOwnProperty("clear")&&(n.$el.val(""),n.$date.attr("data-value",""))}}))),!1!==n.options.time&&(n.options.time.formatSubmit="HH:i",n.$time=r('<input type="text"/>').attr("placeholder",n.options.placeholderTime).attr("data-value",i).addClass(n.options.classTimeName).appendTo(r("<div/>").addClass(n.options.classTimeWrapperName).appendTo(n.$wrapper)).pickatime(r.extend(!0,{},n.options.time,{onSet:function(e){void 0!==e.select&&(n.$time.attr("data-value",e.select),!1!==n.options.date&&""===n.$date.attr("data-value")||n.updateValue.call(n)),e.hasOwnProperty("clear")&&(n.$el.val(""),n.$time.attr("data-value",""))}})),"string"==typeof i&&"00"===i.substring(0,2)&&(n.$time.pickatime("picker").set("select",i.split(":")),n.$time.attr("data-value",i))),!1!==n.options.date&&!1!==n.options.time&&n.options.timezone&&(n.$separator=r("<span/>").addClass(n.options.classSeparatorName).html(" "===n.options.separator?"&nbsp;":n.options.separator).appendTo(n.$wrapper)),null!==n.options.timezone){n.$timezone=r('<input type="text"/>').addClass(n.options.classTimezoneName).appendTo(r("<div/>").addClass(n.options.classTimezoneWrapperName).appendTo(n.$wrapper)).patternSelect2(r.extend(!0,{placeholder:n.options.placeholderTimezone,width:"10em"},n.options.timezone,{multiple:!1})).on("change",function(e){void 0!==e.val&&(n.$timezone.attr("data-value",e.val),!1!==n.options.date&&""===n.$date.attr("data-value")||!1!==n.options.time&&""===n.$time.attr("data-value")||n.updateValue.call(n))});var o,a=n.options.timezone.default;if(a)n.options.timezone.data.some(function(e){return o=e.text===n.options.timezone.default}),o&&(n.$timezone.attr("data-value",a),n.$timezone.parent().find(".select2-chosen").text(a));1===n.options.timezone.data.length&&(n.$timezone.attr("data-value",n.options.timezone.data[0].text),n.$timezone.parent().find(".select2-chosen").text(n.options.timezone.data[0].text),n.$timezone.select2("enable",!1))}s.bool(n.options.today)&&(n.$now=r('<button type="button" class="btn btn-xs btn-info" title="'+n.options.today+'"><span class="glyphicon glyphicon-time"></span></button>').addClass(n.options.classNowName).on("click",function(e){e.preventDefault();var t=new Date;n.$date&&n.$date.data("pickadate").set("select",t),n.$time&&n.$time.data("pickatime").set("select",t),n.emit("updated")}).appendTo(n.$wrapper)),s.bool(n.options.clear)&&(n.$clear=r('<button type="button" class="btn btn-xs btn-danger" title="'+n.options.clear+'"><span class="glyphicon glyphicon-trash"></span></button>').addClass(n.options.classClearName).on("click",function(e){e.preventDefault(),n.$date&&n.$date.data("pickadate").clear(),n.$time&&n.$time.data("pickatime").clear(),n.emit("updated")}).appendTo(n.$wrapper))},updateValue:function(){var e=this,t="";if(!1!==e.options.date){var n=e.$date.data("pickadate").component,i=e.$date.data("pickadate").get("select"),o=n.formats.toString;i&&(t+=o.apply(n,[e.options.date.formatSubmit,i]))}if(!1!==e.options.date&&!1!==e.options.time&&(t+=" "),!1!==e.options.time){var a=e.$time.data("pickatime").component,r=e.$time.data("pickatime").get("select"),s=a.formats.toString;r&&(t+=s.apply(a,["HH:i",r]))}if(null!==e.options.timezone){var l=" "+e.$timezone.attr("data-value");l&&(t+=l)}e.$el.val(t),e.emit("updated")}})}),require(["mockup-patterns-inlinevalidation","mockup-patterns-recurrence","mockup-patterns-relateditems","mockup-patterns-pickadate","mockup-patterns-select2"],function(){}),define("/Volumes/WORKSPACE2/buildout.coredev.barceloneta-lts/src/plone.staticresources/src/plone/staticresources/static/plone-logged-in.js",function(){});
//# sourceMappingURL=plone-logged-in-compiled.min.js.map